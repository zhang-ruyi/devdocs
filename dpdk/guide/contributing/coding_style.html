

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>1. DPDK Coding Style &mdash; Data Plane Development Kit 20.11.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2. Design" href="design.html" />
    <link rel="prev" title="Contributor’s Guidelines" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Data Plane Development Kit
          

          
            
            <img src="../_static/DPDK_logo_vertical_rev_small.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                20.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../linux_gsg/index.html">Getting Started Guide for Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../freebsd_gsg/index.html">Getting Started Guide for FreeBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../windows_gsg/index.html">Getting Started Guide for Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sample_app_ug/index.html">Sample Applications User Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prog_guide/index.html">Programmer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howto/index.html">HowTo Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">DPDK Tools User Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testpmd_app_ug/index.html">Testpmd Application User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nics/index.html">Network Interface Controller Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bbdevs/index.html">Baseband Device Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cryptodevs/index.html">Crypto Device Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compressdevs/index.html">Compression Device Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vdpadevs/index.html">vDPA Device Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../regexdevs/index.html">REGEX Device Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../eventdevs/index.html">Event Device Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rawdevs/index.html">Rawdev Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mempool/index.html">Mempool Device Driver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../platform/index.html">Platform Specific Guides</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Contributor’s Guidelines</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">1. DPDK Coding Style</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#description">1.1. Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#general-guidelines">1.2. General Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#c-comment-style">1.3. C Comment Style</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#usual-comments">1.3.1. Usual Comments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#license-header">1.3.2. License Header</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#c-preprocessor-directives">1.4. C Preprocessor Directives</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#header-includes">1.4.1. Header Includes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#header-file-guards">1.4.2. Header File Guards</a></li>
<li class="toctree-l4"><a class="reference internal" href="#macros">1.4.3. Macros</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conditional-compilation">1.4.4. Conditional Compilation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#c-types">1.5. C Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#integers">1.5.1. Integers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#enumerations">1.5.2. Enumerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bitfields">1.5.3. Bitfields</a></li>
<li class="toctree-l4"><a class="reference internal" href="#variable-declarations">1.5.4. Variable Declarations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#structure-declarations">1.5.5. Structure Declarations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#queues">1.5.6. Queues</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#naming">1.6. Naming</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#typedefs">1.6.1. Typedefs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#c-indentation">1.7. C Indentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#general">1.7.1. General</a></li>
<li class="toctree-l4"><a class="reference internal" href="#control-statements-and-loops">1.7.2. Control Statements and Loops</a></li>
<li class="toctree-l4"><a class="reference internal" href="#function-calls">1.7.3. Function Calls</a></li>
<li class="toctree-l4"><a class="reference internal" href="#operators">1.7.4. Operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exit">1.7.5. Exit</a></li>
<li class="toctree-l4"><a class="reference internal" href="#local-variables">1.7.6. Local Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#casts-and-sizeof">1.7.7. Casts and sizeof</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#c-function-definition-declaration-and-use">1.8. C Function Definition, Declaration and Use</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#prototypes">1.8.1. Prototypes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#definitions">1.8.2. Definitions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#c-statement-style-and-conventions">1.9. C Statement Style and Conventions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#null-pointers">1.9.1. NULL Pointers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#return-value">1.9.2. Return Value</a></li>
<li class="toctree-l4"><a class="reference internal" href="#logging-and-errors">1.9.3. Logging and Errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="#branch-prediction">1.9.4. Branch Prediction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#static-variables-and-functions">1.9.5. Static Variables and Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#const-attribute">1.9.6. Const Attribute</a></li>
<li class="toctree-l4"><a class="reference internal" href="#inline-asm-in-c-code">1.9.7. Inline ASM in C code</a></li>
<li class="toctree-l4"><a class="reference internal" href="#control-statements">1.9.8. Control Statements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-logging">1.10. Dynamic Logging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#specializations">1.10.1. Specializations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#python-code">1.11. Python Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integrating-with-the-build-system">1.12. Integrating with the Build System</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#meson-build-file-contents-libraries">1.12.1. Meson Build File Contents - Libraries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#meson-build-file-contents-drivers">1.12.2. Meson Build File Contents - Drivers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="design.html">2. Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="abi_policy.html">3. ABI Policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="abi_versioning.html">4. ABI Versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="documentation.html">5. DPDK Documentation Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="patches.html">6. Contributing Code to DPDK</a></li>
<li class="toctree-l2"><a class="reference internal" href="vulnerability.html">7. DPDK Vulnerability Management Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="stable.html">8. DPDK Stable Releases and Long Term Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="cheatsheet.html">9. Patch Cheatsheet</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../rel_notes/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Data Plane Development Kit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Contributor’s Guidelines</a> &raquo;</li>
        
      <li><span class="section-number">1. </span>DPDK Coding Style</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/contributing/coding_style.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dpdk-coding-style">
<span id="coding-style"></span><h1><span class="section-number">1. </span>DPDK Coding Style</h1>
<div class="section" id="description">
<h2><span class="section-number">1.1. </span>Description</h2>
<p>This document specifies the preferred style for source files in the DPDK source tree.
It is based on the Linux Kernel coding guidelines and the FreeBSD 7.2 Kernel Developer’s Manual (see man style(9)), but was heavily modified for the needs of the DPDK.</p>
</div>
<div class="section" id="general-guidelines">
<h2><span class="section-number">1.2. </span>General Guidelines</h2>
<p>The rules and guidelines given in this document cannot cover every situation, so the following general guidelines should be used as a fallback:</p>
<ul class="simple">
<li><p>The code style should be consistent within each individual file.</p></li>
<li><p>In the case of creating new files, the style should be consistent within each file in a given directory or module.</p></li>
<li><p>The primary reason for coding standards is to increase code readability and comprehensibility, therefore always use whatever option will make the code easiest to read.</p></li>
</ul>
<p>Line length is recommended to be not more than 80 characters, including comments.
[Tab stop size should be assumed to be 8-characters wide].</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The above is recommendation, and not a hard limit.
However, it is expected that the recommendations should be followed in all but the rarest situations.</p>
</div>
</div>
<div class="section" id="c-comment-style">
<h2><span class="section-number">1.3. </span>C Comment Style</h2>
<div class="section" id="usual-comments">
<h3><span class="section-number">1.3.1. </span>Usual Comments</h3>
<p>These comments should be used in normal cases.
To document a public API, a doxygen-like format must be used: refer to <a class="reference internal" href="documentation.html#doxygen-guidelines"><span class="std std-ref">Doxygen Guidelines</span></a>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * VERY important single-line comments look like this.</span>
<span class="cm"> */</span>

<span class="cm">/* Most single-line comments look like this. */</span>

<span class="cm">/*</span>
<span class="cm"> * Multi-line comments look like this.  Make them real sentences. Fill</span>
<span class="cm"> * them so they look like real paragraphs.</span>
<span class="cm"> */</span>
</pre></div>
</div>
</div>
<div class="section" id="license-header">
<h3><span class="section-number">1.3.2. </span>License Header</h3>
<p>Each file must begin with a special comment containing the
<a class="reference external" href="https://spdx.org/using-spdx-license-identifier">Software Package Data Exchange (SPDX) License Identfier</a>.</p>
<p>Generally this is the BSD License, except for code granted special exceptions.
The SPDX licences identifier is sufficient, a file should not contain
an additional text version of the license (boilerplate).</p>
<p>After any copyright header, a blank line should be left before any other contents, e.g. include statements in a C file.</p>
</div>
</div>
<div class="section" id="c-preprocessor-directives">
<h2><span class="section-number">1.4. </span>C Preprocessor Directives</h2>
<div class="section" id="header-includes">
<h3><span class="section-number">1.4.1. </span>Header Includes</h3>
<p>In DPDK sources, the include files should be ordered as following:</p>
<ol class="arabic simple">
<li><p>libc includes (system includes first)</p></li>
<li><p>DPDK EAL includes</p></li>
<li><p>DPDK misc libraries includes</p></li>
<li><p>application-specific includes</p></li>
</ol>
<p>Include files from the local application directory are included using quotes, while includes from other paths are included using angle brackets: “&lt;&gt;”.</p>
<p>Example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&lt;rte_eal.h&gt;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&lt;rte_ring.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;rte_mempool.h&gt;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&quot;application.h&quot;</span><span class="cp"></span>
</pre></div>
</div>
</div>
<div class="section" id="header-file-guards">
<h3><span class="section-number">1.4.2. </span>Header File Guards</h3>
<p>Headers should be protected against multiple inclusion with the usual:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef _FILE_H_</span>
<span class="cp">#define _FILE_H_</span>

<span class="cm">/* Code */</span>

<span class="cp">#endif </span><span class="cm">/* _FILE_H_ */</span><span class="cp"></span>
</pre></div>
</div>
</div>
<div class="section" id="macros">
<h3><span class="section-number">1.4.3. </span>Macros</h3>
<p>Do not <code class="docutils literal notranslate"><span class="pre">#define</span></code> or declare names except with the standard DPDK prefix: <code class="docutils literal notranslate"><span class="pre">RTE_</span></code>.
This is to ensure there are no collisions with definitions in the application itself.</p>
<p>The names of “unsafe” macros (ones that have side effects), and the names of macros for manifest constants, are all in uppercase.</p>
<p>The expansions of expression-like macros are either a single token or have outer parentheses.
If a macro is an inline expansion of a function, the function name is all in lowercase and the macro has the same name all in uppercase.
If the macro encapsulates a compound statement, enclose it in a do-while loop, so that it can be used safely in if statements.
Any final statement-terminating semicolon should be supplied by the macro invocation rather than the macro, to make parsing easier for pretty-printers and editors.</p>
<p>For example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define MACRO(x, y) do {                                        \</span>
<span class="cp">        variable = (x) + (y);                                   \</span>
<span class="cp">        (y) += 2;                                               \</span>
<span class="cp">} while(0)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Wherever possible, enums and inline functions should be preferred to macros, since they provide additional degrees of type-safety and can allow compilers to emit extra warnings about unsafe code.</p>
</div>
</div>
<div class="section" id="conditional-compilation">
<h3><span class="section-number">1.4.4. </span>Conditional Compilation</h3>
<ul class="simple">
<li><p>When code is conditionally compiled using <code class="docutils literal notranslate"><span class="pre">#ifdef</span></code> or <code class="docutils literal notranslate"><span class="pre">#if</span></code>, a comment may be added following the matching
<code class="docutils literal notranslate"><span class="pre">#endif</span></code> or <code class="docutils literal notranslate"><span class="pre">#else</span></code> to permit the reader to easily discern where conditionally compiled code regions end.</p></li>
<li><p>This comment should be used only for (subjectively) long regions, regions greater than 20 lines, or where a series of nested <code class="docutils literal notranslate"><span class="pre">#ifdef</span></code>’s may be confusing to the reader.
Exceptions may be made for cases where code is conditionally not compiled for the purposes of lint(1), or other tools, even though the uncompiled region may be small.</p></li>
<li><p>The comment should be separated from the <code class="docutils literal notranslate"><span class="pre">#endif</span></code> or <code class="docutils literal notranslate"><span class="pre">#else</span></code> by a single space.</p></li>
<li><p>For short conditionally compiled regions, a closing comment should not be used.</p></li>
<li><p>The comment for <code class="docutils literal notranslate"><span class="pre">#endif</span></code> should match the expression used in the corresponding <code class="docutils literal notranslate"><span class="pre">#if</span></code> or <code class="docutils literal notranslate"><span class="pre">#ifdef</span></code>.</p></li>
<li><p>The comment for <code class="docutils literal notranslate"><span class="pre">#else</span></code> and <code class="docutils literal notranslate"><span class="pre">#elif</span></code> should match the inverse of the expression(s) used in the preceding <code class="docutils literal notranslate"><span class="pre">#if</span></code> and/or <code class="docutils literal notranslate"><span class="pre">#elif</span></code> statements.</p></li>
<li><p>In the comments, the subexpression <code class="docutils literal notranslate"><span class="pre">defined(FOO)</span></code> is abbreviated as “FOO”.
For the purposes of comments, <code class="docutils literal notranslate"><span class="pre">#ifndef</span> <span class="pre">FOO</span></code> is treated as <code class="docutils literal notranslate"><span class="pre">#if</span> <span class="pre">!defined(FOO)</span></code>.</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifdef KTRACE</span>
<span class="cp">#include</span> <span class="cpf">&lt;sys/ktrace.h&gt;</span><span class="cp"></span>
<span class="cp">#endif</span>

<span class="cp">#ifdef COMPAT_43</span>
<span class="cm">/* A large region here, or other conditional code. */</span>
<span class="cp">#else </span><span class="cm">/* !COMPAT_43 */</span><span class="cp"></span>
<span class="cm">/* Or here. */</span>
<span class="cp">#endif </span><span class="cm">/* COMPAT_43 */</span><span class="cp"></span>

<span class="cp">#ifndef COMPAT_43</span>
<span class="cm">/* Yet another large region here, or other conditional code. */</span>
<span class="cp">#else </span><span class="cm">/* COMPAT_43 */</span><span class="cp"></span>
<span class="cm">/* Or here. */</span>
<span class="cp">#endif </span><span class="cm">/* !COMPAT_43 */</span><span class="cp"></span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Conditional compilation should be used only when absolutely necessary, as it increases the number of target binaries that need to be built and tested.</p>
</div>
</div>
</div>
<div class="section" id="c-types">
<h2><span class="section-number">1.5. </span>C Types</h2>
<div class="section" id="integers">
<h3><span class="section-number">1.5.1. </span>Integers</h3>
<p>For fixed/minimum-size integer values, the project uses the form uintXX_t (from stdint.h) instead of older BSD-style integer identifiers of the form u_intXX_t.</p>
</div>
<div class="section" id="enumerations">
<h3><span class="section-number">1.5.2. </span>Enumerations</h3>
<ul class="simple">
<li><p>Enumeration values are all uppercase.</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span> <span class="n">enumtype</span> <span class="p">{</span> <span class="n">ONE</span><span class="p">,</span> <span class="n">TWO</span> <span class="p">}</span> <span class="n">et</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Enum types should be used in preference to macros #defining a set of (sequential) values.</p></li>
<li><p>Enum types should be prefixed with <code class="docutils literal notranslate"><span class="pre">rte_</span></code> and the elements by a suitable prefix [generally starting <code class="docutils literal notranslate"><span class="pre">RTE_&lt;enum&gt;_</span></code> - where &lt;enum&gt; is a shortname for the enum type] to avoid namespace collisions.</p></li>
</ul>
</div>
<div class="section" id="bitfields">
<h3><span class="section-number">1.5.3. </span>Bitfields</h3>
<p>The developer should group bitfields that are included in the same integer, as follows:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">grehdr</span> <span class="p">{</span>
  <span class="kt">uint16_t</span> <span class="nl">rec</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
      <span class="nl">srr</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
      <span class="nl">seq</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
      <span class="nl">key</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
      <span class="nl">routing</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
      <span class="nl">csum</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
      <span class="nl">version</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
      <span class="nl">reserved</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>
      <span class="nl">ack</span><span class="p">:</span><span class="mi">1</span><span class="p">;</span>
<span class="cm">/* ... */</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="variable-declarations">
<h3><span class="section-number">1.5.4. </span>Variable Declarations</h3>
<p>In declarations, do not put any whitespace between asterisks and adjacent tokens, except for tokens that are identifiers related to types.
(These identifiers are the names of basic types, type qualifiers, and typedef-names other than the one being declared.)
Separate these identifiers from asterisks using a single space.</p>
<p>For example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="o">*</span><span class="n">x</span><span class="p">;</span>         <span class="cm">/* no space after asterisk */</span>
<span class="kt">int</span> <span class="o">*</span> <span class="k">const</span> <span class="n">x</span><span class="p">;</span>  <span class="cm">/* space after asterisk when using a type qualifier */</span>
</pre></div>
</div>
<ul class="simple">
<li><p>All externally-visible variables should have an <code class="docutils literal notranslate"><span class="pre">rte_</span></code> prefix in the name to avoid namespace collisions.</p></li>
<li><p>Do not use uppercase letters - either in the form of ALL_UPPERCASE, or CamelCase - in variable names.
Lower-case letters and underscores only.</p></li>
</ul>
</div>
<div class="section" id="structure-declarations">
<h3><span class="section-number">1.5.5. </span>Structure Declarations</h3>
<ul class="simple">
<li><p>In general, when declaring variables in new structures, declare them sorted by use, then by size (largest to smallest), and then in alphabetical order.
Sorting by use means that commonly used variables are used together and that the structure layout makes logical sense.
Ordering by size then ensures that as little padding is added to the structure as possible.</p></li>
<li><p>For existing structures, additions to structures should be added to the end so for backward compatibility reasons.</p></li>
<li><p>Each structure element gets its own line.</p></li>
<li><p>Try to make the structure readable by aligning the member names using spaces as shown below.</p></li>
<li><p>Names following extremely long types, which therefore cannot be easily aligned with the rest, should be separated by a single space.</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">foo</span> <span class="p">{</span>
        <span class="k">struct</span> <span class="n">foo</span>      <span class="o">*</span><span class="n">next</span><span class="p">;</span>          <span class="cm">/* List of active foo. */</span>
        <span class="k">struct</span> <span class="n">mumble</span>   <span class="n">amumble</span><span class="p">;</span>        <span class="cm">/* Comment for mumble. */</span>
        <span class="kt">int</span>             <span class="n">bar</span><span class="p">;</span>            <span class="cm">/* Try to align the comments. */</span>
        <span class="k">struct</span> <span class="n">verylongtypename</span> <span class="o">*</span><span class="n">baz</span><span class="p">;</span>   <span class="cm">/* Won&#39;t fit with other members */</span>
<span class="p">};</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Major structures should be declared at the top of the file in which they are used, or in separate header files if they are used in multiple source files.</p></li>
<li><p>Use of the structures should be by separate variable declarations and those declarations must be extern if they are declared in a header file.</p></li>
<li><p>Externally visible structure definitions should have the structure name prefixed by <code class="docutils literal notranslate"><span class="pre">rte_</span></code> to avoid namespace collisions.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Uses of <code class="docutils literal notranslate"><span class="pre">bool</span></code> in structures are not preferred as is wastes space and
it’s also not clear as to what type size the bool is. A preferred use of
<code class="docutils literal notranslate"><span class="pre">bool</span></code> is mainly as a return type from functions that return true/false,
and maybe local variable functions.</p>
<p>Ref: <a class="reference external" href="https://lkml.org/lkml/2017/11/21/384">LKML</a></p>
</div>
</div>
<div class="section" id="queues">
<h3><span class="section-number">1.5.6. </span>Queues</h3>
<p>Use queue(3) macros rather than rolling your own lists, whenever possible.
Thus, the previous example would be better written:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;sys/queue.h&gt;</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">foo</span> <span class="p">{</span>
        <span class="n">LIST_ENTRY</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span> <span class="n">link</span><span class="p">;</span>      <span class="cm">/* Use queue macros for foo lists. */</span>
        <span class="k">struct</span> <span class="n">mumble</span>   <span class="n">amumble</span><span class="p">;</span>   <span class="cm">/* Comment for mumble. */</span>
        <span class="kt">int</span>             <span class="n">bar</span><span class="p">;</span>       <span class="cm">/* Try to align the comments. */</span>
        <span class="k">struct</span> <span class="n">verylongtypename</span> <span class="o">*</span><span class="n">baz</span><span class="p">;</span>   <span class="cm">/* Won&#39;t fit with other members */</span>
<span class="p">};</span>
<span class="n">LIST_HEAD</span><span class="p">(,</span> <span class="n">foo</span><span class="p">)</span> <span class="n">foohead</span><span class="p">;</span>          <span class="cm">/* Head of global foo list. */</span>
</pre></div>
</div>
<p>DPDK also provides an optimized way to store elements in lockless rings.
This should be used in all data-path code, when there are several consumer and/or producers to avoid locking for concurrent access.</p>
</div>
</div>
<div class="section" id="naming">
<h2><span class="section-number">1.6. </span>Naming</h2>
<p>For symbol names and documentation, new usage of
‘master / slave’ (or ‘slave’ independent of ‘master’) and ‘blacklist /
whitelist’ is not allowed.</p>
<dl class="simple">
<dt>Recommended replacements for ‘master / slave’ are:</dt><dd><p>‘{primary,main} / {secondary,replica,subordinate}’
‘{initiator,requester} / {target,responder}’
‘{controller,host} / {device,worker,proxy}’
‘leader / follower’
‘director / performer’</p>
</dd>
<dt>Recommended replacements for ‘blacklist/whitelist’ are:</dt><dd><p>‘denylist / allowlist’
‘blocklist / passlist’</p>
</dd>
</dl>
<p>Exceptions for introducing new usage is to maintain compatibility
with an existing (as of 2020) hardware or protocol
specification that mandates those terms.</p>
<div class="section" id="typedefs">
<h3><span class="section-number">1.6.1. </span>Typedefs</h3>
<p>Avoid using typedefs for structure types.</p>
<p>For example, use:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">my_struct_type</span> <span class="p">{</span>
<span class="cm">/* ... */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">my_struct_type</span> <span class="n">my_var</span><span class="p">;</span>
</pre></div>
</div>
<p>rather than:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">struct</span> <span class="n">my_struct_type</span> <span class="p">{</span>
<span class="cm">/* ... */</span>
<span class="p">}</span> <span class="n">my_struct_type</span><span class="p">;</span>

<span class="n">my_struct_type</span> <span class="n">my_var</span>
</pre></div>
</div>
<p>Typedefs are problematic because they do not properly hide their underlying type;
for example, you need to know if the typedef is the structure itself, as shown above, or a pointer to the structure.
In addition, they must be declared exactly once, whereas an incomplete structure type can be mentioned as many times as necessary.
Typedefs are difficult to use in stand-alone header files.
The header that defines the typedef must be included before the header that uses it, or by the header that uses it (which causes namespace pollution),
or there must be a back-door mechanism for obtaining the typedef.</p>
<p>Note that #defines used instead of typedefs also are problematic (since they do not propagate the pointer type correctly due to direct text replacement).
For example, <code class="docutils literal notranslate"><span class="pre">#define</span> <span class="pre">pint</span> <span class="pre">int</span> <span class="pre">*</span></code> does not work as expected, while <code class="docutils literal notranslate"><span class="pre">typedef</span> <span class="pre">int</span> <span class="pre">*pint</span></code> does work.
As stated when discussing macros, typedefs should be preferred to macros in cases like this.</p>
<p>When convention requires a typedef; make its name match the struct tag.
Avoid typedefs ending in <code class="docutils literal notranslate"><span class="pre">_t</span></code>, except as specified in Standard C or by POSIX.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is recommended to use typedefs to define function pointer types, for reasons of code readability.
This is especially true when the function type is used as a parameter to another function.</p>
</div>
<p>For example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * Definition of a remote launch function.</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="nf">int</span> <span class="p">(</span><span class="n">lcore_function_t</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="p">);</span>

<span class="cm">/* launch a function of lcore_function_t type */</span>
<span class="kt">int</span> <span class="nf">rte_eal_remote_launch</span><span class="p">(</span><span class="n">lcore_function_t</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">worker_id</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="c-indentation">
<h2><span class="section-number">1.7. </span>C Indentation</h2>
<div class="section" id="general">
<h3><span class="section-number">1.7.1. </span>General</h3>
<ul class="simple">
<li><p>Indentation is a hard tab, that is, a tab character, not a sequence of spaces,</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Global whitespace rule in DPDK, use tabs for indentation, spaces for alignment.</p>
</div>
<ul class="simple">
<li><p>Do not put any spaces before a tab for indentation.</p></li>
<li><p>If you have to wrap a long statement, put the operator at the end of the line, and indent again.</p></li>
<li><p>For control statements (if, while, etc.), continuation it is recommended that the next line be indented by two tabs, rather than one,
to prevent confusion as to whether the second line of the control statement forms part of the statement body or not.
Alternatively, the line continuation may use additional spaces to line up to an appropriately point on the preceding line, for example, to align to an opening brace.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As with all style guidelines, code should match style already in use in an existing file.</p>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="p">(</span><span class="n">really_long_variable_name_1</span> <span class="o">==</span> <span class="n">really_long_variable_name_2</span> <span class="o">&amp;&amp;</span>
    <span class="n">var3</span> <span class="o">==</span> <span class="n">var4</span><span class="p">){</span>  <span class="cm">/* confusing to read as */</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">;</span>      <span class="cm">/* control stmt body lines up with second line of */</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">;</span>      <span class="cm">/* control statement itself if single indent used */</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="n">really_long_variable_name_1</span> <span class="o">==</span> <span class="n">really_long_variable_name_2</span> <span class="o">&amp;&amp;</span>
        <span class="n">var3</span> <span class="o">==</span> <span class="n">var4</span><span class="p">){</span>  <span class="cm">/* two tabs used */</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">;</span>          <span class="cm">/* statement body no longer lines up */</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">really</span> <span class="o">+</span> <span class="kt">long</span> <span class="o">+</span> <span class="n">statement</span> <span class="o">+</span> <span class="n">that</span> <span class="o">+</span> <span class="n">needs</span> <span class="o">+</span>
        <span class="n">two</span> <span class="o">+</span> <span class="n">lines</span> <span class="o">+</span> <span class="n">gets</span> <span class="o">+</span> <span class="n">indented</span> <span class="o">+</span> <span class="n">on</span> <span class="o">+</span> <span class="n">the</span> <span class="o">+</span>
        <span class="n">second</span> <span class="o">+</span> <span class="n">and</span> <span class="o">+</span> <span class="n">subsequent</span> <span class="o">+</span> <span class="n">lines</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Do not add whitespace at the end of a line.</p></li>
<li><p>Do not add whitespace or a blank line at the end of a file.</p></li>
</ul>
</div>
<div class="section" id="control-statements-and-loops">
<h3><span class="section-number">1.7.2. </span>Control Statements and Loops</h3>
<ul class="simple">
<li><p>Include a space after keywords (if, while, for, return, switch).</p></li>
<li><p>Do not use braces (<code class="docutils literal notranslate"><span class="pre">{</span></code> and <code class="docutils literal notranslate"><span class="pre">}</span></code>) for control statements with zero or just a single statement, unless that statement is more than a single line in which case the braces are permitted.</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">p</span> <span class="o">=</span> <span class="n">buf</span><span class="p">;</span> <span class="o">*</span><span class="n">p</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span> <span class="o">++</span><span class="n">p</span><span class="p">)</span>
        <span class="p">;</span>       <span class="cm">/* nothing */</span>
<span class="k">for</span> <span class="p">(;;)</span>
        <span class="n">stmt</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(;;)</span> <span class="p">{</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">really</span> <span class="o">+</span> <span class="kt">long</span> <span class="o">+</span> <span class="n">statement</span> <span class="o">+</span> <span class="n">that</span> <span class="o">+</span> <span class="n">needs</span> <span class="o">+</span>
                <span class="n">two</span> <span class="o">+</span> <span class="n">lines</span> <span class="o">+</span> <span class="n">gets</span> <span class="o">+</span> <span class="n">indented</span> <span class="o">+</span> <span class="n">on</span> <span class="o">+</span> <span class="n">the</span> <span class="o">+</span>
                <span class="n">second</span> <span class="o">+</span> <span class="n">and</span> <span class="o">+</span> <span class="n">subsequent</span> <span class="o">+</span> <span class="n">lines</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">for</span> <span class="p">(;;)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">cond</span><span class="p">)</span>
                <span class="n">stmt</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">realloc</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">newsize</span><span class="p">);</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Parts of a for loop may be left empty.</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">stmt1</span><span class="p">;</span>
        <span class="n">stmt2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Closing and opening braces go on the same line as the else keyword.</p></li>
<li><p>Braces that are not necessary should be left out.</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">test</span><span class="p">)</span>
        <span class="n">stmt</span><span class="p">;</span>
<span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">bar</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">stmt</span><span class="p">;</span>
        <span class="n">stmt</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span>
        <span class="n">stmt</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="function-calls">
<h3><span class="section-number">1.7.3. </span>Function Calls</h3>
<ul class="simple">
<li><p>Do not use spaces after function names.</p></li>
<li><p>Commas should have a space after them.</p></li>
<li><p>No spaces after <code class="docutils literal notranslate"><span class="pre">(</span></code> or <code class="docutils literal notranslate"><span class="pre">[</span></code> or preceding the <code class="docutils literal notranslate"><span class="pre">]</span></code> or <code class="docutils literal notranslate"><span class="pre">)</span></code> characters.</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">error</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">error</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">exit</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="operators">
<h3><span class="section-number">1.7.4. </span>Operators</h3>
<ul class="simple">
<li><p>Unary operators do not require spaces, binary operators do.</p></li>
<li><p>Do not use parentheses unless they are required for precedence or unless the statement is confusing without them.
However, remember that other people may be more easily confused than you.</p></li>
</ul>
</div>
<div class="section" id="exit">
<h3><span class="section-number">1.7.5. </span>Exit</h3>
<p>Exits should be 0 on success, or 1 on failure.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>        <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>        <span class="cm">/*</span>
<span class="cm">                         * Avoid obvious comments such as</span>
<span class="cm">                         * &quot;Exit 0 on success.&quot;</span>
<span class="cm">                         */</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="local-variables">
<h3><span class="section-number">1.7.6. </span>Local Variables</h3>
<ul class="simple">
<li><p>Variables should be declared at the start of a block of code rather than in the middle.
The exception to this is when the variable is <code class="docutils literal notranslate"><span class="pre">const</span></code> in which case the declaration must be at the point of first use/assignment.</p></li>
<li><p>When declaring variables in functions, multiple variables per line are OK.
However, if multiple declarations would cause the line to exceed a reasonable line length, begin a new set of declarations on the next line rather than using a line continuation.</p></li>
<li><p>Be careful to not obfuscate the code by initializing variables in the declarations, only the last variable on a line should be initialized.
If multiple variables are to be initialized when defined, put one per line.</p></li>
<li><p>Do not use function calls in initializers, except for <code class="docutils literal notranslate"><span class="pre">const</span></code> variables.</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>  <span class="cm">/* bad, too many initializer */</span>

<span class="kt">char</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>        <span class="cm">/* OK, one variable per line with initializer */</span>
<span class="kt">char</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kt">float</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>  <span class="cm">/* OK, only last variable has initializer */</span>
</pre></div>
</div>
</div>
<div class="section" id="casts-and-sizeof">
<h3><span class="section-number">1.7.7. </span>Casts and sizeof</h3>
<ul class="simple">
<li><p>Casts and sizeof statements are not followed by a space.</p></li>
<li><p>Always write sizeof statements with parenthesis.
The redundant parenthesis rules do not apply to sizeof(var) instances.</p></li>
</ul>
</div>
</div>
<div class="section" id="c-function-definition-declaration-and-use">
<h2><span class="section-number">1.8. </span>C Function Definition, Declaration and Use</h2>
<div class="section" id="prototypes">
<h3><span class="section-number">1.8.1. </span>Prototypes</h3>
<ul class="simple">
<li><p>It is recommended (and generally required by the compiler) that all non-static functions are prototyped somewhere.</p></li>
<li><p>Functions local to one source module should be declared static, and should not be prototyped unless absolutely necessary.</p></li>
<li><p>Functions used from other parts of code (external API) must be prototyped in the relevant include file.</p></li>
<li><p>Function prototypes should be listed in a logical order, preferably alphabetical unless there is a compelling reason to use a different ordering.</p></li>
<li><p>Functions that are used locally in more than one module go into a separate header file, for example, “extern.h”.</p></li>
<li><p>Do not use the <code class="docutils literal notranslate"><span class="pre">__P</span></code> macro.</p></li>
<li><p>Functions that are part of an external API should be documented using Doxygen-like comments above declarations. See <a class="reference internal" href="documentation.html#doxygen-guidelines"><span class="std std-ref">Doxygen Guidelines</span></a> for details.</p></li>
<li><p>Functions that are part of the external API must have an <code class="docutils literal notranslate"><span class="pre">rte_</span></code> prefix on the function name.</p></li>
<li><p>Do not use uppercase letters - either in the form of ALL_UPPERCASE, or CamelCase - in function names. Lower-case letters and underscores only.</p></li>
<li><p>When prototyping functions, associate names with parameter types, for example:</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">function1</span><span class="p">(</span><span class="kt">int</span> <span class="n">fd</span><span class="p">);</span> <span class="cm">/* good */</span>
<span class="kt">void</span> <span class="nf">function2</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span>    <span class="cm">/* bad */</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Short function prototypes should be contained on a single line.
Longer prototypes, e.g. those with many parameters, can be split across multiple lines.
The second and subsequent lines should be further indented as for line statement continuations as described in the previous section.</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">function1</span><span class="p">(</span><span class="kt">int</span> <span class="n">_arg</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">_arg2</span><span class="p">,</span>
       <span class="k">struct</span> <span class="n">foo</span> <span class="o">*</span><span class="n">_arg3</span><span class="p">,</span>
       <span class="k">struct</span> <span class="n">bar</span> <span class="o">*</span><span class="n">_arg4</span><span class="p">,</span>
       <span class="k">struct</span> <span class="n">baz</span> <span class="o">*</span><span class="n">_arg5</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">usage</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unlike function definitions, the function prototypes do not need to place the function return type on a separate line.</p>
</div>
</div>
<div class="section" id="definitions">
<h3><span class="section-number">1.8.2. </span>Definitions</h3>
<ul class="simple">
<li><p>The function type should be on a line by itself preceding the function.</p></li>
<li><p>The opening brace of the function body should be on a line by itself.</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">char</span> <span class="o">*</span>
<span class="nf">function</span><span class="p">(</span><span class="kt">int</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">,</span> <span class="kt">float</span> <span class="n">fl</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a4</span><span class="p">)</span>
<span class="p">{</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Do not declare functions inside other functions.
ANSI C states that such declarations have file scope regardless of the nesting of the declaration.
Hiding file declarations in what appears to be a local scope is undesirable and will elicit complaints from a good compiler.</p></li>
<li><p>Old-style (K&amp;R) function declaration should not be used, use ANSI function declarations instead as shown below.</p></li>
<li><p>Long argument lists should be wrapped as described above in the function prototypes section.</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * All major routines should have a comment briefly describing what</span>
<span class="cm"> * they do. The comment before the &quot;main&quot; routine should describe</span>
<span class="cm"> * what the program does.</span>
<span class="cm"> */</span>
<span class="kt">int</span>
<span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
        <span class="kt">char</span> <span class="o">*</span><span class="n">ep</span><span class="p">;</span>
        <span class="kt">long</span> <span class="n">num</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">ch</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="c-statement-style-and-conventions">
<h2><span class="section-number">1.9. </span>C Statement Style and Conventions</h2>
<div class="section" id="null-pointers">
<h3><span class="section-number">1.9.1. </span>NULL Pointers</h3>
<ul class="simple">
<li><p>NULL is the preferred null pointer constant.
Use NULL instead of <code class="docutils literal notranslate"><span class="pre">(type</span> <span class="pre">*)0</span></code> or <code class="docutils literal notranslate"><span class="pre">(type</span> <span class="pre">*)NULL</span></code>, except where the compiler does not know the destination type e.g. for variadic args to a function.</p></li>
<li><p>Test pointers against NULL, for example, use:</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="cm">/* Good, compare pointer to NULL */</span>

<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">)</span> <span class="cm">/* Bad, using ! on pointer */</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Do not use ! for tests unless it is a boolean, for example, use:</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">p</span> <span class="o">==</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span> <span class="cm">/* check character against (char)0 */</span>
</pre></div>
</div>
</div>
<div class="section" id="return-value">
<h3><span class="section-number">1.9.2. </span>Return Value</h3>
<ul class="simple">
<li><p>Functions which create objects, or allocate memory, should return pointer types, and NULL on error.
The error type should be indicated may setting the variable <code class="docutils literal notranslate"><span class="pre">rte_errno</span></code> appropriately.</p></li>
<li><p>Functions which work on bursts of packets, such as RX-like or TX-like functions, should return the number of packets handled.</p></li>
<li><p>Other functions returning int should generally behave like system calls:
returning 0 on success and -1 on error, setting <code class="docutils literal notranslate"><span class="pre">rte_errno</span></code> to indicate the specific type of error.</p></li>
<li><p>Where already standard in a given library, the alternative error approach may be used where the negative value is not -1 but is instead <code class="docutils literal notranslate"><span class="pre">-errno</span></code> if relevant, for example, <code class="docutils literal notranslate"><span class="pre">-EINVAL</span></code>.
Note, however, to allow consistency across functions returning integer or pointer types, the previous approach is preferred for any new libraries.</p></li>
<li><p>For functions where no error is possible, the function type should be <code class="docutils literal notranslate"><span class="pre">void</span></code> not <code class="docutils literal notranslate"><span class="pre">int</span></code>.</p></li>
<li><p>Routines returning <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span></code> should not have their return values cast to any pointer type.
(Typecasting can prevent the compiler from warning about missing prototypes as any implicit definition of a function returns int,
which, unlike <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span></code>, needs a typecast to assign to a pointer variable.)</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The above rule about not typecasting <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span></code> applies to malloc, as well as to DPDK functions.</p>
</div>
<ul class="simple">
<li><p>Values in return statements should not be enclosed in parentheses.</p></li>
</ul>
</div>
<div class="section" id="logging-and-errors">
<h3><span class="section-number">1.9.3. </span>Logging and Errors</h3>
<p>In the DPDK environment, use the logging interface provided:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* register log types for this application */</span>
<span class="kt">int</span> <span class="n">my_logtype1</span> <span class="o">=</span> <span class="n">rte_log_register</span><span class="p">(</span><span class="s">&quot;myapp.log1&quot;</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">my_logtype2</span> <span class="o">=</span> <span class="n">rte_log_register</span><span class="p">(</span><span class="s">&quot;myapp.log2&quot;</span><span class="p">);</span>

<span class="cm">/* set global log level to INFO */</span>
<span class="n">rte_log_set_global_level</span><span class="p">(</span><span class="n">RTE_LOG_INFO</span><span class="p">);</span>

<span class="cm">/* only display messages higher than NOTICE for log2 (default</span>
<span class="cm"> * is DEBUG) */</span>
<span class="n">rte_log_set_level</span><span class="p">(</span><span class="n">my_logtype2</span><span class="p">,</span> <span class="n">RTE_LOG_NOTICE</span><span class="p">);</span>

<span class="cm">/* enable all PMD logs (whose identifier string starts with &quot;pmd.&quot;) */</span>
<span class="n">rte_log_set_level_pattern</span><span class="p">(</span><span class="s">&quot;pmd.*&quot;</span><span class="p">,</span> <span class="n">RTE_LOG_DEBUG</span><span class="p">);</span>

<span class="cm">/* log in debug level */</span>
<span class="n">rte_log_set_global_level</span><span class="p">(</span><span class="n">RTE_LOG_DEBUG</span><span class="p">);</span>
<span class="n">RTE_LOG</span><span class="p">(</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">my_logtype1</span><span class="p">,</span> <span class="s">&quot;this is a debug level message</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="n">RTE_LOG</span><span class="p">(</span><span class="n">INFO</span><span class="p">,</span> <span class="n">my_logtype1</span><span class="p">,</span> <span class="s">&quot;this is a info level message</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="n">RTE_LOG</span><span class="p">(</span><span class="n">WARNING</span><span class="p">,</span> <span class="n">my_logtype1</span><span class="p">,</span> <span class="s">&quot;this is a warning level message</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="n">RTE_LOG</span><span class="p">(</span><span class="n">WARNING</span><span class="p">,</span> <span class="n">my_logtype2</span><span class="p">,</span> <span class="s">&quot;this is a debug level message (not displayed)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="cm">/* log in info level */</span>
<span class="n">rte_log_set_global_level</span><span class="p">(</span><span class="n">RTE_LOG_INFO</span><span class="p">);</span>
<span class="n">RTE_LOG</span><span class="p">(</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">my_logtype1</span><span class="p">,</span> <span class="s">&quot;debug level message (not displayed)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="branch-prediction">
<h3><span class="section-number">1.9.4. </span>Branch Prediction</h3>
<ul class="simple">
<li><p>When a test is done in a critical zone (called often or in a data path) the code can use the <code class="docutils literal notranslate"><span class="pre">likely()</span></code> and <code class="docutils literal notranslate"><span class="pre">unlikely()</span></code> macros to indicate the expected, or preferred fast path.
They are expanded as a compiler builtin and allow the developer to indicate if the branch is likely to be taken or not. Example:</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;rte_branch_prediction.h&gt;</span><span class="cp"></span>
<span class="k">if</span> <span class="p">(</span><span class="n">likely</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">))</span>
  <span class="n">do_stuff</span><span class="p">();</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The use of <code class="docutils literal notranslate"><span class="pre">likely()</span></code> and <code class="docutils literal notranslate"><span class="pre">unlikely()</span></code> should only be done in performance critical paths,
and only when there is a clearly preferred path, or a measured performance increase gained from doing so.
These macros should be avoided in non-performance-critical code.</p>
</div>
</div>
<div class="section" id="static-variables-and-functions">
<h3><span class="section-number">1.9.5. </span>Static Variables and Functions</h3>
<ul class="simple">
<li><p>All functions and variables that are local to a file must be declared as <code class="docutils literal notranslate"><span class="pre">static</span></code> because it can often help the compiler to do some optimizations (such as, inlining the code).</p></li>
<li><p>Functions that should be inlined should to be declared as <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">inline</span></code> and can be defined in a .c or a .h file.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Static functions defined in a header file must be declared as <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">inline</span></code> in order to prevent compiler warnings about the function being unused.</p>
</div>
</div>
<div class="section" id="const-attribute">
<h3><span class="section-number">1.9.6. </span>Const Attribute</h3>
<p>The <code class="docutils literal notranslate"><span class="pre">const</span></code> attribute should be used as often as possible when a variable is read-only.</p>
</div>
<div class="section" id="inline-asm-in-c-code">
<h3><span class="section-number">1.9.7. </span>Inline ASM in C code</h3>
<p>The <code class="docutils literal notranslate"><span class="pre">asm</span></code> and <code class="docutils literal notranslate"><span class="pre">volatile</span></code> keywords do not have underscores. The AT&amp;T syntax should be used.
Input and output operands should be named to avoid confusion, as shown in the following example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">asm</span> <span class="nf">volatile</span><span class="p">(</span><span class="s">&quot;outb %[val], %[port]&quot;</span>
        <span class="o">:</span> <span class="o">:</span>
        <span class="p">[</span><span class="n">port</span><span class="p">]</span> <span class="s">&quot;dN&quot;</span> <span class="p">(</span><span class="n">port</span><span class="p">),</span>
        <span class="p">[</span><span class="n">val</span><span class="p">]</span> <span class="s">&quot;a&quot;</span> <span class="p">(</span><span class="n">val</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="section" id="control-statements">
<h3><span class="section-number">1.9.8. </span>Control Statements</h3>
<ul class="simple">
<li><p>Forever loops are done with for statements, not while statements.</p></li>
<li><p>Elements in a switch statement that cascade should have a FALLTHROUGH comment. For example:</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">switch</span> <span class="p">(</span><span class="n">ch</span><span class="p">)</span> <span class="p">{</span>         <span class="cm">/* Indent the switch. */</span>
<span class="k">case</span> <span class="sc">&#39;a&#39;</span><span class="o">:</span>             <span class="cm">/* Don&#39;t indent the case. */</span>
        <span class="n">aflag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>    <span class="cm">/* Indent case body one tab. */</span>
        <span class="cm">/* FALLTHROUGH */</span>
<span class="k">case</span> <span class="sc">&#39;b&#39;</span><span class="o">:</span>
        <span class="n">bflag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
<span class="k">case</span> <span class="sc">&#39;?&#39;</span><span class="o">:</span>
<span class="k">default</span><span class="o">:</span>
        <span class="n">usage</span><span class="p">();</span>
        <span class="cm">/* NOTREACHED */</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="dynamic-logging">
<h2><span class="section-number">1.10. </span>Dynamic Logging</h2>
<p>DPDK provides infrastructure to perform logging during runtime. This is very
useful for enabling debug output without recompilation. To enable or disable
logging of a particular topic, the <code class="docutils literal notranslate"><span class="pre">--log-level</span></code> parameter can be provided
to EAL, which will change the log level. DPDK code can register topics,
which allows the user to adjust the log verbosity for that specific topic.</p>
<p>In general, the naming scheme is as follows: <code class="docutils literal notranslate"><span class="pre">type.section.name</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p>Type is the type of component, where <code class="docutils literal notranslate"><span class="pre">lib</span></code>, <code class="docutils literal notranslate"><span class="pre">pmd</span></code>, <code class="docutils literal notranslate"><span class="pre">bus</span></code> and <code class="docutils literal notranslate"><span class="pre">user</span></code>
are the common options.</p></li>
<li><p>Section refers to a specific area, for example a poll-mode-driver for an
ethernet device would use <code class="docutils literal notranslate"><span class="pre">pmd.net</span></code>, while an eventdev PMD uses
<code class="docutils literal notranslate"><span class="pre">pmd.event</span></code>.</p></li>
<li><p>The name identifies the individual item that the log applies to.
The name section must align with
the directory that the PMD code resides. See examples below for clarity.</p></li>
</ul>
</div></blockquote>
<p>Examples:</p>
<blockquote>
<div><ul class="simple">
<li><p>The virtio network PMD in <code class="docutils literal notranslate"><span class="pre">drivers/net/virtio</span></code> uses <code class="docutils literal notranslate"><span class="pre">pmd.net.virtio</span></code></p></li>
<li><p>The eventdev software poll mode driver in <code class="docutils literal notranslate"><span class="pre">drivers/event/sw</span></code> uses <code class="docutils literal notranslate"><span class="pre">pmd.event.sw</span></code></p></li>
<li><p>The octeontx mempool driver in <code class="docutils literal notranslate"><span class="pre">drivers/mempool/octeontx</span></code> uses <code class="docutils literal notranslate"><span class="pre">pmd.mempool.octeontx</span></code></p></li>
<li><p>The DPDK hash library in <code class="docutils literal notranslate"><span class="pre">lib/librte_hash</span></code> uses <code class="docutils literal notranslate"><span class="pre">lib.hash</span></code></p></li>
</ul>
</div></blockquote>
<div class="section" id="specializations">
<h3><span class="section-number">1.10.1. </span>Specializations</h3>
<p>In addition to the above logging topic, any PMD or library can further split
logging output by using “specializations”. A specialization could be the
difference between initialization code, and logs of events that occur at runtime.</p>
<p>An example could be the initialization log messages getting one
specialization, while another specialization handles mailbox command logging.
Each PMD, library or component can create as many specializations as required.</p>
<p>A specialization looks like this:</p>
<blockquote>
<div><ul class="simple">
<li><p>Initialization output: <code class="docutils literal notranslate"><span class="pre">type.section.name.init</span></code></p></li>
<li><p>PF/VF mailbox output: <code class="docutils literal notranslate"><span class="pre">type.section.name.mbox</span></code></p></li>
</ul>
</div></blockquote>
<p>A real world example is the i40e poll mode driver which exposes two
specializations, one for initialization <code class="docutils literal notranslate"><span class="pre">pmd.net.i40e.init</span></code> and the other for
the remaining driver logs <code class="docutils literal notranslate"><span class="pre">pmd.net.i40e.driver</span></code>.</p>
<p>Note that specializations have no formatting rules, but please follow
a precedent if one exists. In order to see all current log topics and
specializations, run the <code class="docutils literal notranslate"><span class="pre">app/test</span></code> binary, and use the <code class="docutils literal notranslate"><span class="pre">dump_log_types</span></code></p>
</div>
</div>
<div class="section" id="python-code">
<h2><span class="section-number">1.11. </span>Python Code</h2>
<p>All Python code should be compliant with
<a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP8 (Style Guide for Python Code)</a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pep8</span></code> tool can be used for testing compliance with the guidelines.</p>
</div>
<div class="section" id="integrating-with-the-build-system">
<h2><span class="section-number">1.12. </span>Integrating with the Build System</h2>
<p>DPDK is built using the tools <code class="docutils literal notranslate"><span class="pre">meson</span></code> and <code class="docutils literal notranslate"><span class="pre">ninja</span></code>.</p>
<p>Therefore all new component additions should include a <code class="docutils literal notranslate"><span class="pre">meson.build</span></code> file,
and should be added to the component lists in the <code class="docutils literal notranslate"><span class="pre">meson.build</span></code> files in the
relevant top-level directory:
either <code class="docutils literal notranslate"><span class="pre">lib</span></code> directory or a <code class="docutils literal notranslate"><span class="pre">driver</span></code> subdirectory.</p>
<div class="section" id="meson-build-file-contents-libraries">
<h3><span class="section-number">1.12.1. </span>Meson Build File Contents - Libraries</h3>
<p>The <code class="docutils literal notranslate"><span class="pre">meson.build</span></code> file for a new DPDK library should be of the following basic
format.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sources</span> <span class="o">=</span> <span class="n">files</span><span class="p">(</span><span class="s1">&#39;file1.c&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="n">headers</span> <span class="o">=</span> <span class="n">files</span><span class="p">(</span><span class="s1">&#39;file1.h&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>This will build based on a number of conventions and assumptions within the DPDK
itself, for example, that the library name is the same as the directory name in
which the files are stored.</p>
<p>For a library <code class="docutils literal notranslate"><span class="pre">meson.build</span></code> file, there are number of variables which can be
set, some mandatory, others optional. The mandatory fields are:</p>
<dl class="simple">
<dt>sources</dt><dd><p><strong>Default Value = []</strong>.
This variable should list out the files to be compiled up to create the
library. Files must be specified using the meson <code class="docutils literal notranslate"><span class="pre">files()</span></code> function.</p>
</dd>
</dl>
<p>The optional fields are:</p>
<dl class="simple">
<dt>build</dt><dd><p><strong>Default Value = true</strong>
Used to optionally compile a library, based on its dependencies or
environment. When set to “false” the <code class="docutils literal notranslate"><span class="pre">reason</span></code> value, explained below, should
also be set to explain to the user why the component is not being built.
A simple example of use would be:</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="n">is_linux</span>
        <span class="n">build</span> <span class="o">=</span> <span class="n">false</span>
        <span class="n">reason</span> <span class="o">=</span> <span class="s1">&#39;only supported on Linux&#39;</span>
<span class="n">endif</span>
</pre></div>
</div>
<dl class="simple">
<dt>cflags</dt><dd><p><strong>Default Value = [&lt;-march/-mcpu flags&gt;]</strong>.
Used to specify any additional cflags that need to be passed to compile
the sources in the library.</p>
</dd>
<dt>deps</dt><dd><p><strong>Default Value = [‘eal’]</strong>.
Used to list the internal library dependencies of the library. It should
be assigned to using <code class="docutils literal notranslate"><span class="pre">+=</span></code> rather than overwriting using <code class="docutils literal notranslate"><span class="pre">=</span></code>.  The
dependencies should be specified as strings, each one giving the name of
a DPDK library, without the <code class="docutils literal notranslate"><span class="pre">librte_</span></code> prefix. Dependencies are handled
recursively, so specifying e.g. <code class="docutils literal notranslate"><span class="pre">mempool</span></code>, will automatically also
make the library depend upon the mempool library’s dependencies too -
<code class="docutils literal notranslate"><span class="pre">ring</span></code> and <code class="docutils literal notranslate"><span class="pre">eal</span></code>. For libraries that only depend upon EAL, this
variable may be omitted from the <code class="docutils literal notranslate"><span class="pre">meson.build</span></code> file.  For example:</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">deps</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;ethdev&#39;</span><span class="p">]</span>
</pre></div>
</div>
<dl class="simple">
<dt>ext_deps</dt><dd><p><strong>Default Value = []</strong>.
Used to specify external dependencies of this library. They should be
returned as dependency objects, as returned from the meson
<code class="docutils literal notranslate"><span class="pre">dependency()</span></code> or <code class="docutils literal notranslate"><span class="pre">find_library()</span></code> functions. Before returning
these, they should be checked to ensure the dependencies have been
found, and, if not, the <code class="docutils literal notranslate"><span class="pre">build</span></code> variable should be set to <code class="docutils literal notranslate"><span class="pre">false</span></code>.
For example:</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_dep</span> <span class="o">=</span> <span class="n">dependency</span><span class="p">(</span><span class="s1">&#39;libX&#39;</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="s1">&#39;false&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">my_dep</span><span class="o">.</span><span class="n">found</span><span class="p">()</span>
        <span class="n">ext_deps</span> <span class="o">+=</span> <span class="n">my_dep</span>
<span class="k">else</span>
        <span class="n">build</span> <span class="o">=</span> <span class="n">false</span>
<span class="n">endif</span>
</pre></div>
</div>
<dl class="simple">
<dt>headers</dt><dd><p><strong>Default Value = []</strong>.
Used to return the list of header files for the library that should be
installed to $PREFIX/include when <code class="docutils literal notranslate"><span class="pre">ninja</span> <span class="pre">install</span></code> is run. As with
source files, these should be specified using the meson <code class="docutils literal notranslate"><span class="pre">files()</span></code>
function.</p>
</dd>
<dt>includes:</dt><dd><p><strong>Default Value = []</strong>.
Used to indicate any additional header file paths which should be
added to the header search path for other libs depending on this
library. EAL uses this so that other libraries building against it
can find the headers in subdirectories of the main EAL directory. The
base directory of each library is always given in the include path,
it does not need to be specified here.</p>
</dd>
<dt>name</dt><dd><p><strong>Default Value = library name derived from the directory name</strong>.
If a library’s .so or .a file differs from that given in the directory
name, the name should be specified using this variable. In practice,
since the convention is that for a library called <code class="docutils literal notranslate"><span class="pre">librte_xyz.so</span></code>, the
sources are stored in a directory <code class="docutils literal notranslate"><span class="pre">lib/librte_xyz</span></code>, this value should
never be needed for new libraries.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The name value also provides the name used to find the function version
map file, as part of the build process, so if the directory name and
library names differ, the <code class="docutils literal notranslate"><span class="pre">version.map</span></code> file should be named
consistently with the library, not the directory</p>
</div>
<dl class="simple">
<dt>objs</dt><dd><p><strong>Default Value = []</strong>.
This variable can be used to pass to the library build some pre-built
objects that were compiled up as part of another target given in the
included library <code class="docutils literal notranslate"><span class="pre">meson.build</span></code> file.</p>
</dd>
<dt>reason</dt><dd><p><strong>Default Value = ‘&lt;unknown reason&gt;’</strong>.
This variable should be used when a library is not to be built i.e. when
<code class="docutils literal notranslate"><span class="pre">build</span></code> is set to “false”, to specify the reason why a library will not be
built. For missing dependencies this should be of the form
<code class="docutils literal notranslate"><span class="pre">'missing</span> <span class="pre">dependency,</span> <span class="pre">&quot;libname&quot;'</span></code>.</p>
</dd>
<dt>use_function_versioning</dt><dd><p><strong>Default Value = false</strong>.
Specifies if the library in question has ABI versioned functions. If it
has, this value should be set to ensure that the C files are compiled
twice with suitable parameters for each of shared or static library
builds.</p>
</dd>
</dl>
</div>
<div class="section" id="meson-build-file-contents-drivers">
<h3><span class="section-number">1.12.2. </span>Meson Build File Contents - Drivers</h3>
<p>For drivers, the values are largely the same as for libraries. The variables
supported are:</p>
<dl class="simple">
<dt>build</dt><dd><p>As above.</p>
</dd>
<dt>cflags</dt><dd><p>As above.</p>
</dd>
<dt>deps</dt><dd><p>As above.</p>
</dd>
<dt>ext_deps</dt><dd><p>As above.</p>
</dd>
<dt>includes</dt><dd><p><strong>Default Value = &lt;driver directory&gt;</strong> Some drivers include a base
directory for additional source files and headers, so we have this
variable to allow the headers from that base directory to be found when
compiling driver sources. Should be appended to using <code class="docutils literal notranslate"><span class="pre">+=</span></code> rather than
overwritten using <code class="docutils literal notranslate"><span class="pre">=</span></code>.  The values appended should be meson include
objects got using the <code class="docutils literal notranslate"><span class="pre">include_directories()</span></code> function. For example:</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">includes</span> <span class="o">+=</span> <span class="n">include_directories</span><span class="p">(</span><span class="s1">&#39;base&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>name</dt><dd><p>As above, though note that each driver class can define it’s own naming
scheme for the resulting <code class="docutils literal notranslate"><span class="pre">.so</span></code> files.</p>
</dd>
<dt>objs</dt><dd><p>As above, generally used for the contents of the <code class="docutils literal notranslate"><span class="pre">base</span></code> directory.</p>
</dd>
<dt>pkgconfig_extra_libs</dt><dd><p><strong>Default Value = []</strong>
This variable is used to pass additional library link flags through to
the DPDK pkgconfig file generated, for example, to track any additional
libraries that may need to be linked into the build - especially when
using static libraries. Anything added here will be appended to the end
of the <code class="docutils literal notranslate"><span class="pre">pkgconfig</span> <span class="pre">--libs</span></code> output.</p>
</dd>
<dt>reason</dt><dd><p>As above.</p>
</dd>
<dt>sources [mandatory]</dt><dd><p>As above</p>
</dd>
<dt>headers</dt><dd><p>As above</p>
</dd>
<dt>version</dt><dd><p>As above</p>
</dd>
</dl>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="design.html" class="btn btn-neutral float-right" title="2. Design" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="Contributor’s Guidelines" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>