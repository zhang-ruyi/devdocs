<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DPDK: examples/ip_pipeline/thread.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DPDK
   &#160;<span id="projectnumber">20.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">examples/ip_pipeline/thread.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/* SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment"> * Copyright(c) 2010-2018 Intel Corporation</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__common_8h.html">rte_common.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__cycles_8h.html">rte_cycles.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__lcore_8h.html">rte_lcore.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ring_8h.html">rte_ring.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__table__acl_8h.html">rte_table_acl.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__table__array_8h.html">rte_table_array.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__table__hash_8h.html">rte_table_hash.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__table__lpm_8h.html">rte_table_lpm.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__table__lpm__ipv6_8h.html">rte_table_lpm_ipv6.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;common.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;thread.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;pipeline.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef THREAD_PIPELINES_MAX</span></div>
<div class="line"><span class="preprocessor">#define THREAD_PIPELINES_MAX                               256</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef THREAD_MSGQ_SIZE</span></div>
<div class="line"><span class="preprocessor">#define THREAD_MSGQ_SIZE                                   64</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef THREAD_TIMER_PERIOD_MS</span></div>
<div class="line"><span class="preprocessor">#define THREAD_TIMER_PERIOD_MS                             100</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>thread {</div>
<div class="line">    <span class="keyword">struct </span><a name="_a0"></a><a class="code" href="structrte__ring.html">rte_ring</a> *msgq_req;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ring.html">rte_ring</a> *msgq_rsp;</div>
<div class="line"> </div>
<div class="line">    uint32_t enabled;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>thread thread[RTE_MAX_LCORE];</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>table_data {</div>
<div class="line">    <span class="keyword">struct </span>rte_table_action *a;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_data {</div>
<div class="line">    <span class="keyword">struct </span>rte_pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>table_data table_data[<a name="a1"></a><a class="code" href="rte__pipeline_8h.html#ae53c3736fb2a1edc8e4b9b185d9d8fc3">RTE_PIPELINE_TABLE_MAX</a>];</div>
<div class="line">    uint32_t n_tables;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ring.html">rte_ring</a> *msgq_req;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ring.html">rte_ring</a> *msgq_rsp;</div>
<div class="line">    uint64_t timer_period; <span class="comment">/* Measured in CPU cycles. */</span></div>
<div class="line">    uint64_t time_next;</div>
<div class="line"> </div>
<div class="line">    uint8_t buffer[TABLE_RULE_ACTION_SIZE_MAX];</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>thread_data {</div>
<div class="line">    <span class="keyword">struct </span>rte_pipeline *p[THREAD_PIPELINES_MAX];</div>
<div class="line">    uint32_t n_pipelines;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span>pipeline_data pipeline_data[THREAD_PIPELINES_MAX];</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ring.html">rte_ring</a> *msgq_req;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ring.html">rte_ring</a> *msgq_rsp;</div>
<div class="line">    uint64_t timer_period; <span class="comment">/* Measured in CPU cycles. */</span></div>
<div class="line">    uint64_t time_next;</div>
<div class="line">    uint64_t time_next_min;</div>
<div class="line">} <a name="a2"></a><a class="code" href="rte__common_8h.html#a38e32f822bc941e90fdcbe5a9c69b178">__rte_cache_aligned</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>thread_data thread_data[RTE_MAX_LCORE];</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">thread_free(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    uint32_t i;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; RTE_MAX_LCORE; i++) {</div>
<div class="line">        <span class="keyword">struct </span>thread *t = &amp;thread[i];</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (!<a name="a3"></a><a class="code" href="rte__lcore_8h.html#a5404ee6ac26cbe5a4f4ddef44d690b76">rte_lcore_is_enabled</a>(i))</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* MSGQs */</span></div>
<div class="line">        <span class="keywordflow">if</span> (t-&gt;msgq_req)</div>
<div class="line">            <a name="a4"></a><a class="code" href="rte__ring_8h.html#a564e012c1eb4ae08f9eea3acfd08b377">rte_ring_free</a>(t-&gt;msgq_req);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (t-&gt;msgq_rsp)</div>
<div class="line">            <a class="code" href="rte__ring_8h.html#a564e012c1eb4ae08f9eea3acfd08b377">rte_ring_free</a>(t-&gt;msgq_rsp);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">thread_init(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    uint32_t i;</div>
<div class="line"> </div>
<div class="line">    <a name="a5"></a><a class="code" href="rte__lcore_8h.html#ac779e61584eb9d087c3e20bf2d1150c8">RTE_LCORE_FOREACH_WORKER</a>(i) {</div>
<div class="line">        <span class="keywordtype">char</span> name[NAME_MAX];</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structrte__ring.html">rte_ring</a> *msgq_req, *msgq_rsp;</div>
<div class="line">        <span class="keyword">struct </span>thread *t = &amp;thread[i];</div>
<div class="line">        <span class="keyword">struct </span>thread_data *t_data = &amp;thread_data[i];</div>
<div class="line">        uint32_t cpu_id = <a name="a6"></a><a class="code" href="rte__lcore_8h.html#a023b4909f52c3cdf0351d71d2b5032bc">rte_lcore_to_socket_id</a>(i);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* MSGQs */</span></div>
<div class="line">        snprintf(name, <span class="keyword">sizeof</span>(name), <span class="stringliteral">&quot;THREAD-%04x-MSGQ-REQ&quot;</span>, i);</div>
<div class="line"> </div>
<div class="line">        msgq_req = <a name="a7"></a><a class="code" href="rte__ring_8h.html#ae4dece63653850041afd5c16d3d6e052">rte_ring_create</a>(name,</div>
<div class="line">            THREAD_MSGQ_SIZE,</div>
<div class="line">            cpu_id,</div>
<div class="line">            <a name="a8"></a><a class="code" href="rte__ring__core_8h.html#a127c66adbeab4653a47649993b94f35b">RING_F_SP_ENQ</a> | <a name="a9"></a><a class="code" href="rte__ring__core_8h.html#a421a61b2f94cdf65b3a6ac146c492fb9">RING_F_SC_DEQ</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (msgq_req == NULL) {</div>
<div class="line">            thread_free();</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        snprintf(name, <span class="keyword">sizeof</span>(name), <span class="stringliteral">&quot;THREAD-%04x-MSGQ-RSP&quot;</span>, i);</div>
<div class="line"> </div>
<div class="line">        msgq_rsp = <a class="code" href="rte__ring_8h.html#ae4dece63653850041afd5c16d3d6e052">rte_ring_create</a>(name,</div>
<div class="line">            THREAD_MSGQ_SIZE,</div>
<div class="line">            cpu_id,</div>
<div class="line">            <a class="code" href="rte__ring__core_8h.html#a127c66adbeab4653a47649993b94f35b">RING_F_SP_ENQ</a> | <a class="code" href="rte__ring__core_8h.html#a421a61b2f94cdf65b3a6ac146c492fb9">RING_F_SC_DEQ</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (msgq_rsp == NULL) {</div>
<div class="line">            thread_free();</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Main thread records */</span></div>
<div class="line">        t-&gt;msgq_req = msgq_req;</div>
<div class="line">        t-&gt;msgq_rsp = msgq_rsp;</div>
<div class="line">        t-&gt;enabled = 1;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Data plane thread records */</span></div>
<div class="line">        t_data-&gt;n_pipelines = 0;</div>
<div class="line">        t_data-&gt;msgq_req = msgq_req;</div>
<div class="line">        t_data-&gt;msgq_rsp = msgq_rsp;</div>
<div class="line">        t_data-&gt;timer_period =</div>
<div class="line">            (<a name="a10"></a><a class="code" href="rte__cycles_8h.html#ae016e608f344823e677819d8f04264c5">rte_get_tsc_hz</a>() * THREAD_TIMER_PERIOD_MS) / 1000;</div>
<div class="line">        t_data-&gt;time_next = <a name="a11"></a><a class="code" href="rte__cycles_8h.html#a34aaedfb8b9fa4f83d4cb3108cda2041">rte_get_tsc_cycles</a>() + t_data-&gt;timer_period;</div>
<div class="line">        t_data-&gt;time_next_min = t_data-&gt;time_next;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span></div>
<div class="line">thread_is_running(uint32_t thread_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="rte__launch_8h.html#aac7785c53560a19ce4108c510e5024c9">rte_lcore_state_t</a> thread_state;</div>
<div class="line"> </div>
<div class="line">    thread_state = <a name="a12"></a><a class="code" href="rte__launch_8h.html#a66d883d90f6112489b69c996a2f6f2ab">rte_eal_get_lcore_state</a>(thread_id);</div>
<div class="line">    <span class="keywordflow">return</span> (thread_state == <a name="a13"></a><a class="code" href="rte__launch_8h.html#aac7785c53560a19ce4108c510e5024c9a1061be6c3fb88d32829cba6f6b2be304">RUNNING</a>) ? 1 : 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span></div>
<div class="line">pipeline_is_running(<span class="keyword">struct</span> pipeline *p)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (p-&gt;enabled == 0)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> thread_is_running(p-&gt;thread_id);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum</span> thread_req_type {</div>
<div class="line">    THREAD_REQ_PIPELINE_ENABLE = 0,</div>
<div class="line">    THREAD_REQ_PIPELINE_DISABLE,</div>
<div class="line">    THREAD_REQ_MAX</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>thread_msg_req {</div>
<div class="line">    <span class="keyword">enum</span> thread_req_type type;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">union </span>{</div>
<div class="line">        <span class="keyword">struct </span>{</div>
<div class="line">            <span class="keyword">struct </span>rte_pipeline *p;</div>
<div class="line">            <span class="keyword">struct </span>{</div>
<div class="line">                <span class="keyword">struct </span>rte_table_action *a;</div>
<div class="line">            } table[<a class="code" href="rte__pipeline_8h.html#ae53c3736fb2a1edc8e4b9b185d9d8fc3">RTE_PIPELINE_TABLE_MAX</a>];</div>
<div class="line">            <span class="keyword">struct </span><a class="code" href="structrte__ring.html">rte_ring</a> *msgq_req;</div>
<div class="line">            <span class="keyword">struct </span><a class="code" href="structrte__ring.html">rte_ring</a> *msgq_rsp;</div>
<div class="line">            uint32_t timer_period_ms;</div>
<div class="line">            uint32_t n_tables;</div>
<div class="line">        } pipeline_enable;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">struct </span>{</div>
<div class="line">            <span class="keyword">struct </span>rte_pipeline *p;</div>
<div class="line">        } pipeline_disable;</div>
<div class="line">    };</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>thread_msg_rsp {</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>thread_msg_req *</div>
<div class="line">thread_msg_alloc(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">size_t</span> size = <a name="a14"></a><a class="code" href="rte__common_8h.html#a8df8b303b8ea240cf6aebf937fd21eaf">RTE_MAX</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> thread_msg_req),</div>
<div class="line">        <span class="keyword">sizeof</span>(<span class="keyword">struct</span> thread_msg_rsp));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> calloc(1, size);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">thread_msg_free(<span class="keyword">struct</span> thread_msg_rsp *rsp)</div>
<div class="line">{</div>
<div class="line">    free(rsp);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>thread_msg_rsp *</div>
<div class="line">thread_msg_send_recv(uint32_t thread_id,</div>
<div class="line">    <span class="keyword">struct</span> thread_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>thread *t = &amp;thread[thread_id];</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ring.html">rte_ring</a> *msgq_req = t-&gt;msgq_req;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ring.html">rte_ring</a> *msgq_rsp = t-&gt;msgq_rsp;</div>
<div class="line">    <span class="keyword">struct </span>thread_msg_rsp *rsp;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* send */</span></div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        status = <a name="a15"></a><a class="code" href="rte__ring_8h.html#afd7f172fbce0358e0b140fb9bd82aa7a">rte_ring_sp_enqueue</a>(msgq_req, req);</div>
<div class="line">    } <span class="keywordflow">while</span> (status == -ENOBUFS);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* recv */</span></div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        status = <a name="a16"></a><a class="code" href="rte__ring_8h.html#ae8a18b67229a569e0ad2fb1e5df70d2c">rte_ring_sc_dequeue</a>(msgq_rsp, (<span class="keywordtype">void</span> **) &amp;rsp);</div>
<div class="line">    } <span class="keywordflow">while</span> (status != 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">thread_pipeline_enable(uint32_t thread_id,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keyword">struct </span>thread *t;</div>
<div class="line">    <span class="keyword">struct </span>thread_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>thread_msg_rsp *rsp;</div>
<div class="line">    uint32_t i;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((thread_id &gt;= RTE_MAX_LCORE) ||</div>
<div class="line">        (p == NULL) ||</div>
<div class="line">        (p-&gt;n_ports_in == 0) ||</div>
<div class="line">        (p-&gt;n_ports_out == 0) ||</div>
<div class="line">        (p-&gt;n_tables == 0))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    t = &amp;thread[thread_id];</div>
<div class="line">    <span class="keywordflow">if</span> ((t-&gt;enabled == 0) ||</div>
<div class="line">        p-&gt;enabled)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!thread_is_running(thread_id)) {</div>
<div class="line">        <span class="keyword">struct </span>thread_data *td = &amp;thread_data[thread_id];</div>
<div class="line">        <span class="keyword">struct </span>pipeline_data *tdp = &amp;td-&gt;pipeline_data[td-&gt;n_pipelines];</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (td-&gt;n_pipelines &gt;= THREAD_PIPELINES_MAX)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Data plane thread */</span></div>
<div class="line">        td-&gt;p[td-&gt;n_pipelines] = p-&gt;p;</div>
<div class="line"> </div>
<div class="line">        tdp-&gt;p = p-&gt;p;</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; p-&gt;n_tables; i++)</div>
<div class="line">            tdp-&gt;table_data[i].a = p-&gt;table[i].a;</div>
<div class="line"> </div>
<div class="line">        tdp-&gt;n_tables = p-&gt;n_tables;</div>
<div class="line"> </div>
<div class="line">        tdp-&gt;msgq_req = p-&gt;msgq_req;</div>
<div class="line">        tdp-&gt;msgq_rsp = p-&gt;msgq_rsp;</div>
<div class="line">        tdp-&gt;timer_period = (<a class="code" href="rte__cycles_8h.html#ae016e608f344823e677819d8f04264c5">rte_get_tsc_hz</a>() * p-&gt;timer_period_ms) / 1000;</div>
<div class="line">        tdp-&gt;time_next = <a class="code" href="rte__cycles_8h.html#a34aaedfb8b9fa4f83d4cb3108cda2041">rte_get_tsc_cycles</a>() + tdp-&gt;timer_period;</div>
<div class="line"> </div>
<div class="line">        td-&gt;n_pipelines++;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Pipeline */</span></div>
<div class="line">        p-&gt;thread_id = thread_id;</div>
<div class="line">        p-&gt;enabled = 1;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = thread_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = THREAD_REQ_PIPELINE_ENABLE;</div>
<div class="line">    req-&gt;pipeline_enable.p = p-&gt;p;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; p-&gt;n_tables; i++)</div>
<div class="line">        req-&gt;pipeline_enable.table[i].a =</div>
<div class="line">            p-&gt;table[i].a;</div>
<div class="line">    req-&gt;pipeline_enable.msgq_req = p-&gt;msgq_req;</div>
<div class="line">    req-&gt;pipeline_enable.msgq_rsp = p-&gt;msgq_rsp;</div>
<div class="line">    req-&gt;pipeline_enable.timer_period_ms = p-&gt;timer_period_ms;</div>
<div class="line">    req-&gt;pipeline_enable.n_tables = p-&gt;n_tables;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = thread_msg_send_recv(thread_id, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    thread_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Request completion */</span></div>
<div class="line">    <span class="keywordflow">if</span> (status)</div>
<div class="line">        <span class="keywordflow">return</span> status;</div>
<div class="line"> </div>
<div class="line">    p-&gt;thread_id = thread_id;</div>
<div class="line">    p-&gt;enabled = 1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">thread_pipeline_disable(uint32_t thread_id,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keyword">struct </span>thread *t;</div>
<div class="line">    <span class="keyword">struct </span>thread_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>thread_msg_rsp *rsp;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((thread_id &gt;= RTE_MAX_LCORE) ||</div>
<div class="line">        (p == NULL))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    t = &amp;thread[thread_id];</div>
<div class="line">    <span class="keywordflow">if</span> (t-&gt;enabled == 0)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (p-&gt;enabled == 0)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (p-&gt;thread_id != thread_id)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!thread_is_running(thread_id)) {</div>
<div class="line">        <span class="keyword">struct </span>thread_data *td = &amp;thread_data[thread_id];</div>
<div class="line">        uint32_t i;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; td-&gt;n_pipelines; i++) {</div>
<div class="line">            <span class="keyword">struct </span>pipeline_data *tdp = &amp;td-&gt;pipeline_data[i];</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (tdp-&gt;p != p-&gt;p)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Data plane thread */</span></div>
<div class="line">            <span class="keywordflow">if</span> (i &lt; td-&gt;n_pipelines - 1) {</div>
<div class="line">                <span class="keyword">struct </span>rte_pipeline *pipeline_last =</div>
<div class="line">                    td-&gt;p[td-&gt;n_pipelines - 1];</div>
<div class="line">                <span class="keyword">struct </span>pipeline_data *tdp_last =</div>
<div class="line">                    &amp;td-&gt;pipeline_data[td-&gt;n_pipelines - 1];</div>
<div class="line"> </div>
<div class="line">                td-&gt;p[i] = pipeline_last;</div>
<div class="line">                memcpy(tdp, tdp_last, <span class="keyword">sizeof</span>(*tdp));</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            td-&gt;n_pipelines--;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Pipeline */</span></div>
<div class="line">            p-&gt;enabled = 0;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = thread_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = THREAD_REQ_PIPELINE_DISABLE;</div>
<div class="line">    req-&gt;pipeline_disable.p = p-&gt;p;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = thread_msg_send_recv(thread_id, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    thread_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Request completion */</span></div>
<div class="line">    <span class="keywordflow">if</span> (status)</div>
<div class="line">        <span class="keywordflow">return</span> status;</div>
<div class="line"> </div>
<div class="line">    p-&gt;enabled = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span>thread_msg_req *</div>
<div class="line">thread_msg_recv(<span class="keyword">struct</span> <a class="code" href="structrte__ring.html">rte_ring</a> *msgq_req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>thread_msg_req *req;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> status = <a class="code" href="rte__ring_8h.html#ae8a18b67229a569e0ad2fb1e5df70d2c">rte_ring_sc_dequeue</a>(msgq_req, (<span class="keywordtype">void</span> **) &amp;req);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (status != 0)</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> req;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">thread_msg_send(<span class="keyword">struct</span> <a class="code" href="structrte__ring.html">rte_ring</a> *msgq_rsp,</div>
<div class="line">    <span class="keyword">struct</span> thread_msg_rsp *rsp)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        status = <a class="code" href="rte__ring_8h.html#afd7f172fbce0358e0b140fb9bd82aa7a">rte_ring_sp_enqueue</a>(msgq_rsp, rsp);</div>
<div class="line">    } <span class="keywordflow">while</span> (status == -ENOBUFS);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>thread_msg_rsp *</div>
<div class="line">thread_msg_handle_pipeline_enable(<span class="keyword">struct</span> thread_data *t,</div>
<div class="line">    <span class="keyword">struct</span> thread_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>thread_msg_rsp *rsp = (<span class="keyword">struct </span>thread_msg_rsp *) req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_data *p = &amp;t-&gt;pipeline_data[t-&gt;n_pipelines];</div>
<div class="line">    uint32_t i;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Request */</span></div>
<div class="line">    <span class="keywordflow">if</span> (t-&gt;n_pipelines &gt;= THREAD_PIPELINES_MAX) {</div>
<div class="line">        rsp-&gt;status = -1;</div>
<div class="line">        <span class="keywordflow">return</span> rsp;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    t-&gt;p[t-&gt;n_pipelines] = req-&gt;pipeline_enable.p;</div>
<div class="line"> </div>
<div class="line">    p-&gt;p = req-&gt;pipeline_enable.p;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; req-&gt;pipeline_enable.n_tables; i++)</div>
<div class="line">        p-&gt;table_data[i].a =</div>
<div class="line">            req-&gt;pipeline_enable.table[i].a;</div>
<div class="line"> </div>
<div class="line">    p-&gt;n_tables = req-&gt;pipeline_enable.n_tables;</div>
<div class="line"> </div>
<div class="line">    p-&gt;msgq_req = req-&gt;pipeline_enable.msgq_req;</div>
<div class="line">    p-&gt;msgq_rsp = req-&gt;pipeline_enable.msgq_rsp;</div>
<div class="line">    p-&gt;timer_period =</div>
<div class="line">        (<a class="code" href="rte__cycles_8h.html#ae016e608f344823e677819d8f04264c5">rte_get_tsc_hz</a>() * req-&gt;pipeline_enable.timer_period_ms) / 1000;</div>
<div class="line">    p-&gt;time_next = <a class="code" href="rte__cycles_8h.html#a34aaedfb8b9fa4f83d4cb3108cda2041">rte_get_tsc_cycles</a>() + p-&gt;timer_period;</div>
<div class="line"> </div>
<div class="line">    t-&gt;n_pipelines++;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Response */</span></div>
<div class="line">    rsp-&gt;status = 0;</div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>thread_msg_rsp *</div>
<div class="line">thread_msg_handle_pipeline_disable(<span class="keyword">struct</span> thread_data *t,</div>
<div class="line">    <span class="keyword">struct</span> thread_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>thread_msg_rsp *rsp = (<span class="keyword">struct </span>thread_msg_rsp *) req;</div>
<div class="line">    uint32_t n_pipelines = t-&gt;n_pipelines;</div>
<div class="line">    <span class="keyword">struct </span>rte_pipeline *pipeline = req-&gt;pipeline_disable.p;</div>
<div class="line">    uint32_t i;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* find pipeline */</span></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; n_pipelines; i++) {</div>
<div class="line">        <span class="keyword">struct </span>pipeline_data *p = &amp;t-&gt;pipeline_data[i];</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (p-&gt;p != pipeline)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (i &lt; n_pipelines - 1) {</div>
<div class="line">            <span class="keyword">struct </span>rte_pipeline *pipeline_last =</div>
<div class="line">                t-&gt;p[n_pipelines - 1];</div>
<div class="line">            <span class="keyword">struct </span>pipeline_data *p_last =</div>
<div class="line">                &amp;t-&gt;pipeline_data[n_pipelines - 1];</div>
<div class="line"> </div>
<div class="line">            t-&gt;p[i] = pipeline_last;</div>
<div class="line">            memcpy(p, p_last, <span class="keyword">sizeof</span>(*p));</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        t-&gt;n_pipelines--;</div>
<div class="line"> </div>
<div class="line">        rsp-&gt;status = 0;</div>
<div class="line">        <span class="keywordflow">return</span> rsp;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* should not get here */</span></div>
<div class="line">    rsp-&gt;status = 0;</div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">thread_msg_handle(<span class="keyword">struct</span> thread_data *t)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span> ( ; ; ) {</div>
<div class="line">        <span class="keyword">struct </span>thread_msg_req *req;</div>
<div class="line">        <span class="keyword">struct </span>thread_msg_rsp *rsp;</div>
<div class="line"> </div>
<div class="line">        req = thread_msg_recv(t-&gt;msgq_req);</div>
<div class="line">        <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">switch</span> (req-&gt;type) {</div>
<div class="line">        <span class="keywordflow">case</span> THREAD_REQ_PIPELINE_ENABLE:</div>
<div class="line">            rsp = thread_msg_handle_pipeline_enable(t, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> THREAD_REQ_PIPELINE_DISABLE:</div>
<div class="line">            rsp = thread_msg_handle_pipeline_disable(t, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            rsp = (<span class="keyword">struct </span>thread_msg_rsp *) req;</div>
<div class="line">            rsp-&gt;status = -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        thread_msg_send(t-&gt;msgq_rsp, rsp);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum</span> pipeline_req_type {</div>
<div class="line">    <span class="comment">/* Port IN */</span></div>
<div class="line">    PIPELINE_REQ_PORT_IN_STATS_READ,</div>
<div class="line">    PIPELINE_REQ_PORT_IN_ENABLE,</div>
<div class="line">    PIPELINE_REQ_PORT_IN_DISABLE,</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Port OUT */</span></div>
<div class="line">    PIPELINE_REQ_PORT_OUT_STATS_READ,</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Table */</span></div>
<div class="line">    PIPELINE_REQ_TABLE_STATS_READ,</div>
<div class="line">    PIPELINE_REQ_TABLE_RULE_ADD,</div>
<div class="line">    PIPELINE_REQ_TABLE_RULE_ADD_DEFAULT,</div>
<div class="line">    PIPELINE_REQ_TABLE_RULE_ADD_BULK,</div>
<div class="line">    PIPELINE_REQ_TABLE_RULE_DELETE,</div>
<div class="line">    PIPELINE_REQ_TABLE_RULE_DELETE_DEFAULT,</div>
<div class="line">    PIPELINE_REQ_TABLE_RULE_STATS_READ,</div>
<div class="line">    PIPELINE_REQ_TABLE_MTR_PROFILE_ADD,</div>
<div class="line">    PIPELINE_REQ_TABLE_MTR_PROFILE_DELETE,</div>
<div class="line">    PIPELINE_REQ_TABLE_RULE_MTR_READ,</div>
<div class="line">    PIPELINE_REQ_TABLE_DSCP_TABLE_UPDATE,</div>
<div class="line">    PIPELINE_REQ_TABLE_RULE_TTL_READ,</div>
<div class="line">    PIPELINE_REQ_TABLE_RULE_TIME_READ,</div>
<div class="line">    PIPELINE_REQ_MAX</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_req_port_in_stats_read {</div>
<div class="line">    <span class="keywordtype">int</span> clear;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_req_port_out_stats_read {</div>
<div class="line">    <span class="keywordtype">int</span> clear;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_req_table_stats_read {</div>
<div class="line">    <span class="keywordtype">int</span> clear;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_req_table_rule_add {</div>
<div class="line">    <span class="keyword">struct </span>table_rule_match match;</div>
<div class="line">    <span class="keyword">struct </span>table_rule_action action;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_req_table_rule_add_default {</div>
<div class="line">    <span class="keyword">struct </span>table_rule_action action;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_req_table_rule_add_bulk {</div>
<div class="line">    <span class="keyword">struct </span>table_rule_list *list;</div>
<div class="line">    <span class="keywordtype">int</span> bulk;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_req_table_rule_delete {</div>
<div class="line">    <span class="keyword">struct </span>table_rule_match match;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_req_table_rule_stats_read {</div>
<div class="line">    <span class="keywordtype">void</span> *data;</div>
<div class="line">    <span class="keywordtype">int</span> clear;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_req_table_mtr_profile_add {</div>
<div class="line">    uint32_t meter_profile_id;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a17"></a><a class="code" href="structrte__table__action__meter__profile.html">rte_table_action_meter_profile</a> profile;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_req_table_mtr_profile_delete {</div>
<div class="line">    uint32_t meter_profile_id;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_req_table_rule_mtr_read {</div>
<div class="line">    <span class="keywordtype">void</span> *data;</div>
<div class="line">    uint32_t tc_mask;</div>
<div class="line">    <span class="keywordtype">int</span> clear;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_req_table_dscp_table_update {</div>
<div class="line">    uint64_t dscp_mask;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a18"></a><a class="code" href="structrte__table__action__dscp__table.html">rte_table_action_dscp_table</a> dscp_table;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_req_table_rule_ttl_read {</div>
<div class="line">    <span class="keywordtype">void</span> *data;</div>
<div class="line">    <span class="keywordtype">int</span> clear;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_req_table_rule_time_read {</div>
<div class="line">    <span class="keywordtype">void</span> *data;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_req {</div>
<div class="line">    <span class="keyword">enum</span> pipeline_req_type type;</div>
<div class="line">    uint32_t id; <span class="comment">/* Port IN, port OUT or table ID */</span></div>
<div class="line"> </div>
<div class="line">    <a name="a19"></a><a class="code" href="rte__common_8h.html#aef7d28b28ed75cf43a62bfab9bb4b6da">RTE_STD_C11</a></div>
<div class="line">    <span class="keyword">union </span>{</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_req_port_in_stats_read port_in_stats_read;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_req_port_out_stats_read port_out_stats_read;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_req_table_stats_read table_stats_read;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_req_table_rule_add table_rule_add;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_req_table_rule_add_default table_rule_add_default;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_req_table_rule_add_bulk table_rule_add_bulk;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_req_table_rule_delete table_rule_delete;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_req_table_rule_stats_read table_rule_stats_read;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_req_table_mtr_profile_add table_mtr_profile_add;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_req_table_mtr_profile_delete table_mtr_profile_delete;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_req_table_rule_mtr_read table_rule_mtr_read;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_req_table_dscp_table_update table_dscp_table_update;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_req_table_rule_ttl_read table_rule_ttl_read;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_req_table_rule_time_read table_rule_time_read;</div>
<div class="line">    };</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_rsp_port_in_stats_read {</div>
<div class="line">    <span class="keyword">struct </span><a name="_a20"></a><a class="code" href="structrte__pipeline__port__in__stats.html">rte_pipeline_port_in_stats</a> <a name="a21"></a><a class="code" href="structrte__pipeline__port__in__stats.html#a48efd9560ccf56a1dedb5d25e323fa8a">stats</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_rsp_port_out_stats_read {</div>
<div class="line">    <span class="keyword">struct </span><a name="_a22"></a><a class="code" href="structrte__pipeline__port__out__stats.html">rte_pipeline_port_out_stats</a> <a name="a23"></a><a class="code" href="structrte__pipeline__port__out__stats.html#a7d127ce0e2d9594ebb38cc5441e60174">stats</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_rsp_table_stats_read {</div>
<div class="line">    <span class="keyword">struct </span><a name="_a24"></a><a class="code" href="structrte__pipeline__table__stats.html">rte_pipeline_table_stats</a> <a name="a25"></a><a class="code" href="structrte__pipeline__table__stats.html#a324dbcea014c359561641979bb66c6f1">stats</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_rsp_table_rule_add {</div>
<div class="line">    <span class="keywordtype">void</span> *data;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_rsp_table_rule_add_default {</div>
<div class="line">    <span class="keywordtype">void</span> *data;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_rsp_table_rule_add_bulk {</div>
<div class="line">    uint32_t n_rules;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_rsp_table_rule_stats_read {</div>
<div class="line">    <span class="keyword">struct </span><a name="_a26"></a><a class="code" href="structrte__table__action__stats__counters.html">rte_table_action_stats_counters</a> stats;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_rsp_table_rule_mtr_read {</div>
<div class="line">    <span class="keyword">struct </span><a name="_a27"></a><a class="code" href="structrte__table__action__mtr__counters.html">rte_table_action_mtr_counters</a> <a name="a28"></a><a class="code" href="structrte__table__action__mtr__counters.html#afb347cc5ec7a582aaf2067d1bcc979af">stats</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_rsp_table_rule_ttl_read {</div>
<div class="line">    <span class="keyword">struct </span><a name="_a29"></a><a class="code" href="structrte__table__action__ttl__counters.html">rte_table_action_ttl_counters</a> stats;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_rsp_table_rule_time_read {</div>
<div class="line">    uint64_t timestamp;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pipeline_msg_rsp {</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__common_8h.html#aef7d28b28ed75cf43a62bfab9bb4b6da">RTE_STD_C11</a></div>
<div class="line">    <span class="keyword">union </span>{</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_rsp_port_in_stats_read port_in_stats_read;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_rsp_port_out_stats_read port_out_stats_read;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_rsp_table_stats_read table_stats_read;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_rsp_table_rule_add table_rule_add;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_rsp_table_rule_add_default table_rule_add_default;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_rsp_table_rule_add_bulk table_rule_add_bulk;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_rsp_table_rule_stats_read table_rule_stats_read;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_rsp_table_rule_mtr_read table_rule_mtr_read;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_rsp_table_rule_ttl_read table_rule_ttl_read;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_rsp_table_rule_time_read table_rule_time_read;</div>
<div class="line">    };</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_req *</div>
<div class="line">pipeline_msg_alloc(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">size_t</span> size = <a class="code" href="rte__common_8h.html#a8df8b303b8ea240cf6aebf937fd21eaf">RTE_MAX</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> pipeline_msg_req),</div>
<div class="line">        <span class="keyword">sizeof</span>(<span class="keyword">struct</span> pipeline_msg_rsp));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> calloc(1, size);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">pipeline_msg_free(<span class="keyword">struct</span> pipeline_msg_rsp *rsp)</div>
<div class="line">{</div>
<div class="line">    free(rsp);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_rsp *</div>
<div class="line">pipeline_msg_send_recv(<span class="keyword">struct</span> pipeline *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ring.html">rte_ring</a> *msgq_req = p-&gt;msgq_req;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ring.html">rte_ring</a> *msgq_rsp = p-&gt;msgq_rsp;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* send */</span></div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        status = <a class="code" href="rte__ring_8h.html#afd7f172fbce0358e0b140fb9bd82aa7a">rte_ring_sp_enqueue</a>(msgq_req, req);</div>
<div class="line">    } <span class="keywordflow">while</span> (status == -ENOBUFS);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* recv */</span></div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        status = <a class="code" href="rte__ring_8h.html#ae8a18b67229a569e0ad2fb1e5df70d2c">rte_ring_sc_dequeue</a>(msgq_rsp, (<span class="keywordtype">void</span> **) &amp;rsp);</div>
<div class="line">    } <span class="keywordflow">while</span> (status != 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">pipeline_port_in_stats_read(<span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name,</div>
<div class="line">    uint32_t port_id,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="structrte__pipeline__port__in__stats.html">rte_pipeline_port_in_stats</a> *stats,</div>
<div class="line">    <span class="keywordtype">int</span> clear)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((pipeline_name == NULL) ||</div>
<div class="line">        (stats == NULL))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (port_id &gt;= p-&gt;n_ports_in))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pipeline_is_running(p)) {</div>
<div class="line">        status = <a name="a30"></a><a class="code" href="rte__pipeline_8h.html#a790da0e2e134063df3eaa55bf6b70342">rte_pipeline_port_in_stats_read</a>(p-&gt;p,</div>
<div class="line">            port_id,</div>
<div class="line">            stats,</div>
<div class="line">            clear);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = pipeline_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = PIPELINE_REQ_PORT_IN_STATS_READ;</div>
<div class="line">    req-&gt;id = port_id;</div>
<div class="line">    req-&gt;port_in_stats_read.clear = clear;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = pipeline_msg_send_recv(p, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line">    <span class="keywordflow">if</span> (status == 0)</div>
<div class="line">        memcpy(stats, &amp;rsp-&gt;port_in_stats_read.stats, <span class="keyword">sizeof</span>(*stats));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    pipeline_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">pipeline_port_in_enable(<span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name,</div>
<div class="line">    uint32_t port_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> (pipeline_name == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (port_id &gt;= p-&gt;n_ports_in))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pipeline_is_running(p)) {</div>
<div class="line">        status = <a name="a31"></a><a class="code" href="rte__pipeline_8h.html#af8a48f99a99731883005dfe93c5406e6">rte_pipeline_port_in_enable</a>(p-&gt;p, port_id);</div>
<div class="line">        <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = pipeline_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = PIPELINE_REQ_PORT_IN_ENABLE;</div>
<div class="line">    req-&gt;id = port_id;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = pipeline_msg_send_recv(p, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    pipeline_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">pipeline_port_in_disable(<span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name,</div>
<div class="line">    uint32_t port_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> (pipeline_name == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (port_id &gt;= p-&gt;n_ports_in))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pipeline_is_running(p)) {</div>
<div class="line">        status = <a name="a32"></a><a class="code" href="rte__pipeline_8h.html#a6b3750798dfd9a03093790d52dd94aca">rte_pipeline_port_in_disable</a>(p-&gt;p, port_id);</div>
<div class="line">        <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = pipeline_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = PIPELINE_REQ_PORT_IN_DISABLE;</div>
<div class="line">    req-&gt;id = port_id;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = pipeline_msg_send_recv(p, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    pipeline_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">pipeline_port_out_stats_read(<span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name,</div>
<div class="line">    uint32_t port_id,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="structrte__pipeline__port__out__stats.html">rte_pipeline_port_out_stats</a> *stats,</div>
<div class="line">    <span class="keywordtype">int</span> clear)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((pipeline_name == NULL) ||</div>
<div class="line">        (stats == NULL))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (port_id &gt;= p-&gt;n_ports_out))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pipeline_is_running(p)) {</div>
<div class="line">        status = <a name="a33"></a><a class="code" href="rte__pipeline_8h.html#ab831fab1384d2dc680140e08bd2acdff">rte_pipeline_port_out_stats_read</a>(p-&gt;p,</div>
<div class="line">            port_id,</div>
<div class="line">            stats,</div>
<div class="line">            clear);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = pipeline_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = PIPELINE_REQ_PORT_OUT_STATS_READ;</div>
<div class="line">    req-&gt;id = port_id;</div>
<div class="line">    req-&gt;port_out_stats_read.clear = clear;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = pipeline_msg_send_recv(p, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line">    <span class="keywordflow">if</span> (status == 0)</div>
<div class="line">        memcpy(stats, &amp;rsp-&gt;port_out_stats_read.stats, <span class="keyword">sizeof</span>(*stats));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    pipeline_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">pipeline_table_stats_read(<span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name,</div>
<div class="line">    uint32_t table_id,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="structrte__pipeline__table__stats.html">rte_pipeline_table_stats</a> *stats,</div>
<div class="line">    <span class="keywordtype">int</span> clear)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((pipeline_name == NULL) ||</div>
<div class="line">        (stats == NULL))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (table_id &gt;= p-&gt;n_tables))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pipeline_is_running(p)) {</div>
<div class="line">        status = <a name="a34"></a><a class="code" href="rte__pipeline_8h.html#a3fb68f21e8a212dcf698077b66e53e94">rte_pipeline_table_stats_read</a>(p-&gt;p,</div>
<div class="line">            table_id,</div>
<div class="line">            stats,</div>
<div class="line">            clear);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = pipeline_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = PIPELINE_REQ_TABLE_STATS_READ;</div>
<div class="line">    req-&gt;id = table_id;</div>
<div class="line">    req-&gt;table_stats_read.clear = clear;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = pipeline_msg_send_recv(p, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line">    <span class="keywordflow">if</span> (status == 0)</div>
<div class="line">        memcpy(stats, &amp;rsp-&gt;table_stats_read.stats, <span class="keyword">sizeof</span>(*stats));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    pipeline_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">match_check(<span class="keyword">struct</span> table_rule_match *match,</div>
<div class="line">    <span class="keyword">struct</span> pipeline *p,</div>
<div class="line">    uint32_t table_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>table *table;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((match == NULL) ||</div>
<div class="line">        (p == NULL) ||</div>
<div class="line">        (table_id &gt;= p-&gt;n_tables))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    table = &amp;p-&gt;table[table_id];</div>
<div class="line">    <span class="keywordflow">if</span> (match-&gt;match_type != table-&gt;params.match_type)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (match-&gt;match_type) {</div>
<div class="line">    <span class="keywordflow">case</span> TABLE_ACL:</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">struct </span>table_acl_params *t = &amp;table-&gt;params.match.acl;</div>
<div class="line">        <span class="keyword">struct </span>table_rule_match_acl *r = &amp;match-&gt;match.acl;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((r-&gt;ip_version &amp;&amp; (t-&gt;ip_version == 0)) ||</div>
<div class="line">            ((r-&gt;ip_version == 0) &amp;&amp; t-&gt;ip_version))</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (r-&gt;ip_version) {</div>
<div class="line">            <span class="keywordflow">if</span> ((r-&gt;sa_depth &gt; 32) ||</div>
<div class="line">                (r-&gt;da_depth &gt; 32))</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">if</span> ((r-&gt;sa_depth &gt; 128) ||</div>
<div class="line">                (r-&gt;da_depth &gt; 128))</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">case</span> TABLE_ARRAY:</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">case</span> TABLE_HASH:</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">case</span> TABLE_LPM:</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">struct </span>table_lpm_params *t = &amp;table-&gt;params.match.lpm;</div>
<div class="line">        <span class="keyword">struct </span>table_rule_match_lpm *r = &amp;match-&gt;match.lpm;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((r-&gt;ip_version &amp;&amp; (t-&gt;key_size != 4)) ||</div>
<div class="line">            ((r-&gt;ip_version == 0) &amp;&amp; (t-&gt;key_size != 16)))</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (r-&gt;ip_version) {</div>
<div class="line">            <span class="keywordflow">if</span> (r-&gt;depth &gt; 32)</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">if</span> (r-&gt;depth &gt; 128)</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">case</span> TABLE_STUB:</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">action_check(<span class="keyword">struct</span> table_rule_action *action,</div>
<div class="line">    <span class="keyword">struct</span> pipeline *p,</div>
<div class="line">    uint32_t table_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>table_action_profile *ap;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((action == NULL) ||</div>
<div class="line">        (p == NULL) ||</div>
<div class="line">        (table_id &gt;= p-&gt;n_tables))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    ap = p-&gt;table[table_id].ap;</div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask != ap-&gt;params.action_mask)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask &amp; (1LLU &lt;&lt; <a name="a35"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aa5194910932359cba3eeca7183922dbf">RTE_TABLE_ACTION_FWD</a>)) {</div>
<div class="line">        <span class="keywordflow">if</span> ((action-&gt;fwd.action == <a name="a36"></a><a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572ac8c58609785d844989b7d9eb1e6db8aa">RTE_PIPELINE_ACTION_PORT</a>) &amp;&amp;</div>
<div class="line">            (action-&gt;fwd.id &gt;= p-&gt;n_ports_out))</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((action-&gt;fwd.action == <a name="a37"></a><a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572abafaf6276afcfcb170a2f7aa44c21048">RTE_PIPELINE_ACTION_TABLE</a>) &amp;&amp;</div>
<div class="line">            (action-&gt;fwd.id &gt;= p-&gt;n_tables))</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask &amp; (1LLU &lt;&lt; <a name="a38"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a7442253cfdff0aec945b0ad7ddf5ab2d">RTE_TABLE_ACTION_MTR</a>)) {</div>
<div class="line">        uint32_t tc_mask0 = (1 &lt;&lt; ap-&gt;params.mtr.n_tc) - 1;</div>
<div class="line">        uint32_t tc_mask1 = action-&gt;mtr.tc_mask;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (tc_mask1 != tc_mask0)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask &amp; (1LLU &lt;&lt; <a name="a39"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a9f9ca84acea19612c86d3da0898ed34e">RTE_TABLE_ACTION_TM</a>)) {</div>
<div class="line">        uint32_t n_subports_per_port =</div>
<div class="line">            ap-&gt;params.tm.n_subports_per_port;</div>
<div class="line">        uint32_t n_pipes_per_subport =</div>
<div class="line">            ap-&gt;params.tm.n_pipes_per_subport;</div>
<div class="line">        uint32_t subport_id = action-&gt;tm.subport_id;</div>
<div class="line">        uint32_t pipe_id = action-&gt;tm.pipe_id;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((subport_id &gt;= n_subports_per_port) ||</div>
<div class="line">            (pipe_id &gt;= n_pipes_per_subport))</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask &amp; (1LLU &lt;&lt; <a name="a40"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1">RTE_TABLE_ACTION_ENCAP</a>)) {</div>
<div class="line">        uint64_t encap_mask = ap-&gt;params.encap.encap_mask;</div>
<div class="line">        <span class="keyword">enum</span> <a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629c">rte_table_action_encap_type</a> type = action-&gt;encap.type;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((encap_mask &amp; (1LLU &lt;&lt; type)) == 0)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask &amp; (1LLU &lt;&lt; <a name="a41"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a6368c734fa9c1ac9cb591160eb6bf293">RTE_TABLE_ACTION_NAT</a>)) {</div>
<div class="line">        <span class="keywordtype">int</span> ip_version0 = ap-&gt;params.common.ip_version;</div>
<div class="line">        <span class="keywordtype">int</span> ip_version1 = action-&gt;nat.ip_version;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((ip_version1 &amp;&amp; (ip_version0 == 0)) ||</div>
<div class="line">            ((ip_version1 == 0) &amp;&amp; ip_version0))</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">action_default_check(<span class="keyword">struct</span> table_rule_action *action,</div>
<div class="line">    <span class="keyword">struct</span> pipeline *p,</div>
<div class="line">    uint32_t table_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> ((action == NULL) ||</div>
<div class="line">        (action-&gt;action_mask != (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aa5194910932359cba3eeca7183922dbf">RTE_TABLE_ACTION_FWD</a>)) ||</div>
<div class="line">        (p == NULL) ||</div>
<div class="line">        (table_id &gt;= p-&gt;n_tables))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask &amp; (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aa5194910932359cba3eeca7183922dbf">RTE_TABLE_ACTION_FWD</a>)) {</div>
<div class="line">        <span class="keywordflow">if</span> ((action-&gt;fwd.action == <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572ac8c58609785d844989b7d9eb1e6db8aa">RTE_PIPELINE_ACTION_PORT</a>) &amp;&amp;</div>
<div class="line">            (action-&gt;fwd.id &gt;= p-&gt;n_ports_out))</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((action-&gt;fwd.action == <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572abafaf6276afcfcb170a2f7aa44c21048">RTE_PIPELINE_ACTION_TABLE</a>) &amp;&amp;</div>
<div class="line">            (action-&gt;fwd.id &gt;= p-&gt;n_tables))</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">union </span>table_rule_match_low_level {</div>
<div class="line">    <span class="keyword">struct </span><a name="_a42"></a><a class="code" href="structrte__table__acl__rule__add__params.html">rte_table_acl_rule_add_params</a> acl_add;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a43"></a><a class="code" href="structrte__table__acl__rule__delete__params.html">rte_table_acl_rule_delete_params</a> acl_delete;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a44"></a><a class="code" href="structrte__table__array__key.html">rte_table_array_key</a> array;</div>
<div class="line">    uint8_t hash[TABLE_RULE_MATCH_SIZE_MAX];</div>
<div class="line">    <span class="keyword">struct </span><a name="_a45"></a><a class="code" href="structrte__table__lpm__key.html">rte_table_lpm_key</a> lpm_ipv4;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a46"></a><a class="code" href="structrte__table__lpm__ipv6__key.html">rte_table_lpm_ipv6_key</a> lpm_ipv6;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">match_convert(<span class="keyword">struct</span> table_rule_match *mh,</div>
<div class="line">    <span class="keyword">union</span> table_rule_match_low_level *ml,</div>
<div class="line">    <span class="keywordtype">int</span> add);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">action_convert(<span class="keyword">struct</span> rte_table_action *a,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_action *action,</div>
<div class="line">    <span class="keyword">struct</span> <a name="_a47"></a><a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *data);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>table_ll {</div>
<div class="line">    <span class="keyword">struct </span>rte_pipeline *p;</div>
<div class="line">    <span class="keywordtype">int</span> table_id;</div>
<div class="line">    <span class="keyword">struct </span>rte_table_action *a;</div>
<div class="line">    <span class="keywordtype">int</span> bulk_supported;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">table_rule_add_bulk_ll(<span class="keyword">struct</span> table_ll *table,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_list *list,</div>
<div class="line">    uint32_t *n_rules)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">union </span>table_rule_match_low_level *match_ll = NULL;</div>
<div class="line">    uint8_t *action_ll = NULL;</div>
<div class="line">    <span class="keywordtype">void</span> **match_ll_ptr = NULL;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> **action_ll_ptr = NULL;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> **entries_ptr = NULL;</div>
<div class="line">    <span class="keywordtype">int</span> *found = NULL;</div>
<div class="line">    <span class="keyword">struct </span>table_rule *rule;</div>
<div class="line">    uint32_t n, i;</div>
<div class="line">    <span class="keywordtype">int</span> status = 0;</div>
<div class="line"> </div>
<div class="line">    n = 0;</div>
<div class="line">    TAILQ_FOREACH(rule, list, node)</div>
<div class="line">        n++;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Memory allocation */</span></div>
<div class="line">    match_ll = calloc(n, <span class="keyword">sizeof</span>(<span class="keyword">union</span> table_rule_match_low_level));</div>
<div class="line">    action_ll = calloc(n, TABLE_RULE_ACTION_SIZE_MAX);</div>
<div class="line"> </div>
<div class="line">    match_ll_ptr = calloc(n, <span class="keyword">sizeof</span>(<span class="keywordtype">void</span> *));</div>
<div class="line">    action_ll_ptr = calloc(n, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *));</div>
<div class="line"> </div>
<div class="line">    entries_ptr = calloc(n, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *));</div>
<div class="line">    found = calloc(n, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (match_ll == NULL ||</div>
<div class="line">        action_ll == NULL ||</div>
<div class="line">        match_ll_ptr == NULL ||</div>
<div class="line">        action_ll_ptr == NULL ||</div>
<div class="line">        entries_ptr == NULL ||</div>
<div class="line">        found == NULL) {</div>
<div class="line">            status = -ENOMEM;</div>
<div class="line">            <span class="keywordflow">goto</span> table_rule_add_bulk_ll_free;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Init */</span></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {</div>
<div class="line">        match_ll_ptr[i] = (<span class="keywordtype">void</span> *)&amp;match_ll[i];</div>
<div class="line">        action_ll_ptr[i] = (<span class="keyword">struct </span><a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *)</div>
<div class="line">            &amp;action_ll[i * TABLE_RULE_ACTION_SIZE_MAX];</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Rule (match, action) conversion */</span></div>
<div class="line">    i = 0;</div>
<div class="line">    TAILQ_FOREACH(rule, list, node) {</div>
<div class="line">        status = match_convert(&amp;rule-&gt;match, match_ll_ptr[i], 1);</div>
<div class="line">        <span class="keywordflow">if</span> (status)</div>
<div class="line">            <span class="keywordflow">goto</span> table_rule_add_bulk_ll_free;</div>
<div class="line"> </div>
<div class="line">        status = action_convert(table-&gt;a, &amp;rule-&gt;action, action_ll_ptr[i]);</div>
<div class="line">        <span class="keywordflow">if</span> (status)</div>
<div class="line">            <span class="keywordflow">goto</span> table_rule_add_bulk_ll_free;</div>
<div class="line"> </div>
<div class="line">        i++;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Add rule (match, action) to table */</span></div>
<div class="line">    <span class="keywordflow">if</span> (table-&gt;bulk_supported) {</div>
<div class="line">        status = <a name="a48"></a><a class="code" href="rte__pipeline_8h.html#a95cffe0cc5ee976c84d57af72b570523">rte_pipeline_table_entry_add_bulk</a>(table-&gt;p,</div>
<div class="line">            table-&gt;table_id,</div>
<div class="line">            match_ll_ptr,</div>
<div class="line">            action_ll_ptr,</div>
<div class="line">            n,</div>
<div class="line">            found,</div>
<div class="line">            entries_ptr);</div>
<div class="line">        <span class="keywordflow">if</span> (status)</div>
<div class="line">            <span class="keywordflow">goto</span> table_rule_add_bulk_ll_free;</div>
<div class="line">    } <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {</div>
<div class="line">            status = <a name="a49"></a><a class="code" href="rte__pipeline_8h.html#a0e90e4a54b6467deb9b449bf8bd5cab4">rte_pipeline_table_entry_add</a>(table-&gt;p,</div>
<div class="line">                table-&gt;table_id,</div>
<div class="line">                match_ll_ptr[i],</div>
<div class="line">                action_ll_ptr[i],</div>
<div class="line">                &amp;found[i],</div>
<div class="line">                &amp;entries_ptr[i]);</div>
<div class="line">            <span class="keywordflow">if</span> (status) {</div>
<div class="line">                <span class="keywordflow">if</span> (i == 0)</div>
<div class="line">                    <span class="keywordflow">goto</span> table_rule_add_bulk_ll_free;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">/* No roll-back. */</span></div>
<div class="line">                status = 0;</div>
<div class="line">                n = i;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write back to the rule list. */</span></div>
<div class="line">    i = 0;</div>
<div class="line">    TAILQ_FOREACH(rule, list, node) {</div>
<div class="line">        <span class="keywordflow">if</span> (i &gt;= n)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        rule-&gt;data = entries_ptr[i];</div>
<div class="line"> </div>
<div class="line">        i++;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    *n_rules = n;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free */</span></div>
<div class="line">table_rule_add_bulk_ll_free:</div>
<div class="line">    free(found);</div>
<div class="line">    free(entries_ptr);</div>
<div class="line">    free(action_ll_ptr);</div>
<div class="line">    free(match_ll_ptr);</div>
<div class="line">    free(action_ll);</div>
<div class="line">    free(match_ll);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">pipeline_table_rule_add(<span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name,</div>
<div class="line">    uint32_t <a name="a50"></a><a class="code" href="structrte__pipeline__table__entry.html#a4783596f73bb7e535d78875dbf3397b0">table_id</a>,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_match *match,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_action *<a name="a51"></a><a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>table *table;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line">    <span class="keyword">struct </span>table_rule *rule;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((pipeline_name == NULL) ||</div>
<div class="line">        (match == NULL) ||</div>
<div class="line">        (action == NULL))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (table_id &gt;= p-&gt;n_tables) ||</div>
<div class="line">        match_check(match, p, table_id) ||</div>
<div class="line">        action_check(action, p, table_id))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    table = &amp;p-&gt;table[table_id];</div>
<div class="line"> </div>
<div class="line">    rule = calloc(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> table_rule));</div>
<div class="line">    <span class="keywordflow">if</span> (rule == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    memcpy(&amp;rule-&gt;match, match, <span class="keyword">sizeof</span>(*match));</div>
<div class="line">    memcpy(&amp;rule-&gt;action, action, <span class="keyword">sizeof</span>(*action));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pipeline_is_running(p)) {</div>
<div class="line">        <span class="keyword">union </span>table_rule_match_low_level match_ll;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *data_in, *data_out;</div>
<div class="line">        <span class="keywordtype">int</span> key_found;</div>
<div class="line">        uint8_t *buffer;</div>
<div class="line"> </div>
<div class="line">        buffer = calloc(TABLE_RULE_ACTION_SIZE_MAX, <span class="keyword">sizeof</span>(uint8_t));</div>
<div class="line">        <span class="keywordflow">if</span> (buffer == NULL) {</div>
<div class="line">            free(rule);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Table match-action rule conversion */</span></div>
<div class="line">        data_in = (<span class="keyword">struct </span><a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *)buffer;</div>
<div class="line"> </div>
<div class="line">        status = match_convert(match, &amp;match_ll, 1);</div>
<div class="line">        <span class="keywordflow">if</span> (status) {</div>
<div class="line">            free(buffer);</div>
<div class="line">            free(rule);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        status = action_convert(table-&gt;a, <a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a>, data_in);</div>
<div class="line">        <span class="keywordflow">if</span> (status) {</div>
<div class="line">            free(buffer);</div>
<div class="line">            free(rule);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Add rule (match, action) to table */</span></div>
<div class="line">        status = <a class="code" href="rte__pipeline_8h.html#a0e90e4a54b6467deb9b449bf8bd5cab4">rte_pipeline_table_entry_add</a>(p-&gt;p,</div>
<div class="line">                <a class="code" href="structrte__pipeline__table__entry.html#a4783596f73bb7e535d78875dbf3397b0">table_id</a>,</div>
<div class="line">                &amp;match_ll,</div>
<div class="line">                data_in,</div>
<div class="line">                &amp;key_found,</div>
<div class="line">                &amp;data_out);</div>
<div class="line">        <span class="keywordflow">if</span> (status) {</div>
<div class="line">            free(buffer);</div>
<div class="line">            free(rule);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Write Response */</span></div>
<div class="line">        rule-&gt;data = data_out;</div>
<div class="line">        table_rule_add(table, rule);</div>
<div class="line"> </div>
<div class="line">        free(buffer);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = pipeline_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL) {</div>
<div class="line">        free(rule);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = PIPELINE_REQ_TABLE_RULE_ADD;</div>
<div class="line">    req-&gt;id = <a class="code" href="structrte__pipeline__table__entry.html#a4783596f73bb7e535d78875dbf3397b0">table_id</a>;</div>
<div class="line">    memcpy(&amp;req-&gt;table_rule_add.match, match, <span class="keyword">sizeof</span>(*match));</div>
<div class="line">    memcpy(&amp;req-&gt;table_rule_add.action, <a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a>, <span class="keyword">sizeof</span>(*<a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = pipeline_msg_send_recv(p, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line">    <span class="keywordflow">if</span> (status == 0) {</div>
<div class="line">        rule-&gt;data = rsp-&gt;table_rule_add.data;</div>
<div class="line">        table_rule_add(table, rule);</div>
<div class="line">    } <span class="keywordflow">else</span></div>
<div class="line">        free(rule);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    pipeline_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">pipeline_table_rule_add_default(<span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name,</div>
<div class="line">    uint32_t <a class="code" href="structrte__pipeline__table__entry.html#a4783596f73bb7e535d78875dbf3397b0">table_id</a>,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_action *<a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>table *table;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line">    <span class="keyword">struct </span>table_rule *rule;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((pipeline_name == NULL) ||</div>
<div class="line">        (action == NULL))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (table_id &gt;= p-&gt;n_tables) ||</div>
<div class="line">        action_default_check(action, p, table_id))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    table = &amp;p-&gt;table[table_id];</div>
<div class="line"> </div>
<div class="line">    rule = calloc(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> table_rule));</div>
<div class="line">    <span class="keywordflow">if</span> (rule == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    memcpy(&amp;rule-&gt;action, action, <span class="keyword">sizeof</span>(*action));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pipeline_is_running(p)) {</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *data_in, *data_out;</div>
<div class="line">        uint8_t *buffer;</div>
<div class="line"> </div>
<div class="line">        buffer = calloc(TABLE_RULE_ACTION_SIZE_MAX, <span class="keyword">sizeof</span>(uint8_t));</div>
<div class="line">        <span class="keywordflow">if</span> (buffer == NULL) {</div>
<div class="line">            free(rule);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Apply actions */</span></div>
<div class="line">        data_in = (<span class="keyword">struct </span><a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *)buffer;</div>
<div class="line"> </div>
<div class="line">        data_in-&gt;<a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a> = <a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a>-&gt;fwd.action;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a>-&gt;fwd.action == <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572ac8c58609785d844989b7d9eb1e6db8aa">RTE_PIPELINE_ACTION_PORT</a>)</div>
<div class="line">            data_in-&gt;<a name="a52"></a><a class="code" href="structrte__pipeline__table__entry.html#a6f54b893342775cdf092c6646e57c83b">port_id</a> = <a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a>-&gt;fwd.id;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a>-&gt;fwd.action == <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572abafaf6276afcfcb170a2f7aa44c21048">RTE_PIPELINE_ACTION_TABLE</a>)</div>
<div class="line">            data_in-&gt;<a class="code" href="structrte__pipeline__table__entry.html#a4783596f73bb7e535d78875dbf3397b0">table_id</a> = <a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a>-&gt;fwd.id;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Add default rule to table */</span></div>
<div class="line">        status = <a name="a53"></a><a class="code" href="rte__pipeline_8h.html#a8980fbc2a51d6dc8041b798ea5172318">rte_pipeline_table_default_entry_add</a>(p-&gt;p,</div>
<div class="line">                <a class="code" href="structrte__pipeline__table__entry.html#a4783596f73bb7e535d78875dbf3397b0">table_id</a>,</div>
<div class="line">                data_in,</div>
<div class="line">                &amp;data_out);</div>
<div class="line">        <span class="keywordflow">if</span> (status) {</div>
<div class="line">            free(buffer);</div>
<div class="line">            free(rule);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Write Response */</span></div>
<div class="line">        rule-&gt;data = data_out;</div>
<div class="line">        table_rule_default_add(table, rule);</div>
<div class="line"> </div>
<div class="line">        free(buffer);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = pipeline_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL) {</div>
<div class="line">        free(rule);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = PIPELINE_REQ_TABLE_RULE_ADD_DEFAULT;</div>
<div class="line">    req-&gt;id = <a class="code" href="structrte__pipeline__table__entry.html#a4783596f73bb7e535d78875dbf3397b0">table_id</a>;</div>
<div class="line">    memcpy(&amp;req-&gt;table_rule_add_default.action, <a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a>, <span class="keyword">sizeof</span>(*<a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = pipeline_msg_send_recv(p, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line">    <span class="keywordflow">if</span> (status == 0) {</div>
<div class="line">        rule-&gt;data = rsp-&gt;table_rule_add_default.data;</div>
<div class="line">        table_rule_default_add(table, rule);</div>
<div class="line">    } <span class="keywordflow">else</span></div>
<div class="line">        free(rule);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    pipeline_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">table_rule_list_free(<span class="keyword">struct</span> table_rule_list *list)</div>
<div class="line">{</div>
<div class="line">    uint32_t n = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!list)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> ( ; ; ) {</div>
<div class="line">        <span class="keyword">struct </span>table_rule *rule;</div>
<div class="line"> </div>
<div class="line">        rule = TAILQ_FIRST(list);</div>
<div class="line">        <span class="keywordflow">if</span> (rule == NULL)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        TAILQ_REMOVE(list, rule, node);</div>
<div class="line">        free(rule);</div>
<div class="line">        n++;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    free(list);</div>
<div class="line">    <span class="keywordflow">return</span> n;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">pipeline_table_rule_add_bulk(<span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name,</div>
<div class="line">    uint32_t table_id,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_list *list,</div>
<div class="line">    uint32_t *n_rules_added,</div>
<div class="line">    uint32_t *n_rules_not_added)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>table *table;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line">    <span class="keyword">struct </span>table_rule *rule;</div>
<div class="line">    <span class="keywordtype">int</span> status = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((pipeline_name == NULL) ||</div>
<div class="line">        (list == NULL) ||</div>
<div class="line">        TAILQ_EMPTY(list) ||</div>
<div class="line">        (n_rules_added == NULL) ||</div>
<div class="line">        (n_rules_not_added == NULL)) {</div>
<div class="line">        table_rule_list_free(list);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (table_id &gt;= p-&gt;n_tables)) {</div>
<div class="line">        table_rule_list_free(list);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    table = &amp;p-&gt;table[table_id];</div>
<div class="line"> </div>
<div class="line">    TAILQ_FOREACH(rule, list, node)</div>
<div class="line">        <span class="keywordflow">if</span> (match_check(&amp;rule-&gt;match, p, table_id) ||</div>
<div class="line">            action_check(&amp;rule-&gt;action, p, table_id)) {</div>
<div class="line">            table_rule_list_free(list);</div>
<div class="line">            <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pipeline_is_running(p)) {</div>
<div class="line">        <span class="keyword">struct </span>table_ll table_ll = {</div>
<div class="line">            .p = p-&gt;p,</div>
<div class="line">            .table_id = table_id,</div>
<div class="line">            .a = table-&gt;a,</div>
<div class="line">            .bulk_supported = table-&gt;params.match_type == TABLE_ACL,</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        status = table_rule_add_bulk_ll(&amp;table_ll, list, n_rules_added);</div>
<div class="line">        <span class="keywordflow">if</span> (status) {</div>
<div class="line">            table_rule_list_free(list);</div>
<div class="line">            <span class="keywordflow">return</span> status;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        table_rule_add_bulk(table, list, *n_rules_added);</div>
<div class="line">        *n_rules_not_added = table_rule_list_free(list);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = pipeline_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL) {</div>
<div class="line">        table_rule_list_free(list);</div>
<div class="line">        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = PIPELINE_REQ_TABLE_RULE_ADD_BULK;</div>
<div class="line">    req-&gt;id = table_id;</div>
<div class="line">    req-&gt;table_rule_add_bulk.list = list;</div>
<div class="line">    req-&gt;table_rule_add_bulk.bulk = table-&gt;params.match_type == TABLE_ACL;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = pipeline_msg_send_recv(p, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line">    <span class="keywordflow">if</span> (status == 0) {</div>
<div class="line">        *n_rules_added = rsp-&gt;table_rule_add_bulk.n_rules;</div>
<div class="line"> </div>
<div class="line">        table_rule_add_bulk(table, list, *n_rules_added);</div>
<div class="line">        *n_rules_not_added = table_rule_list_free(list);</div>
<div class="line">    } <span class="keywordflow">else</span></div>
<div class="line">        table_rule_list_free(list);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    pipeline_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">pipeline_table_rule_delete(<span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name,</div>
<div class="line">    uint32_t table_id,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_match *match)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>table *table;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((pipeline_name == NULL) ||</div>
<div class="line">        (match == NULL))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (table_id &gt;= p-&gt;n_tables) ||</div>
<div class="line">        match_check(match, p, table_id))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    table = &amp;p-&gt;table[table_id];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pipeline_is_running(p)) {</div>
<div class="line">        <span class="keyword">union </span>table_rule_match_low_level match_ll;</div>
<div class="line">        <span class="keywordtype">int</span> key_found;</div>
<div class="line"> </div>
<div class="line">        status = match_convert(match, &amp;match_ll, 0);</div>
<div class="line">        <span class="keywordflow">if</span> (status)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">        status = <a name="a54"></a><a class="code" href="rte__pipeline_8h.html#a946f0d5610d152c1e6f641928c4f0743">rte_pipeline_table_entry_delete</a>(p-&gt;p,</div>
<div class="line">                table_id,</div>
<div class="line">                &amp;match_ll,</div>
<div class="line">                &amp;key_found,</div>
<div class="line">                NULL);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (status == 0)</div>
<div class="line">            table_rule_delete(table, match);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = pipeline_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = PIPELINE_REQ_TABLE_RULE_DELETE;</div>
<div class="line">    req-&gt;id = table_id;</div>
<div class="line">    memcpy(&amp;req-&gt;table_rule_delete.match, match, <span class="keyword">sizeof</span>(*match));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = pipeline_msg_send_recv(p, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line">    <span class="keywordflow">if</span> (status == 0)</div>
<div class="line">        table_rule_delete(table, match);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    pipeline_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">pipeline_table_rule_delete_default(<span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name,</div>
<div class="line">    uint32_t table_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>table *table;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> (pipeline_name == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (table_id &gt;= p-&gt;n_tables))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    table = &amp;p-&gt;table[table_id];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pipeline_is_running(p)) {</div>
<div class="line">        status = <a name="a55"></a><a class="code" href="rte__pipeline_8h.html#ac83e9cacb91301a7425694f32249e050">rte_pipeline_table_default_entry_delete</a>(p-&gt;p,</div>
<div class="line">            table_id,</div>
<div class="line">            NULL);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (status == 0)</div>
<div class="line">            table_rule_default_delete(table);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = pipeline_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = PIPELINE_REQ_TABLE_RULE_DELETE_DEFAULT;</div>
<div class="line">    req-&gt;id = table_id;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = pipeline_msg_send_recv(p, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line">    <span class="keywordflow">if</span> (status == 0)</div>
<div class="line">        table_rule_default_delete(table);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    pipeline_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">pipeline_table_rule_stats_read(<span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name,</div>
<div class="line">    uint32_t table_id,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_match *match,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="structrte__table__action__stats__counters.html">rte_table_action_stats_counters</a> *stats,</div>
<div class="line">    <span class="keywordtype">int</span> clear)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>table *table;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line">    <span class="keyword">struct </span>table_rule *rule;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((pipeline_name == NULL) ||</div>
<div class="line">        (match == NULL) ||</div>
<div class="line">        (stats == NULL))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (table_id &gt;= p-&gt;n_tables) ||</div>
<div class="line">        match_check(match, p, table_id))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    table = &amp;p-&gt;table[table_id];</div>
<div class="line">    rule = table_rule_find(table, match);</div>
<div class="line">    <span class="keywordflow">if</span> (rule == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pipeline_is_running(p)) {</div>
<div class="line">        status = <a name="a56"></a><a class="code" href="rte__table__action_8h.html#a93c0fb3b5ac9825a0656c91b0af4c913">rte_table_action_stats_read</a>(table-&gt;a,</div>
<div class="line">            rule-&gt;data,</div>
<div class="line">            stats,</div>
<div class="line">            clear);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = pipeline_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = PIPELINE_REQ_TABLE_RULE_STATS_READ;</div>
<div class="line">    req-&gt;id = table_id;</div>
<div class="line">    req-&gt;table_rule_stats_read.data = rule-&gt;data;</div>
<div class="line">    req-&gt;table_rule_stats_read.clear = clear;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = pipeline_msg_send_recv(p, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line">    <span class="keywordflow">if</span> (status == 0)</div>
<div class="line">        memcpy(stats, &amp;rsp-&gt;table_rule_stats_read.stats, <span class="keyword">sizeof</span>(*stats));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    pipeline_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">pipeline_table_mtr_profile_add(<span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name,</div>
<div class="line">    uint32_t table_id,</div>
<div class="line">    uint32_t meter_profile_id,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="structrte__table__action__meter__profile.html">rte_table_action_meter_profile</a> *profile)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((pipeline_name == NULL) ||</div>
<div class="line">        (profile == NULL))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (table_id &gt;= p-&gt;n_tables))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pipeline_is_running(p)) {</div>
<div class="line">        <span class="keyword">struct </span>rte_table_action *a = p-&gt;table[table_id].a;</div>
<div class="line"> </div>
<div class="line">        status = <a name="a57"></a><a class="code" href="rte__table__action_8h.html#a5e8b781110a05d3a7ef91d9ef8cf84a0">rte_table_action_meter_profile_add</a>(a,</div>
<div class="line">            meter_profile_id,</div>
<div class="line">            profile);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = pipeline_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = PIPELINE_REQ_TABLE_MTR_PROFILE_ADD;</div>
<div class="line">    req-&gt;id = table_id;</div>
<div class="line">    req-&gt;table_mtr_profile_add.meter_profile_id = meter_profile_id;</div>
<div class="line">    memcpy(&amp;req-&gt;table_mtr_profile_add.profile, profile, <span class="keyword">sizeof</span>(*profile));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = pipeline_msg_send_recv(p, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    pipeline_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">pipeline_table_mtr_profile_delete(<span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name,</div>
<div class="line">    uint32_t table_id,</div>
<div class="line">    uint32_t meter_profile_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> (pipeline_name == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (table_id &gt;= p-&gt;n_tables))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pipeline_is_running(p)) {</div>
<div class="line">        <span class="keyword">struct </span>rte_table_action *a = p-&gt;table[table_id].a;</div>
<div class="line"> </div>
<div class="line">        status = <a name="a58"></a><a class="code" href="rte__table__action_8h.html#a05023d9cc6b8951283f6494573dc8f30">rte_table_action_meter_profile_delete</a>(a,</div>
<div class="line">                meter_profile_id);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = pipeline_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = PIPELINE_REQ_TABLE_MTR_PROFILE_DELETE;</div>
<div class="line">    req-&gt;id = table_id;</div>
<div class="line">    req-&gt;table_mtr_profile_delete.meter_profile_id = meter_profile_id;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = pipeline_msg_send_recv(p, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    pipeline_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">pipeline_table_rule_mtr_read(<span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name,</div>
<div class="line">    uint32_t table_id,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_match *match,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="structrte__table__action__mtr__counters.html">rte_table_action_mtr_counters</a> *stats,</div>
<div class="line">    <span class="keywordtype">int</span> clear)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>table *table;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line">    <span class="keyword">struct </span>table_rule *rule;</div>
<div class="line">    uint32_t tc_mask;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((pipeline_name == NULL) ||</div>
<div class="line">        (match == NULL) ||</div>
<div class="line">        (stats == NULL))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (table_id &gt;= p-&gt;n_tables) ||</div>
<div class="line">        match_check(match, p, table_id))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    table = &amp;p-&gt;table[table_id];</div>
<div class="line">    tc_mask = (1 &lt;&lt; table-&gt;ap-&gt;params.mtr.n_tc) - 1;</div>
<div class="line"> </div>
<div class="line">    rule = table_rule_find(table, match);</div>
<div class="line">    <span class="keywordflow">if</span> (rule == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pipeline_is_running(p)) {</div>
<div class="line">        status = <a name="a59"></a><a class="code" href="rte__table__action_8h.html#aaca015bba5fc3cf51c0e30344ca60416">rte_table_action_meter_read</a>(table-&gt;a,</div>
<div class="line">                rule-&gt;data,</div>
<div class="line">                tc_mask,</div>
<div class="line">                stats,</div>
<div class="line">                clear);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = pipeline_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = PIPELINE_REQ_TABLE_RULE_MTR_READ;</div>
<div class="line">    req-&gt;id = table_id;</div>
<div class="line">    req-&gt;table_rule_mtr_read.data = rule-&gt;data;</div>
<div class="line">    req-&gt;table_rule_mtr_read.tc_mask = tc_mask;</div>
<div class="line">    req-&gt;table_rule_mtr_read.clear = clear;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = pipeline_msg_send_recv(p, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line">    <span class="keywordflow">if</span> (status == 0)</div>
<div class="line">        memcpy(stats, &amp;rsp-&gt;table_rule_mtr_read.stats, <span class="keyword">sizeof</span>(*stats));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    pipeline_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">pipeline_table_dscp_table_update(<span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name,</div>
<div class="line">    uint32_t table_id,</div>
<div class="line">    uint64_t dscp_mask,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="structrte__table__action__dscp__table.html">rte_table_action_dscp_table</a> *dscp_table)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((pipeline_name == NULL) ||</div>
<div class="line">        (dscp_table == NULL))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (table_id &gt;= p-&gt;n_tables))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pipeline_is_running(p)) {</div>
<div class="line">        <span class="keyword">struct </span>rte_table_action *a = p-&gt;table[table_id].a;</div>
<div class="line"> </div>
<div class="line">        status = <a name="a60"></a><a class="code" href="rte__table__action_8h.html#aa6c355b2ffff26b22405df408539790f">rte_table_action_dscp_table_update</a>(a,</div>
<div class="line">                dscp_mask,</div>
<div class="line">                dscp_table);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = pipeline_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = PIPELINE_REQ_TABLE_DSCP_TABLE_UPDATE;</div>
<div class="line">    req-&gt;id = table_id;</div>
<div class="line">    req-&gt;table_dscp_table_update.dscp_mask = dscp_mask;</div>
<div class="line">    memcpy(&amp;req-&gt;table_dscp_table_update.dscp_table,</div>
<div class="line">        dscp_table, <span class="keyword">sizeof</span>(*dscp_table));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = pipeline_msg_send_recv(p, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    pipeline_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">pipeline_table_rule_ttl_read(<span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name,</div>
<div class="line">    uint32_t table_id,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_match *match,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="structrte__table__action__ttl__counters.html">rte_table_action_ttl_counters</a> *stats,</div>
<div class="line">    <span class="keywordtype">int</span> clear)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>table *table;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line">    <span class="keyword">struct </span>table_rule *rule;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((pipeline_name == NULL) ||</div>
<div class="line">        (match == NULL) ||</div>
<div class="line">        (stats == NULL))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (table_id &gt;= p-&gt;n_tables) ||</div>
<div class="line">        match_check(match, p, table_id))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    table = &amp;p-&gt;table[table_id];</div>
<div class="line">    <span class="keywordflow">if</span> (!table-&gt;ap-&gt;params.ttl.n_packets_enabled)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    rule = table_rule_find(table, match);</div>
<div class="line">    <span class="keywordflow">if</span> (rule == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pipeline_is_running(p)) {</div>
<div class="line">        status = <a name="a61"></a><a class="code" href="rte__table__action_8h.html#aad5f9c62ce78601c8ef6c0f5b0a5d814">rte_table_action_ttl_read</a>(table-&gt;a,</div>
<div class="line">                rule-&gt;data,</div>
<div class="line">                stats,</div>
<div class="line">                clear);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = pipeline_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = PIPELINE_REQ_TABLE_RULE_TTL_READ;</div>
<div class="line">    req-&gt;id = table_id;</div>
<div class="line">    req-&gt;table_rule_ttl_read.data = rule-&gt;data;</div>
<div class="line">    req-&gt;table_rule_ttl_read.clear = clear;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = pipeline_msg_send_recv(p, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line">    <span class="keywordflow">if</span> (status == 0)</div>
<div class="line">        memcpy(stats, &amp;rsp-&gt;table_rule_ttl_read.stats, <span class="keyword">sizeof</span>(*stats));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    pipeline_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">pipeline_table_rule_time_read(<span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name,</div>
<div class="line">    uint32_t table_id,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_match *match,</div>
<div class="line">    uint64_t *timestamp)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>table *table;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line">    <span class="keyword">struct </span>table_rule *rule;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((pipeline_name == NULL) ||</div>
<div class="line">        (match == NULL) ||</div>
<div class="line">        (timestamp == NULL))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (table_id &gt;= p-&gt;n_tables) ||</div>
<div class="line">        match_check(match, p, table_id))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    table = &amp;p-&gt;table[table_id];</div>
<div class="line"> </div>
<div class="line">    rule = table_rule_find(table, match);</div>
<div class="line">    <span class="keywordflow">if</span> (rule == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pipeline_is_running(p)) {</div>
<div class="line">        status = <a name="a62"></a><a class="code" href="rte__table__action_8h.html#ac09a29a1ab18953296ba1851cdba7903">rte_table_action_time_read</a>(table-&gt;a,</div>
<div class="line">                rule-&gt;data,</div>
<div class="line">                timestamp);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allocate request */</span></div>
<div class="line">    req = pipeline_msg_alloc();</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write request */</span></div>
<div class="line">    req-&gt;type = PIPELINE_REQ_TABLE_RULE_TIME_READ;</div>
<div class="line">    req-&gt;id = table_id;</div>
<div class="line">    req-&gt;table_rule_time_read.data = rule-&gt;data;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = pipeline_msg_send_recv(p, req);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = rsp-&gt;status;</div>
<div class="line">    <span class="keywordflow">if</span> (status == 0)</div>
<div class="line">        *timestamp = rsp-&gt;table_rule_time_read.timestamp;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    pipeline_msg_free(rsp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">struct </span>pipeline_msg_req *</div>
<div class="line">pipeline_msg_recv(<span class="keyword">struct</span> <a class="code" href="structrte__ring.html">rte_ring</a> *msgq_req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> status = <a class="code" href="rte__ring_8h.html#ae8a18b67229a569e0ad2fb1e5df70d2c">rte_ring_sc_dequeue</a>(msgq_req, (<span class="keywordtype">void</span> **) &amp;req);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (status != 0)</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> req;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">pipeline_msg_send(<span class="keyword">struct</span> <a class="code" href="structrte__ring.html">rte_ring</a> *msgq_rsp,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_rsp *rsp)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        status = <a class="code" href="rte__ring_8h.html#afd7f172fbce0358e0b140fb9bd82aa7a">rte_ring_sp_enqueue</a>(msgq_rsp, rsp);</div>
<div class="line">    } <span class="keywordflow">while</span> (status == -ENOBUFS);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_rsp *</div>
<div class="line">pipeline_msg_handle_port_in_stats_read(<span class="keyword">struct</span> pipeline_data *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp = (<span class="keyword">struct </span>pipeline_msg_rsp *) req;</div>
<div class="line">    uint32_t port_id = req-&gt;id;</div>
<div class="line">    <span class="keywordtype">int</span> clear = req-&gt;port_in_stats_read.clear;</div>
<div class="line"> </div>
<div class="line">    rsp-&gt;status = <a class="code" href="rte__pipeline_8h.html#a790da0e2e134063df3eaa55bf6b70342">rte_pipeline_port_in_stats_read</a>(p-&gt;p,</div>
<div class="line">        port_id,</div>
<div class="line">        &amp;rsp-&gt;port_in_stats_read.stats,</div>
<div class="line">        clear);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_rsp *</div>
<div class="line">pipeline_msg_handle_port_in_enable(<span class="keyword">struct</span> pipeline_data *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp = (<span class="keyword">struct </span>pipeline_msg_rsp *) req;</div>
<div class="line">    uint32_t port_id = req-&gt;id;</div>
<div class="line"> </div>
<div class="line">    rsp-&gt;status = <a class="code" href="rte__pipeline_8h.html#af8a48f99a99731883005dfe93c5406e6">rte_pipeline_port_in_enable</a>(p-&gt;p,</div>
<div class="line">        port_id);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_rsp *</div>
<div class="line">pipeline_msg_handle_port_in_disable(<span class="keyword">struct</span> pipeline_data *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp = (<span class="keyword">struct </span>pipeline_msg_rsp *) req;</div>
<div class="line">    uint32_t port_id = req-&gt;id;</div>
<div class="line"> </div>
<div class="line">    rsp-&gt;status = <a class="code" href="rte__pipeline_8h.html#a6b3750798dfd9a03093790d52dd94aca">rte_pipeline_port_in_disable</a>(p-&gt;p,</div>
<div class="line">        port_id);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_rsp *</div>
<div class="line">pipeline_msg_handle_port_out_stats_read(<span class="keyword">struct</span> pipeline_data *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp = (<span class="keyword">struct </span>pipeline_msg_rsp *) req;</div>
<div class="line">    uint32_t port_id = req-&gt;id;</div>
<div class="line">    <span class="keywordtype">int</span> clear = req-&gt;port_out_stats_read.clear;</div>
<div class="line"> </div>
<div class="line">    rsp-&gt;status = <a class="code" href="rte__pipeline_8h.html#ab831fab1384d2dc680140e08bd2acdff">rte_pipeline_port_out_stats_read</a>(p-&gt;p,</div>
<div class="line">        port_id,</div>
<div class="line">        &amp;rsp-&gt;port_out_stats_read.stats,</div>
<div class="line">        clear);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_rsp *</div>
<div class="line">pipeline_msg_handle_table_stats_read(<span class="keyword">struct</span> pipeline_data *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp = (<span class="keyword">struct </span>pipeline_msg_rsp *) req;</div>
<div class="line">    uint32_t port_id = req-&gt;id;</div>
<div class="line">    <span class="keywordtype">int</span> clear = req-&gt;table_stats_read.clear;</div>
<div class="line"> </div>
<div class="line">    rsp-&gt;status = <a class="code" href="rte__pipeline_8h.html#a3fb68f21e8a212dcf698077b66e53e94">rte_pipeline_table_stats_read</a>(p-&gt;p,</div>
<div class="line">        port_id,</div>
<div class="line">        &amp;rsp-&gt;table_stats_read.stats,</div>
<div class="line">        clear);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">match_convert_ipv6_depth(uint32_t depth, uint32_t *depth32)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (depth &gt; 128)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (depth / 32) {</div>
<div class="line">    <span class="keywordflow">case</span> 0:</div>
<div class="line">        depth32[0] = depth;</div>
<div class="line">        depth32[1] = 0;</div>
<div class="line">        depth32[2] = 0;</div>
<div class="line">        depth32[3] = 0;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">case</span> 1:</div>
<div class="line">        depth32[0] = 32;</div>
<div class="line">        depth32[1] = depth - 32;</div>
<div class="line">        depth32[2] = 0;</div>
<div class="line">        depth32[3] = 0;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">case</span> 2:</div>
<div class="line">        depth32[0] = 32;</div>
<div class="line">        depth32[1] = 32;</div>
<div class="line">        depth32[2] = depth - 64;</div>
<div class="line">        depth32[3] = 0;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">case</span> 3:</div>
<div class="line">        depth32[0] = 32;</div>
<div class="line">        depth32[1] = 32;</div>
<div class="line">        depth32[2] = 32;</div>
<div class="line">        depth32[3] = depth - 96;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">case</span> 4:</div>
<div class="line">        depth32[0] = 32;</div>
<div class="line">        depth32[1] = 32;</div>
<div class="line">        depth32[2] = 32;</div>
<div class="line">        depth32[3] = 32;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">match_convert(<span class="keyword">struct</span> table_rule_match *mh,</div>
<div class="line">    <span class="keyword">union</span> table_rule_match_low_level *ml,</div>
<div class="line">    <span class="keywordtype">int</span> add)</div>
<div class="line">{</div>
<div class="line">    memset(ml, 0, <span class="keyword">sizeof</span>(*ml));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (mh-&gt;match_type) {</div>
<div class="line">    <span class="keywordflow">case</span> TABLE_ACL:</div>
<div class="line">        <span class="keywordflow">if</span> (mh-&gt;match.acl.ip_version)</div>
<div class="line">            <span class="keywordflow">if</span> (add) {</div>
<div class="line">                ml-&gt;acl_add.field_value[0].value.u8 =</div>
<div class="line">                    mh-&gt;match.acl.proto;</div>
<div class="line">                ml-&gt;acl_add.field_value[0].mask_range.u8 =</div>
<div class="line">                    mh-&gt;match.acl.proto_mask;</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_add.field_value[1].value.u32 =</div>
<div class="line">                    mh-&gt;match.acl.ipv4.sa;</div>
<div class="line">                ml-&gt;acl_add.field_value[1].mask_range.u32 =</div>
<div class="line">                    mh-&gt;match.acl.sa_depth;</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_add.field_value[2].value.u32 =</div>
<div class="line">                    mh-&gt;match.acl.ipv4.da;</div>
<div class="line">                ml-&gt;acl_add.field_value[2].mask_range.u32 =</div>
<div class="line">                    mh-&gt;match.acl.da_depth;</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_add.field_value[3].value.u16 =</div>
<div class="line">                    mh-&gt;match.acl.sp0;</div>
<div class="line">                ml-&gt;acl_add.field_value[3].mask_range.u16 =</div>
<div class="line">                    mh-&gt;match.acl.sp1;</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_add.field_value[4].value.u16 =</div>
<div class="line">                    mh-&gt;match.acl.dp0;</div>
<div class="line">                ml-&gt;acl_add.field_value[4].mask_range.u16 =</div>
<div class="line">                    mh-&gt;match.acl.dp1;</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_add.priority =</div>
<div class="line">                    (int32_t) mh-&gt;match.acl.priority;</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                ml-&gt;acl_delete.field_value[0].value.u8 =</div>
<div class="line">                    mh-&gt;match.acl.proto;</div>
<div class="line">                ml-&gt;acl_delete.field_value[0].mask_range.u8 =</div>
<div class="line">                    mh-&gt;match.acl.proto_mask;</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_delete.field_value[1].value.u32 =</div>
<div class="line">                    mh-&gt;match.acl.ipv4.sa;</div>
<div class="line">                ml-&gt;acl_delete.field_value[1].mask_range.u32 =</div>
<div class="line">                    mh-&gt;match.acl.sa_depth;</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_delete.field_value[2].value.u32 =</div>
<div class="line">                    mh-&gt;match.acl.ipv4.da;</div>
<div class="line">                ml-&gt;acl_delete.field_value[2].mask_range.u32 =</div>
<div class="line">                    mh-&gt;match.acl.da_depth;</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_delete.field_value[3].value.u16 =</div>
<div class="line">                    mh-&gt;match.acl.sp0;</div>
<div class="line">                ml-&gt;acl_delete.field_value[3].mask_range.u16 =</div>
<div class="line">                    mh-&gt;match.acl.sp1;</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_delete.field_value[4].value.u16 =</div>
<div class="line">                    mh-&gt;match.acl.dp0;</div>
<div class="line">                ml-&gt;acl_delete.field_value[4].mask_range.u16 =</div>
<div class="line">                    mh-&gt;match.acl.dp1;</div>
<div class="line">            }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">if</span> (add) {</div>
<div class="line">                uint32_t *sa32 =</div>
<div class="line">                    (uint32_t *) mh-&gt;match.acl.ipv6.sa;</div>
<div class="line">                uint32_t *da32 =</div>
<div class="line">                    (uint32_t *) mh-&gt;match.acl.ipv6.da;</div>
<div class="line">                uint32_t sa32_depth[4], da32_depth[4];</div>
<div class="line">                <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">                status = match_convert_ipv6_depth(</div>
<div class="line">                    mh-&gt;match.acl.sa_depth,</div>
<div class="line">                    sa32_depth);</div>
<div class="line">                <span class="keywordflow">if</span> (status)</div>
<div class="line">                    <span class="keywordflow">return</span> status;</div>
<div class="line"> </div>
<div class="line">                status = match_convert_ipv6_depth(</div>
<div class="line">                    mh-&gt;match.acl.da_depth,</div>
<div class="line">                    da32_depth);</div>
<div class="line">                <span class="keywordflow">if</span> (status)</div>
<div class="line">                    <span class="keywordflow">return</span> status;</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_add.field_value[0].value.u8 =</div>
<div class="line">                    mh-&gt;match.acl.proto;</div>
<div class="line">                ml-&gt;acl_add.field_value[0].mask_range.u8 =</div>
<div class="line">                    mh-&gt;match.acl.proto_mask;</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_add.field_value[1].value.u32 =</div>
<div class="line">                    <a name="a63"></a><a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(sa32[0]);</div>
<div class="line">                ml-&gt;acl_add.field_value[1].mask_range.u32 =</div>
<div class="line">                    sa32_depth[0];</div>
<div class="line">                ml-&gt;acl_add.field_value[2].value.u32 =</div>
<div class="line">                    <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(sa32[1]);</div>
<div class="line">                ml-&gt;acl_add.field_value[2].mask_range.u32 =</div>
<div class="line">                    sa32_depth[1];</div>
<div class="line">                ml-&gt;acl_add.field_value[3].value.u32 =</div>
<div class="line">                    <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(sa32[2]);</div>
<div class="line">                ml-&gt;acl_add.field_value[3].mask_range.u32 =</div>
<div class="line">                    sa32_depth[2];</div>
<div class="line">                ml-&gt;acl_add.field_value[4].value.u32 =</div>
<div class="line">                    <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(sa32[3]);</div>
<div class="line">                ml-&gt;acl_add.field_value[4].mask_range.u32 =</div>
<div class="line">                    sa32_depth[3];</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_add.field_value[5].value.u32 =</div>
<div class="line">                    <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(da32[0]);</div>
<div class="line">                ml-&gt;acl_add.field_value[5].mask_range.u32 =</div>
<div class="line">                    da32_depth[0];</div>
<div class="line">                ml-&gt;acl_add.field_value[6].value.u32 =</div>
<div class="line">                    <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(da32[1]);</div>
<div class="line">                ml-&gt;acl_add.field_value[6].mask_range.u32 =</div>
<div class="line">                    da32_depth[1];</div>
<div class="line">                ml-&gt;acl_add.field_value[7].value.u32 =</div>
<div class="line">                    <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(da32[2]);</div>
<div class="line">                ml-&gt;acl_add.field_value[7].mask_range.u32 =</div>
<div class="line">                    da32_depth[2];</div>
<div class="line">                ml-&gt;acl_add.field_value[8].value.u32 =</div>
<div class="line">                    <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(da32[3]);</div>
<div class="line">                ml-&gt;acl_add.field_value[8].mask_range.u32 =</div>
<div class="line">                    da32_depth[3];</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_add.field_value[9].value.u16 =</div>
<div class="line">                    mh-&gt;match.acl.sp0;</div>
<div class="line">                ml-&gt;acl_add.field_value[9].mask_range.u16 =</div>
<div class="line">                    mh-&gt;match.acl.sp1;</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_add.field_value[10].value.u16 =</div>
<div class="line">                    mh-&gt;match.acl.dp0;</div>
<div class="line">                ml-&gt;acl_add.field_value[10].mask_range.u16 =</div>
<div class="line">                    mh-&gt;match.acl.dp1;</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_add.priority =</div>
<div class="line">                    (int32_t) mh-&gt;match.acl.priority;</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                uint32_t *sa32 =</div>
<div class="line">                    (uint32_t *) mh-&gt;match.acl.ipv6.sa;</div>
<div class="line">                uint32_t *da32 =</div>
<div class="line">                    (uint32_t *) mh-&gt;match.acl.ipv6.da;</div>
<div class="line">                uint32_t sa32_depth[4], da32_depth[4];</div>
<div class="line">                <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">                status = match_convert_ipv6_depth(</div>
<div class="line">                    mh-&gt;match.acl.sa_depth,</div>
<div class="line">                    sa32_depth);</div>
<div class="line">                <span class="keywordflow">if</span> (status)</div>
<div class="line">                    <span class="keywordflow">return</span> status;</div>
<div class="line"> </div>
<div class="line">                status = match_convert_ipv6_depth(</div>
<div class="line">                    mh-&gt;match.acl.da_depth,</div>
<div class="line">                    da32_depth);</div>
<div class="line">                <span class="keywordflow">if</span> (status)</div>
<div class="line">                    <span class="keywordflow">return</span> status;</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_delete.field_value[0].value.u8 =</div>
<div class="line">                    mh-&gt;match.acl.proto;</div>
<div class="line">                ml-&gt;acl_delete.field_value[0].mask_range.u8 =</div>
<div class="line">                    mh-&gt;match.acl.proto_mask;</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_delete.field_value[1].value.u32 =</div>
<div class="line">                    <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(sa32[0]);</div>
<div class="line">                ml-&gt;acl_delete.field_value[1].mask_range.u32 =</div>
<div class="line">                    sa32_depth[0];</div>
<div class="line">                ml-&gt;acl_delete.field_value[2].value.u32 =</div>
<div class="line">                    <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(sa32[1]);</div>
<div class="line">                ml-&gt;acl_delete.field_value[2].mask_range.u32 =</div>
<div class="line">                    sa32_depth[1];</div>
<div class="line">                ml-&gt;acl_delete.field_value[3].value.u32 =</div>
<div class="line">                    <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(sa32[2]);</div>
<div class="line">                ml-&gt;acl_delete.field_value[3].mask_range.u32 =</div>
<div class="line">                    sa32_depth[2];</div>
<div class="line">                ml-&gt;acl_delete.field_value[4].value.u32 =</div>
<div class="line">                    <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(sa32[3]);</div>
<div class="line">                ml-&gt;acl_delete.field_value[4].mask_range.u32 =</div>
<div class="line">                    sa32_depth[3];</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_delete.field_value[5].value.u32 =</div>
<div class="line">                    <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(da32[0]);</div>
<div class="line">                ml-&gt;acl_delete.field_value[5].mask_range.u32 =</div>
<div class="line">                    da32_depth[0];</div>
<div class="line">                ml-&gt;acl_delete.field_value[6].value.u32 =</div>
<div class="line">                    <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(da32[1]);</div>
<div class="line">                ml-&gt;acl_delete.field_value[6].mask_range.u32 =</div>
<div class="line">                    da32_depth[1];</div>
<div class="line">                ml-&gt;acl_delete.field_value[7].value.u32 =</div>
<div class="line">                    <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(da32[2]);</div>
<div class="line">                ml-&gt;acl_delete.field_value[7].mask_range.u32 =</div>
<div class="line">                    da32_depth[2];</div>
<div class="line">                ml-&gt;acl_delete.field_value[8].value.u32 =</div>
<div class="line">                    <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(da32[3]);</div>
<div class="line">                ml-&gt;acl_delete.field_value[8].mask_range.u32 =</div>
<div class="line">                    da32_depth[3];</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_delete.field_value[9].value.u16 =</div>
<div class="line">                    mh-&gt;match.acl.sp0;</div>
<div class="line">                ml-&gt;acl_delete.field_value[9].mask_range.u16 =</div>
<div class="line">                    mh-&gt;match.acl.sp1;</div>
<div class="line"> </div>
<div class="line">                ml-&gt;acl_delete.field_value[10].value.u16 =</div>
<div class="line">                    mh-&gt;match.acl.dp0;</div>
<div class="line">                ml-&gt;acl_delete.field_value[10].mask_range.u16 =</div>
<div class="line">                    mh-&gt;match.acl.dp1;</div>
<div class="line">            }</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">case</span> TABLE_ARRAY:</div>
<div class="line">        ml-&gt;array.pos = mh-&gt;match.array.pos;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">case</span> TABLE_HASH:</div>
<div class="line">        memcpy(ml-&gt;hash, mh-&gt;match.hash.key, <span class="keyword">sizeof</span>(ml-&gt;hash));</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">case</span> TABLE_LPM:</div>
<div class="line">        <span class="keywordflow">if</span> (mh-&gt;match.lpm.ip_version) {</div>
<div class="line">            ml-&gt;lpm_ipv4.ip = mh-&gt;match.lpm.ipv4;</div>
<div class="line">            ml-&gt;lpm_ipv4.depth = mh-&gt;match.lpm.depth;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            memcpy(ml-&gt;lpm_ipv6.ip,</div>
<div class="line">                mh-&gt;match.lpm.ipv6, <span class="keyword">sizeof</span>(ml-&gt;lpm_ipv6.ip));</div>
<div class="line">            ml-&gt;lpm_ipv6.depth = mh-&gt;match.lpm.depth;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">action_convert(<span class="keyword">struct</span> rte_table_action *a,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_action *action,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *data)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Apply actions */</span></div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask &amp; (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aa5194910932359cba3eeca7183922dbf">RTE_TABLE_ACTION_FWD</a>)) {</div>
<div class="line">        status = <a name="a64"></a><a class="code" href="rte__table__action_8h.html#a019ab01972c7267f95dbf90a506b0ba6">rte_table_action_apply</a>(a,</div>
<div class="line">            data,</div>
<div class="line">            <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aa5194910932359cba3eeca7183922dbf">RTE_TABLE_ACTION_FWD</a>,</div>
<div class="line">            &amp;action-&gt;fwd);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (status)</div>
<div class="line">            <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask &amp; (1LLU &lt;&lt; <a name="a65"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2af4f7ba5c7d7eefc2fde9341b8724c11b">RTE_TABLE_ACTION_LB</a>)) {</div>
<div class="line">        status = <a class="code" href="rte__table__action_8h.html#a019ab01972c7267f95dbf90a506b0ba6">rte_table_action_apply</a>(a,</div>
<div class="line">            data,</div>
<div class="line">            <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2af4f7ba5c7d7eefc2fde9341b8724c11b">RTE_TABLE_ACTION_LB</a>,</div>
<div class="line">            &amp;action-&gt;lb);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (status)</div>
<div class="line">            <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask &amp; (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a7442253cfdff0aec945b0ad7ddf5ab2d">RTE_TABLE_ACTION_MTR</a>)) {</div>
<div class="line">        status = <a class="code" href="rte__table__action_8h.html#a019ab01972c7267f95dbf90a506b0ba6">rte_table_action_apply</a>(a,</div>
<div class="line">            data,</div>
<div class="line">            <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a7442253cfdff0aec945b0ad7ddf5ab2d">RTE_TABLE_ACTION_MTR</a>,</div>
<div class="line">            &amp;action-&gt;mtr);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (status)</div>
<div class="line">            <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask &amp; (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a9f9ca84acea19612c86d3da0898ed34e">RTE_TABLE_ACTION_TM</a>)) {</div>
<div class="line">        status = <a class="code" href="rte__table__action_8h.html#a019ab01972c7267f95dbf90a506b0ba6">rte_table_action_apply</a>(a,</div>
<div class="line">            data,</div>
<div class="line">            <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a9f9ca84acea19612c86d3da0898ed34e">RTE_TABLE_ACTION_TM</a>,</div>
<div class="line">            &amp;action-&gt;tm);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (status)</div>
<div class="line">            <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask &amp; (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1">RTE_TABLE_ACTION_ENCAP</a>)) {</div>
<div class="line">        status = <a class="code" href="rte__table__action_8h.html#a019ab01972c7267f95dbf90a506b0ba6">rte_table_action_apply</a>(a,</div>
<div class="line">            data,</div>
<div class="line">            <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1">RTE_TABLE_ACTION_ENCAP</a>,</div>
<div class="line">            &amp;action-&gt;encap);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (status)</div>
<div class="line">            <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask &amp; (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a6368c734fa9c1ac9cb591160eb6bf293">RTE_TABLE_ACTION_NAT</a>)) {</div>
<div class="line">        status = <a class="code" href="rte__table__action_8h.html#a019ab01972c7267f95dbf90a506b0ba6">rte_table_action_apply</a>(a,</div>
<div class="line">            data,</div>
<div class="line">            <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a6368c734fa9c1ac9cb591160eb6bf293">RTE_TABLE_ACTION_NAT</a>,</div>
<div class="line">            &amp;action-&gt;nat);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (status)</div>
<div class="line">            <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask &amp; (1LLU &lt;&lt; <a name="a66"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a64248fbadf2339ff36eee3c6c7c54ce6">RTE_TABLE_ACTION_TTL</a>)) {</div>
<div class="line">        status = <a class="code" href="rte__table__action_8h.html#a019ab01972c7267f95dbf90a506b0ba6">rte_table_action_apply</a>(a,</div>
<div class="line">            data,</div>
<div class="line">            <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a64248fbadf2339ff36eee3c6c7c54ce6">RTE_TABLE_ACTION_TTL</a>,</div>
<div class="line">            &amp;action-&gt;ttl);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (status)</div>
<div class="line">            <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask &amp; (1LLU &lt;&lt; <a name="a67"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a491ff78ac06bce973d261ed4dea04101">RTE_TABLE_ACTION_STATS</a>)) {</div>
<div class="line">        status = <a class="code" href="rte__table__action_8h.html#a019ab01972c7267f95dbf90a506b0ba6">rte_table_action_apply</a>(a,</div>
<div class="line">            data,</div>
<div class="line">            <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a491ff78ac06bce973d261ed4dea04101">RTE_TABLE_ACTION_STATS</a>,</div>
<div class="line">            &amp;action-&gt;stats);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (status)</div>
<div class="line">            <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask &amp; (1LLU &lt;&lt; <a name="a68"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a5ff88316e4574c62086f9f978a89fe5a">RTE_TABLE_ACTION_TIME</a>)) {</div>
<div class="line">        status = <a class="code" href="rte__table__action_8h.html#a019ab01972c7267f95dbf90a506b0ba6">rte_table_action_apply</a>(a,</div>
<div class="line">            data,</div>
<div class="line">            <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a5ff88316e4574c62086f9f978a89fe5a">RTE_TABLE_ACTION_TIME</a>,</div>
<div class="line">            &amp;action-&gt;time);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (status)</div>
<div class="line">            <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask &amp; (1LLU &lt;&lt; <a name="a69"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a962e3a5154b7a1a3e8648bd129c4b561">RTE_TABLE_ACTION_SYM_CRYPTO</a>)) {</div>
<div class="line">        status = <a class="code" href="rte__table__action_8h.html#a019ab01972c7267f95dbf90a506b0ba6">rte_table_action_apply</a>(a,</div>
<div class="line">            data,</div>
<div class="line">            <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a962e3a5154b7a1a3e8648bd129c4b561">RTE_TABLE_ACTION_SYM_CRYPTO</a>,</div>
<div class="line">            &amp;action-&gt;sym_crypto);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (status)</div>
<div class="line">            <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask &amp; (1LLU &lt;&lt; <a name="a70"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a3a25fcdcb69e9946dc6d9f6fc7f6ac72">RTE_TABLE_ACTION_TAG</a>)) {</div>
<div class="line">        status = <a class="code" href="rte__table__action_8h.html#a019ab01972c7267f95dbf90a506b0ba6">rte_table_action_apply</a>(a,</div>
<div class="line">            data,</div>
<div class="line">            <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a3a25fcdcb69e9946dc6d9f6fc7f6ac72">RTE_TABLE_ACTION_TAG</a>,</div>
<div class="line">            &amp;action-&gt;tag);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (status)</div>
<div class="line">            <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (action-&gt;action_mask &amp; (1LLU &lt;&lt; <a name="a71"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a73da4960f9f9b30236eeaaed592c855c">RTE_TABLE_ACTION_DECAP</a>)) {</div>
<div class="line">        status = <a class="code" href="rte__table__action_8h.html#a019ab01972c7267f95dbf90a506b0ba6">rte_table_action_apply</a>(a,</div>
<div class="line">            data,</div>
<div class="line">            <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a73da4960f9f9b30236eeaaed592c855c">RTE_TABLE_ACTION_DECAP</a>,</div>
<div class="line">            &amp;action-&gt;decap);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (status)</div>
<div class="line">            <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_rsp *</div>
<div class="line">pipeline_msg_handle_table_rule_add(<span class="keyword">struct</span> pipeline_data *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">union </span>table_rule_match_low_level match_ll;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp = (<span class="keyword">struct </span>pipeline_msg_rsp *) req;</div>
<div class="line">    <span class="keyword">struct </span>table_rule_match *match = &amp;req-&gt;table_rule_add.match;</div>
<div class="line">    <span class="keyword">struct </span>table_rule_action *action = &amp;req-&gt;table_rule_add.action;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *data_in, *data_out;</div>
<div class="line">    uint32_t <a class="code" href="structrte__pipeline__table__entry.html#a4783596f73bb7e535d78875dbf3397b0">table_id</a> = req-&gt;id;</div>
<div class="line">    <span class="keywordtype">int</span> key_found, status;</div>
<div class="line">    <span class="keyword">struct </span>rte_table_action *a = p-&gt;table_data[table_id].a;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Apply actions */</span></div>
<div class="line">    memset(p-&gt;buffer, 0, <span class="keyword">sizeof</span>(p-&gt;buffer));</div>
<div class="line">    data_in = (<span class="keyword">struct </span><a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *) p-&gt;buffer;</div>
<div class="line"> </div>
<div class="line">    status = match_convert(match, &amp;match_ll, 1);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        rsp-&gt;status = -1;</div>
<div class="line">        <span class="keywordflow">return</span> rsp;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = action_convert(a, <a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a>, data_in);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        rsp-&gt;status = -1;</div>
<div class="line">        <span class="keywordflow">return</span> rsp;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = <a class="code" href="rte__pipeline_8h.html#a0e90e4a54b6467deb9b449bf8bd5cab4">rte_pipeline_table_entry_add</a>(p-&gt;p,</div>
<div class="line">        <a class="code" href="structrte__pipeline__table__entry.html#a4783596f73bb7e535d78875dbf3397b0">table_id</a>,</div>
<div class="line">        &amp;match_ll,</div>
<div class="line">        data_in,</div>
<div class="line">        &amp;key_found,</div>
<div class="line">        &amp;data_out);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        rsp-&gt;status = -1;</div>
<div class="line">        <span class="keywordflow">return</span> rsp;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write response */</span></div>
<div class="line">    rsp-&gt;status = 0;</div>
<div class="line">    rsp-&gt;table_rule_add.data = data_out;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_rsp *</div>
<div class="line">pipeline_msg_handle_table_rule_add_default(<span class="keyword">struct</span> pipeline_data *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp = (<span class="keyword">struct </span>pipeline_msg_rsp *) req;</div>
<div class="line">    <span class="keyword">struct </span>table_rule_action *action = &amp;req-&gt;table_rule_add_default.action;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *data_in, *data_out;</div>
<div class="line">    uint32_t <a class="code" href="structrte__pipeline__table__entry.html#a4783596f73bb7e535d78875dbf3397b0">table_id</a> = req-&gt;id;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Apply actions */</span></div>
<div class="line">    memset(p-&gt;buffer, 0, <span class="keyword">sizeof</span>(p-&gt;buffer));</div>
<div class="line">    data_in = (<span class="keyword">struct </span><a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *) p-&gt;buffer;</div>
<div class="line"> </div>
<div class="line">    data_in-&gt;<a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a> = <a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a>-&gt;fwd.action;</div>
<div class="line">    if (<a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a>-&gt;fwd.action == <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572ac8c58609785d844989b7d9eb1e6db8aa">RTE_PIPELINE_ACTION_PORT</a>)</div>
<div class="line">        data_in-&gt;<a class="code" href="structrte__pipeline__table__entry.html#a6f54b893342775cdf092c6646e57c83b">port_id</a> = <a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a>-&gt;fwd.id;</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a>-&gt;fwd.action == <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572abafaf6276afcfcb170a2f7aa44c21048">RTE_PIPELINE_ACTION_TABLE</a>)</div>
<div class="line">        data_in-&gt;<a class="code" href="structrte__pipeline__table__entry.html#a4783596f73bb7e535d78875dbf3397b0">table_id</a> = <a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a>-&gt;fwd.id;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Add default rule to table */</span></div>
<div class="line">    status = <a class="code" href="rte__pipeline_8h.html#a8980fbc2a51d6dc8041b798ea5172318">rte_pipeline_table_default_entry_add</a>(p-&gt;p,</div>
<div class="line">        <a class="code" href="structrte__pipeline__table__entry.html#a4783596f73bb7e535d78875dbf3397b0">table_id</a>,</div>
<div class="line">        data_in,</div>
<div class="line">        &amp;data_out);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        rsp-&gt;status = -1;</div>
<div class="line">        <span class="keywordflow">return</span> rsp;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write response */</span></div>
<div class="line">    rsp-&gt;status = 0;</div>
<div class="line">    rsp-&gt;table_rule_add_default.data = data_out;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_rsp *</div>
<div class="line">pipeline_msg_handle_table_rule_add_bulk(<span class="keyword">struct</span> pipeline_data *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp = (<span class="keyword">struct </span>pipeline_msg_rsp *) req;</div>
<div class="line"> </div>
<div class="line">    uint32_t table_id = req-&gt;id;</div>
<div class="line">    <span class="keyword">struct </span>table_rule_list *list = req-&gt;table_rule_add_bulk.list;</div>
<div class="line">    uint32_t bulk = req-&gt;table_rule_add_bulk.bulk;</div>
<div class="line"> </div>
<div class="line">    uint32_t n_rules_added;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span>table_ll table_ll = {</div>
<div class="line">        .p = p-&gt;p,</div>
<div class="line">        .table_id = table_id,</div>
<div class="line">        .a = p-&gt;table_data[table_id].a,</div>
<div class="line">        .bulk_supported = bulk,</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    status = table_rule_add_bulk_ll(&amp;table_ll, list, &amp;n_rules_added);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        rsp-&gt;status = -1;</div>
<div class="line">        rsp-&gt;table_rule_add_bulk.n_rules = 0;</div>
<div class="line">        <span class="keywordflow">return</span> rsp;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write response */</span></div>
<div class="line">    rsp-&gt;status = 0;</div>
<div class="line">    rsp-&gt;table_rule_add_bulk.n_rules = n_rules_added;</div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_rsp *</div>
<div class="line">pipeline_msg_handle_table_rule_delete(<span class="keyword">struct</span> pipeline_data *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">union </span>table_rule_match_low_level match_ll;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp = (<span class="keyword">struct </span>pipeline_msg_rsp *) req;</div>
<div class="line">    <span class="keyword">struct </span>table_rule_match *match = &amp;req-&gt;table_rule_delete.match;</div>
<div class="line">    uint32_t table_id = req-&gt;id;</div>
<div class="line">    <span class="keywordtype">int</span> key_found, status;</div>
<div class="line"> </div>
<div class="line">    status = match_convert(match, &amp;match_ll, 0);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        rsp-&gt;status = -1;</div>
<div class="line">        <span class="keywordflow">return</span> rsp;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    rsp-&gt;status = <a class="code" href="rte__pipeline_8h.html#a946f0d5610d152c1e6f641928c4f0743">rte_pipeline_table_entry_delete</a>(p-&gt;p,</div>
<div class="line">        table_id,</div>
<div class="line">        &amp;match_ll,</div>
<div class="line">        &amp;key_found,</div>
<div class="line">        NULL);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_rsp *</div>
<div class="line">pipeline_msg_handle_table_rule_delete_default(<span class="keyword">struct</span> pipeline_data *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp = (<span class="keyword">struct </span>pipeline_msg_rsp *) req;</div>
<div class="line">    uint32_t table_id = req-&gt;id;</div>
<div class="line"> </div>
<div class="line">    rsp-&gt;status = <a class="code" href="rte__pipeline_8h.html#ac83e9cacb91301a7425694f32249e050">rte_pipeline_table_default_entry_delete</a>(p-&gt;p,</div>
<div class="line">        table_id,</div>
<div class="line">        NULL);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_rsp *</div>
<div class="line">pipeline_msg_handle_table_rule_stats_read(<span class="keyword">struct</span> pipeline_data *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp = (<span class="keyword">struct </span>pipeline_msg_rsp *) req;</div>
<div class="line">    uint32_t table_id = req-&gt;id;</div>
<div class="line">    <span class="keywordtype">void</span> *data = req-&gt;table_rule_stats_read.data;</div>
<div class="line">    <span class="keywordtype">int</span> clear = req-&gt;table_rule_stats_read.clear;</div>
<div class="line">    <span class="keyword">struct </span>rte_table_action *a = p-&gt;table_data[table_id].a;</div>
<div class="line"> </div>
<div class="line">    rsp-&gt;status = <a class="code" href="rte__table__action_8h.html#a93c0fb3b5ac9825a0656c91b0af4c913">rte_table_action_stats_read</a>(a,</div>
<div class="line">        data,</div>
<div class="line">        &amp;rsp-&gt;table_rule_stats_read.stats,</div>
<div class="line">        clear);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_rsp *</div>
<div class="line">pipeline_msg_handle_table_mtr_profile_add(<span class="keyword">struct</span> pipeline_data *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp = (<span class="keyword">struct </span>pipeline_msg_rsp *) req;</div>
<div class="line">    uint32_t table_id = req-&gt;id;</div>
<div class="line">    uint32_t meter_profile_id = req-&gt;table_mtr_profile_add.meter_profile_id;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__table__action__meter__profile.html">rte_table_action_meter_profile</a> *profile =</div>
<div class="line">        &amp;req-&gt;table_mtr_profile_add.profile;</div>
<div class="line">    <span class="keyword">struct </span>rte_table_action *a = p-&gt;table_data[table_id].a;</div>
<div class="line"> </div>
<div class="line">    rsp-&gt;status = <a class="code" href="rte__table__action_8h.html#a5e8b781110a05d3a7ef91d9ef8cf84a0">rte_table_action_meter_profile_add</a>(a,</div>
<div class="line">        meter_profile_id,</div>
<div class="line">        profile);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_rsp *</div>
<div class="line">pipeline_msg_handle_table_mtr_profile_delete(<span class="keyword">struct</span> pipeline_data *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp = (<span class="keyword">struct </span>pipeline_msg_rsp *) req;</div>
<div class="line">    uint32_t table_id = req-&gt;id;</div>
<div class="line">    uint32_t meter_profile_id =</div>
<div class="line">        req-&gt;table_mtr_profile_delete.meter_profile_id;</div>
<div class="line">    <span class="keyword">struct </span>rte_table_action *a = p-&gt;table_data[table_id].a;</div>
<div class="line"> </div>
<div class="line">    rsp-&gt;status = <a class="code" href="rte__table__action_8h.html#a05023d9cc6b8951283f6494573dc8f30">rte_table_action_meter_profile_delete</a>(a,</div>
<div class="line">        meter_profile_id);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_rsp *</div>
<div class="line">pipeline_msg_handle_table_rule_mtr_read(<span class="keyword">struct</span> pipeline_data *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp = (<span class="keyword">struct </span>pipeline_msg_rsp *) req;</div>
<div class="line">    uint32_t table_id = req-&gt;id;</div>
<div class="line">    <span class="keywordtype">void</span> *data = req-&gt;table_rule_mtr_read.data;</div>
<div class="line">    uint32_t tc_mask = req-&gt;table_rule_mtr_read.tc_mask;</div>
<div class="line">    <span class="keywordtype">int</span> clear = req-&gt;table_rule_mtr_read.clear;</div>
<div class="line">    <span class="keyword">struct </span>rte_table_action *a = p-&gt;table_data[table_id].a;</div>
<div class="line"> </div>
<div class="line">    rsp-&gt;status = <a class="code" href="rte__table__action_8h.html#aaca015bba5fc3cf51c0e30344ca60416">rte_table_action_meter_read</a>(a,</div>
<div class="line">        data,</div>
<div class="line">        tc_mask,</div>
<div class="line">        &amp;rsp-&gt;table_rule_mtr_read.stats,</div>
<div class="line">        clear);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_rsp *</div>
<div class="line">pipeline_msg_handle_table_dscp_table_update(<span class="keyword">struct</span> pipeline_data *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp = (<span class="keyword">struct </span>pipeline_msg_rsp *) req;</div>
<div class="line">    uint32_t table_id = req-&gt;id;</div>
<div class="line">    uint64_t dscp_mask = req-&gt;table_dscp_table_update.dscp_mask;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__table__action__dscp__table.html">rte_table_action_dscp_table</a> *dscp_table =</div>
<div class="line">        &amp;req-&gt;table_dscp_table_update.dscp_table;</div>
<div class="line">    <span class="keyword">struct </span>rte_table_action *a = p-&gt;table_data[table_id].a;</div>
<div class="line"> </div>
<div class="line">    rsp-&gt;status = <a class="code" href="rte__table__action_8h.html#aa6c355b2ffff26b22405df408539790f">rte_table_action_dscp_table_update</a>(a,</div>
<div class="line">        dscp_mask,</div>
<div class="line">        dscp_table);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_rsp *</div>
<div class="line">pipeline_msg_handle_table_rule_ttl_read(<span class="keyword">struct</span> pipeline_data *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp = (<span class="keyword">struct </span>pipeline_msg_rsp *) req;</div>
<div class="line">    uint32_t table_id = req-&gt;id;</div>
<div class="line">    <span class="keywordtype">void</span> *data = req-&gt;table_rule_ttl_read.data;</div>
<div class="line">    <span class="keywordtype">int</span> clear = req-&gt;table_rule_ttl_read.clear;</div>
<div class="line">    <span class="keyword">struct </span>rte_table_action *a = p-&gt;table_data[table_id].a;</div>
<div class="line"> </div>
<div class="line">    rsp-&gt;status = <a class="code" href="rte__table__action_8h.html#aad5f9c62ce78601c8ef6c0f5b0a5d814">rte_table_action_ttl_read</a>(a,</div>
<div class="line">        data,</div>
<div class="line">        &amp;rsp-&gt;table_rule_ttl_read.stats,</div>
<div class="line">        clear);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_msg_rsp *</div>
<div class="line">pipeline_msg_handle_table_rule_time_read(<span class="keyword">struct</span> pipeline_data *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_msg_req *req)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_msg_rsp *rsp = (<span class="keyword">struct </span>pipeline_msg_rsp *) req;</div>
<div class="line">    uint32_t table_id = req-&gt;id;</div>
<div class="line">    <span class="keywordtype">void</span> *data = req-&gt;table_rule_time_read.data;</div>
<div class="line">    <span class="keyword">struct </span>rte_table_action *a = p-&gt;table_data[table_id].a;</div>
<div class="line"> </div>
<div class="line">    rsp-&gt;status = <a class="code" href="rte__table__action_8h.html#ac09a29a1ab18953296ba1851cdba7903">rte_table_action_time_read</a>(a,</div>
<div class="line">        data,</div>
<div class="line">        &amp;rsp-&gt;table_rule_time_read.timestamp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">pipeline_msg_handle(<span class="keyword">struct</span> pipeline_data *p)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span> ( ; ; ) {</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_req *req;</div>
<div class="line">        <span class="keyword">struct </span>pipeline_msg_rsp *rsp;</div>
<div class="line"> </div>
<div class="line">        req = pipeline_msg_recv(p-&gt;msgq_req);</div>
<div class="line">        <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">switch</span> (req-&gt;type) {</div>
<div class="line">        <span class="keywordflow">case</span> PIPELINE_REQ_PORT_IN_STATS_READ:</div>
<div class="line">            rsp = pipeline_msg_handle_port_in_stats_read(p, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> PIPELINE_REQ_PORT_IN_ENABLE:</div>
<div class="line">            rsp = pipeline_msg_handle_port_in_enable(p, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> PIPELINE_REQ_PORT_IN_DISABLE:</div>
<div class="line">            rsp = pipeline_msg_handle_port_in_disable(p, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> PIPELINE_REQ_PORT_OUT_STATS_READ:</div>
<div class="line">            rsp = pipeline_msg_handle_port_out_stats_read(p, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> PIPELINE_REQ_TABLE_STATS_READ:</div>
<div class="line">            rsp = pipeline_msg_handle_table_stats_read(p, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> PIPELINE_REQ_TABLE_RULE_ADD:</div>
<div class="line">            rsp = pipeline_msg_handle_table_rule_add(p, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> PIPELINE_REQ_TABLE_RULE_ADD_DEFAULT:</div>
<div class="line">            rsp = pipeline_msg_handle_table_rule_add_default(p, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> PIPELINE_REQ_TABLE_RULE_ADD_BULK:</div>
<div class="line">            rsp = pipeline_msg_handle_table_rule_add_bulk(p, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> PIPELINE_REQ_TABLE_RULE_DELETE:</div>
<div class="line">            rsp = pipeline_msg_handle_table_rule_delete(p, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> PIPELINE_REQ_TABLE_RULE_DELETE_DEFAULT:</div>
<div class="line">            rsp = pipeline_msg_handle_table_rule_delete_default(p, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> PIPELINE_REQ_TABLE_RULE_STATS_READ:</div>
<div class="line">            rsp = pipeline_msg_handle_table_rule_stats_read(p, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> PIPELINE_REQ_TABLE_MTR_PROFILE_ADD:</div>
<div class="line">            rsp = pipeline_msg_handle_table_mtr_profile_add(p, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> PIPELINE_REQ_TABLE_MTR_PROFILE_DELETE:</div>
<div class="line">            rsp = pipeline_msg_handle_table_mtr_profile_delete(p, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> PIPELINE_REQ_TABLE_RULE_MTR_READ:</div>
<div class="line">            rsp = pipeline_msg_handle_table_rule_mtr_read(p, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> PIPELINE_REQ_TABLE_DSCP_TABLE_UPDATE:</div>
<div class="line">            rsp = pipeline_msg_handle_table_dscp_table_update(p, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> PIPELINE_REQ_TABLE_RULE_TTL_READ:</div>
<div class="line">            rsp = pipeline_msg_handle_table_rule_ttl_read(p, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> PIPELINE_REQ_TABLE_RULE_TIME_READ:</div>
<div class="line">            rsp = pipeline_msg_handle_table_rule_time_read(p, req);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            rsp = (<span class="keyword">struct </span>pipeline_msg_rsp *) req;</div>
<div class="line">            rsp-&gt;status = -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        pipeline_msg_send(p-&gt;msgq_rsp, rsp);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">thread_main(<span class="keywordtype">void</span> *arg <a name="a72"></a><a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>thread_data *t;</div>
<div class="line">    uint32_t thread_id, i;</div>
<div class="line"> </div>
<div class="line">    thread_id = <a name="a73"></a><a class="code" href="rte__lcore_8h.html#adfb2b334e7e73f534f25e8888a8a775f">rte_lcore_id</a>();</div>
<div class="line">    t = &amp;thread_data[thread_id];</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Dispatch loop */</span></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; ; i++) {</div>
<div class="line">        uint32_t j;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Data Plane */</span></div>
<div class="line">        <span class="keywordflow">for</span> (j = 0; j &lt; t-&gt;n_pipelines; j++)</div>
<div class="line">            <a name="a74"></a><a class="code" href="rte__pipeline_8h.html#a4570eddec506f947c5c91cb2334a2eda">rte_pipeline_run</a>(t-&gt;p[j]);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Control Plane */</span></div>
<div class="line">        <span class="keywordflow">if</span> ((i &amp; 0xF) == 0) {</div>
<div class="line">            uint64_t time = <a class="code" href="rte__cycles_8h.html#a34aaedfb8b9fa4f83d4cb3108cda2041">rte_get_tsc_cycles</a>();</div>
<div class="line">            uint64_t time_next_min = UINT64_MAX;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (time &lt; t-&gt;time_next_min)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Pipeline message queues */</span></div>
<div class="line">            <span class="keywordflow">for</span> (j = 0; j &lt; t-&gt;n_pipelines; j++) {</div>
<div class="line">                <span class="keyword">struct </span>pipeline_data *p =</div>
<div class="line">                    &amp;t-&gt;pipeline_data[j];</div>
<div class="line">                uint64_t time_next = p-&gt;time_next;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (time_next &lt;= time) {</div>
<div class="line">                    pipeline_msg_handle(p);</div>
<div class="line">                    <a name="a75"></a><a class="code" href="rte__pipeline_8h.html#ac26447a6b0c4b1ec218a9133d790fef1">rte_pipeline_flush</a>(p-&gt;p);</div>
<div class="line">                    time_next = time + p-&gt;timer_period;</div>
<div class="line">                    p-&gt;time_next = time_next;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (time_next &lt; time_next_min)</div>
<div class="line">                    time_next_min = time_next;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Thread message queues */</span></div>
<div class="line">            {</div>
<div class="line">                uint64_t time_next = t-&gt;time_next;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (time_next &lt;= time) {</div>
<div class="line">                    thread_msg_handle(t);</div>
<div class="line">                    time_next = time + t-&gt;timer_period;</div>
<div class="line">                    t-&gt;time_next = time_next;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (time_next &lt; time_next_min)</div>
<div class="line">                    time_next_min = time_next;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            t-&gt;time_next_min = time_next_min;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="arte__table__action_8h_html_a05023d9cc6b8951283f6494573dc8f30"><div class="ttname"><a href="rte__table__action_8h.html#a05023d9cc6b8951283f6494573dc8f30">rte_table_action_meter_profile_delete</a></div><div class="ttdeci">__rte_experimental int rte_table_action_meter_profile_delete(struct rte_table_action *action, uint32_t meter_profile_id)</div></div>
<div class="ttc" id="arte__common_8h_html_a8df8b303b8ea240cf6aebf937fd21eaf"><div class="ttname"><a href="rte__common_8h.html#a8df8b303b8ea240cf6aebf937fd21eaf">RTE_MAX</a></div><div class="ttdeci">#define RTE_MAX(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00583">rte_common.h:583</a></div></div>
<div class="ttc" id="arte__pipeline_8h_html_a6376b240935404d998f003d113651572ac8c58609785d844989b7d9eb1e6db8aa"><div class="ttname"><a href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572ac8c58609785d844989b7d9eb1e6db8aa">RTE_PIPELINE_ACTION_PORT</a></div><div class="ttdeci">@ RTE_PIPELINE_ACTION_PORT</div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00186">rte_pipeline.h:186</a></div></div>
<div class="ttc" id="astructrte__pipeline__port__out__stats_html_a7d127ce0e2d9594ebb38cc5441e60174"><div class="ttname"><a href="structrte__pipeline__port__out__stats.html#a7d127ce0e2d9594ebb38cc5441e60174">rte_pipeline_port_out_stats::stats</a></div><div class="ttdeci">struct rte_port_out_stats stats</div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00093">rte_pipeline.h:100</a></div></div>
<div class="ttc" id="astructrte__pipeline__table__entry_html_a4783596f73bb7e535d78875dbf3397b0"><div class="ttname"><a href="structrte__pipeline__table__entry.html#a4783596f73bb7e535d78875dbf3397b0">rte_pipeline_table_entry::table_id</a></div><div class="ttdeci">uint32_t table_id</div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00225">rte_pipeline.h:225</a></div></div>
<div class="ttc" id="arte__pipeline_8h_html_ae53c3736fb2a1edc8e4b9b185d9d8fc3"><div class="ttname"><a href="rte__pipeline_8h.html#ae53c3736fb2a1edc8e4b9b185d9d8fc3">RTE_PIPELINE_TABLE_MAX</a></div><div class="ttdeci">#define RTE_PIPELINE_TABLE_MAX</div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00204">rte_pipeline.h:204</a></div></div>
<div class="ttc" id="arte__pipeline_8h_html_a946f0d5610d152c1e6f641928c4f0743"><div class="ttname"><a href="rte__pipeline_8h.html#a946f0d5610d152c1e6f641928c4f0743">rte_pipeline_table_entry_delete</a></div><div class="ttdeci">int rte_pipeline_table_entry_delete(struct rte_pipeline *p, uint32_t table_id, void *key, int *key_found, struct rte_pipeline_table_entry *entry)</div></div>
<div class="ttc" id="astructrte__table__action__dscp__table_html"><div class="ttname"><a href="structrte__table__action__dscp__table.html">rte_table_action_dscp_table</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00209">rte_table_action.h:209</a></div></div>
<div class="ttc" id="arte__table__acl_8h_html"><div class="ttname"><a href="rte__table__acl_8h.html">rte_table_acl.h</a></div></div>
<div class="ttc" id="arte__pipeline_8h_html_a6376b240935404d998f003d113651572abafaf6276afcfcb170a2f7aa44c21048"><div class="ttname"><a href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572abafaf6276afcfcb170a2f7aa44c21048">RTE_PIPELINE_ACTION_TABLE</a></div><div class="ttdeci">@ RTE_PIPELINE_ACTION_TABLE</div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00192">rte_pipeline.h:192</a></div></div>
<div class="ttc" id="arte__lcore_8h_html_a5404ee6ac26cbe5a4f4ddef44d690b76"><div class="ttname"><a href="rte__lcore_8h.html#a5404ee6ac26cbe5a4f4ddef44d690b76">rte_lcore_is_enabled</a></div><div class="ttdeci">int rte_lcore_is_enabled(unsigned int lcore_id)</div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2af4f7ba5c7d7eefc2fde9341b8724c11b"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2af4f7ba5c7d7eefc2fde9341b8724c11b">RTE_TABLE_ACTION_LB</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_LB</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00074">rte_table_action.h:74</a></div></div>
<div class="ttc" id="arte__pipeline_8h_html_a3fb68f21e8a212dcf698077b66e53e94"><div class="ttname"><a href="rte__pipeline_8h.html#a3fb68f21e8a212dcf698077b66e53e94">rte_pipeline_table_stats_read</a></div><div class="ttdeci">int rte_pipeline_table_stats_read(struct rte_pipeline *p, uint32_t table_id, struct rte_pipeline_table_stats *stats, int clear)</div></div>
<div class="ttc" id="arte__lcore_8h_html"><div class="ttname"><a href="rte__lcore_8h.html">rte_lcore.h</a></div></div>
<div class="ttc" id="astructrte__table__action__stats__counters_html"><div class="ttname"><a href="structrte__table__action__stats__counters.html">rte_table_action_stats_counters</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00685">rte_table_action.h:685</a></div></div>
<div class="ttc" id="arte__pipeline_8h_html_a0e90e4a54b6467deb9b449bf8bd5cab4"><div class="ttname"><a href="rte__pipeline_8h.html#a0e90e4a54b6467deb9b449bf8bd5cab4">rte_pipeline_table_entry_add</a></div><div class="ttdeci">int rte_pipeline_table_entry_add(struct rte_pipeline *p, uint32_t table_id, void *key, struct rte_pipeline_table_entry *entry, int *key_found, struct rte_pipeline_table_entry **entry_ptr)</div></div>
<div class="ttc" id="arte__ring_8h_html_ae4dece63653850041afd5c16d3d6e052"><div class="ttname"><a href="rte__ring_8h.html#ae4dece63653850041afd5c16d3d6e052">rte_ring_create</a></div><div class="ttdeci">struct rte_ring * rte_ring_create(const char *name, unsigned int count, int socket_id, unsigned int flags)</div></div>
<div class="ttc" id="arte__pipeline_8h_html_ac26447a6b0c4b1ec218a9133d790fef1"><div class="ttname"><a href="rte__pipeline_8h.html#ac26447a6b0c4b1ec218a9133d790fef1">rte_pipeline_flush</a></div><div class="ttdeci">int rte_pipeline_flush(struct rte_pipeline *p)</div></div>
<div class="ttc" id="arte__table__action_8h_html_ac09a29a1ab18953296ba1851cdba7903"><div class="ttname"><a href="rte__table__action_8h.html#ac09a29a1ab18953296ba1851cdba7903">rte_table_action_time_read</a></div><div class="ttdeci">__rte_experimental int rte_table_action_time_read(struct rte_table_action *action, void *data, uint64_t *timestamp)</div></div>
<div class="ttc" id="astructrte__pipeline__table__entry_html"><div class="ttname"><a href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00215">rte_pipeline.h:215</a></div></div>
<div class="ttc" id="arte__ring_8h_html"><div class="ttname"><a href="rte__ring_8h.html">rte_ring.h</a></div></div>
<div class="ttc" id="arte__common_8h_html_a38e32f822bc941e90fdcbe5a9c69b178"><div class="ttname"><a href="rte__common_8h.html#a38e32f822bc941e90fdcbe5a9c69b178">__rte_cache_aligned</a></div><div class="ttdeci">#define __rte_cache_aligned</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00400">rte_common.h:400</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_a019ab01972c7267f95dbf90a506b0ba6"><div class="ttname"><a href="rte__table__action_8h.html#a019ab01972c7267f95dbf90a506b0ba6">rte_table_action_apply</a></div><div class="ttdeci">__rte_experimental int rte_table_action_apply(struct rte_table_action *action, void *data, enum rte_table_action_type type, void *action_params)</div></div>
<div class="ttc" id="arte__lcore_8h_html_a023b4909f52c3cdf0351d71d2b5032bc"><div class="ttname"><a href="rte__lcore_8h.html#a023b4909f52c3cdf0351d71d2b5032bc">rte_lcore_to_socket_id</a></div><div class="ttdeci">unsigned int rte_lcore_to_socket_id(unsigned int lcore_id)</div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2a73da4960f9f9b30236eeaaed592c855c"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a73da4960f9f9b30236eeaaed592c855c">RTE_TABLE_ACTION_DECAP</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_DECAP</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00104">rte_table_action.h:104</a></div></div>
<div class="ttc" id="arte__ring_8h_html_a564e012c1eb4ae08f9eea3acfd08b377"><div class="ttname"><a href="rte__ring_8h.html#a564e012c1eb4ae08f9eea3acfd08b377">rte_ring_free</a></div><div class="ttdeci">void rte_ring_free(struct rte_ring *r)</div></div>
<div class="ttc" id="arte__pipeline_8h_html_a790da0e2e134063df3eaa55bf6b70342"><div class="ttname"><a href="rte__pipeline_8h.html#a790da0e2e134063df3eaa55bf6b70342">rte_pipeline_port_in_stats_read</a></div><div class="ttdeci">int rte_pipeline_port_in_stats_read(struct rte_pipeline *p, uint32_t port_id, struct rte_pipeline_port_in_stats *stats, int clear)</div></div>
<div class="ttc" id="arte__pipeline_8h_html_a8980fbc2a51d6dc8041b798ea5172318"><div class="ttname"><a href="rte__pipeline_8h.html#a8980fbc2a51d6dc8041b798ea5172318">rte_pipeline_table_default_entry_add</a></div><div class="ttdeci">int rte_pipeline_table_default_entry_add(struct rte_pipeline *p, uint32_t table_id, struct rte_pipeline_table_entry *default_entry, struct rte_pipeline_table_entry **default_entry_ptr)</div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2a9f9ca84acea19612c86d3da0898ed34e"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a9f9ca84acea19612c86d3da0898ed34e">RTE_TABLE_ACTION_TM</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_TM</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00080">rte_table_action.h:80</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2a491ff78ac06bce973d261ed4dea04101"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a491ff78ac06bce973d261ed4dea04101">RTE_TABLE_ACTION_STATS</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_STATS</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00092">rte_table_action.h:92</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2a3a25fcdcb69e9946dc6d9f6fc7f6ac72"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a3a25fcdcb69e9946dc6d9f6fc7f6ac72">RTE_TABLE_ACTION_TAG</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_TAG</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00101">rte_table_action.h:101</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2a5ff88316e4574c62086f9f978a89fe5a"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a5ff88316e4574c62086f9f978a89fe5a">RTE_TABLE_ACTION_TIME</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_TIME</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00095">rte_table_action.h:95</a></div></div>
<div class="ttc" id="arte__pipeline_8h_html_a4570eddec506f947c5c91cb2334a2eda"><div class="ttname"><a href="rte__pipeline_8h.html#a4570eddec506f947c5c91cb2334a2eda">rte_pipeline_run</a></div><div class="ttdeci">int rte_pipeline_run(struct rte_pipeline *p)</div></div>
<div class="ttc" id="arte__byteorder_8h_html_a1d6fa9e3f0a9b2de0836177fa02eb403"><div class="ttname"><a href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a></div><div class="ttdeci">static uint32_t rte_be_to_cpu_32(rte_be32_t x)</div></div>
<div class="ttc" id="arte__table__lpm__ipv6_8h_html"><div class="ttname"><a href="rte__table__lpm__ipv6_8h.html">rte_table_lpm_ipv6.h</a></div></div>
<div class="ttc" id="arte__cycles_8h_html_ae016e608f344823e677819d8f04264c5"><div class="ttname"><a href="rte__cycles_8h.html#ae016e608f344823e677819d8f04264c5">rte_get_tsc_hz</a></div><div class="ttdeci">uint64_t rte_get_tsc_hz(void)</div></div>
<div class="ttc" id="arte__ring__core_8h_html_a127c66adbeab4653a47649993b94f35b"><div class="ttname"><a href="rte__ring__core_8h.html#a127c66adbeab4653a47649993b94f35b">RING_F_SP_ENQ</a></div><div class="ttdeci">#define RING_F_SP_ENQ</div><div class="ttdef"><b>Definition:</b> <a href="rte__ring__core_8h_source.html#l00161">rte_ring_core.h:161</a></div></div>
<div class="ttc" id="arte__lcore_8h_html_adfb2b334e7e73f534f25e8888a8a775f"><div class="ttname"><a href="rte__lcore_8h.html#adfb2b334e7e73f534f25e8888a8a775f">rte_lcore_id</a></div><div class="ttdeci">static unsigned rte_lcore_id(void)</div><div class="ttdef"><b>Definition:</b> <a href="rte__lcore_8h_source.html#l00075">rte_lcore.h:75</a></div></div>
<div class="ttc" id="astructrte__ring_html"><div class="ttname"><a href="structrte__ring.html">rte_ring</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ring__core_8h_source.html#l00123">rte_ring_core.h:123</a></div></div>
<div class="ttc" id="arte__cycles_8h_html"><div class="ttname"><a href="rte__cycles_8h.html">rte_cycles.h</a></div></div>
<div class="ttc" id="astructrte__table__action__mtr__counters_html"><div class="ttname"><a href="structrte__table__action__mtr__counters.html">rte_table_action_mtr_counters</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00327">rte_table_action.h:327</a></div></div>
<div class="ttc" id="astructrte__table__acl__rule__add__params_html"><div class="ttname"><a href="structrte__table__acl__rule__add__params.html">rte_table_acl_rule_add_params</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__table__acl_8h_source.html#l00045">rte_table_acl.h:45</a></div></div>
<div class="ttc" id="astructrte__table__lpm__key_html"><div class="ttname"><a href="structrte__table__lpm__key.html">rte_table_lpm_key</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__table__lpm_8h_source.html#l00077">rte_table_lpm.h:77</a></div></div>
<div class="ttc" id="astructrte__pipeline__table__stats_html_a324dbcea014c359561641979bb66c6f1"><div class="ttname"><a href="structrte__pipeline__table__stats.html#a324dbcea014c359561641979bb66c6f1">rte_pipeline_table_stats::stats</a></div><div class="ttdeci">struct rte_table_stats stats</div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00103">rte_pipeline.h:109</a></div></div>
<div class="ttc" id="arte__pipeline_8h_html_af8a48f99a99731883005dfe93c5406e6"><div class="ttname"><a href="rte__pipeline_8h.html#af8a48f99a99731883005dfe93c5406e6">rte_pipeline_port_in_enable</a></div><div class="ttdeci">int rte_pipeline_port_in_enable(struct rte_pipeline *p, uint32_t port_id)</div></div>
<div class="ttc" id="astructrte__table__action__ttl__counters_html"><div class="ttname"><a href="structrte__table__action__ttl__counters.html">rte_table_action_ttl_counters</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00642">rte_table_action.h:642</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_a93c0fb3b5ac9825a0656c91b0af4c913"><div class="ttname"><a href="rte__table__action_8h.html#a93c0fb3b5ac9825a0656c91b0af4c913">rte_table_action_stats_read</a></div><div class="ttdeci">__rte_experimental int rte_table_action_stats_read(struct rte_table_action *action, void *data, struct rte_table_action_stats_counters *stats, int clear)</div></div>
<div class="ttc" id="astructrte__pipeline__port__in__stats_html"><div class="ttname"><a href="structrte__pipeline__port__in__stats.html">rte_pipeline_port_in_stats</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00088">rte_pipeline.h:88</a></div></div>
<div class="ttc" id="arte__common_8h_html"><div class="ttname"><a href="rte__common_8h.html">rte_common.h</a></div></div>
<div class="ttc" id="arte__table__array_8h_html"><div class="ttname"><a href="rte__table__array_8h.html">rte_table_array.h</a></div></div>
<div class="ttc" id="arte__pipeline_8h_html_a6b3750798dfd9a03093790d52dd94aca"><div class="ttname"><a href="rte__pipeline_8h.html#a6b3750798dfd9a03093790d52dd94aca">rte_pipeline_port_in_disable</a></div><div class="ttdeci">int rte_pipeline_port_in_disable(struct rte_pipeline *p, uint32_t port_id)</div></div>
<div class="ttc" id="arte__common_8h_html_ae1a7c8799cb57669ae2ddf367b21533f"><div class="ttname"><a href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a></div><div class="ttdeci">#define __rte_unused</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00116">rte_common.h:116</a></div></div>
<div class="ttc" id="arte__launch_8h_html_aac7785c53560a19ce4108c510e5024c9"><div class="ttname"><a href="rte__launch_8h.html#aac7785c53560a19ce4108c510e5024c9">rte_lcore_state_t</a></div><div class="ttdeci">rte_lcore_state_t</div><div class="ttdef"><b>Definition:</b> <a href="rte__launch_8h_source.html#l00021">rte_launch.h:21</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_ac3fd327e32beaa5080a6e42040e4629c"><div class="ttname"><a href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629c">rte_table_action_encap_type</a></div><div class="ttdeci">rte_table_action_encap_type</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00363">rte_table_action.h:363</a></div></div>
<div class="ttc" id="arte__launch_8h_html_a66d883d90f6112489b69c996a2f6f2ab"><div class="ttname"><a href="rte__launch_8h.html#a66d883d90f6112489b69c996a2f6f2ab">rte_eal_get_lcore_state</a></div><div class="ttdeci">enum rte_lcore_state_t rte_eal_get_lcore_state(unsigned int worker_id)</div></div>
<div class="ttc" id="arte__table__hash_8h_html"><div class="ttname"><a href="rte__table__hash_8h.html">rte_table_hash.h</a></div></div>
<div class="ttc" id="arte__common_8h_html_aef7d28b28ed75cf43a62bfab9bb4b6da"><div class="ttname"><a href="rte__common_8h.html#aef7d28b28ed75cf43a62bfab9bb4b6da">RTE_STD_C11</a></div><div class="ttdeci">#define RTE_STD_C11</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00040">rte_common.h:40</a></div></div>
<div class="ttc" id="astructrte__pipeline__table__stats_html"><div class="ttname"><a href="structrte__pipeline__table__stats.html">rte_pipeline_table_stats</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00107">rte_pipeline.h:107</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_aaca015bba5fc3cf51c0e30344ca60416"><div class="ttname"><a href="rte__table__action_8h.html#aaca015bba5fc3cf51c0e30344ca60416">rte_table_action_meter_read</a></div><div class="ttdeci">__rte_experimental int rte_table_action_meter_read(struct rte_table_action *action, void *data, uint32_t tc_mask, struct rte_table_action_mtr_counters *stats, int clear)</div></div>
<div class="ttc" id="arte__pipeline_8h_html_a95cffe0cc5ee976c84d57af72b570523"><div class="ttname"><a href="rte__pipeline_8h.html#a95cffe0cc5ee976c84d57af72b570523">rte_pipeline_table_entry_add_bulk</a></div><div class="ttdeci">int rte_pipeline_table_entry_add_bulk(struct rte_pipeline *p, uint32_t table_id, void **keys, struct rte_pipeline_table_entry **entries, uint32_t n_keys, int *key_found, struct rte_pipeline_table_entry **entries_ptr)</div></div>
<div class="ttc" id="arte__lcore_8h_html_ac779e61584eb9d087c3e20bf2d1150c8"><div class="ttname"><a href="rte__lcore_8h.html#ac779e61584eb9d087c3e20bf2d1150c8">RTE_LCORE_FOREACH_WORKER</a></div><div class="ttdeci">#define RTE_LCORE_FOREACH_WORKER(i)</div><div class="ttdef"><b>Definition:</b> <a href="rte__lcore_8h_source.html#l00239">rte_lcore.h:239</a></div></div>
<div class="ttc" id="arte__ring_8h_html_ae8a18b67229a569e0ad2fb1e5df70d2c"><div class="ttname"><a href="rte__ring_8h.html#ae8a18b67229a569e0ad2fb1e5df70d2c">rte_ring_sc_dequeue</a></div><div class="ttdeci">static __rte_always_inline int rte_ring_sc_dequeue(struct rte_ring *r, void **obj_p)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ring_8h_source.html#l00439">rte_ring.h:439</a></div></div>
<div class="ttc" id="astructrte__pipeline__port__out__stats_html"><div class="ttname"><a href="structrte__pipeline__port__out__stats.html">rte_pipeline_port_out_stats</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00098">rte_pipeline.h:98</a></div></div>
<div class="ttc" id="arte__pipeline_8h_html_ab831fab1384d2dc680140e08bd2acdff"><div class="ttname"><a href="rte__pipeline_8h.html#ab831fab1384d2dc680140e08bd2acdff">rte_pipeline_port_out_stats_read</a></div><div class="ttdeci">int rte_pipeline_port_out_stats_read(struct rte_pipeline *p, uint32_t port_id, struct rte_pipeline_port_out_stats *stats, int clear)</div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2a7442253cfdff0aec945b0ad7ddf5ab2d"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a7442253cfdff0aec945b0ad7ddf5ab2d">RTE_TABLE_ACTION_MTR</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_MTR</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00077">rte_table_action.h:77</a></div></div>
<div class="ttc" id="astructrte__pipeline__port__in__stats_html_a48efd9560ccf56a1dedb5d25e323fa8a"><div class="ttname"><a href="structrte__pipeline__port__in__stats.html#a48efd9560ccf56a1dedb5d25e323fa8a">rte_pipeline_port_in_stats::stats</a></div><div class="ttdeci">struct rte_port_in_stats stats</div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00084">rte_pipeline.h:90</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2a6368c734fa9c1ac9cb591160eb6bf293"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a6368c734fa9c1ac9cb591160eb6bf293">RTE_TABLE_ACTION_NAT</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_NAT</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00086">rte_table_action.h:86</a></div></div>
<div class="ttc" id="astructrte__pipeline__table__entry_html_a6f54b893342775cdf092c6646e57c83b"><div class="ttname"><a href="structrte__pipeline__table__entry.html#a6f54b893342775cdf092c6646e57c83b">rte_pipeline_table_entry::port_id</a></div><div class="ttdeci">uint32_t port_id</div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00223">rte_pipeline.h:223</a></div></div>
<div class="ttc" id="arte__pipeline_8h_html_ac83e9cacb91301a7425694f32249e050"><div class="ttname"><a href="rte__pipeline_8h.html#ac83e9cacb91301a7425694f32249e050">rte_pipeline_table_default_entry_delete</a></div><div class="ttdeci">int rte_pipeline_table_default_entry_delete(struct rte_pipeline *p, uint32_t table_id, struct rte_pipeline_table_entry *entry)</div></div>
<div class="ttc" id="arte__cycles_8h_html_a34aaedfb8b9fa4f83d4cb3108cda2041"><div class="ttname"><a href="rte__cycles_8h.html#a34aaedfb8b9fa4f83d4cb3108cda2041">rte_get_tsc_cycles</a></div><div class="ttdeci">static uint64_t rte_get_tsc_cycles(void)</div></div>
<div class="ttc" id="arte__launch_8h_html_aac7785c53560a19ce4108c510e5024c9a1061be6c3fb88d32829cba6f6b2be304"><div class="ttname"><a href="rte__launch_8h.html#aac7785c53560a19ce4108c510e5024c9a1061be6c3fb88d32829cba6f6b2be304">RUNNING</a></div><div class="ttdeci">@ RUNNING</div><div class="ttdef"><b>Definition:</b> <a href="rte__launch_8h_source.html#l00023">rte_launch.h:23</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_aad5f9c62ce78601c8ef6c0f5b0a5d814"><div class="ttname"><a href="rte__table__action_8h.html#aad5f9c62ce78601c8ef6c0f5b0a5d814">rte_table_action_ttl_read</a></div><div class="ttdeci">__rte_experimental int rte_table_action_ttl_read(struct rte_table_action *action, void *data, struct rte_table_action_ttl_counters *stats, int clear)</div></div>
<div class="ttc" id="arte__ring__core_8h_html_a421a61b2f94cdf65b3a6ac146c492fb9"><div class="ttname"><a href="rte__ring__core_8h.html#a421a61b2f94cdf65b3a6ac146c492fb9">RING_F_SC_DEQ</a></div><div class="ttdeci">#define RING_F_SC_DEQ</div><div class="ttdef"><b>Definition:</b> <a href="rte__ring__core_8h_source.html#l00162">rte_ring_core.h:162</a></div></div>
<div class="ttc" id="astructrte__table__acl__rule__delete__params_html"><div class="ttname"><a href="structrte__table__acl__rule__delete__params.html">rte_table_acl_rule_delete_params</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__table__acl_8h_source.html#l00054">rte_table_acl.h:54</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_aa6c355b2ffff26b22405df408539790f"><div class="ttname"><a href="rte__table__action_8h.html#aa6c355b2ffff26b22405df408539790f">rte_table_action_dscp_table_update</a></div><div class="ttdeci">__rte_experimental int rte_table_action_dscp_table_update(struct rte_table_action *action, uint64_t dscp_mask, struct rte_table_action_dscp_table *table)</div></div>
<div class="ttc" id="astructrte__table__lpm__ipv6__key_html"><div class="ttname"><a href="structrte__table__lpm__ipv6__key.html">rte_table_lpm_ipv6_key</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__table__lpm__ipv6_8h_source.html#l00075">rte_table_lpm_ipv6.h:75</a></div></div>
<div class="ttc" id="arte__ring_8h_html_afd7f172fbce0358e0b140fb9bd82aa7a"><div class="ttname"><a href="rte__ring_8h.html#afd7f172fbce0358e0b140fb9bd82aa7a">rte_ring_sp_enqueue</a></div><div class="ttdeci">static __rte_always_inline int rte_ring_sp_enqueue(struct rte_ring *r, void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ring_8h_source.html#l00302">rte_ring.h:302</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2a962e3a5154b7a1a3e8648bd129c4b561"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a962e3a5154b7a1a3e8648bd129c4b561">RTE_TABLE_ACTION_SYM_CRYPTO</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_SYM_CRYPTO</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00098">rte_table_action.h:98</a></div></div>
<div class="ttc" id="arte__table__lpm_8h_html"><div class="ttname"><a href="rte__table__lpm_8h.html">rte_table_lpm.h</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2a64248fbadf2339ff36eee3c6c7c54ce6"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a64248fbadf2339ff36eee3c6c7c54ce6">RTE_TABLE_ACTION_TTL</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_TTL</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00089">rte_table_action.h:89</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1">RTE_TABLE_ACTION_ENCAP</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_ENCAP</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00083">rte_table_action.h:83</a></div></div>
<div class="ttc" id="astructrte__pipeline__table__entry_html_ab65480a4c6171d9ea813e0b1be3afef2"><div class="ttname"><a href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">rte_pipeline_table_entry::action</a></div><div class="ttdeci">enum rte_pipeline_action action</div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00123">rte_pipeline.h:217</a></div></div>
<div class="ttc" id="astructrte__table__array__key_html"><div class="ttname"><a href="structrte__table__array__key.html">rte_table_array_key</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__table__array_8h_source.html#l00035">rte_table_array.h:35</a></div></div>
<div class="ttc" id="astructrte__table__action__meter__profile_html"><div class="ttname"><a href="structrte__table__action__meter__profile.html">rte_table_action_meter_profile</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00224">rte_table_action.h:224</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2aa5194910932359cba3eeca7183922dbf"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aa5194910932359cba3eeca7183922dbf">RTE_TABLE_ACTION_FWD</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_FWD</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00071">rte_table_action.h:71</a></div></div>
<div class="ttc" id="astructrte__table__action__mtr__counters_html_afb347cc5ec7a582aaf2067d1bcc979af"><div class="ttname"><a href="structrte__table__action__mtr__counters.html#afb347cc5ec7a582aaf2067d1bcc979af">rte_table_action_mtr_counters::stats</a></div><div class="ttdeci">struct rte_table_action_mtr_counters_tc stats[RTE_TABLE_ACTION_TC_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00323">rte_table_action.h:329</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_a5e8b781110a05d3a7ef91d9ef8cf84a0"><div class="ttname"><a href="rte__table__action_8h.html#a5e8b781110a05d3a7ef91d9ef8cf84a0">rte_table_action_meter_profile_add</a></div><div class="ttdeci">__rte_experimental int rte_table_action_meter_profile_add(struct rte_table_action *action, uint32_t meter_profile_id, struct rte_table_action_meter_profile *profile)</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
