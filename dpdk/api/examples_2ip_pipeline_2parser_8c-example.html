<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DPDK: examples/ip_pipeline/parser.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DPDK
   &#160;<span id="projectnumber">20.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">examples/ip_pipeline/parser.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/* SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment"> * Copyright(c) 2016 Intel Corporation.</span></div>
<div class="line"><span class="comment"> * Copyright (c) 2009, Olivier MATZ &lt;zer0@droids-corp.org&gt;</span></div>
<div class="line"><span class="comment"> * All rights reserved.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ctype.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;getopt.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;errno.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdarg.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;libgen.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/wait.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;arpa/inet.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/socket.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__errno_8h.html">rte_errno.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__string__fns_8h.html">rte_string_fns.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;parser.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">get_hex_val(<span class="keywordtype">char</span> c)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">switch</span> (c) {</div>
<div class="line">    <span class="keywordflow">case</span> <span class="charliteral">&#39;0&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;1&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;2&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;3&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;4&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;5&#39;</span>:</div>
<div class="line">    <span class="keywordflow">case</span> <span class="charliteral">&#39;6&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;7&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;8&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;9&#39;</span>:</div>
<div class="line">        <span class="keywordflow">return</span> c - <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;D&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;E&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;F&#39;</span>:</div>
<div class="line">        <span class="keywordflow">return</span> c - <span class="charliteral">&#39;A&#39;</span> + 10;</div>
<div class="line">    <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;b&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;e&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>:</div>
<div class="line">        <span class="keywordflow">return</span> c - <span class="charliteral">&#39;a&#39;</span> + 10;</div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">parser_read_arg_bool(<span class="keyword">const</span> <span class="keywordtype">char</span> *p)</div>
<div class="line">{</div>
<div class="line">    p = skip_white_spaces(p);</div>
<div class="line">    <span class="keywordtype">int</span> result = -EINVAL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (((p[0] == <span class="charliteral">&#39;y&#39;</span>) &amp;&amp; (p[1] == <span class="charliteral">&#39;e&#39;</span>) &amp;&amp; (p[2] == <span class="charliteral">&#39;s&#39;</span>)) ||</div>
<div class="line">        ((p[0] == <span class="charliteral">&#39;Y&#39;</span>) &amp;&amp; (p[1] == <span class="charliteral">&#39;E&#39;</span>) &amp;&amp; (p[2] == <span class="charliteral">&#39;S&#39;</span>))) {</div>
<div class="line">        p += 3;</div>
<div class="line">        result = 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (((p[0] == <span class="charliteral">&#39;o&#39;</span>) &amp;&amp; (p[1] == <span class="charliteral">&#39;n&#39;</span>)) ||</div>
<div class="line">        ((p[0] == <span class="charliteral">&#39;O&#39;</span>) &amp;&amp; (p[1] == <span class="charliteral">&#39;N&#39;</span>))) {</div>
<div class="line">        p += 2;</div>
<div class="line">        result = 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (((p[0] == <span class="charliteral">&#39;n&#39;</span>) &amp;&amp; (p[1] == <span class="charliteral">&#39;o&#39;</span>)) ||</div>
<div class="line">        ((p[0] == <span class="charliteral">&#39;N&#39;</span>) &amp;&amp; (p[1] == <span class="charliteral">&#39;O&#39;</span>))) {</div>
<div class="line">        p += 2;</div>
<div class="line">        result = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (((p[0] == <span class="charliteral">&#39;o&#39;</span>) &amp;&amp; (p[1] == <span class="charliteral">&#39;f&#39;</span>) &amp;&amp; (p[2] == <span class="charliteral">&#39;f&#39;</span>)) ||</div>
<div class="line">        ((p[0] == <span class="charliteral">&#39;O&#39;</span>) &amp;&amp; (p[1] == <span class="charliteral">&#39;F&#39;</span>) &amp;&amp; (p[2] == <span class="charliteral">&#39;F&#39;</span>))) {</div>
<div class="line">        p += 3;</div>
<div class="line">        result = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    p = skip_white_spaces(p);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (p[0] != <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">parser_read_uint64(uint64_t *value, <span class="keyword">const</span> <span class="keywordtype">char</span> *p)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *next;</div>
<div class="line">    uint64_t val;</div>
<div class="line"> </div>
<div class="line">    p = skip_white_spaces(p);</div>
<div class="line">    <span class="keywordflow">if</span> (!isdigit(*p))</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">    val = strtoul(p, &amp;next, 10);</div>
<div class="line">    <span class="keywordflow">if</span> (p == next)</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">    p = next;</div>
<div class="line">    <span class="keywordflow">switch</span> (*p) {</div>
<div class="line">    <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:</div>
<div class="line">        val *= 1024ULL;</div>
<div class="line">        <span class="comment">/* fall through */</span></div>
<div class="line">    <span class="keywordflow">case</span> <span class="charliteral">&#39;G&#39;</span>:</div>
<div class="line">        val *= 1024ULL;</div>
<div class="line">        <span class="comment">/* fall through */</span></div>
<div class="line">    <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>:</div>
<div class="line">        val *= 1024ULL;</div>
<div class="line">        <span class="comment">/* fall through */</span></div>
<div class="line">    <span class="keywordflow">case</span> <span class="charliteral">&#39;k&#39;</span>:</div>
<div class="line">    <span class="keywordflow">case</span> <span class="charliteral">&#39;K&#39;</span>:</div>
<div class="line">        val *= 1024ULL;</div>
<div class="line">        p++;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    p = skip_white_spaces(p);</div>
<div class="line">    <span class="keywordflow">if</span> (*p != <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">    *value = val;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">parser_read_uint64_hex(uint64_t *value, <span class="keyword">const</span> <span class="keywordtype">char</span> *p)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *next;</div>
<div class="line">    uint64_t val;</div>
<div class="line"> </div>
<div class="line">    p = skip_white_spaces(p);</div>
<div class="line"> </div>
<div class="line">    val = strtoul(p, &amp;next, 16);</div>
<div class="line">    <span class="keywordflow">if</span> (p == next)</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">    p = skip_white_spaces(next);</div>
<div class="line">    <span class="keywordflow">if</span> (*p != <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">    *value = val;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">parser_read_uint32(uint32_t *value, <span class="keyword">const</span> <span class="keywordtype">char</span> *p)</div>
<div class="line">{</div>
<div class="line">    uint64_t val = 0;</div>
<div class="line">    <span class="keywordtype">int</span> ret = parser_read_uint64(&amp;val, p);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (val &gt; UINT32_MAX)</div>
<div class="line">        <span class="keywordflow">return</span> -ERANGE;</div>
<div class="line"> </div>
<div class="line">    *value = val;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">parser_read_uint32_hex(uint32_t *value, <span class="keyword">const</span> <span class="keywordtype">char</span> *p)</div>
<div class="line">{</div>
<div class="line">    uint64_t val = 0;</div>
<div class="line">    <span class="keywordtype">int</span> ret = parser_read_uint64_hex(&amp;val, p);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (val &gt; UINT32_MAX)</div>
<div class="line">        <span class="keywordflow">return</span> -ERANGE;</div>
<div class="line"> </div>
<div class="line">    *value = val;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">parser_read_uint16(uint16_t *value, <span class="keyword">const</span> <span class="keywordtype">char</span> *p)</div>
<div class="line">{</div>
<div class="line">    uint64_t val = 0;</div>
<div class="line">    <span class="keywordtype">int</span> ret = parser_read_uint64(&amp;val, p);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (val &gt; UINT16_MAX)</div>
<div class="line">        <span class="keywordflow">return</span> -ERANGE;</div>
<div class="line"> </div>
<div class="line">    *value = val;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">parser_read_uint16_hex(uint16_t *value, <span class="keyword">const</span> <span class="keywordtype">char</span> *p)</div>
<div class="line">{</div>
<div class="line">    uint64_t val = 0;</div>
<div class="line">    <span class="keywordtype">int</span> ret = parser_read_uint64_hex(&amp;val, p);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (val &gt; UINT16_MAX)</div>
<div class="line">        <span class="keywordflow">return</span> -ERANGE;</div>
<div class="line"> </div>
<div class="line">    *value = val;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">parser_read_uint8(uint8_t *value, <span class="keyword">const</span> <span class="keywordtype">char</span> *p)</div>
<div class="line">{</div>
<div class="line">    uint64_t val = 0;</div>
<div class="line">    <span class="keywordtype">int</span> ret = parser_read_uint64(&amp;val, p);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (val &gt; UINT8_MAX)</div>
<div class="line">        <span class="keywordflow">return</span> -ERANGE;</div>
<div class="line"> </div>
<div class="line">    *value = val;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">parser_read_uint8_hex(uint8_t *value, <span class="keyword">const</span> <span class="keywordtype">char</span> *p)</div>
<div class="line">{</div>
<div class="line">    uint64_t val = 0;</div>
<div class="line">    <span class="keywordtype">int</span> ret = parser_read_uint64_hex(&amp;val, p);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (val &gt; UINT8_MAX)</div>
<div class="line">        <span class="keywordflow">return</span> -ERANGE;</div>
<div class="line"> </div>
<div class="line">    *value = val;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">parse_tokenize_string(<span class="keywordtype">char</span> *<span class="keywordtype">string</span>, <span class="keywordtype">char</span> *tokens[], uint32_t *n_tokens)</div>
<div class="line">{</div>
<div class="line">    uint32_t i;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((<span class="keywordtype">string</span> == NULL) ||</div>
<div class="line">        (tokens == NULL) ||</div>
<div class="line">        (*n_tokens &lt; 1))</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; *n_tokens; i++) {</div>
<div class="line">        tokens[i] = strtok_r(<span class="keywordtype">string</span>, PARSE_DELIMITER, &amp;<span class="keywordtype">string</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (tokens[i] == NULL)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((i == *n_tokens) &amp;&amp;</div>
<div class="line">        (NULL != strtok_r(<span class="keywordtype">string</span>, PARSE_DELIMITER, &amp;<span class="keywordtype">string</span>)))</div>
<div class="line">        <span class="keywordflow">return</span> -E2BIG;</div>
<div class="line"> </div>
<div class="line">    *n_tokens = i;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">parse_hex_string(<span class="keywordtype">char</span> *src, uint8_t *dst, uint32_t *<a name="a0"></a><a class="code" href="structrte__mempool.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *c;</div>
<div class="line">    uint32_t len, i;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input parameters */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((src == NULL) ||</div>
<div class="line">        (dst == NULL) ||</div>
<div class="line">        (<a class="code" href="structrte__mempool.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a> == NULL) ||</div>
<div class="line">        (*<a class="code" href="structrte__mempool.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a> == 0))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    len = strlen(src);</div>
<div class="line">    <span class="keywordflow">if</span> (((len &amp; 3) != 0) ||</div>
<div class="line">        (len &gt; (*<a class="code" href="structrte__mempool.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a>) * 2))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    *<a class="code" href="structrte__mempool.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a> = len / 2;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (c = src; *c != 0; c++) {</div>
<div class="line">        <span class="keywordflow">if</span> ((((*c) &gt;= <span class="charliteral">&#39;0&#39;</span>) &amp;&amp; ((*c) &lt;= <span class="charliteral">&#39;9&#39;</span>)) ||</div>
<div class="line">            (((*c) &gt;= <span class="charliteral">&#39;A&#39;</span>) &amp;&amp; ((*c) &lt;= <span class="charliteral">&#39;F&#39;</span>)) ||</div>
<div class="line">            (((*c) &gt;= <span class="charliteral">&#39;a&#39;</span>) &amp;&amp; ((*c) &lt;= <span class="charliteral">&#39;f&#39;</span>)))</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Convert chars to bytes */</span></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; *<a class="code" href="structrte__mempool.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a>; i++)</div>
<div class="line">        dst[i] = get_hex_val(src[2 * i]) * 16 +</div>
<div class="line">            get_hex_val(src[2 * i + 1]);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">parse_mpls_labels(<span class="keywordtype">char</span> *<span class="keywordtype">string</span>, uint32_t *labels, uint32_t *n_labels)</div>
<div class="line">{</div>
<div class="line">    uint32_t n_max_labels = *n_labels, count = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check for void list of labels */</span></div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(<span class="keywordtype">string</span>, <span class="stringliteral">&quot;&lt;void&gt;&quot;</span>) == 0) {</div>
<div class="line">        *n_labels = 0;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* At least one label should be present */</span></div>
<div class="line">    <span class="keywordflow">for</span> ( ; (*<span class="keywordtype">string</span> != <span class="charliteral">&#39;\0&#39;</span>); ) {</div>
<div class="line">        <span class="keywordtype">char</span> *next;</div>
<div class="line">        <span class="keywordtype">int</span> value;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (count &gt;= n_max_labels)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (count &gt; 0) {</div>
<div class="line">            <span class="keywordflow">if</span> (<span class="keywordtype">string</span>[0] != <span class="charliteral">&#39;:&#39;</span>)</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">string</span>++;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        value = strtol(<span class="keywordtype">string</span>, &amp;next, 10);</div>
<div class="line">        <span class="keywordflow">if</span> (next == <span class="keywordtype">string</span>)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        <span class="keywordtype">string</span> = next;</div>
<div class="line"> </div>
<div class="line">        labels[count++] = (uint32_t) value;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    *n_labels = count;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a name="_a1"></a><a class="code" href="structrte__ether__addr.html">rte_ether_addr</a> *</div>
<div class="line">my_ether_aton(<span class="keyword">const</span> <span class="keywordtype">char</span> *a)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">char</span> *end;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> o[<a name="a2"></a><a class="code" href="rte__ether_8h.html#a22bf3d2d6b4e7be447b5e805674e0845">RTE_ETHER_ADDR_LEN</a>];</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structrte__ether__addr.html">rte_ether_addr</a> ether_addr;</div>
<div class="line"> </div>
<div class="line">    i = 0;</div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        errno = 0;</div>
<div class="line">        o[i] = strtoul(a, &amp;end, 16);</div>
<div class="line">        <span class="keywordflow">if</span> (errno != 0 || end == a || (end[0] != <span class="charliteral">&#39;:&#39;</span> &amp;&amp; end[0] != 0))</div>
<div class="line">            <span class="keywordflow">return</span> NULL;</div>
<div class="line">        a = end + 1;</div>
<div class="line">    } <span class="keywordflow">while</span> (++i != <a name="a3"></a><a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(o) &amp;&amp; end[0] != 0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Junk at the end of line */</span></div>
<div class="line">    <span class="keywordflow">if</span> (end[0] != 0)</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Support the format XX:XX:XX:XX:XX:XX */</span></div>
<div class="line">    <span class="keywordflow">if</span> (i == <a class="code" href="rte__ether_8h.html#a22bf3d2d6b4e7be447b5e805674e0845">RTE_ETHER_ADDR_LEN</a>) {</div>
<div class="line">        <span class="keywordflow">while</span> (i-- != 0) {</div>
<div class="line">            <span class="keywordflow">if</span> (o[i] &gt; UINT8_MAX)</div>
<div class="line">                <span class="keywordflow">return</span> NULL;</div>
<div class="line">            ether_addr.addr_bytes[i] = (uint8_t)o[i];</div>
<div class="line">        }</div>
<div class="line">    <span class="comment">/* Support the format XXXX:XXXX:XXXX */</span></div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == <a class="code" href="rte__ether_8h.html#a22bf3d2d6b4e7be447b5e805674e0845">RTE_ETHER_ADDR_LEN</a> / 2) {</div>
<div class="line">        <span class="keywordflow">while</span> (i-- != 0) {</div>
<div class="line">            <span class="keywordflow">if</span> (o[i] &gt; UINT16_MAX)</div>
<div class="line">                <span class="keywordflow">return</span> NULL;</div>
<div class="line">            ether_addr.addr_bytes[i * 2] = (uint8_t)(o[i] &gt;&gt; 8);</div>
<div class="line">            ether_addr.addr_bytes[i * 2 + 1] = (uint8_t)(o[i] &amp; 0xff);</div>
<div class="line">        }</div>
<div class="line">    <span class="comment">/* unknown format */</span></div>
<div class="line">    } <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> (<span class="keyword">struct</span> <a class="code" href="structrte__ether__addr.html">rte_ether_addr</a> *)&amp;ether_addr;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">parse_ipv4_addr(<span class="keyword">const</span> <span class="keywordtype">char</span> *token, <span class="keyword">struct</span> in_addr *ipv4)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (strlen(token) &gt;= INET_ADDRSTRLEN)</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (inet_pton(AF_INET, token, ipv4) != 1)</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">parse_ipv6_addr(<span class="keyword">const</span> <span class="keywordtype">char</span> *token, <span class="keyword">struct</span> in6_addr *ipv6)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (strlen(token) &gt;= INET6_ADDRSTRLEN)</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (inet_pton(AF_INET6, token, ipv6) != 1)</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">parse_mac_addr(<span class="keyword">const</span> <span class="keywordtype">char</span> *token, <span class="keyword">struct</span> <a class="code" href="structrte__ether__addr.html">rte_ether_addr</a> *addr)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ether__addr.html">rte_ether_addr</a> *tmp;</div>
<div class="line"> </div>
<div class="line">    tmp = my_ether_aton(token);</div>
<div class="line">    <span class="keywordflow">if</span> (tmp == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    memcpy(addr, tmp, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrte__ether__addr.html">rte_ether_addr</a>));</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">parse_cpu_core(<span class="keyword">const</span> <span class="keywordtype">char</span> *entry,</div>
<div class="line">    <span class="keyword">struct</span> cpu_core_params *p)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">size_t</span> num_len;</div>
<div class="line">    <span class="keywordtype">char</span> num[8];</div>
<div class="line"> </div>
<div class="line">    uint32_t s = 0, c = 0, h = 0, val;</div>
<div class="line">    uint8_t s_parsed = 0, c_parsed = 0, h_parsed = 0;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *next = skip_white_spaces(entry);</div>
<div class="line">    <span class="keywordtype">char</span> type;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (p == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Expect &lt;CORE&gt; or [sX][cY][h]. At least one parameter is required. */</span></div>
<div class="line">    <span class="keywordflow">while</span> (*next != <span class="charliteral">&#39;\0&#39;</span>) {</div>
<div class="line">        <span class="comment">/* If everything parsed nothing should left */</span></div>
<div class="line">        <span class="keywordflow">if</span> (s_parsed &amp;&amp; c_parsed &amp;&amp; h_parsed)</div>
<div class="line">            <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">        type = *next;</div>
<div class="line">        <span class="keywordflow">switch</span> (type) {</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>:</div>
<div class="line">            <span class="keywordflow">if</span> (s_parsed || c_parsed || h_parsed)</div>
<div class="line">                <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">            s_parsed = 1;</div>
<div class="line">            next++;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:</div>
<div class="line">            <span class="keywordflow">if</span> (c_parsed || h_parsed)</div>
<div class="line">                <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">            c_parsed = 1;</div>
<div class="line">            next++;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span>:</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;H&#39;</span>:</div>
<div class="line">            <span class="keywordflow">if</span> (h_parsed)</div>
<div class="line">                <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">            h_parsed = 1;</div>
<div class="line">            next++;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <span class="comment">/* If it start from digit it must be only core id. */</span></div>
<div class="line">            <span class="keywordflow">if</span> (!isdigit(*next) || s_parsed || c_parsed || h_parsed)</div>
<div class="line">                <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">            type = <span class="charliteral">&#39;C&#39;</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (num_len = 0; *next != <span class="charliteral">&#39;\0&#39;</span>; next++, num_len++) {</div>
<div class="line">            <span class="keywordflow">if</span> (num_len == <a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(num))</div>
<div class="line">                <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (!isdigit(*next))</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">            num[num_len] = *next;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (num_len == 0 &amp;&amp; type != <span class="charliteral">&#39;h&#39;</span> &amp;&amp; type != <span class="charliteral">&#39;H&#39;</span>)</div>
<div class="line">            <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (num_len != 0 &amp;&amp; (type == <span class="charliteral">&#39;h&#39;</span> || type == <span class="charliteral">&#39;H&#39;</span>))</div>
<div class="line">            <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">        num[num_len] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line">        val = strtol(num, NULL, 10);</div>
<div class="line"> </div>
<div class="line">        h = 0;</div>
<div class="line">        <span class="keywordflow">switch</span> (type) {</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>:</div>
<div class="line">            s = val;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:</div>
<div class="line">            c = val;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span>:</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;H&#39;</span>:</div>
<div class="line">            h = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    p-&gt;socket_id = s;</div>
<div class="line">    p-&gt;core_id = c;</div>
<div class="line">    p-&gt;thread_id = h;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="arte__string__fns_8h_html"><div class="ttname"><a href="rte__string__fns_8h.html">rte_string_fns.h</a></div></div>
<div class="ttc" id="arte__errno_8h_html"><div class="ttname"><a href="rte__errno_8h.html">rte_errno.h</a></div></div>
<div class="ttc" id="astructrte__mempool_html_ab2c6b258f02add8fdf4cfc7c371dd772"><div class="ttname"><a href="structrte__mempool.html#ab2c6b258f02add8fdf4cfc7c371dd772">rte_mempool::size</a></div><div class="ttdeci">uint32_t size</div><div class="ttdef"><b>Definition:</b> <a href="rte__mempool_8h_source.html#l00223">rte_mempool.h:223</a></div></div>
<div class="ttc" id="arte__common_8h_html_ac963da91b35efa4700b73a1f4eb1d8a6"><div class="ttname"><a href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a></div><div class="ttdeci">#define RTE_DIM(a)</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00809">rte_common.h:809</a></div></div>
<div class="ttc" id="arte__ether_8h_html_a22bf3d2d6b4e7be447b5e805674e0845"><div class="ttname"><a href="rte__ether_8h.html#a22bf3d2d6b4e7be447b5e805674e0845">RTE_ETHER_ADDR_LEN</a></div><div class="ttdeci">#define RTE_ETHER_ADDR_LEN</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00030">rte_ether.h:30</a></div></div>
<div class="ttc" id="astructrte__ether__addr_html"><div class="ttname"><a href="structrte__ether__addr.html">rte_ether_addr</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00064">rte_ether.h:64</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
