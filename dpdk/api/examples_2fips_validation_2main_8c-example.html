<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DPDK: examples/fips_validation/main.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DPDK
   &#160;<span id="projectnumber">20.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">examples/fips_validation/main.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/* SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment"> * Copyright(c) 2018 Intel Corporation</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;getopt.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;dirent.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__cryptodev_8h.html">rte_cryptodev.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__cryptodev__pmd_8h.html">rte_cryptodev_pmd.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__mempool_8h.html">rte_mempool.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__mbuf_8h.html">rte_mbuf.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__string__fns_8h.html">rte_string_fns.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;fips_validation.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;fips_dev_self_test.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define REQ_FILE_PATH_KEYWORD   &quot;req-file&quot;</span></div>
<div class="line"><span class="preprocessor">#define RSP_FILE_PATH_KEYWORD   &quot;rsp-file&quot;</span></div>
<div class="line"><span class="preprocessor">#define MBUF_DATAROOM_KEYWORD   &quot;mbuf-dataroom&quot;</span></div>
<div class="line"><span class="preprocessor">#define FOLDER_KEYWORD      &quot;path-is-folder&quot;</span></div>
<div class="line"><span class="preprocessor">#define CRYPTODEV_KEYWORD   &quot;cryptodev&quot;</span></div>
<div class="line"><span class="preprocessor">#define CRYPTODEV_ID_KEYWORD    &quot;cryptodev-id&quot;</span></div>
<div class="line"><span class="preprocessor">#define CRYPTODEV_ST_KEYWORD    &quot;self-test&quot;</span></div>
<div class="line"><span class="preprocessor">#define CRYPTODEV_BK_ID_KEYWORD &quot;broken-test-id&quot;</span></div>
<div class="line"><span class="preprocessor">#define CRYPTODEV_BK_DIR_KEY    &quot;broken-test-dir&quot;</span></div>
<div class="line"><span class="preprocessor">#define CRYPTODEV_ENC_KEYWORD   &quot;enc&quot;</span></div>
<div class="line"><span class="preprocessor">#define CRYPTODEV_DEC_KEYWORD   &quot;dec&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>fips_test_vector vec;</div>
<div class="line"><span class="keyword">struct </span>fips_test_interim_info info;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>cryptodev_fips_validate_env {</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *req_path;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *rsp_path;</div>
<div class="line">    uint32_t is_path_folder;</div>
<div class="line">    uint8_t dev_id;</div>
<div class="line">    uint8_t dev_support_sgl;</div>
<div class="line">    uint16_t mbuf_data_room;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a0"></a><a class="code" href="structrte__mempool.html">rte_mempool</a> *mpool;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mempool.html">rte_mempool</a> *sess_mpool;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mempool.html">rte_mempool</a> *sess_priv_mpool;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mempool.html">rte_mempool</a> *op_pool;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a1"></a><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *mbuf;</div>
<div class="line">    uint8_t *digest;</div>
<div class="line">    uint16_t digest_len;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a2"></a><a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> *op;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a3"></a><a class="code" href="structrte__cryptodev__sym__session.html">rte_cryptodev_sym_session</a> *sess;</div>
<div class="line">    uint16_t self_test;</div>
<div class="line">    <span class="keyword">struct </span>fips_dev_broken_test_config *broken_test_config;</div>
<div class="line">} env;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">cryptodev_fips_validate_app_int(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a4"></a><a class="code" href="structrte__cryptodev__config.html">rte_cryptodev_config</a> conf = {<a name="a5"></a><a class="code" href="rte__lcore_8h.html#a7c8da4664df26a64cf05dc508a4f26df">rte_socket_id</a>(), 1, 0};</div>
<div class="line">    <span class="keyword">struct </span><a name="_a6"></a><a class="code" href="structrte__cryptodev__qp__conf.html">rte_cryptodev_qp_conf</a> qp_conf = {128, NULL, NULL};</div>
<div class="line">    <span class="keyword">struct </span><a name="_a7"></a><a class="code" href="structrte__cryptodev__info.html">rte_cryptodev_info</a> dev_info;</div>
<div class="line">    uint32_t sess_sz = <a name="a8"></a><a class="code" href="rte__cryptodev_8h.html#a34a54ae38920d21d95aa6049640e8c0e">rte_cryptodev_sym_get_private_session_size</a>(</div>
<div class="line">            env.dev_id);</div>
<div class="line">    uint32_t nb_mbufs = UINT16_MAX / env.mbuf_data_room + 1;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (env.self_test) {</div>
<div class="line">        ret = fips_dev_self_test(env.dev_id, env.broken_test_config);</div>
<div class="line">        <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">            <span class="keyword">struct </span><a name="_a9"></a><a class="code" href="structrte__cryptodev.html">rte_cryptodev</a> *cryptodev =</div>
<div class="line">                    <a name="a10"></a><a class="code" href="rte__cryptodev__pmd_8h.html#aa040dd660348ff2ec55ea08194e1fec9">rte_cryptodev_pmd_get_dev</a>(env.dev_id);</div>
<div class="line"> </div>
<div class="line">            rte_cryptodev_pmd_destroy(cryptodev);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> ret;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a11"></a><a class="code" href="rte__cryptodev_8h.html#a58207367533ac9e65e4a611ba78090e5">rte_cryptodev_configure</a>(env.dev_id, &amp;conf);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">    <a name="a12"></a><a class="code" href="rte__cryptodev_8h.html#aeb677c03cea6fcc48a8caa533e3729f9">rte_cryptodev_info_get</a>(env.dev_id, &amp;dev_info);</div>
<div class="line">    <span class="keywordflow">if</span> (dev_info.feature_flags &amp; <a name="a13"></a><a class="code" href="rte__cryptodev_8h.html#a4c4acd655062a7195c722948d93c22c4">RTE_CRYPTODEV_FF_IN_PLACE_SGL</a>)</div>
<div class="line">        env.dev_support_sgl = 1;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        env.dev_support_sgl = 0;</div>
<div class="line"> </div>
<div class="line">    env.mpool = <a name="a14"></a><a class="code" href="rte__mbuf_8h.html#a593921f13307803b94bbb4e0932db962">rte_pktmbuf_pool_create</a>(<span class="stringliteral">&quot;FIPS_MEMPOOL&quot;</span>, nb_mbufs,</div>
<div class="line">            0, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a>) + RTE_PKTMBUF_HEADROOM +</div>
<div class="line">            env.mbuf_data_room, <a class="code" href="rte__lcore_8h.html#a7c8da4664df26a64cf05dc508a4f26df">rte_socket_id</a>());</div>
<div class="line">    <span class="keywordflow">if</span> (!env.mpool)</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a15"></a><a class="code" href="rte__cryptodev_8h.html#ae4388e0326c8789ddf39e32044dc4187">rte_cryptodev_queue_pair_setup</a>(env.dev_id, 0, &amp;qp_conf,</div>
<div class="line">            <a class="code" href="rte__lcore_8h.html#a7c8da4664df26a64cf05dc508a4f26df">rte_socket_id</a>());</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">    ret = -ENOMEM;</div>
<div class="line"> </div>
<div class="line">    env.sess_mpool = <a name="a16"></a><a class="code" href="rte__cryptodev_8h.html#ac86bc0178d39db9734c594c35f9aee4e">rte_cryptodev_sym_session_pool_create</a>(</div>
<div class="line">            <span class="stringliteral">&quot;FIPS_SESS_MEMPOOL&quot;</span>, 16, 0, 0, 0, <a class="code" href="rte__lcore_8h.html#a7c8da4664df26a64cf05dc508a4f26df">rte_socket_id</a>());</div>
<div class="line">    <span class="keywordflow">if</span> (!env.sess_mpool)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    env.sess_priv_mpool = <a name="a17"></a><a class="code" href="rte__mempool_8h.html#a503f2f889043a48ca9995878846db2fd">rte_mempool_create</a>(<span class="stringliteral">&quot;FIPS_SESS_PRIV_MEMPOOL&quot;</span>,</div>
<div class="line">            16, sess_sz, 0, 0, NULL, NULL, NULL,</div>
<div class="line">            NULL, <a class="code" href="rte__lcore_8h.html#a7c8da4664df26a64cf05dc508a4f26df">rte_socket_id</a>(), 0);</div>
<div class="line">    <span class="keywordflow">if</span> (!env.sess_priv_mpool)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    env.op_pool = <a name="a18"></a><a class="code" href="rte__crypto_8h.html#aa3035c7b271a4736dc9654b2eb85d1fd">rte_crypto_op_pool_create</a>(</div>
<div class="line">            <span class="stringliteral">&quot;FIPS_OP_POOL&quot;</span>,</div>
<div class="line">            <a name="a19"></a><a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc">RTE_CRYPTO_OP_TYPE_SYMMETRIC</a>,</div>
<div class="line">            1, 0,</div>
<div class="line">            16,</div>
<div class="line">            <a class="code" href="rte__lcore_8h.html#a7c8da4664df26a64cf05dc508a4f26df">rte_socket_id</a>());</div>
<div class="line">    <span class="keywordflow">if</span> (!env.op_pool)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    env.op = <a name="a20"></a><a class="code" href="rte__crypto_8h.html#a9c2eeaf1fa1cc3e1f4508eeee1b8c4d7">rte_crypto_op_alloc</a>(env.op_pool, <a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc">RTE_CRYPTO_OP_TYPE_SYMMETRIC</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (!env.op)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    qp_conf.<a name="a21"></a><a class="code" href="structrte__cryptodev__qp__conf.html#a661ccdf79af65025fe9bde05b60ef9ca">mp_session</a> = env.sess_mpool;</div>
<div class="line">    qp_conf.<a name="a22"></a><a class="code" href="structrte__cryptodev__qp__conf.html#a39d13b64c531ebb44df1fab456d7a261">mp_session_private</a> = env.sess_priv_mpool;</div>
<div class="line"> </div>
<div class="line">    ret = <a class="code" href="rte__cryptodev_8h.html#ae4388e0326c8789ddf39e32044dc4187">rte_cryptodev_queue_pair_setup</a>(env.dev_id, 0, &amp;qp_conf,</div>
<div class="line">            <a class="code" href="rte__lcore_8h.html#a7c8da4664df26a64cf05dc508a4f26df">rte_socket_id</a>());</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">error_exit:</div>
<div class="line"> </div>
<div class="line">    <a name="a23"></a><a class="code" href="rte__mempool_8h.html#a35271bce2d546e116074803fd69376e9">rte_mempool_free</a>(env.mpool);</div>
<div class="line">    <span class="keywordflow">if</span> (env.sess_mpool)</div>
<div class="line">        <a class="code" href="rte__mempool_8h.html#a35271bce2d546e116074803fd69376e9">rte_mempool_free</a>(env.sess_mpool);</div>
<div class="line">    <span class="keywordflow">if</span> (env.sess_priv_mpool)</div>
<div class="line">        <a class="code" href="rte__mempool_8h.html#a35271bce2d546e116074803fd69376e9">rte_mempool_free</a>(env.sess_priv_mpool);</div>
<div class="line">    <span class="keywordflow">if</span> (env.op_pool)</div>
<div class="line">        <a class="code" href="rte__mempool_8h.html#a35271bce2d546e116074803fd69376e9">rte_mempool_free</a>(env.op_pool);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cryptodev_fips_validate_app_uninit(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <a name="a24"></a><a class="code" href="rte__mbuf_8h.html#a1215458932900b7cd5192326fa4a6902">rte_pktmbuf_free</a>(env.mbuf);</div>
<div class="line">    <a name="a25"></a><a class="code" href="rte__crypto_8h.html#aca76406e3f1ab04ab44dfbe4ff26f4ba">rte_crypto_op_free</a>(env.op);</div>
<div class="line">    <a name="a26"></a><a class="code" href="rte__cryptodev_8h.html#aa729e554cbafb168eff86f99f9ea518a">rte_cryptodev_sym_session_clear</a>(env.dev_id, env.sess);</div>
<div class="line">    <a name="a27"></a><a class="code" href="rte__cryptodev_8h.html#af91b263a2a66ca15680cb4367c7b8f0e">rte_cryptodev_sym_session_free</a>(env.sess);</div>
<div class="line">    <a class="code" href="rte__mempool_8h.html#a35271bce2d546e116074803fd69376e9">rte_mempool_free</a>(env.mpool);</div>
<div class="line">    <a class="code" href="rte__mempool_8h.html#a35271bce2d546e116074803fd69376e9">rte_mempool_free</a>(env.sess_mpool);</div>
<div class="line">    <a class="code" href="rte__mempool_8h.html#a35271bce2d546e116074803fd69376e9">rte_mempool_free</a>(env.sess_priv_mpool);</div>
<div class="line">    <a class="code" href="rte__mempool_8h.html#a35271bce2d546e116074803fd69376e9">rte_mempool_free</a>(env.op_pool);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">fips_test_one_file(<span class="keywordtype">void</span>);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_cryptodev_arg(<span class="keywordtype">char</span> *arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a name="a28"></a><a class="code" href="rte__cryptodev_8h.html#aa2fc5b92f8ba59be669061e31d783fb2">rte_cryptodev_get_dev_id</a>(arg);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<span class="keywordtype">id</span> &lt; 0) {</div>
<div class="line">        <a name="a29"></a><a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: invalid cryptodev name %s\n&quot;</span>,</div>
<div class="line">                <span class="keywordtype">id</span>, arg);</div>
<div class="line">        <span class="keywordflow">return</span> id;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    env.dev_id = (uint8_t)<span class="keywordtype">id</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_cryptodev_id_arg(<span class="keywordtype">char</span> *arg)</div>
<div class="line">{</div>
<div class="line">    uint32_t cryptodev_id;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;cryptodev_id, arg) &lt; 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: invalid cryptodev id %s\n&quot;</span>,</div>
<div class="line">                -EINVAL, arg);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!<a name="a30"></a><a class="code" href="rte__cryptodev__pmd_8h.html#abf0b16359e5f1d85737ff72ee6440990">rte_cryptodev_pmd_is_valid_dev</a>(cryptodev_id)) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: invalid cryptodev id %s\n&quot;</span>,</div>
<div class="line">                cryptodev_id, arg);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    env.dev_id = (uint8_t)cryptodev_id;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cryptodev_fips_validate_usage(<span class="keyword">const</span> <span class="keywordtype">char</span> *prgname)</div>
<div class="line">{</div>
<div class="line">    uint32_t def_mbuf_seg_size = DEF_MBUF_SEG_SIZE;</div>
<div class="line">    printf(<span class="stringliteral">&quot;%s [EAL options] --\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --%s: REQUEST-FILE-PATH\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --%s: RESPONSE-FILE-PATH\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --%s: indicating both paths are folders\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --%s: mbuf dataroom size (default %u bytes)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --%s: CRYPTODEV-NAME\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --%s: CRYPTODEV-ID-NAME\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --%s: self test indicator\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --%s: self broken test ID\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --%s: self broken test direction\n&quot;</span>,</div>
<div class="line">        prgname, REQ_FILE_PATH_KEYWORD, RSP_FILE_PATH_KEYWORD,</div>
<div class="line">        FOLDER_KEYWORD, MBUF_DATAROOM_KEYWORD, def_mbuf_seg_size,</div>
<div class="line">        CRYPTODEV_KEYWORD, CRYPTODEV_ID_KEYWORD, CRYPTODEV_ST_KEYWORD,</div>
<div class="line">        CRYPTODEV_BK_ID_KEYWORD, CRYPTODEV_BK_DIR_KEY);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">cryptodev_fips_validate_parse_args(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> opt, ret;</div>
<div class="line">    <span class="keywordtype">char</span> *prgname = argv[0];</div>
<div class="line">    <span class="keywordtype">char</span> **argvopt;</div>
<div class="line">    <span class="keywordtype">int</span> option_index;</div>
<div class="line">    <span class="keyword">struct </span>option lgopts[] = {</div>
<div class="line">            {REQ_FILE_PATH_KEYWORD, required_argument, 0, 0},</div>
<div class="line">            {RSP_FILE_PATH_KEYWORD, required_argument, 0, 0},</div>
<div class="line">            {FOLDER_KEYWORD, no_argument, 0, 0},</div>
<div class="line">            {MBUF_DATAROOM_KEYWORD, required_argument, 0, 0},</div>
<div class="line">            {CRYPTODEV_KEYWORD, required_argument, 0, 0},</div>
<div class="line">            {CRYPTODEV_ID_KEYWORD, required_argument, 0, 0},</div>
<div class="line">            {CRYPTODEV_ST_KEYWORD, no_argument, 0, 0},</div>
<div class="line">            {CRYPTODEV_BK_ID_KEYWORD, required_argument, 0, 0},</div>
<div class="line">            {CRYPTODEV_BK_DIR_KEY, required_argument, 0, 0},</div>
<div class="line">            {NULL, 0, 0, 0}</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    argvopt = argv;</div>
<div class="line"> </div>
<div class="line">    env.mbuf_data_room = DEF_MBUF_SEG_SIZE;</div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a31"></a><a class="code" href="rte__cryptodev_8h.html#a1a0c23adc25339b56bd19242194a002f">rte_cryptodev_count</a>())</div>
<div class="line">        env.dev_id = 0;</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">        cryptodev_fips_validate_usage(prgname);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> ((opt = getopt_long(argc, argvopt, <span class="stringliteral">&quot;s:&quot;</span>,</div>
<div class="line">                  lgopts, &amp;option_index)) != EOF) {</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">switch</span> (opt) {</div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">            <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name,</div>
<div class="line">                    REQ_FILE_PATH_KEYWORD) == 0)</div>
<div class="line">                env.req_path = optarg;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name,</div>
<div class="line">                    RSP_FILE_PATH_KEYWORD) == 0)</div>
<div class="line">                env.rsp_path = optarg;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name,</div>
<div class="line">                    FOLDER_KEYWORD) == 0)</div>
<div class="line">                env.is_path_folder = 1;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name,</div>
<div class="line">                    CRYPTODEV_KEYWORD) == 0) {</div>
<div class="line">                ret = parse_cryptodev_arg(optarg);</div>
<div class="line">                <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">                    cryptodev_fips_validate_usage(prgname);</div>
<div class="line">                    <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">                }</div>
<div class="line">            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name,</div>
<div class="line">                    CRYPTODEV_ID_KEYWORD) == 0) {</div>
<div class="line">                ret = parse_cryptodev_id_arg(optarg);</div>
<div class="line">                <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">                    cryptodev_fips_validate_usage(prgname);</div>
<div class="line">                    <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">                }</div>
<div class="line">            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name,</div>
<div class="line">                    CRYPTODEV_ST_KEYWORD) == 0) {</div>
<div class="line">                env.self_test = 1;</div>
<div class="line">            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name,</div>
<div class="line">                    CRYPTODEV_BK_ID_KEYWORD) == 0) {</div>
<div class="line">                <span class="keywordflow">if</span> (!env.broken_test_config) {</div>
<div class="line">                    env.broken_test_config = <a name="a32"></a><a class="code" href="rte__malloc_8h.html#a247c99e8d36300c52729c9ee58c2b489">rte_malloc</a>(</div>
<div class="line">                        NULL,</div>
<div class="line">                        <span class="keyword">sizeof</span>(*env.broken_test_config),</div>
<div class="line">                        0);</div>
<div class="line">                    <span class="keywordflow">if</span> (!env.broken_test_config)</div>
<div class="line">                        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"> </div>
<div class="line">                    env.broken_test_config-&gt;expect_fail_dir =</div>
<div class="line">                        self_test_dir_enc_auth_gen;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (parser_read_uint32(</div>
<div class="line">                    &amp;env.broken_test_config-&gt;expect_fail_test_idx,</div>
<div class="line">                        optarg) &lt; 0) {</div>
<div class="line">                    <a name="a33"></a><a class="code" href="rte__malloc_8h.html#a1fc82f67711b13aca7e05dc9d58f9dbd">rte_free</a>(env.broken_test_config);</div>
<div class="line">                    cryptodev_fips_validate_usage(prgname);</div>
<div class="line">                    <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">                }</div>
<div class="line">            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name,</div>
<div class="line">                    CRYPTODEV_BK_DIR_KEY) == 0) {</div>
<div class="line">                <span class="keywordflow">if</span> (!env.broken_test_config) {</div>
<div class="line">                    env.broken_test_config = <a class="code" href="rte__malloc_8h.html#a247c99e8d36300c52729c9ee58c2b489">rte_malloc</a>(</div>
<div class="line">                        NULL,</div>
<div class="line">                        <span class="keyword">sizeof</span>(*env.broken_test_config),</div>
<div class="line">                        0);</div>
<div class="line">                    <span class="keywordflow">if</span> (!env.broken_test_config)</div>
<div class="line">                        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"> </div>
<div class="line">                    env.broken_test_config-&gt;</div>
<div class="line">                        expect_fail_test_idx = 0;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (strcmp(optarg, CRYPTODEV_ENC_KEYWORD) == 0)</div>
<div class="line">                    env.broken_test_config-&gt;expect_fail_dir =</div>
<div class="line">                        self_test_dir_enc_auth_gen;</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(optarg, CRYPTODEV_DEC_KEYWORD)</div>
<div class="line">                        == 0)</div>
<div class="line">                    env.broken_test_config-&gt;expect_fail_dir =</div>
<div class="line">                        self_test_dir_dec_auth_verify;</div>
<div class="line">                <span class="keywordflow">else</span> {</div>
<div class="line">                    <a class="code" href="rte__malloc_8h.html#a1fc82f67711b13aca7e05dc9d58f9dbd">rte_free</a>(env.broken_test_config);</div>
<div class="line">                    cryptodev_fips_validate_usage(prgname);</div>
<div class="line">                    <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">                }</div>
<div class="line">            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name,</div>
<div class="line">                    MBUF_DATAROOM_KEYWORD) == 0) {</div>
<div class="line">                uint32_t data_room_size;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (parser_read_uint32(&amp;data_room_size,</div>
<div class="line">                        optarg) &lt; 0) {</div>
<div class="line">                    cryptodev_fips_validate_usage(prgname);</div>
<div class="line">                    <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (data_room_size == 0 ||</div>
<div class="line">                        data_room_size &gt; UINT16_MAX) {</div>
<div class="line">                    cryptodev_fips_validate_usage(prgname);</div>
<div class="line">                    <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                env.mbuf_data_room = data_room_size;</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                cryptodev_fips_validate_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((env.req_path == NULL &amp;&amp; env.rsp_path != NULL) ||</div>
<div class="line">            (env.req_path != NULL &amp;&amp; env.rsp_path == NULL)) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Missing req path or rsp path\n&quot;</span>);</div>
<div class="line">        cryptodev_fips_validate_usage(prgname);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (env.req_path == NULL &amp;&amp; env.self_test == 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;--self-test must be set if req path is missing\n&quot;</span>);</div>
<div class="line">        cryptodev_fips_validate_usage(prgname);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a34"></a><a class="code" href="rte__eal_8h.html#a5c3f4dddc25e38c5a186ecd8a69260e3">rte_eal_init</a>(argc, argv);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: Failed init\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    argc -= ret;</div>
<div class="line">    argv += ret;</div>
<div class="line"> </div>
<div class="line">    ret = cryptodev_fips_validate_parse_args(argc, argv);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <a name="a35"></a><a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Failed to parse arguments!\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    ret = cryptodev_fips_validate_app_int();</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: Failed init\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (env.req_path == NULL || env.rsp_path == NULL) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;No request, exit.\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">goto</span> exit;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!env.is_path_folder) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Processing file %s... &quot;</span>, env.req_path);</div>
<div class="line"> </div>
<div class="line">        ret = fips_test_init(env.req_path, env.rsp_path,</div>
<div class="line">            <a name="a36"></a><a class="code" href="rte__cryptodev_8h.html#a9aa918a5f6b561c0df3df2cdd65b7298">rte_cryptodev_name_get</a>(env.dev_id));</div>
<div class="line">        <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: Failed test %s\n&quot;</span>,</div>
<div class="line">                    ret, env.req_path);</div>
<div class="line">            <span class="keywordflow">goto</span> exit;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        ret = fips_test_one_file();</div>
<div class="line">        <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: Failed test %s\n&quot;</span>,</div>
<div class="line">                    ret, env.req_path);</div>
<div class="line">            <span class="keywordflow">goto</span> exit;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        printf(<span class="stringliteral">&quot;Done\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keyword">struct </span>dirent *dir;</div>
<div class="line">        DIR *d_req, *d_rsp;</div>
<div class="line">        <span class="keywordtype">char</span> req_path[1024];</div>
<div class="line">        <span class="keywordtype">char</span> rsp_path[1024];</div>
<div class="line"> </div>
<div class="line">        d_req = opendir(env.req_path);</div>
<div class="line">        <span class="keywordflow">if</span> (!d_req) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: Path %s not exist\n&quot;</span>,</div>
<div class="line">                    -EINVAL, env.req_path);</div>
<div class="line">            <span class="keywordflow">goto</span> exit;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        d_rsp = opendir(env.rsp_path);</div>
<div class="line">        <span class="keywordflow">if</span> (!d_rsp) {</div>
<div class="line">            ret = mkdir(env.rsp_path, 0700);</div>
<div class="line">            <span class="keywordflow">if</span> (ret == 0)</div>
<div class="line">                d_rsp = opendir(env.rsp_path);</div>
<div class="line">            <span class="keywordflow">else</span> {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: Invalid %s\n&quot;</span>,</div>
<div class="line">                        -EINVAL, env.rsp_path);</div>
<div class="line">                <span class="keywordflow">goto</span> exit;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        closedir(d_rsp);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">while</span> ((dir = readdir(d_req)) != NULL) {</div>
<div class="line">            <span class="keywordflow">if</span> (strstr(dir-&gt;d_name, <span class="stringliteral">&quot;req&quot;</span>) == NULL)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            snprintf(req_path, 1023, <span class="stringliteral">&quot;%s/%s&quot;</span>, env.req_path,</div>
<div class="line">                    dir-&gt;d_name);</div>
<div class="line">            snprintf(rsp_path, 1023, <span class="stringliteral">&quot;%s/%s&quot;</span>, env.rsp_path,</div>
<div class="line">                    dir-&gt;d_name);</div>
<div class="line">            strlcpy(strstr(rsp_path, <span class="stringliteral">&quot;req&quot;</span>), <span class="stringliteral">&quot;rsp&quot;</span>, 4);</div>
<div class="line"> </div>
<div class="line">            printf(<span class="stringliteral">&quot;Processing file %s... &quot;</span>, req_path);</div>
<div class="line"> </div>
<div class="line">            ret = fips_test_init(req_path, rsp_path,</div>
<div class="line">            <a class="code" href="rte__cryptodev_8h.html#a9aa918a5f6b561c0df3df2cdd65b7298">rte_cryptodev_name_get</a>(env.dev_id));</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: Failed test %s\n&quot;</span>,</div>
<div class="line">                        ret, req_path);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            ret = fips_test_one_file();</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: Failed test %s\n&quot;</span>,</div>
<div class="line">                        ret, req_path);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            printf(<span class="stringliteral">&quot;Done\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        closedir(d_req);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">exit:</div>
<div class="line">    fips_test_clear();</div>
<div class="line">    cryptodev_fips_validate_app_uninit();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define IV_OFF (sizeof(struct rte_crypto_op) + sizeof(struct rte_crypto_sym_op))</span></div>
<div class="line"><span class="preprocessor">#define CRYPTODEV_FIPS_MAX_RETRIES  16</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>fips_test_ops test_ops;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">prepare_data_mbufs(<span class="keyword">struct</span> fips_val *val)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m, *head = 0;</div>
<div class="line">    uint8_t *src = val-&gt;val;</div>
<div class="line">    uint32_t total_len = val-&gt;len;</div>
<div class="line">    uint16_t nb_seg;</div>
<div class="line">    <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (env.mbuf)</div>
<div class="line">        <a class="code" href="rte__mbuf_8h.html#a1215458932900b7cd5192326fa4a6902">rte_pktmbuf_free</a>(env.mbuf);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (total_len &gt; <a name="a37"></a><a class="code" href="rte__mbuf__core_8h.html#a6023553536ea8c463fb703ac2437fa58">RTE_MBUF_MAX_NB_SEGS</a>) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Data len %u too big\n&quot;</span>, total_len);</div>
<div class="line">        <span class="keywordflow">return</span> -EPERM;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    nb_seg = total_len / env.mbuf_data_room;</div>
<div class="line">    <span class="keywordflow">if</span> (total_len % env.mbuf_data_room)</div>
<div class="line">        nb_seg++;</div>
<div class="line"> </div>
<div class="line">    m = <a name="a38"></a><a class="code" href="rte__mbuf_8h.html#ad4d1c289d8cffc831dfb77c64f52447b">rte_pktmbuf_alloc</a>(env.mpool);</div>
<div class="line">    <span class="keywordflow">if</span> (!m) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: Not enough mbuf\n&quot;</span>,</div>
<div class="line">                -ENOMEM);</div>
<div class="line">        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line">    }</div>
<div class="line">    head = m;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (nb_seg) {</div>
<div class="line">        uint16_t len = <a name="a39"></a><a class="code" href="rte__common_8h.html#a4c7571cbcdbfe9b63431036af811bee9">RTE_MIN</a>(total_len, env.mbuf_data_room);</div>
<div class="line">        uint8_t *dst = (uint8_t *)<a name="a40"></a><a class="code" href="rte__mbuf_8h.html#ad5b0cd686ad3bcbb83416ca8395a080b">rte_pktmbuf_append</a>(m, len);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (!dst) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: MBUF too small\n&quot;</span>,</div>
<div class="line">                    -ENOMEM);</div>
<div class="line">            ret = -ENOMEM;</div>
<div class="line">            <span class="keywordflow">goto</span> error_exit;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        memcpy(dst, src, len);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (head != m) {</div>
<div class="line">            ret = <a name="a41"></a><a class="code" href="rte__mbuf_8h.html#af52dbeb3951f5b90259d3760128ee139">rte_pktmbuf_chain</a>(head, m);</div>
<div class="line">            <span class="keywordflow">if</span> (ret) {</div>
<div class="line">                <a class="code" href="rte__mbuf_8h.html#a1215458932900b7cd5192326fa4a6902">rte_pktmbuf_free</a>(m);</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: SGL build\n&quot;</span>,</div>
<div class="line">                        ret);</div>
<div class="line">                <span class="keywordflow">goto</span> error_exit;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        total_len -= len;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (total_len) {</div>
<div class="line">            <span class="keywordflow">if</span> (!env.dev_support_sgl) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;SGL not supported\n&quot;</span>);</div>
<div class="line">                ret = -EPERM;</div>
<div class="line">                <span class="keywordflow">goto</span> error_exit;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            m = <a class="code" href="rte__mbuf_8h.html#ad4d1c289d8cffc831dfb77c64f52447b">rte_pktmbuf_alloc</a>(env.mpool);</div>
<div class="line">            <span class="keywordflow">if</span> (!m) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: No memory\n&quot;</span>,</div>
<div class="line">                        -ENOMEM);</div>
<div class="line">                <span class="keywordflow">goto</span> error_exit;</div>
<div class="line">            }</div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        src += len;</div>
<div class="line">        nb_seg--;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (total_len) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: Failed to store all data\n&quot;</span>,</div>
<div class="line">                -ENOMEM);</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    env.mbuf = head;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">error_exit:</div>
<div class="line">    <span class="keywordflow">if</span> (head)</div>
<div class="line">        <a class="code" href="rte__mbuf_8h.html#a1215458932900b7cd5192326fa4a6902">rte_pktmbuf_free</a>(head);</div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">prepare_cipher_op(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a42"></a><a class="code" href="structrte__crypto__sym__op.html">rte_crypto_sym_op</a> *sym = env.op-&gt;sym;</div>
<div class="line">    uint8_t *iv = <a name="a43"></a><a class="code" href="rte__cryptodev_8h.html#aecf8ad2a113d395767f5b6cea89f3ee2">rte_crypto_op_ctod_offset</a>(env.op, uint8_t *, IV_OFF);</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    <a name="a44"></a><a class="code" href="rte__crypto_8h.html#ae7fffda852cfcc8fb259eb8334c577ae">__rte_crypto_op_reset</a>(env.op, <a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc">RTE_CRYPTO_OP_TYPE_SYMMETRIC</a>);</div>
<div class="line"> </div>
<div class="line">    memcpy(iv, vec.iv.val, vec.iv.len);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (info.op == FIPS_TEST_ENC_AUTH_GEN) {</div>
<div class="line">        ret = prepare_data_mbufs(&amp;vec.pt);</div>
<div class="line">        <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">            <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">        sym-&gt;<a name="a45"></a>cipher.data.length = vec.pt.len;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        ret = prepare_data_mbufs(&amp;vec.ct);</div>
<div class="line">        <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">            <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">        sym-&gt;cipher.data.length = vec.ct.len;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a name="a46"></a><a class="code" href="rte__crypto_8h.html#affaf4fd29a51d350b387155494402a84">rte_crypto_op_attach_sym_session</a>(env.op, env.sess);</div>
<div class="line"> </div>
<div class="line">    sym-&gt;<a name="a47"></a><a class="code" href="structrte__crypto__sym__op.html#af021669494a2806b0569587e2096e88e">m_src</a> = env.mbuf;</div>
<div class="line">    sym-&gt;cipher.data.offset = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">prepare_auth_op(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__sym__op.html">rte_crypto_sym_op</a> *sym = env.op-&gt;sym;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__crypto_8h.html#ae7fffda852cfcc8fb259eb8334c577ae">__rte_crypto_op_reset</a>(env.op, <a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc">RTE_CRYPTO_OP_TYPE_SYMMETRIC</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (vec.iv.len) {</div>
<div class="line">        uint8_t *iv = <a class="code" href="rte__cryptodev_8h.html#aecf8ad2a113d395767f5b6cea89f3ee2">rte_crypto_op_ctod_offset</a>(env.op, uint8_t *,</div>
<div class="line">                IV_OFF);</div>
<div class="line">        memset(iv, 0, vec.iv.len);</div>
<div class="line">        <span class="keywordflow">if</span> (vec.iv.val)</div>
<div class="line">            memcpy(iv, vec.iv.val, vec.iv.len);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ret = prepare_data_mbufs(&amp;vec.pt);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (env.digest)</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a1fc82f67711b13aca7e05dc9d58f9dbd">rte_free</a>(env.digest);</div>
<div class="line"> </div>
<div class="line">    env.digest = <a name="a48"></a><a class="code" href="rte__malloc_8h.html#aaf0f048a5fd1672688c662cdfb4536b3">rte_zmalloc</a>(NULL, vec.cipher_auth.digest.len,</div>
<div class="line">            RTE_CACHE_LINE_SIZE);</div>
<div class="line">    <span class="keywordflow">if</span> (!env.digest) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Not enough memory\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line">    }</div>
<div class="line">    env.digest_len = vec.cipher_auth.digest.len;</div>
<div class="line"> </div>
<div class="line">    sym-&gt;<a class="code" href="structrte__crypto__sym__op.html#af021669494a2806b0569587e2096e88e">m_src</a> = env.mbuf;</div>
<div class="line">    sym-&gt;<a name="a49"></a>auth.data.offset = 0;</div>
<div class="line">    sym-&gt;auth.data.length = vec.pt.len;</div>
<div class="line">    sym-&gt;auth.digest.data = env.digest;</div>
<div class="line">    sym-&gt;auth.digest.phys_addr = <a name="a50"></a><a class="code" href="rte__malloc_8h.html#a9fa8949fa521967981829b2afe40702b">rte_malloc_virt2iova</a>(env.digest);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (info.op == FIPS_TEST_DEC_AUTH_VERIF)</div>
<div class="line">        memcpy(env.digest, vec.cipher_auth.digest.val,</div>
<div class="line">                vec.cipher_auth.digest.len);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__crypto_8h.html#affaf4fd29a51d350b387155494402a84">rte_crypto_op_attach_sym_session</a>(env.op, env.sess);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">prepare_aead_op(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__sym__op.html">rte_crypto_sym_op</a> *sym = env.op-&gt;sym;</div>
<div class="line">    uint8_t *iv = <a class="code" href="rte__cryptodev_8h.html#aecf8ad2a113d395767f5b6cea89f3ee2">rte_crypto_op_ctod_offset</a>(env.op, uint8_t *, IV_OFF);</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__crypto_8h.html#ae7fffda852cfcc8fb259eb8334c577ae">__rte_crypto_op_reset</a>(env.op, <a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc">RTE_CRYPTO_OP_TYPE_SYMMETRIC</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (info.algo == FIPS_TEST_ALGO_AES_CCM)</div>
<div class="line">        iv++;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (vec.iv.val)</div>
<div class="line">        memcpy(iv, vec.iv.val, vec.iv.len);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <span class="comment">/* if REQ file has iv length but not data, default as all 0 */</span></div>
<div class="line">        memset(iv, 0, vec.iv.len);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (info.op == FIPS_TEST_ENC_AUTH_GEN) {</div>
<div class="line">        ret = prepare_data_mbufs(&amp;vec.pt);</div>
<div class="line">        <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">            <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (env.digest)</div>
<div class="line">            <a class="code" href="rte__malloc_8h.html#a1fc82f67711b13aca7e05dc9d58f9dbd">rte_free</a>(env.digest);</div>
<div class="line">        env.digest = <a class="code" href="rte__malloc_8h.html#aaf0f048a5fd1672688c662cdfb4536b3">rte_zmalloc</a>(NULL, vec.aead.digest.len,</div>
<div class="line">                RTE_CACHE_LINE_SIZE);</div>
<div class="line">        <span class="keywordflow">if</span> (!env.digest) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Not enough memory\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line">        }</div>
<div class="line">        env.digest_len = vec.cipher_auth.digest.len;</div>
<div class="line"> </div>
<div class="line">        sym-&gt;<a name="a51"></a>aead.data.length = vec.pt.len;</div>
<div class="line">        sym-&gt;aead.digest.data = env.digest;</div>
<div class="line">        sym-&gt;aead.digest.phys_addr = <a class="code" href="rte__malloc_8h.html#a9fa8949fa521967981829b2afe40702b">rte_malloc_virt2iova</a>(env.digest);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        ret = prepare_data_mbufs(&amp;vec.ct);</div>
<div class="line">        <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">            <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">        sym-&gt;aead.data.length = vec.ct.len;</div>
<div class="line">        sym-&gt;aead.digest.data = vec.aead.digest.val;</div>
<div class="line">        sym-&gt;aead.digest.phys_addr = <a class="code" href="rte__malloc_8h.html#a9fa8949fa521967981829b2afe40702b">rte_malloc_virt2iova</a>(</div>
<div class="line">                sym-&gt;aead.digest.data);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    sym-&gt;<a class="code" href="structrte__crypto__sym__op.html#af021669494a2806b0569587e2096e88e">m_src</a> = env.mbuf;</div>
<div class="line">    sym-&gt;aead.data.offset = 0;</div>
<div class="line">    sym-&gt;aead.aad.data = vec.aead.aad.val;</div>
<div class="line">    sym-&gt;aead.aad.phys_addr = <a class="code" href="rte__malloc_8h.html#a9fa8949fa521967981829b2afe40702b">rte_malloc_virt2iova</a>(sym-&gt;aead.aad.data);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__crypto_8h.html#affaf4fd29a51d350b387155494402a84">rte_crypto_op_attach_sym_session</a>(env.op, env.sess);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">prepare_aes_xform(<span class="keyword">struct</span> <a name="_a52"></a><a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *<a name="a53"></a><a class="code" href="structrte__crypto__sym__op.html#ac8e4b59a436a743849b7116e8a3d135c">xform</a>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a name="_a54"></a><a class="code" href="structrte__cryptodev__symmetric__capability.html">rte_cryptodev_symmetric_capability</a> *cap;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a55"></a><a class="code" href="structrte__cryptodev__sym__capability__idx.html">rte_cryptodev_sym_capability_idx</a> cap_idx;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a56"></a><a class="code" href="structrte__crypto__cipher__xform.html">rte_crypto_cipher_xform</a> *cipher_xform = &amp;xform-&gt;<a name="a57"></a><a class="code" href="structrte__crypto__sym__xform.html#ac50ef6f5e9722a6125cad8e2547c9847">cipher</a>;</div>
<div class="line"> </div>
<div class="line">    xform-&gt;<a name="a58"></a><a class="code" href="structrte__crypto__sym__xform.html#a714d838357b795dd999dc8de04f1c7f4">type</a> = <a name="a59"></a><a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c">RTE_CRYPTO_SYM_XFORM_CIPHER</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (info.interim_info.aes_data.cipher_algo == <a name="a60"></a><a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ead9f8e28815f3dd2b77e7ce93b7b8a7ca">RTE_CRYPTO_CIPHER_AES_CBC</a>)</div>
<div class="line">        cipher_xform-&gt;<a name="a61"></a><a class="code" href="structrte__crypto__cipher__xform.html#a23947db20adeb0a2e186dc618f645e44">algo</a> = <a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ead9f8e28815f3dd2b77e7ce93b7b8a7ca">RTE_CRYPTO_CIPHER_AES_CBC</a>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a23947db20adeb0a2e186dc618f645e44">algo</a> = <a name="a62"></a><a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eaf7d6407f595eafe9d16b372e7d256f9e">RTE_CRYPTO_CIPHER_AES_ECB</a>;</div>
<div class="line"> </div>
<div class="line">    cipher_xform-&gt;<a name="a63"></a><a class="code" href="structrte__crypto__cipher__xform.html#ab8e313535343ba1b7b75ad16589de6c9">op</a> = (info.op == FIPS_TEST_ENC_AUTH_GEN) ?</div>
<div class="line">            <a name="a64"></a><a class="code" href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321a74a31028a7180f96bcbe6c1edc298c5b">RTE_CRYPTO_CIPHER_OP_ENCRYPT</a> :</div>
<div class="line">            <a name="a65"></a><a class="code" href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321a4ec0ce9be05fae0758c95aadfb03c4ee">RTE_CRYPTO_CIPHER_OP_DECRYPT</a>;</div>
<div class="line">    cipher_xform-&gt;<a name="a66"></a><a class="code" href="structrte__crypto__cipher__xform.html#a320b4b9a8f44fe20dcf27b2914a83145">key</a>.<a name="a67"></a><a class="code" href="structrte__crypto__cipher__xform.html#a579f5164b5b16e18ddcdb0296ef81799">data</a> = vec.cipher_auth.key.val;</div>
<div class="line">    cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a320b4b9a8f44fe20dcf27b2914a83145">key</a>.<a name="a68"></a><a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a> = vec.cipher_auth.key.len;</div>
<div class="line">    <span class="keywordflow">if</span> (cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a23947db20adeb0a2e186dc618f645e44">algo</a> == <a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ead9f8e28815f3dd2b77e7ce93b7b8a7ca">RTE_CRYPTO_CIPHER_AES_CBC</a>) {</div>
<div class="line">        cipher_xform-&gt;<a name="a69"></a><a class="code" href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">iv</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a> = vec.iv.len;</div>
<div class="line">        cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">iv</a>.<a name="a70"></a><a class="code" href="structrte__crypto__cipher__xform.html#ac681806181c80437cfab37335f62ff39">offset</a> = IV_OFF;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">iv</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a> = 0;</div>
<div class="line">        cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">iv</a>.<a class="code" href="structrte__crypto__cipher__xform.html#ac681806181c80437cfab37335f62ff39">offset</a> = 0;</div>
<div class="line">    }</div>
<div class="line">    cap_idx.algo.cipher = cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a23947db20adeb0a2e186dc618f645e44">algo</a>;</div>
<div class="line">    cap_idx.type = <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c">RTE_CRYPTO_SYM_XFORM_CIPHER</a>;</div>
<div class="line"> </div>
<div class="line">    cap = <a name="a71"></a><a class="code" href="rte__cryptodev_8h.html#aea2f599f2be3d8c139c57f98e0f0c9c1">rte_cryptodev_sym_capability_get</a>(env.dev_id, &amp;cap_idx);</div>
<div class="line">    <span class="keywordflow">if</span> (!cap) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Failed to get capability for cdev %u\n&quot;</span>,</div>
<div class="line">                env.dev_id);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a72"></a><a class="code" href="rte__cryptodev_8h.html#ad11f75024b43932a55bae067e92d718a">rte_cryptodev_sym_capability_check_cipher</a>(cap,</div>
<div class="line">            cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a320b4b9a8f44fe20dcf27b2914a83145">key</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>,</div>
<div class="line">            cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">iv</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>) != 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;PMD %s key length %u IV length %u\n&quot;</span>,</div>
<div class="line">                info.device_name, cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a320b4b9a8f44fe20dcf27b2914a83145">key</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>,</div>
<div class="line">                cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">iv</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>);</div>
<div class="line">        <span class="keywordflow">return</span> -EPERM;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">prepare_tdes_xform(<span class="keyword">struct</span> <a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *xform)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__symmetric__capability.html">rte_cryptodev_symmetric_capability</a> *cap;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__sym__capability__idx.html">rte_cryptodev_sym_capability_idx</a> cap_idx;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__cipher__xform.html">rte_crypto_cipher_xform</a> *cipher_xform = &amp;xform-&gt;<a class="code" href="structrte__crypto__sym__xform.html#ac50ef6f5e9722a6125cad8e2547c9847">cipher</a>;</div>
<div class="line"> </div>
<div class="line">    xform-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a714d838357b795dd999dc8de04f1c7f4">type</a> = <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c">RTE_CRYPTO_SYM_XFORM_CIPHER</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (info.interim_info.tdes_data.test_mode == TDES_MODE_CBC)</div>
<div class="line">        cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a23947db20adeb0a2e186dc618f645e44">algo</a> = <a name="a73"></a><a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eaed8720577f149444ab479ee7415dbfb2">RTE_CRYPTO_CIPHER_3DES_CBC</a>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a23947db20adeb0a2e186dc618f645e44">algo</a> = <a name="a74"></a><a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eab8a2eee308e346ed3b076e2d400615b2">RTE_CRYPTO_CIPHER_3DES_ECB</a>;</div>
<div class="line">    cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#ab8e313535343ba1b7b75ad16589de6c9">op</a> = (info.op == FIPS_TEST_ENC_AUTH_GEN) ?</div>
<div class="line">            <a class="code" href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321a74a31028a7180f96bcbe6c1edc298c5b">RTE_CRYPTO_CIPHER_OP_ENCRYPT</a> :</div>
<div class="line">            <a class="code" href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321a4ec0ce9be05fae0758c95aadfb03c4ee">RTE_CRYPTO_CIPHER_OP_DECRYPT</a>;</div>
<div class="line">    cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a320b4b9a8f44fe20dcf27b2914a83145">key</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a579f5164b5b16e18ddcdb0296ef81799">data</a> = vec.cipher_auth.key.val;</div>
<div class="line">    cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a320b4b9a8f44fe20dcf27b2914a83145">key</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a> = vec.cipher_auth.key.len;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a23947db20adeb0a2e186dc618f645e44">algo</a> == <a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eaed8720577f149444ab479ee7415dbfb2">RTE_CRYPTO_CIPHER_3DES_CBC</a>) {</div>
<div class="line">        cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">iv</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a> = vec.iv.len;</div>
<div class="line">        cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">iv</a>.<a class="code" href="structrte__crypto__cipher__xform.html#ac681806181c80437cfab37335f62ff39">offset</a> = IV_OFF;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">iv</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a> = 0;</div>
<div class="line">        cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">iv</a>.<a class="code" href="structrte__crypto__cipher__xform.html#ac681806181c80437cfab37335f62ff39">offset</a> = 0;</div>
<div class="line">    }</div>
<div class="line">    cap_idx.algo.cipher = cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a23947db20adeb0a2e186dc618f645e44">algo</a>;</div>
<div class="line">    cap_idx.type = <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c">RTE_CRYPTO_SYM_XFORM_CIPHER</a>;</div>
<div class="line"> </div>
<div class="line">    cap = <a class="code" href="rte__cryptodev_8h.html#aea2f599f2be3d8c139c57f98e0f0c9c1">rte_cryptodev_sym_capability_get</a>(env.dev_id, &amp;cap_idx);</div>
<div class="line">    <span class="keywordflow">if</span> (!cap) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Failed to get capability for cdev %u\n&quot;</span>,</div>
<div class="line">                env.dev_id);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__cryptodev_8h.html#ad11f75024b43932a55bae067e92d718a">rte_cryptodev_sym_capability_check_cipher</a>(cap,</div>
<div class="line">            cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a320b4b9a8f44fe20dcf27b2914a83145">key</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>,</div>
<div class="line">            cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">iv</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>) != 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;PMD %s key length %u IV length %u\n&quot;</span>,</div>
<div class="line">                info.device_name, cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a320b4b9a8f44fe20dcf27b2914a83145">key</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>,</div>
<div class="line">                cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">iv</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>);</div>
<div class="line">        <span class="keywordflow">return</span> -EPERM;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">prepare_hmac_xform(<span class="keyword">struct</span> <a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *xform)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__symmetric__capability.html">rte_cryptodev_symmetric_capability</a> *cap;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__sym__capability__idx.html">rte_cryptodev_sym_capability_idx</a> cap_idx;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a75"></a><a class="code" href="structrte__crypto__auth__xform.html">rte_crypto_auth_xform</a> *auth_xform = &amp;xform-&gt;<a name="a76"></a><a class="code" href="structrte__crypto__sym__xform.html#a3f971d41f5862b2967c0598d5e78e1a6">auth</a>;</div>
<div class="line"> </div>
<div class="line">    xform-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a714d838357b795dd999dc8de04f1c7f4">type</a> = <a name="a77"></a><a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9">RTE_CRYPTO_SYM_XFORM_AUTH</a>;</div>
<div class="line"> </div>
<div class="line">    auth_xform-&gt;<a name="a78"></a><a class="code" href="structrte__crypto__auth__xform.html#a00412ca4847e32cce6759541ca06ca86">algo</a> = info.interim_info.hmac_data.algo;</div>
<div class="line">    auth_xform-&gt;<a name="a79"></a><a class="code" href="structrte__crypto__auth__xform.html#a8e2f80c0b35f9851e755100ea1e8db95">op</a> = <a name="a80"></a><a class="code" href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47aa4697c029df30850f9f01b1c641aca32">RTE_CRYPTO_AUTH_OP_GENERATE</a>;</div>
<div class="line">    auth_xform-&gt;<a name="a81"></a><a class="code" href="structrte__crypto__auth__xform.html#a765cf2674d1c06ca36503b60c24c6b34">digest_length</a> = vec.cipher_auth.digest.len;</div>
<div class="line">    auth_xform-&gt;<a name="a82"></a><a class="code" href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">key</a>.<a name="a83"></a><a class="code" href="structrte__crypto__auth__xform.html#a579f5164b5b16e18ddcdb0296ef81799">data</a> = vec.cipher_auth.key.val;</div>
<div class="line">    auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">key</a>.<a name="a84"></a><a class="code" href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a> = vec.cipher_auth.key.len;</div>
<div class="line"> </div>
<div class="line">    cap_idx.algo.auth = auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a00412ca4847e32cce6759541ca06ca86">algo</a>;</div>
<div class="line">    cap_idx.type = <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9">RTE_CRYPTO_SYM_XFORM_AUTH</a>;</div>
<div class="line"> </div>
<div class="line">    cap = <a class="code" href="rte__cryptodev_8h.html#aea2f599f2be3d8c139c57f98e0f0c9c1">rte_cryptodev_sym_capability_get</a>(env.dev_id, &amp;cap_idx);</div>
<div class="line">    <span class="keywordflow">if</span> (!cap) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Failed to get capability for cdev %u\n&quot;</span>,</div>
<div class="line">                env.dev_id);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a85"></a><a class="code" href="rte__cryptodev_8h.html#a52884dfa1aa89cc83c879d5e8620e6eb">rte_cryptodev_sym_capability_check_auth</a>(cap,</div>
<div class="line">            auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">key</a>.<a class="code" href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>,</div>
<div class="line">            auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a765cf2674d1c06ca36503b60c24c6b34">digest_length</a>, 0) != 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;PMD %s key length %u IV length %u\n&quot;</span>,</div>
<div class="line">                info.device_name, auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">key</a>.<a class="code" href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>,</div>
<div class="line">                auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a765cf2674d1c06ca36503b60c24c6b34">digest_length</a>);</div>
<div class="line">        <span class="keywordflow">return</span> -EPERM;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">prepare_gcm_xform(<span class="keyword">struct</span> <a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *xform)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__symmetric__capability.html">rte_cryptodev_symmetric_capability</a> *cap;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__sym__capability__idx.html">rte_cryptodev_sym_capability_idx</a> cap_idx;</div>
<div class="line">    <span class="keyword">struct </span>rte_crypto_aead_xform *aead_xform = &amp;xform-&gt;<a name="a86"></a><a class="code" href="structrte__crypto__sym__xform.html#afe8d3d45863238a8b9d868967071061c">aead</a>;</div>
<div class="line"> </div>
<div class="line">    xform-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a714d838357b795dd999dc8de04f1c7f4">type</a> = <a name="a87"></a><a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a87d8d14b56f41d42ca643d33a279912a">RTE_CRYPTO_SYM_XFORM_AEAD</a>;</div>
<div class="line"> </div>
<div class="line">    aead_xform-&gt;algo = <a name="a88"></a><a class="code" href="rte__crypto__sym_8h.html#a648bc317af3ee238310fac9d87512508ab8b38d7173d30b7adf47116abb09c469">RTE_CRYPTO_AEAD_AES_GCM</a>;</div>
<div class="line">    aead_xform-&gt;aad_length = vec.aead.aad.len;</div>
<div class="line">    aead_xform-&gt;digest_length = vec.aead.digest.len;</div>
<div class="line">    aead_xform-&gt;iv.offset = IV_OFF;</div>
<div class="line">    aead_xform-&gt;iv.length = vec.iv.len;</div>
<div class="line">    aead_xform-&gt;key.data = vec.aead.key.val;</div>
<div class="line">    aead_xform-&gt;key.length = vec.aead.key.len;</div>
<div class="line">    aead_xform-&gt;op = (info.op == FIPS_TEST_ENC_AUTH_GEN) ?</div>
<div class="line">            <a name="a89"></a><a class="code" href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57ea80f5756a76a8c903cc56a3b475576e2c">RTE_CRYPTO_AEAD_OP_ENCRYPT</a> :</div>
<div class="line">            <a name="a90"></a><a class="code" href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57ea331ebd5a481118673489e7c580530179">RTE_CRYPTO_AEAD_OP_DECRYPT</a>;</div>
<div class="line"> </div>
<div class="line">    cap_idx.algo.aead = aead_xform-&gt;algo;</div>
<div class="line">    cap_idx.type = <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a87d8d14b56f41d42ca643d33a279912a">RTE_CRYPTO_SYM_XFORM_AEAD</a>;</div>
<div class="line"> </div>
<div class="line">    cap = <a class="code" href="rte__cryptodev_8h.html#aea2f599f2be3d8c139c57f98e0f0c9c1">rte_cryptodev_sym_capability_get</a>(env.dev_id, &amp;cap_idx);</div>
<div class="line">    <span class="keywordflow">if</span> (!cap) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Failed to get capability for cdev %u\n&quot;</span>,</div>
<div class="line">                env.dev_id);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a91"></a><a class="code" href="rte__cryptodev_8h.html#ac02d0b6d3234564763e8395b3e9e3ea6">rte_cryptodev_sym_capability_check_aead</a>(cap,</div>
<div class="line">            aead_xform-&gt;key.length,</div>
<div class="line">            aead_xform-&gt;digest_length, aead_xform-&gt;aad_length,</div>
<div class="line">            aead_xform-&gt;iv.length) != 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1,</div>
<div class="line">            <span class="stringliteral">&quot;PMD %s key_len %u tag_len %u aad_len %u iv_len %u\n&quot;</span>,</div>
<div class="line">                info.device_name, aead_xform-&gt;key.length,</div>
<div class="line">                aead_xform-&gt;digest_length,</div>
<div class="line">                aead_xform-&gt;aad_length,</div>
<div class="line">                aead_xform-&gt;iv.length);</div>
<div class="line">        <span class="keywordflow">return</span> -EPERM;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">prepare_gmac_xform(<span class="keyword">struct</span> <a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *xform)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__symmetric__capability.html">rte_cryptodev_symmetric_capability</a> *cap;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__sym__capability__idx.html">rte_cryptodev_sym_capability_idx</a> cap_idx;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__auth__xform.html">rte_crypto_auth_xform</a> *auth_xform = &amp;xform-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a3f971d41f5862b2967c0598d5e78e1a6">auth</a>;</div>
<div class="line"> </div>
<div class="line">    xform-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a714d838357b795dd999dc8de04f1c7f4">type</a> = <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9">RTE_CRYPTO_SYM_XFORM_AUTH</a>;</div>
<div class="line"> </div>
<div class="line">    auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a00412ca4847e32cce6759541ca06ca86">algo</a> = <a name="a92"></a><a class="code" href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793ae1c3a78693f23571875543835e02bd4d">RTE_CRYPTO_AUTH_AES_GMAC</a>;</div>
<div class="line">    auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a8e2f80c0b35f9851e755100ea1e8db95">op</a> = (info.op == FIPS_TEST_ENC_AUTH_GEN) ?</div>
<div class="line">            <a class="code" href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47aa4697c029df30850f9f01b1c641aca32">RTE_CRYPTO_AUTH_OP_GENERATE</a> :</div>
<div class="line">            <a name="a93"></a><a class="code" href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47a99f910b408b48db113988c3b841972b9">RTE_CRYPTO_AUTH_OP_VERIFY</a>;</div>
<div class="line">    auth_xform-&gt;<a name="a94"></a><a class="code" href="structrte__crypto__auth__xform.html#ae4d1b05e299eae17c0c2ea8ba1dddb1d">iv</a>.<a name="a95"></a><a class="code" href="structrte__crypto__auth__xform.html#ac681806181c80437cfab37335f62ff39">offset</a> = IV_OFF;</div>
<div class="line">    auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#ae4d1b05e299eae17c0c2ea8ba1dddb1d">iv</a>.<a class="code" href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a> = vec.iv.len;</div>
<div class="line">    auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a765cf2674d1c06ca36503b60c24c6b34">digest_length</a> = vec.aead.digest.len;</div>
<div class="line">    auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">key</a>.<a class="code" href="structrte__crypto__auth__xform.html#a579f5164b5b16e18ddcdb0296ef81799">data</a> = vec.aead.key.val;</div>
<div class="line">    auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">key</a>.<a class="code" href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a> = vec.aead.key.len;</div>
<div class="line"> </div>
<div class="line">    cap_idx.algo.auth = auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a00412ca4847e32cce6759541ca06ca86">algo</a>;</div>
<div class="line">    cap_idx.type = <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9">RTE_CRYPTO_SYM_XFORM_AUTH</a>;</div>
<div class="line"> </div>
<div class="line">    cap = <a class="code" href="rte__cryptodev_8h.html#aea2f599f2be3d8c139c57f98e0f0c9c1">rte_cryptodev_sym_capability_get</a>(env.dev_id, &amp;cap_idx);</div>
<div class="line">    <span class="keywordflow">if</span> (!cap) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Failed to get capability for cdev %u\n&quot;</span>,</div>
<div class="line">                env.dev_id);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__cryptodev_8h.html#a52884dfa1aa89cc83c879d5e8620e6eb">rte_cryptodev_sym_capability_check_auth</a>(cap,</div>
<div class="line">            auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">key</a>.<a class="code" href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>,</div>
<div class="line">            auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a765cf2674d1c06ca36503b60c24c6b34">digest_length</a>,</div>
<div class="line">            auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#ae4d1b05e299eae17c0c2ea8ba1dddb1d">iv</a>.<a class="code" href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>) != 0) {</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1,</div>
<div class="line">            <span class="stringliteral">&quot;PMD %s key length %u Digest length %u IV length %u\n&quot;</span>,</div>
<div class="line">                info.device_name, auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">key</a>.<a class="code" href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>,</div>
<div class="line">                auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a765cf2674d1c06ca36503b60c24c6b34">digest_length</a>,</div>
<div class="line">                auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#ae4d1b05e299eae17c0c2ea8ba1dddb1d">iv</a>.<a class="code" href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>);</div>
<div class="line">        <span class="keywordflow">return</span> -EPERM;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">prepare_cmac_xform(<span class="keyword">struct</span> <a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *xform)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__symmetric__capability.html">rte_cryptodev_symmetric_capability</a> *cap;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__sym__capability__idx.html">rte_cryptodev_sym_capability_idx</a> cap_idx;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__auth__xform.html">rte_crypto_auth_xform</a> *auth_xform = &amp;xform-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a3f971d41f5862b2967c0598d5e78e1a6">auth</a>;</div>
<div class="line"> </div>
<div class="line">    xform-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a714d838357b795dd999dc8de04f1c7f4">type</a> = <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9">RTE_CRYPTO_SYM_XFORM_AUTH</a>;</div>
<div class="line"> </div>
<div class="line">    auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a00412ca4847e32cce6759541ca06ca86">algo</a> = <a name="a96"></a><a class="code" href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793a8e54f987cb5414570bcc2c5f181cbfe2">RTE_CRYPTO_AUTH_AES_CMAC</a>;</div>
<div class="line">    auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a8e2f80c0b35f9851e755100ea1e8db95">op</a> = (info.op == FIPS_TEST_ENC_AUTH_GEN) ?</div>
<div class="line">            <a class="code" href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47aa4697c029df30850f9f01b1c641aca32">RTE_CRYPTO_AUTH_OP_GENERATE</a> : <a class="code" href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47a99f910b408b48db113988c3b841972b9">RTE_CRYPTO_AUTH_OP_VERIFY</a>;</div>
<div class="line">    auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a765cf2674d1c06ca36503b60c24c6b34">digest_length</a> = vec.cipher_auth.digest.len;</div>
<div class="line">    auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">key</a>.<a class="code" href="structrte__crypto__auth__xform.html#a579f5164b5b16e18ddcdb0296ef81799">data</a> = vec.cipher_auth.key.val;</div>
<div class="line">    auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">key</a>.<a class="code" href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a> = vec.cipher_auth.key.len;</div>
<div class="line"> </div>
<div class="line">    cap_idx.algo.auth = auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a00412ca4847e32cce6759541ca06ca86">algo</a>;</div>
<div class="line">    cap_idx.type = <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9">RTE_CRYPTO_SYM_XFORM_AUTH</a>;</div>
<div class="line"> </div>
<div class="line">    cap = <a class="code" href="rte__cryptodev_8h.html#aea2f599f2be3d8c139c57f98e0f0c9c1">rte_cryptodev_sym_capability_get</a>(env.dev_id, &amp;cap_idx);</div>
<div class="line">    <span class="keywordflow">if</span> (!cap) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Failed to get capability for cdev %u\n&quot;</span>,</div>
<div class="line">                env.dev_id);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__cryptodev_8h.html#a52884dfa1aa89cc83c879d5e8620e6eb">rte_cryptodev_sym_capability_check_auth</a>(cap,</div>
<div class="line">            auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">key</a>.<a class="code" href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>,</div>
<div class="line">            auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a765cf2674d1c06ca36503b60c24c6b34">digest_length</a>, 0) != 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;PMD %s key length %u IV length %u\n&quot;</span>,</div>
<div class="line">                info.device_name, auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">key</a>.<a class="code" href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>,</div>
<div class="line">                auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a765cf2674d1c06ca36503b60c24c6b34">digest_length</a>);</div>
<div class="line">        <span class="keywordflow">return</span> -EPERM;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">prepare_ccm_xform(<span class="keyword">struct</span> <a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *xform)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__symmetric__capability.html">rte_cryptodev_symmetric_capability</a> *cap;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__sym__capability__idx.html">rte_cryptodev_sym_capability_idx</a> cap_idx;</div>
<div class="line">    <span class="keyword">struct </span>rte_crypto_aead_xform *aead_xform = &amp;xform-&gt;<a class="code" href="structrte__crypto__sym__xform.html#afe8d3d45863238a8b9d868967071061c">aead</a>;</div>
<div class="line"> </div>
<div class="line">    xform-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a714d838357b795dd999dc8de04f1c7f4">type</a> = <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a87d8d14b56f41d42ca643d33a279912a">RTE_CRYPTO_SYM_XFORM_AEAD</a>;</div>
<div class="line"> </div>
<div class="line">    aead_xform-&gt;algo = <a name="a97"></a><a class="code" href="rte__crypto__sym_8h.html#a648bc317af3ee238310fac9d87512508a27d121171b5e292d8a7313a38b91bf3e">RTE_CRYPTO_AEAD_AES_CCM</a>;</div>
<div class="line">    aead_xform-&gt;aad_length = vec.aead.aad.len;</div>
<div class="line">    aead_xform-&gt;digest_length = vec.aead.digest.len;</div>
<div class="line">    aead_xform-&gt;iv.offset = IV_OFF;</div>
<div class="line">    aead_xform-&gt;iv.length = vec.iv.len;</div>
<div class="line">    aead_xform-&gt;key.data = vec.aead.key.val;</div>
<div class="line">    aead_xform-&gt;key.length = vec.aead.key.len;</div>
<div class="line">    aead_xform-&gt;op = (info.op == FIPS_TEST_ENC_AUTH_GEN) ?</div>
<div class="line">            <a class="code" href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57ea80f5756a76a8c903cc56a3b475576e2c">RTE_CRYPTO_AEAD_OP_ENCRYPT</a> :</div>
<div class="line">            <a class="code" href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57ea331ebd5a481118673489e7c580530179">RTE_CRYPTO_AEAD_OP_DECRYPT</a>;</div>
<div class="line"> </div>
<div class="line">    cap_idx.algo.aead = aead_xform-&gt;algo;</div>
<div class="line">    cap_idx.type = <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a87d8d14b56f41d42ca643d33a279912a">RTE_CRYPTO_SYM_XFORM_AEAD</a>;</div>
<div class="line"> </div>
<div class="line">    cap = <a class="code" href="rte__cryptodev_8h.html#aea2f599f2be3d8c139c57f98e0f0c9c1">rte_cryptodev_sym_capability_get</a>(env.dev_id, &amp;cap_idx);</div>
<div class="line">    <span class="keywordflow">if</span> (!cap) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Failed to get capability for cdev %u\n&quot;</span>,</div>
<div class="line">                env.dev_id);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__cryptodev_8h.html#ac02d0b6d3234564763e8395b3e9e3ea6">rte_cryptodev_sym_capability_check_aead</a>(cap,</div>
<div class="line">            aead_xform-&gt;key.length,</div>
<div class="line">            aead_xform-&gt;digest_length, aead_xform-&gt;aad_length,</div>
<div class="line">            aead_xform-&gt;iv.length) != 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1,</div>
<div class="line">            <span class="stringliteral">&quot;PMD %s key_len %u tag_len %u aad_len %u iv_len %u\n&quot;</span>,</div>
<div class="line">                info.device_name, aead_xform-&gt;key.length,</div>
<div class="line">                aead_xform-&gt;digest_length,</div>
<div class="line">                aead_xform-&gt;aad_length,</div>
<div class="line">                aead_xform-&gt;iv.length);</div>
<div class="line">        <span class="keywordflow">return</span> -EPERM;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">prepare_sha_xform(<span class="keyword">struct</span> <a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *xform)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__symmetric__capability.html">rte_cryptodev_symmetric_capability</a> *cap;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__sym__capability__idx.html">rte_cryptodev_sym_capability_idx</a> cap_idx;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__auth__xform.html">rte_crypto_auth_xform</a> *auth_xform = &amp;xform-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a3f971d41f5862b2967c0598d5e78e1a6">auth</a>;</div>
<div class="line"> </div>
<div class="line">    xform-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a714d838357b795dd999dc8de04f1c7f4">type</a> = <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9">RTE_CRYPTO_SYM_XFORM_AUTH</a>;</div>
<div class="line"> </div>
<div class="line">    auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a00412ca4847e32cce6759541ca06ca86">algo</a> = info.interim_info.sha_data.algo;</div>
<div class="line">    auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a8e2f80c0b35f9851e755100ea1e8db95">op</a> = <a class="code" href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47aa4697c029df30850f9f01b1c641aca32">RTE_CRYPTO_AUTH_OP_GENERATE</a>;</div>
<div class="line">    auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a765cf2674d1c06ca36503b60c24c6b34">digest_length</a> = vec.cipher_auth.digest.len;</div>
<div class="line"> </div>
<div class="line">    cap_idx.algo.auth = auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a00412ca4847e32cce6759541ca06ca86">algo</a>;</div>
<div class="line">    cap_idx.type = <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9">RTE_CRYPTO_SYM_XFORM_AUTH</a>;</div>
<div class="line"> </div>
<div class="line">    cap = <a class="code" href="rte__cryptodev_8h.html#aea2f599f2be3d8c139c57f98e0f0c9c1">rte_cryptodev_sym_capability_get</a>(env.dev_id, &amp;cap_idx);</div>
<div class="line">    <span class="keywordflow">if</span> (!cap) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Failed to get capability for cdev %u\n&quot;</span>,</div>
<div class="line">                env.dev_id);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__cryptodev_8h.html#a52884dfa1aa89cc83c879d5e8620e6eb">rte_cryptodev_sym_capability_check_auth</a>(cap,</div>
<div class="line">            auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">key</a>.<a class="code" href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>,</div>
<div class="line">            auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a765cf2674d1c06ca36503b60c24c6b34">digest_length</a>, 0) != 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;PMD %s key length %u digest length %u\n&quot;</span>,</div>
<div class="line">                info.device_name, auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">key</a>.<a class="code" href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>,</div>
<div class="line">                auth_xform-&gt;<a class="code" href="structrte__crypto__auth__xform.html#a765cf2674d1c06ca36503b60c24c6b34">digest_length</a>);</div>
<div class="line">        <span class="keywordflow">return</span> -EPERM;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">prepare_xts_xform(<span class="keyword">struct</span> <a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *xform)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__symmetric__capability.html">rte_cryptodev_symmetric_capability</a> *cap;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__sym__capability__idx.html">rte_cryptodev_sym_capability_idx</a> cap_idx;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__cipher__xform.html">rte_crypto_cipher_xform</a> *cipher_xform = &amp;xform-&gt;<a class="code" href="structrte__crypto__sym__xform.html#ac50ef6f5e9722a6125cad8e2547c9847">cipher</a>;</div>
<div class="line"> </div>
<div class="line">    xform-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a714d838357b795dd999dc8de04f1c7f4">type</a> = <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c">RTE_CRYPTO_SYM_XFORM_CIPHER</a>;</div>
<div class="line"> </div>
<div class="line">    cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a23947db20adeb0a2e186dc618f645e44">algo</a> = <a name="a98"></a><a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ea4d25678e94b0dd7ecca1a80f518a6de7">RTE_CRYPTO_CIPHER_AES_XTS</a>;</div>
<div class="line">    cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#ab8e313535343ba1b7b75ad16589de6c9">op</a> = (info.op == FIPS_TEST_ENC_AUTH_GEN) ?</div>
<div class="line">            <a class="code" href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321a74a31028a7180f96bcbe6c1edc298c5b">RTE_CRYPTO_CIPHER_OP_ENCRYPT</a> :</div>
<div class="line">            <a class="code" href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321a4ec0ce9be05fae0758c95aadfb03c4ee">RTE_CRYPTO_CIPHER_OP_DECRYPT</a>;</div>
<div class="line">    cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a320b4b9a8f44fe20dcf27b2914a83145">key</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a579f5164b5b16e18ddcdb0296ef81799">data</a> = vec.cipher_auth.key.val;</div>
<div class="line">    cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a320b4b9a8f44fe20dcf27b2914a83145">key</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a> = vec.cipher_auth.key.len;</div>
<div class="line">    cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">iv</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a> = vec.iv.len;</div>
<div class="line">    cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">iv</a>.<a class="code" href="structrte__crypto__cipher__xform.html#ac681806181c80437cfab37335f62ff39">offset</a> = IV_OFF;</div>
<div class="line"> </div>
<div class="line">    cap_idx.algo.cipher = <a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ea4d25678e94b0dd7ecca1a80f518a6de7">RTE_CRYPTO_CIPHER_AES_XTS</a>;</div>
<div class="line">    cap_idx.type = <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c">RTE_CRYPTO_SYM_XFORM_CIPHER</a>;</div>
<div class="line"> </div>
<div class="line">    cap = <a class="code" href="rte__cryptodev_8h.html#aea2f599f2be3d8c139c57f98e0f0c9c1">rte_cryptodev_sym_capability_get</a>(env.dev_id, &amp;cap_idx);</div>
<div class="line">    <span class="keywordflow">if</span> (!cap) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Failed to get capability for cdev %u\n&quot;</span>,</div>
<div class="line">                env.dev_id);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__cryptodev_8h.html#ad11f75024b43932a55bae067e92d718a">rte_cryptodev_sym_capability_check_cipher</a>(cap,</div>
<div class="line">            cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a320b4b9a8f44fe20dcf27b2914a83145">key</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>,</div>
<div class="line">            cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">iv</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>) != 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;PMD %s key length %u IV length %u\n&quot;</span>,</div>
<div class="line">                info.device_name, cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#a320b4b9a8f44fe20dcf27b2914a83145">key</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>,</div>
<div class="line">                cipher_xform-&gt;<a class="code" href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">iv</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>);</div>
<div class="line">        <span class="keywordflow">return</span> -EPERM;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">get_writeback_data(<span class="keyword">struct</span> fips_val *val)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m = env.mbuf;</div>
<div class="line">    uint16_t <a name="a99"></a><a class="code" href="structrte__mbuf.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a> = <a name="a100"></a><a class="code" href="rte__mbuf_8h.html#a7a7ea614c79d5b9ed790a56c1c79189d">rte_pktmbuf_pkt_len</a>(m);</div>
<div class="line">    uint16_t total_len = <a class="code" href="structrte__mbuf.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a> + env.digest_len;</div>
<div class="line">    uint8_t *src, *dst, *wb_data;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* in case val is reused for MCT test, try to free the buffer first */</span></div>
<div class="line">    <span class="keywordflow">if</span> (val-&gt;val) {</div>
<div class="line">        free(val-&gt;val);</div>
<div class="line">        val-&gt;val = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    wb_data = dst = calloc(1, total_len);</div>
<div class="line">    <span class="keywordflow">if</span> (!dst) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: Not enough memory\n&quot;</span>, -ENOMEM);</div>
<div class="line">        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (m &amp;&amp; <a class="code" href="structrte__mbuf.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a>) {</div>
<div class="line">        uint16_t seg_len = <a class="code" href="rte__common_8h.html#a4c7571cbcdbfe9b63431036af811bee9">RTE_MIN</a>(<a name="a101"></a><a class="code" href="rte__mbuf_8h.html#a2a1e1b30162161ed11d3ba2faf7bbf13">rte_pktmbuf_data_len</a>(m), <a class="code" href="structrte__mbuf.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a>);</div>
<div class="line"> </div>
<div class="line">        src = <a name="a102"></a><a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(m, uint8_t *);</div>
<div class="line">        memcpy(dst, src, seg_len);</div>
<div class="line">        m = m-&gt;<a name="a103"></a><a class="code" href="structrte__mbuf.html#ac858fb3bb1a1d67a6efc9563d0c5a471">next</a>;</div>
<div class="line">        <a class="code" href="structrte__mbuf.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a> -= seg_len;</div>
<div class="line">        dst += seg_len;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="structrte__mbuf.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a>) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error -1: write back data\n&quot;</span>);</div>
<div class="line">        free(wb_data);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (env.digest)</div>
<div class="line">        memcpy(dst, env.digest, env.digest_len);</div>
<div class="line"> </div>
<div class="line">    val-&gt;val = wb_data;</div>
<div class="line">    val-&gt;len = total_len;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">fips_run_test(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> xform = {0};</div>
<div class="line">    uint16_t n_deqd;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    ret = test_ops.prepare_xform(&amp;xform);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">    env.sess = <a name="a104"></a><a class="code" href="rte__cryptodev_8h.html#ad40470ee7e072f93f85f1bb584e64e39">rte_cryptodev_sym_session_create</a>(env.sess_mpool);</div>
<div class="line">    <span class="keywordflow">if</span> (!env.sess)</div>
<div class="line">        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a105"></a><a class="code" href="rte__cryptodev_8h.html#a3b05f51fd91ec181c369e32908d55717">rte_cryptodev_sym_session_init</a>(env.dev_id,</div>
<div class="line">            env.sess, &amp;xform, env.sess_priv_mpool);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: Init session\n&quot;</span>,</div>
<div class="line">                ret);</div>
<div class="line">        <span class="keywordflow">goto</span> exit;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ret = test_ops.prepare_op();</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: Prepare op\n&quot;</span>,</div>
<div class="line">                ret);</div>
<div class="line">        <span class="keywordflow">goto</span> exit;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a106"></a><a class="code" href="rte__cryptodev_8h.html#a1e1336b0a8fe381ea03a52bad85e5734">rte_cryptodev_enqueue_burst</a>(env.dev_id, 0, &amp;env.op, 1) &lt; 1) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error: Failed enqueue\n&quot;</span>);</div>
<div class="line">        ret = -1;</div>
<div class="line">        <span class="keywordflow">goto</span> exit;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> *deqd_op;</div>
<div class="line"> </div>
<div class="line">        n_deqd = <a name="a107"></a><a class="code" href="rte__cryptodev_8h.html#a0032857587ce7e217b8c10ba392bef56">rte_cryptodev_dequeue_burst</a>(env.dev_id, 0, &amp;deqd_op,</div>
<div class="line">                1);</div>
<div class="line">    } <span class="keywordflow">while</span> (n_deqd == 0);</div>
<div class="line"> </div>
<div class="line">    vec.status = env.op-&gt;status;</div>
<div class="line"> </div>
<div class="line">exit:</div>
<div class="line">    <a class="code" href="rte__cryptodev_8h.html#aa729e554cbafb168eff86f99f9ea518a">rte_cryptodev_sym_session_clear</a>(env.dev_id, env.sess);</div>
<div class="line">    <a class="code" href="rte__cryptodev_8h.html#af91b263a2a66ca15680cb4367c7b8f0e">rte_cryptodev_sym_session_free</a>(env.sess);</div>
<div class="line">    env.sess = NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">fips_generic_test(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>fips_val val = {NULL, 0};</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    fips_test_write_one_case();</div>
<div class="line"> </div>
<div class="line">    ret = fips_run_test();</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (ret == -EPERM || ret == -ENOTSUP) {</div>
<div class="line">            fprintf(info.fp_wr, <span class="stringliteral">&quot;Bypass\n\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ret = get_writeback_data(&amp;val);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (info.file_type) {</div>
<div class="line">    <span class="keywordflow">case</span> FIPS_TYPE_REQ:</div>
<div class="line">    <span class="keywordflow">case</span> FIPS_TYPE_RSP:</div>
<div class="line">        <span class="keywordflow">if</span> (info.parse_writeback == NULL)</div>
<div class="line">            <span class="keywordflow">return</span> -EPERM;</div>
<div class="line">        ret = info.parse_writeback(&amp;val);</div>
<div class="line">        <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">            <span class="keywordflow">return</span> ret;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> FIPS_TYPE_FAX:</div>
<div class="line">        <span class="keywordflow">if</span> (info.kat_check == NULL)</div>
<div class="line">            <span class="keywordflow">return</span> -EPERM;</div>
<div class="line">        ret = info.kat_check(&amp;val);</div>
<div class="line">        <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">            <span class="keywordflow">return</span> ret;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    fprintf(info.fp_wr, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    free(val.val);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">fips_mct_tdes_test(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"><span class="preprocessor">#define TDES_BLOCK_SIZE     8</span></div>
<div class="line"><span class="preprocessor">#define TDES_EXTERN_ITER    400</span></div>
<div class="line"><span class="preprocessor">#define TDES_INTERN_ITER    10000</span></div>
<div class="line">    <span class="keyword">struct </span>fips_val val = {NULL, 0}, val_key;</div>
<div class="line">    uint8_t prev_out[TDES_BLOCK_SIZE] = {0};</div>
<div class="line">    uint8_t prev_prev_out[TDES_BLOCK_SIZE] = {0};</div>
<div class="line">    uint8_t prev_in[TDES_BLOCK_SIZE] = {0};</div>
<div class="line">    uint32_t i, j, k;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line">    <span class="keywordtype">int</span> test_mode = info.interim_info.tdes_data.test_mode;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; TDES_EXTERN_ITER; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> ((i == 0) &amp;&amp; (info.version == 21.4f)) {</div>
<div class="line">            <span class="keywordflow">if</span> (!(strstr(info.vec[0], <span class="stringliteral">&quot;COUNT&quot;</span>)))</div>
<div class="line">                fprintf(info.fp_wr, <span class="stringliteral">&quot;%s%u\n&quot;</span>, <span class="stringliteral">&quot;COUNT = &quot;</span>, 0);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (i != 0)</div>
<div class="line">            update_info_vec(i);</div>
<div class="line"> </div>
<div class="line">        fips_test_write_one_case();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (j = 0; j &lt; TDES_INTERN_ITER; j++) {</div>
<div class="line">            ret = fips_run_test();</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">                <span class="keywordflow">if</span> (ret == -EPERM) {</div>
<div class="line">                    fprintf(info.fp_wr, <span class="stringliteral">&quot;Bypass\n&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">return</span> ret;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            ret = get_writeback_data(&amp;val);</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">                <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (info.op == FIPS_TEST_DEC_AUTH_VERIF)</div>
<div class="line">                memcpy(prev_in, vec.ct.val, TDES_BLOCK_SIZE);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (j == 0) {</div>
<div class="line">                memcpy(prev_out, val.val, TDES_BLOCK_SIZE);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (info.op == FIPS_TEST_ENC_AUTH_GEN) {</div>
<div class="line">                    <span class="keywordflow">if</span> (test_mode == TDES_MODE_ECB) {</div>
<div class="line">                        memcpy(vec.pt.val, val.val,</div>
<div class="line">                               TDES_BLOCK_SIZE);</div>
<div class="line">                    } <span class="keywordflow">else</span> {</div>
<div class="line">                        memcpy(vec.pt.val, vec.iv.val,</div>
<div class="line">                               TDES_BLOCK_SIZE);</div>
<div class="line">                        memcpy(vec.iv.val, val.val,</div>
<div class="line">                               TDES_BLOCK_SIZE);</div>
<div class="line">                    }</div>
<div class="line"> </div>
<div class="line">                } <span class="keywordflow">else</span> {</div>
<div class="line">                    <span class="keywordflow">if</span> (test_mode == TDES_MODE_ECB) {</div>
<div class="line">                        memcpy(vec.ct.val, val.val,</div>
<div class="line">                               TDES_BLOCK_SIZE);</div>
<div class="line">                    } <span class="keywordflow">else</span> {</div>
<div class="line">                        memcpy(vec.iv.val, vec.ct.val,</div>
<div class="line">                               TDES_BLOCK_SIZE);</div>
<div class="line">                        memcpy(vec.ct.val, val.val,</div>
<div class="line">                               TDES_BLOCK_SIZE);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (info.op == FIPS_TEST_ENC_AUTH_GEN) {</div>
<div class="line">                <span class="keywordflow">if</span> (test_mode == TDES_MODE_ECB) {</div>
<div class="line">                    memcpy(vec.pt.val, val.val,</div>
<div class="line">                           TDES_BLOCK_SIZE);</div>
<div class="line">                } <span class="keywordflow">else</span> {</div>
<div class="line">                    memcpy(vec.iv.val, val.val,</div>
<div class="line">                           TDES_BLOCK_SIZE);</div>
<div class="line">                    memcpy(vec.pt.val, prev_out,</div>
<div class="line">                           TDES_BLOCK_SIZE);</div>
<div class="line">                }</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="keywordflow">if</span> (test_mode == TDES_MODE_ECB) {</div>
<div class="line">                    memcpy(vec.ct.val, val.val,</div>
<div class="line">                           TDES_BLOCK_SIZE);</div>
<div class="line">                } <span class="keywordflow">else</span> {</div>
<div class="line">                    memcpy(vec.iv.val, vec.ct.val,</div>
<div class="line">                           TDES_BLOCK_SIZE);</div>
<div class="line">                    memcpy(vec.ct.val, val.val,</div>
<div class="line">                           TDES_BLOCK_SIZE);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (j == TDES_INTERN_ITER - 1)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            memcpy(prev_out, val.val, TDES_BLOCK_SIZE);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (j == TDES_INTERN_ITER - 3)</div>
<div class="line">                memcpy(prev_prev_out, val.val, TDES_BLOCK_SIZE);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        info.parse_writeback(&amp;val);</div>
<div class="line">        fprintf(info.fp_wr, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (i == TDES_EXTERN_ITER - 1)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        memcpy(&amp;val_key, &amp;vec.cipher_auth.key, <span class="keyword">sizeof</span>(val_key));</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (info.interim_info.tdes_data.nb_keys == 0) {</div>
<div class="line">            <span class="keywordflow">if</span> (memcmp(val_key.val, val_key.val + 8, 8) == 0)</div>
<div class="line">                info.interim_info.tdes_data.nb_keys = 1;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (memcmp(val_key.val, val_key.val + 16, 8) == 0)</div>
<div class="line">                info.interim_info.tdes_data.nb_keys = 2;</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                info.interim_info.tdes_data.nb_keys = 3;</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (k = 0; k &lt; TDES_BLOCK_SIZE; k++) {</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">switch</span> (info.interim_info.tdes_data.nb_keys) {</div>
<div class="line">            <span class="keywordflow">case</span> 3:</div>
<div class="line">                val_key.val[k] ^= val.val[k];</div>
<div class="line">                val_key.val[k + 8] ^= prev_out[k];</div>
<div class="line">                val_key.val[k + 16] ^= prev_prev_out[k];</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 2:</div>
<div class="line">                val_key.val[k] ^= val.val[k];</div>
<div class="line">                val_key.val[k + 8] ^= prev_out[k];</div>
<div class="line">                val_key.val[k + 16] ^= val.val[k];</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">default</span>: <span class="comment">/* case 1 */</span></div>
<div class="line">                val_key.val[k] ^= val.val[k];</div>
<div class="line">                val_key.val[k + 8] ^= val.val[k];</div>
<div class="line">                val_key.val[k + 16] ^= val.val[k];</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (k = 0; k &lt; 24; k++)</div>
<div class="line">            val_key.val[k] = (__builtin_popcount(val_key.val[k]) &amp;</div>
<div class="line">                    0x1) ?</div>
<div class="line">                    val_key.val[k] : (val_key.val[k] ^ 0x1);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (info.op == FIPS_TEST_ENC_AUTH_GEN) {</div>
<div class="line">            <span class="keywordflow">if</span> (test_mode == TDES_MODE_ECB) {</div>
<div class="line">                memcpy(vec.pt.val, val.val, TDES_BLOCK_SIZE);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                memcpy(vec.iv.val, val.val, TDES_BLOCK_SIZE);</div>
<div class="line">                memcpy(vec.pt.val, prev_out, TDES_BLOCK_SIZE);</div>
<div class="line">            }</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">if</span> (test_mode == TDES_MODE_ECB) {</div>
<div class="line">                memcpy(vec.ct.val, val.val, TDES_BLOCK_SIZE);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                memcpy(vec.iv.val, prev_out, TDES_BLOCK_SIZE);</div>
<div class="line">                memcpy(vec.ct.val, val.val, TDES_BLOCK_SIZE);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (val.val)</div>
<div class="line">        free(val.val);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">fips_mct_aes_ecb_test(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"><span class="preprocessor">#define AES_BLOCK_SIZE  16</span></div>
<div class="line"><span class="preprocessor">#define AES_EXTERN_ITER 100</span></div>
<div class="line"><span class="preprocessor">#define AES_INTERN_ITER 1000</span></div>
<div class="line">    <span class="keyword">struct </span>fips_val val = {NULL, 0}, val_key;</div>
<div class="line">    uint8_t prev_out[AES_BLOCK_SIZE] = {0};</div>
<div class="line">    uint32_t i, j, k;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; AES_EXTERN_ITER; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (i != 0)</div>
<div class="line">            update_info_vec(i);</div>
<div class="line"> </div>
<div class="line">        fips_test_write_one_case();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (j = 0; j &lt; AES_INTERN_ITER; j++) {</div>
<div class="line">            ret = fips_run_test();</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">                <span class="keywordflow">if</span> (ret == -EPERM) {</div>
<div class="line">                    fprintf(info.fp_wr, <span class="stringliteral">&quot;Bypass\n&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">return</span> ret;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            ret = get_writeback_data(&amp;val);</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">                <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (info.op == FIPS_TEST_ENC_AUTH_GEN)</div>
<div class="line">                memcpy(vec.pt.val, val.val, AES_BLOCK_SIZE);</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                memcpy(vec.ct.val, val.val, AES_BLOCK_SIZE);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (j == AES_INTERN_ITER - 1)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            memcpy(prev_out, val.val, AES_BLOCK_SIZE);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        info.parse_writeback(&amp;val);</div>
<div class="line">        fprintf(info.fp_wr, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (i == AES_EXTERN_ITER - 1)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        memcpy(&amp;val_key, &amp;vec.cipher_auth.key, <span class="keyword">sizeof</span>(val_key));</div>
<div class="line">        <span class="keywordflow">for</span> (k = 0; k &lt; vec.cipher_auth.key.len; k++) {</div>
<div class="line">            <span class="keywordflow">switch</span> (vec.cipher_auth.key.len) {</div>
<div class="line">            <span class="keywordflow">case</span> 16:</div>
<div class="line">                val_key.val[k] ^= val.val[k];</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 24:</div>
<div class="line">                <span class="keywordflow">if</span> (k &lt; 8)</div>
<div class="line">                    val_key.val[k] ^= prev_out[k + 8];</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    val_key.val[k] ^= val.val[k - 8];</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 32:</div>
<div class="line">                <span class="keywordflow">if</span> (k &lt; 16)</div>
<div class="line">                    val_key.val[k] ^= prev_out[k];</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    val_key.val[k] ^= val.val[k - 16];</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (val.val)</div>
<div class="line">        free(val.val);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">fips_mct_aes_test(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"><span class="preprocessor">#define AES_BLOCK_SIZE  16</span></div>
<div class="line"><span class="preprocessor">#define AES_EXTERN_ITER 100</span></div>
<div class="line"><span class="preprocessor">#define AES_INTERN_ITER 1000</span></div>
<div class="line">    <span class="keyword">struct </span>fips_val val = {NULL, 0}, val_key;</div>
<div class="line">    uint8_t prev_out[AES_BLOCK_SIZE] = {0};</div>
<div class="line">    uint8_t prev_in[AES_BLOCK_SIZE] = {0};</div>
<div class="line">    uint32_t i, j, k;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (info.interim_info.aes_data.cipher_algo == <a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eaf7d6407f595eafe9d16b372e7d256f9e">RTE_CRYPTO_CIPHER_AES_ECB</a>)</div>
<div class="line">        <span class="keywordflow">return</span> fips_mct_aes_ecb_test();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; AES_EXTERN_ITER; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (i != 0)</div>
<div class="line">            update_info_vec(i);</div>
<div class="line"> </div>
<div class="line">        fips_test_write_one_case();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (j = 0; j &lt; AES_INTERN_ITER; j++) {</div>
<div class="line">            ret = fips_run_test();</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">                <span class="keywordflow">if</span> (ret == -EPERM) {</div>
<div class="line">                    fprintf(info.fp_wr, <span class="stringliteral">&quot;Bypass\n&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">return</span> ret;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            ret = get_writeback_data(&amp;val);</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">                <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (info.op == FIPS_TEST_DEC_AUTH_VERIF)</div>
<div class="line">                memcpy(prev_in, vec.ct.val, AES_BLOCK_SIZE);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (j == 0) {</div>
<div class="line">                memcpy(prev_out, val.val, AES_BLOCK_SIZE);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (info.op == FIPS_TEST_ENC_AUTH_GEN) {</div>
<div class="line">                    memcpy(vec.pt.val, vec.iv.val,</div>
<div class="line">                            AES_BLOCK_SIZE);</div>
<div class="line">                    memcpy(vec.iv.val, val.val,</div>
<div class="line">                            AES_BLOCK_SIZE);</div>
<div class="line">                } <span class="keywordflow">else</span> {</div>
<div class="line">                    memcpy(vec.ct.val, vec.iv.val,</div>
<div class="line">                            AES_BLOCK_SIZE);</div>
<div class="line">                    memcpy(vec.iv.val, prev_in,</div>
<div class="line">                            AES_BLOCK_SIZE);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (info.op == FIPS_TEST_ENC_AUTH_GEN) {</div>
<div class="line">                memcpy(vec.iv.val, val.val, AES_BLOCK_SIZE);</div>
<div class="line">                memcpy(vec.pt.val, prev_out, AES_BLOCK_SIZE);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                memcpy(vec.iv.val, prev_in, AES_BLOCK_SIZE);</div>
<div class="line">                memcpy(vec.ct.val, prev_out, AES_BLOCK_SIZE);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (j == AES_INTERN_ITER - 1)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            memcpy(prev_out, val.val, AES_BLOCK_SIZE);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        info.parse_writeback(&amp;val);</div>
<div class="line">        fprintf(info.fp_wr, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (i == AES_EXTERN_ITER - 1)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        memcpy(&amp;val_key, &amp;vec.cipher_auth.key, <span class="keyword">sizeof</span>(val_key));</div>
<div class="line">        <span class="keywordflow">for</span> (k = 0; k &lt; vec.cipher_auth.key.len; k++) {</div>
<div class="line">            <span class="keywordflow">switch</span> (vec.cipher_auth.key.len) {</div>
<div class="line">            <span class="keywordflow">case</span> 16:</div>
<div class="line">                val_key.val[k] ^= val.val[k];</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 24:</div>
<div class="line">                <span class="keywordflow">if</span> (k &lt; 8)</div>
<div class="line">                    val_key.val[k] ^= prev_out[k + 8];</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    val_key.val[k] ^= val.val[k - 8];</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 32:</div>
<div class="line">                <span class="keywordflow">if</span> (k &lt; 16)</div>
<div class="line">                    val_key.val[k] ^= prev_out[k];</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    val_key.val[k] ^= val.val[k - 16];</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (info.op == FIPS_TEST_DEC_AUTH_VERIF)</div>
<div class="line">            memcpy(vec.iv.val, val.val, AES_BLOCK_SIZE);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (val.val)</div>
<div class="line">        free(val.val);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">fips_mct_sha_test(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"><span class="preprocessor">#define SHA_EXTERN_ITER 100</span></div>
<div class="line"><span class="preprocessor">#define SHA_INTERN_ITER 1000</span></div>
<div class="line"><span class="preprocessor">#define SHA_MD_BLOCK    3</span></div>
<div class="line">    <span class="keyword">struct </span>fips_val val = {NULL, 0}, md[SHA_MD_BLOCK];</div>
<div class="line">    <span class="keywordtype">char</span> temp[MAX_DIGEST_SIZE*2];</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line">    uint32_t i, j;</div>
<div class="line"> </div>
<div class="line">    val.val = <a class="code" href="rte__malloc_8h.html#a247c99e8d36300c52729c9ee58c2b489">rte_malloc</a>(NULL, (MAX_DIGEST_SIZE*SHA_MD_BLOCK), 0);</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; SHA_MD_BLOCK; i++)</div>
<div class="line">        md[i].val = <a class="code" href="rte__malloc_8h.html#a247c99e8d36300c52729c9ee58c2b489">rte_malloc</a>(NULL, (MAX_DIGEST_SIZE*2), 0);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a1fc82f67711b13aca7e05dc9d58f9dbd">rte_free</a>(vec.pt.val);</div>
<div class="line">    vec.pt.val = <a class="code" href="rte__malloc_8h.html#a247c99e8d36300c52729c9ee58c2b489">rte_malloc</a>(NULL, (MAX_DIGEST_SIZE*SHA_MD_BLOCK), 0);</div>
<div class="line"> </div>
<div class="line">    fips_test_write_one_case();</div>
<div class="line">    fprintf(info.fp_wr, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (j = 0; j &lt; SHA_EXTERN_ITER; j++) {</div>
<div class="line"> </div>
<div class="line">        memcpy(md[0].val, vec.cipher_auth.digest.val,</div>
<div class="line">            vec.cipher_auth.digest.len);</div>
<div class="line">        md[0].len = vec.cipher_auth.digest.len;</div>
<div class="line">        memcpy(md[1].val, vec.cipher_auth.digest.val,</div>
<div class="line">            vec.cipher_auth.digest.len);</div>
<div class="line">        md[1].len = vec.cipher_auth.digest.len;</div>
<div class="line">        memcpy(md[2].val, vec.cipher_auth.digest.val,</div>
<div class="line">            vec.cipher_auth.digest.len);</div>
<div class="line">        md[2].len = vec.cipher_auth.digest.len;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; (SHA_INTERN_ITER); i++) {</div>
<div class="line"> </div>
<div class="line">            memcpy(vec.pt.val, md[0].val,</div>
<div class="line">                (<span class="keywordtype">size_t</span>)md[0].len);</div>
<div class="line">            memcpy((vec.pt.val + md[0].len), md[1].val,</div>
<div class="line">                (<span class="keywordtype">size_t</span>)md[1].len);</div>
<div class="line">            memcpy((vec.pt.val + md[0].len + md[1].len),</div>
<div class="line">                md[2].val,</div>
<div class="line">                (<span class="keywordtype">size_t</span>)md[2].len);</div>
<div class="line">            vec.pt.len = md[0].len + md[1].len + md[2].len;</div>
<div class="line"> </div>
<div class="line">            ret = fips_run_test();</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">                <span class="keywordflow">if</span> (ret == -EPERM || ret == -ENOTSUP) {</div>
<div class="line">                    fprintf(info.fp_wr, <span class="stringliteral">&quot;Bypass\n\n&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">return</span> ret;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            ret = get_writeback_data(&amp;val);</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">                <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">            memcpy(md[0].val, md[1].val, md[1].len);</div>
<div class="line">            md[0].len = md[1].len;</div>
<div class="line">            memcpy(md[1].val, md[2].val, md[2].len);</div>
<div class="line">            md[1].len = md[2].len;</div>
<div class="line"> </div>
<div class="line">            memcpy(md[2].val, (val.val + vec.pt.len),</div>
<div class="line">                vec.cipher_auth.digest.len);</div>
<div class="line">            md[2].len = vec.cipher_auth.digest.len;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        memcpy(vec.cipher_auth.digest.val, md[2].val, md[2].len);</div>
<div class="line">        vec.cipher_auth.digest.len = md[2].len;</div>
<div class="line"> </div>
<div class="line">        fprintf(info.fp_wr, <span class="stringliteral">&quot;COUNT = %u\n&quot;</span>, j);</div>
<div class="line"> </div>
<div class="line">        writeback_hex_str(<span class="stringliteral">&quot;&quot;</span>, temp, &amp;vec.cipher_auth.digest);</div>
<div class="line"> </div>
<div class="line">        fprintf(info.fp_wr, <span class="stringliteral">&quot;MD = %s\n\n&quot;</span>, temp);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; (SHA_MD_BLOCK); i++)</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a1fc82f67711b13aca7e05dc9d58f9dbd">rte_free</a>(md[i].val);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a1fc82f67711b13aca7e05dc9d58f9dbd">rte_free</a>(vec.pt.val);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (val.val)</div>
<div class="line">        free(val.val);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">init_test_ops(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">switch</span> (info.algo) {</div>
<div class="line">    <span class="keywordflow">case</span> FIPS_TEST_ALGO_AES:</div>
<div class="line">        test_ops.prepare_op = prepare_cipher_op;</div>
<div class="line">        test_ops.prepare_xform  = prepare_aes_xform;</div>
<div class="line">        <span class="keywordflow">if</span> (info.interim_info.aes_data.test_type == AESAVS_TYPE_MCT)</div>
<div class="line">            test_ops.test = fips_mct_aes_test;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            test_ops.test = fips_generic_test;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> FIPS_TEST_ALGO_HMAC:</div>
<div class="line">        test_ops.prepare_op = prepare_auth_op;</div>
<div class="line">        test_ops.prepare_xform = prepare_hmac_xform;</div>
<div class="line">        test_ops.test = fips_generic_test;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> FIPS_TEST_ALGO_TDES:</div>
<div class="line">        test_ops.prepare_op = prepare_cipher_op;</div>
<div class="line">        test_ops.prepare_xform  = prepare_tdes_xform;</div>
<div class="line">        <span class="keywordflow">if</span> (info.interim_info.tdes_data.test_type == TDES_MCT)</div>
<div class="line">            test_ops.test = fips_mct_tdes_test;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            test_ops.test = fips_generic_test;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> FIPS_TEST_ALGO_AES_GCM:</div>
<div class="line">        test_ops.prepare_op = prepare_aead_op;</div>
<div class="line">        test_ops.prepare_xform = prepare_gcm_xform;</div>
<div class="line">        test_ops.test = fips_generic_test;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> FIPS_TEST_ALGO_AES_CMAC:</div>
<div class="line">        test_ops.prepare_op = prepare_auth_op;</div>
<div class="line">        test_ops.prepare_xform = prepare_cmac_xform;</div>
<div class="line">        test_ops.test = fips_generic_test;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> FIPS_TEST_ALGO_AES_CCM:</div>
<div class="line">        test_ops.prepare_op = prepare_aead_op;</div>
<div class="line">        test_ops.prepare_xform = prepare_ccm_xform;</div>
<div class="line">        test_ops.test = fips_generic_test;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> FIPS_TEST_ALGO_SHA:</div>
<div class="line">        test_ops.prepare_op = prepare_auth_op;</div>
<div class="line">        test_ops.prepare_xform = prepare_sha_xform;</div>
<div class="line">        <span class="keywordflow">if</span> (info.interim_info.sha_data.test_type == SHA_MCT)</div>
<div class="line">            test_ops.test = fips_mct_sha_test;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            test_ops.test = fips_generic_test;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> FIPS_TEST_ALGO_AES_XTS:</div>
<div class="line">        test_ops.prepare_op = prepare_cipher_op;</div>
<div class="line">        test_ops.prepare_xform = prepare_xts_xform;</div>
<div class="line">        test_ops.test = fips_generic_test;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">        <span class="keywordflow">if</span> (strstr(info.file_name, <span class="stringliteral">&quot;TECB&quot;</span>) ||</div>
<div class="line">                strstr(info.file_name, <span class="stringliteral">&quot;TCBC&quot;</span>)) {</div>
<div class="line">            info.algo = FIPS_TEST_ALGO_TDES;</div>
<div class="line">            test_ops.prepare_op = prepare_cipher_op;</div>
<div class="line">            test_ops.prepare_xform  = prepare_tdes_xform;</div>
<div class="line">            <span class="keywordflow">if</span> (info.interim_info.tdes_data.test_type == TDES_MCT)</div>
<div class="line">                test_ops.test = fips_mct_tdes_test;</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                test_ops.test = fips_generic_test;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">print_test_block(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    uint32_t i;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; info.nb_vec_lines; i++)</div>
<div class="line">        printf(<span class="stringliteral">&quot;%s\n&quot;</span>, info.vec[i]);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">fips_test_one_file(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> fetch_ret = 0, ret;</div>
<div class="line"> </div>
<div class="line">    ret = init_test_ops();</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: Init test op\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (ret &gt;= 0 &amp;&amp; fetch_ret == 0) {</div>
<div class="line">        fetch_ret = fips_test_fetch_one_block();</div>
<div class="line">        <span class="keywordflow">if</span> (fetch_ret &lt; 0) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: Fetch block\n&quot;</span>,</div>
<div class="line">                    fetch_ret);</div>
<div class="line">            ret = fetch_ret;</div>
<div class="line">            <span class="keywordflow">goto</span> error_one_case;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (info.nb_vec_lines == 0) {</div>
<div class="line">            <span class="keywordflow">if</span> (fetch_ret == -EOF)</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">            fprintf(info.fp_wr, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        ret = fips_test_parse_one_case();</div>
<div class="line">        <span class="keywordflow">switch</span> (ret) {</div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">            ret = test_ops.test();</div>
<div class="line">            <span class="keywordflow">if</span> (ret == 0)</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: test block\n&quot;</span>,</div>
<div class="line">                    ret);</div>
<div class="line">            <span class="keywordflow">goto</span> error_one_case;</div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Error %i: Parse block\n&quot;</span>,</div>
<div class="line">                    ret);</div>
<div class="line">            <span class="keywordflow">goto</span> error_one_case;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">continue</span>;</div>
<div class="line">error_one_case:</div>
<div class="line">        print_test_block();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    fips_test_clear();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (env.digest)</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a1fc82f67711b13aca7e05dc9d58f9dbd">rte_free</a>(env.digest);</div>
<div class="line">    <span class="keywordflow">if</span> (env.mbuf)</div>
<div class="line">        <a class="code" href="rte__mbuf_8h.html#a1215458932900b7cd5192326fa4a6902">rte_pktmbuf_free</a>(env.mbuf);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="astructrte__mbuf_html_ac858fb3bb1a1d67a6efc9563d0c5a471"><div class="ttname"><a href="structrte__mbuf.html#ac858fb3bb1a1d67a6efc9563d0c5a471">rte_mbuf::next</a></div><div class="ttdeci">struct rte_mbuf * next</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00594">rte_mbuf_core.h:594</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a0032857587ce7e217b8c10ba392bef56"><div class="ttname"><a href="rte__cryptodev_8h.html#a0032857587ce7e217b8c10ba392bef56">rte_cryptodev_dequeue_burst</a></div><div class="ttdeci">static uint16_t rte_cryptodev_dequeue_burst(uint8_t dev_id, uint16_t qp_id, struct rte_crypto_op **ops, uint16_t nb_ops)</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00943">rte_cryptodev.h:943</a></div></div>
<div class="ttc" id="astructrte__cryptodev__info_html"><div class="ttname"><a href="structrte__cryptodev__info.html">rte_cryptodev_info</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00477">rte_cryptodev.h:477</a></div></div>
<div class="ttc" id="astructrte__crypto__sym__xform_html_a3f971d41f5862b2967c0598d5e78e1a6"><div class="ttname"><a href="structrte__crypto__sym__xform.html#a3f971d41f5862b2967c0598d5e78e1a6">rte_crypto_sym_xform::auth</a></div><div class="ttdeci">struct rte_crypto_auth_xform auth</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00548">rte_crypto_sym.h:550</a></div></div>
<div class="ttc" id="arte__mempool_8h_html_a35271bce2d546e116074803fd69376e9"><div class="ttname"><a href="rte__mempool_8h.html#a35271bce2d546e116074803fd69376e9">rte_mempool_free</a></div><div class="ttdeci">void rte_mempool_free(struct rte_mempool *mp)</div></div>
<div class="ttc" id="arte__malloc_8h_html_aaf0f048a5fd1672688c662cdfb4536b3"><div class="ttname"><a href="rte__malloc_8h.html#aaf0f048a5fd1672688c662cdfb4536b3">rte_zmalloc</a></div><div class="ttdeci">void * rte_zmalloc(const char *type, size_t size, unsigned align) __rte_alloc_size(2)</div></div>
<div class="ttc" id="astructrte__crypto__cipher__xform_html_ab8e313535343ba1b7b75ad16589de6c9"><div class="ttname"><a href="structrte__crypto__cipher__xform.html#ab8e313535343ba1b7b75ad16589de6c9">rte_crypto_cipher_xform::op</a></div><div class="ttdeci">enum rte_crypto_cipher_operation op</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00103">rte_crypto_sym.h:190</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a1e1336b0a8fe381ea03a52bad85e5734"><div class="ttname"><a href="rte__cryptodev_8h.html#a1e1336b0a8fe381ea03a52bad85e5734">rte_cryptodev_enqueue_burst</a></div><div class="ttdeci">static uint16_t rte_cryptodev_enqueue_burst(uint8_t dev_id, uint16_t qp_id, struct rte_crypto_op **ops, uint16_t nb_ops)</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00987">rte_cryptodev.h:987</a></div></div>
<div class="ttc" id="astructrte__cryptodev__sym__capability__idx_html"><div class="ttname"><a href="structrte__cryptodev__sym__capability__idx.html">rte_cryptodev_sym_capability_idx</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00192">rte_cryptodev.h:192</a></div></div>
<div class="ttc" id="astructrte__cryptodev__qp__conf_html_a39d13b64c531ebb44df1fab456d7a261"><div class="ttname"><a href="structrte__cryptodev__qp__conf.html#a39d13b64c531ebb44df1fab456d7a261">rte_cryptodev_qp_conf::mp_session_private</a></div><div class="ttdeci">struct rte_mempool * mp_session_private</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00521">rte_cryptodev.h:521</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a275814f8c016f661c72b320295d91793ae1c3a78693f23571875543835e02bd4d"><div class="ttname"><a href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793ae1c3a78693f23571875543835e02bd4d">RTE_CRYPTO_AUTH_AES_GMAC</a></div><div class="ttdeci">@ RTE_CRYPTO_AUTH_AES_GMAC</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00286">rte_crypto_sym.h:285</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a6e6d5d3329c585088678e9d52b50f75eab8a2eee308e346ed3b076e2d400615b2"><div class="ttname"><a href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eab8a2eee308e346ed3b076e2d400615b2">RTE_CRYPTO_CIPHER_3DES_ECB</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_3DES_ECB</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00124">rte_crypto_sym.h:123</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a648bc317af3ee238310fac9d87512508a27d121171b5e292d8a7313a38b91bf3e"><div class="ttname"><a href="rte__crypto__sym_8h.html#a648bc317af3ee238310fac9d87512508a27d121171b5e292d8a7313a38b91bf3e">RTE_CRYPTO_AEAD_AES_CCM</a></div><div class="ttdeci">@ RTE_CRYPTO_AEAD_AES_CCM</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00443">rte_crypto_sym.h:442</a></div></div>
<div class="ttc" id="astructrte__cryptodev_html"><div class="ttname"><a href="structrte__cryptodev.html">rte_cryptodev</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00843">rte_cryptodev.h:843</a></div></div>
<div class="ttc" id="astructrte__crypto__cipher__xform_html_a320b4b9a8f44fe20dcf27b2914a83145"><div class="ttname"><a href="structrte__crypto__cipher__xform.html#a320b4b9a8f44fe20dcf27b2914a83145">rte_crypto_cipher_xform::key</a></div><div class="ttdeci">struct rte_crypto_cipher_xform::@112 key</div></div>
<div class="ttc" id="arte__mempool_8h_html_a503f2f889043a48ca9995878846db2fd"><div class="ttname"><a href="rte__mempool_8h.html#a503f2f889043a48ca9995878846db2fd">rte_mempool_create</a></div><div class="ttdeci">struct rte_mempool * rte_mempool_create(const char *name, unsigned n, unsigned elt_size, unsigned cache_size, unsigned private_data_size, rte_mempool_ctor_t *mp_init, void *mp_init_arg, rte_mempool_obj_cb_t *obj_init, void *obj_init_arg, int socket_id, unsigned flags)</div></div>
<div class="ttc" id="arte__lcore_8h_html_a7c8da4664df26a64cf05dc508a4f26df"><div class="ttname"><a href="rte__lcore_8h.html#a7c8da4664df26a64cf05dc508a4f26df">rte_socket_id</a></div><div class="ttdeci">unsigned int rte_socket_id(void)</div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a6e6d5d3329c585088678e9d52b50f75ea4d25678e94b0dd7ecca1a80f518a6de7"><div class="ttname"><a href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ea4d25678e94b0dd7ecca1a80f518a6de7">RTE_CRYPTO_CIPHER_AES_XTS</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_AES_XTS</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00135">rte_crypto_sym.h:134</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_aeb677c03cea6fcc48a8caa533e3729f9"><div class="ttname"><a href="rte__cryptodev_8h.html#aeb677c03cea6fcc48a8caa533e3729f9">rte_cryptodev_info_get</a></div><div class="ttdeci">void rte_cryptodev_info_get(uint8_t dev_id, struct rte_cryptodev_info *dev_info)</div></div>
<div class="ttc" id="astructrte__crypto__auth__xform_html_a1892eba2086d12ac2b09005aeb09ea3b"><div class="ttname"><a href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">rte_crypto_auth_xform::length</a></div><div class="ttdeci">uint16_t length</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00375">rte_crypto_sym.h:375</a></div></div>
<div class="ttc" id="astructrte__crypto__cipher__xform_html_a23947db20adeb0a2e186dc618f645e44"><div class="ttname"><a href="structrte__crypto__cipher__xform.html#a23947db20adeb0a2e186dc618f645e44">rte_crypto_cipher_xform::algo</a></div><div class="ttdeci">enum rte_crypto_cipher_algorithm algo</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00103">rte_crypto_sym.h:195</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_aea2f599f2be3d8c139c57f98e0f0c9c1"><div class="ttname"><a href="rte__cryptodev_8h.html#aea2f599f2be3d8c139c57f98e0f0c9c1">rte_cryptodev_sym_capability_get</a></div><div class="ttdeci">const struct rte_cryptodev_symmetric_capability * rte_cryptodev_sym_capability_get(uint8_t dev_id, const struct rte_cryptodev_sym_capability_idx *idx)</div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a275814f8c016f661c72b320295d91793a8e54f987cb5414570bcc2c5f181cbfe2"><div class="ttname"><a href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793a8e54f987cb5414570bcc2c5f181cbfe2">RTE_CRYPTO_AUTH_AES_CMAC</a></div><div class="ttdeci">@ RTE_CRYPTO_AUTH_AES_CMAC</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00284">rte_crypto_sym.h:283</a></div></div>
<div class="ttc" id="astructrte__crypto__cipher__xform_html_a579f5164b5b16e18ddcdb0296ef81799"><div class="ttname"><a href="structrte__crypto__cipher__xform.html#a579f5164b5b16e18ddcdb0296ef81799">rte_crypto_cipher_xform::data</a></div><div class="ttdeci">const uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00199">rte_crypto_sym.h:199</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_ac86bc0178d39db9734c594c35f9aee4e"><div class="ttname"><a href="rte__cryptodev_8h.html#ac86bc0178d39db9734c594c35f9aee4e">rte_cryptodev_sym_session_pool_create</a></div><div class="ttdeci">__rte_experimental struct rte_mempool * rte_cryptodev_sym_session_pool_create(const char *name, uint32_t nb_elts, uint32_t elt_size, uint32_t cache_size, uint16_t priv_size, int socket_id)</div></div>
<div class="ttc" id="arte__crypto_8h_html_ae7fffda852cfcc8fb259eb8334c577ae"><div class="ttname"><a href="rte__crypto_8h.html#ae7fffda852cfcc8fb259eb8334c577ae">__rte_crypto_op_reset</a></div><div class="ttdeci">static void __rte_crypto_op_reset(struct rte_crypto_op *op, enum rte_crypto_op_type type)</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00134">rte_crypto.h:134</a></div></div>
<div class="ttc" id="arte__string__fns_8h_html"><div class="ttname"><a href="rte__string__fns_8h.html">rte_string_fns.h</a></div></div>
<div class="ttc" id="arte__malloc_8h_html_a9fa8949fa521967981829b2afe40702b"><div class="ttname"><a href="rte__malloc_8h.html#a9fa8949fa521967981829b2afe40702b">rte_malloc_virt2iova</a></div><div class="ttdeci">rte_iova_t rte_malloc_virt2iova(const void *addr)</div></div>
<div class="ttc" id="arte__cryptodev_8h_html_ad11f75024b43932a55bae067e92d718a"><div class="ttname"><a href="rte__cryptodev_8h.html#ad11f75024b43932a55bae067e92d718a">rte_cryptodev_sym_capability_check_cipher</a></div><div class="ttdeci">int rte_cryptodev_sym_capability_check_cipher(const struct rte_cryptodev_symmetric_capability *capability, uint16_t key_size, uint16_t iv_size)</div></div>
<div class="ttc" id="astructrte__mbuf_html_ad1a572736a10ff6b282c5f43c4ea1ccf"><div class="ttname"><a href="structrte__mbuf.html#ad1a572736a10ff6b282c5f43c4ea1ccf">rte_mbuf::data_len</a></div><div class="ttdeci">uint16_t data_len</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00546">rte_mbuf_core.h:546</a></div></div>
<div class="ttc" id="arte__crypto_8h_html_aa3035c7b271a4736dc9654b2eb85d1fd"><div class="ttname"><a href="rte__crypto_8h.html#aa3035c7b271a4736dc9654b2eb85d1fd">rte_crypto_op_pool_create</a></div><div class="ttdeci">struct rte_mempool * rte_crypto_op_pool_create(const char *name, enum rte_crypto_op_type type, unsigned nb_elts, unsigned cache_size, uint16_t priv_size, int socket_id)</div></div>
<div class="ttc" id="arte__cryptodev_8h_html"><div class="ttname"><a href="rte__cryptodev_8h.html">rte_cryptodev.h</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_ae4388e0326c8789ddf39e32044dc4187"><div class="ttname"><a href="rte__cryptodev_8h.html#ae4388e0326c8789ddf39e32044dc4187">rte_cryptodev_queue_pair_setup</a></div><div class="ttdeci">int rte_cryptodev_queue_pair_setup(uint8_t dev_id, uint16_t queue_pair_id, const struct rte_cryptodev_qp_conf *qp_conf, int socket_id)</div></div>
<div class="ttc" id="astructrte__crypto__sym__op_html_ac8e4b59a436a743849b7116e8a3d135c"><div class="ttname"><a href="structrte__crypto__sym__op.html#ac8e4b59a436a743849b7116e8a3d135c">rte_crypto_sym_op::xform</a></div><div class="ttdeci">struct rte_crypto_sym_xform * xform</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00599">rte_crypto_sym.h:599</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_aa21ba0affdc8a7a267c879fb5599a57ea80f5756a76a8c903cc56a3b475576e2c"><div class="ttname"><a href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57ea80f5756a76a8c903cc56a3b475576e2c">RTE_CRYPTO_AEAD_OP_ENCRYPT</a></div><div class="ttdeci">@ RTE_CRYPTO_AEAD_OP_ENCRYPT</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00457">rte_crypto_sym.h:456</a></div></div>
<div class="ttc" id="astructrte__cryptodev__qp__conf_html"><div class="ttname"><a href="structrte__cryptodev__qp__conf.html">rte_cryptodev_qp_conf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00517">rte_cryptodev.h:517</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_af52dbeb3951f5b90259d3760128ee139"><div class="ttname"><a href="rte__mbuf_8h.html#af52dbeb3951f5b90259d3760128ee139">rte_pktmbuf_chain</a></div><div class="ttdeci">static int rte_pktmbuf_chain(struct rte_mbuf *head, struct rte_mbuf *tail)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01747">rte_mbuf.h:1747</a></div></div>
<div class="ttc" id="astructrte__mbuf_html"><div class="ttname"><a href="structrte__mbuf.html">rte_mbuf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00473">rte_mbuf_core.h:473</a></div></div>
<div class="ttc" id="astructrte__crypto__op_html"><div class="ttname"><a href="structrte__crypto__op.html">rte_crypto_op</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00078">rte_crypto.h:78</a></div></div>
<div class="ttc" id="astructrte__crypto__sym__op_html_af021669494a2806b0569587e2096e88e"><div class="ttname"><a href="structrte__crypto__sym__op.html#af021669494a2806b0569587e2096e88e">rte_crypto_sym_op::m_src</a></div><div class="ttdeci">struct rte_mbuf * m_src</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00592">rte_crypto_sym.h:592</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a8998669d6c958fb1f0e31eeee515dd47a99f910b408b48db113988c3b841972b9"><div class="ttname"><a href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47a99f910b408b48db113988c3b841972b9">RTE_CRYPTO_AUTH_OP_VERIFY</a></div><div class="ttdeci">@ RTE_CRYPTO_AUTH_OP_VERIFY</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00352">rte_crypto_sym.h:352</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_a7a7ea614c79d5b9ed790a56c1c79189d"><div class="ttname"><a href="rte__mbuf_8h.html#a7a7ea614c79d5b9ed790a56c1c79189d">rte_pktmbuf_pkt_len</a></div><div class="ttdeci">#define rte_pktmbuf_pkt_len(m)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01545">rte_mbuf.h:1545</a></div></div>
<div class="ttc" id="astructrte__crypto__auth__xform_html_a8e2f80c0b35f9851e755100ea1e8db95"><div class="ttname"><a href="structrte__crypto__auth__xform.html#a8e2f80c0b35f9851e755100ea1e8db95">rte_crypto_auth_xform::op</a></div><div class="ttdeci">enum rte_crypto_auth_operation op</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00252">rte_crypto_sym.h:368</a></div></div>
<div class="ttc" id="arte__malloc_8h_html_a247c99e8d36300c52729c9ee58c2b489"><div class="ttname"><a href="rte__malloc_8h.html#a247c99e8d36300c52729c9ee58c2b489">rte_malloc</a></div><div class="ttdeci">void * rte_malloc(const char *type, size_t size, unsigned align) __rte_alloc_size(2)</div></div>
<div class="ttc" id="arte__common_8h_html_ac5169870c983b3463cb226bdb8a94880"><div class="ttname"><a href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a></div><div class="ttdeci">__rte_noreturn void rte_exit(int exit_code, const char *format,...) __rte_format_printf(2</div></div>
<div class="ttc" id="arte__crypto_8h_html_affaf4fd29a51d350b387155494402a84"><div class="ttname"><a href="rte__crypto_8h.html#affaf4fd29a51d350b387155494402a84">rte_crypto_op_attach_sym_session</a></div><div class="ttdeci">static int rte_crypto_op_attach_sym_session(struct rte_crypto_op *op, struct rte_cryptodev_sym_session *sess)</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00412">rte_crypto.h:412</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a6e6d5d3329c585088678e9d52b50f75ead9f8e28815f3dd2b77e7ce93b7b8a7ca"><div class="ttname"><a href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ead9f8e28815f3dd2b77e7ce93b7b8a7ca">RTE_CRYPTO_CIPHER_AES_CBC</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_AES_CBC</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00127">rte_crypto_sym.h:126</a></div></div>
<div class="ttc" id="astructrte__crypto__auth__xform_html_a3de186f0ec180eb92911f6d723617b6c"><div class="ttname"><a href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">rte_crypto_auth_xform::key</a></div><div class="ttdeci">struct rte_crypto_auth_xform::@114 key</div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a6e6d5d3329c585088678e9d52b50f75eaf7d6407f595eafe9d16b372e7d256f9e"><div class="ttname"><a href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eaf7d6407f595eafe9d16b372e7d256f9e">RTE_CRYPTO_CIPHER_AES_ECB</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_AES_ECB</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00131">rte_crypto_sym.h:130</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_aa729e554cbafb168eff86f99f9ea518a"><div class="ttname"><a href="rte__cryptodev_8h.html#aa729e554cbafb168eff86f99f9ea518a">rte_cryptodev_sym_session_clear</a></div><div class="ttdeci">int rte_cryptodev_sym_session_clear(uint8_t dev_id, struct rte_cryptodev_sym_session *sess)</div></div>
<div class="ttc" id="arte__cryptodev_8h_html_af91b263a2a66ca15680cb4367c7b8f0e"><div class="ttname"><a href="rte__cryptodev_8h.html#af91b263a2a66ca15680cb4367c7b8f0e">rte_cryptodev_sym_session_free</a></div><div class="ttdeci">int rte_cryptodev_sym_session_free(struct rte_cryptodev_sym_session *sess)</div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a58207367533ac9e65e4a611ba78090e5"><div class="ttname"><a href="rte__cryptodev_8h.html#a58207367533ac9e65e4a611ba78090e5">rte_cryptodev_configure</a></div><div class="ttdeci">int rte_cryptodev_configure(uint8_t dev_id, struct rte_cryptodev_config *config)</div></div>
<div class="ttc" id="arte__common_8h_html_a4c7571cbcdbfe9b63431036af811bee9"><div class="ttname"><a href="rte__common_8h.html#a4c7571cbcdbfe9b63431036af811bee9">RTE_MIN</a></div><div class="ttdeci">#define RTE_MIN(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00573">rte_common.h:573</a></div></div>
<div class="ttc" id="astructrte__crypto__cipher__xform_html_ac681806181c80437cfab37335f62ff39"><div class="ttname"><a href="structrte__crypto__cipher__xform.html#ac681806181c80437cfab37335f62ff39">rte_crypto_cipher_xform::offset</a></div><div class="ttdeci">uint16_t offset</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00226">rte_crypto_sym.h:226</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_ad5b0cd686ad3bcbb83416ca8395a080b"><div class="ttname"><a href="rte__mbuf_8h.html#ad5b0cd686ad3bcbb83416ca8395a080b">rte_pktmbuf_append</a></div><div class="ttdeci">static char * rte_pktmbuf_append(struct rte_mbuf *m, uint16_t len)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01605">rte_mbuf.h:1605</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_a2a8b10263496c7b580e9d0c7f2a1f073"><div class="ttname"><a href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a></div><div class="ttdeci">#define rte_pktmbuf_mtod(m, t)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00726">rte_mbuf_core.h:726</a></div></div>
<div class="ttc" id="astructrte__crypto__cipher__xform_html_a1892eba2086d12ac2b09005aeb09ea3b"><div class="ttname"><a href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">rte_crypto_cipher_xform::length</a></div><div class="ttdeci">uint16_t length</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00200">rte_crypto_sym.h:200</a></div></div>
<div class="ttc" id="astructrte__crypto__cipher__xform_html"><div class="ttname"><a href="structrte__crypto__cipher__xform.html">rte_crypto_cipher_xform</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00189">rte_crypto_sym.h:189</a></div></div>
<div class="ttc" id="arte__cryptodev__pmd_8h_html_abf0b16359e5f1d85737ff72ee6440990"><div class="ttname"><a href="rte__cryptodev__pmd_8h.html#abf0b16359e5f1d85737ff72ee6440990">rte_cryptodev_pmd_is_valid_dev</a></div><div class="ttdeci">unsigned int rte_cryptodev_pmd_is_valid_dev(uint8_t dev_id)</div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a34a54ae38920d21d95aa6049640e8c0e"><div class="ttname"><a href="rte__cryptodev_8h.html#a34a54ae38920d21d95aa6049640e8c0e">rte_cryptodev_sym_get_private_session_size</a></div><div class="ttdeci">unsigned int rte_cryptodev_sym_get_private_session_size(uint8_t dev_id)</div></div>
<div class="ttc" id="arte__cryptodev_8h_html_ad40470ee7e072f93f85f1bb584e64e39"><div class="ttname"><a href="rte__cryptodev_8h.html#ad40470ee7e072f93f85f1bb584e64e39">rte_cryptodev_sym_session_create</a></div><div class="ttdeci">struct rte_cryptodev_sym_session * rte_cryptodev_sym_session_create(struct rte_mempool *mempool)</div></div>
<div class="ttc" id="arte__cryptodev__pmd_8h_html_aa040dd660348ff2ec55ea08194e1fec9"><div class="ttname"><a href="rte__cryptodev__pmd_8h.html#aa040dd660348ff2ec55ea08194e1fec9">rte_cryptodev_pmd_get_dev</a></div><div class="ttdeci">struct rte_cryptodev * rte_cryptodev_pmd_get_dev(uint8_t dev_id)</div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a3b05f51fd91ec181c369e32908d55717"><div class="ttname"><a href="rte__cryptodev_8h.html#a3b05f51fd91ec181c369e32908d55717">rte_cryptodev_sym_session_init</a></div><div class="ttdeci">int rte_cryptodev_sym_session_init(uint8_t dev_id, struct rte_cryptodev_sym_session *sess, struct rte_crypto_sym_xform *xforms, struct rte_mempool *mempool)</div></div>
<div class="ttc" id="astructrte__crypto__sym__xform_html_afe8d3d45863238a8b9d868967071061c"><div class="ttname"><a href="structrte__crypto__sym__xform.html#afe8d3d45863238a8b9d868967071061c">rte_crypto_sym_xform::aead</a></div><div class="ttdeci">struct rte_crypto_aead_xform aead</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00548">rte_crypto_sym.h:554</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a4c4acd655062a7195c722948d93c22c4"><div class="ttname"><a href="rte__cryptodev_8h.html#a4c4acd655062a7195c722948d93c22c4">RTE_CRYPTODEV_FF_IN_PLACE_SGL</a></div><div class="ttdeci">#define RTE_CRYPTODEV_FF_IN_PLACE_SGL</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00425">rte_cryptodev.h:422</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_ac02d0b6d3234564763e8395b3e9e3ea6"><div class="ttname"><a href="rte__cryptodev_8h.html#ac02d0b6d3234564763e8395b3e9e3ea6">rte_cryptodev_sym_capability_check_aead</a></div><div class="ttdeci">int rte_cryptodev_sym_capability_check_aead(const struct rte_cryptodev_symmetric_capability *capability, uint16_t key_size, uint16_t digest_size, uint16_t aad_size, uint16_t iv_size)</div></div>
<div class="ttc" id="astructrte__crypto__sym__xform_html"><div class="ttname"><a href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00543">rte_crypto_sym.h:543</a></div></div>
<div class="ttc" id="arte__eal_8h_html_a5c3f4dddc25e38c5a186ecd8a69260e3"><div class="ttname"><a href="rte__eal_8h.html#a5c3f4dddc25e38c5a186ecd8a69260e3">rte_eal_init</a></div><div class="ttdeci">int rte_eal_init(int argc, char **argv)</div></div>
<div class="ttc" id="astructrte__crypto__auth__xform_html_a765cf2674d1c06ca36503b60c24c6b34"><div class="ttname"><a href="structrte__crypto__auth__xform.html#a765cf2674d1c06ca36503b60c24c6b34">rte_crypto_auth_xform::digest_length</a></div><div class="ttdeci">uint16_t digest_length</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00421">rte_crypto_sym.h:421</a></div></div>
<div class="ttc" id="astructrte__mempool_html"><div class="ttname"><a href="structrte__mempool.html">rte_mempool</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__mempool_8h_source.html#l00207">rte_mempool.h:207</a></div></div>
<div class="ttc" id="astructrte__crypto__auth__xform_html"><div class="ttname"><a href="structrte__crypto__auth__xform.html">rte_crypto_auth_xform</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00367">rte_crypto_sym.h:367</a></div></div>
<div class="ttc" id="astructrte__crypto__auth__xform_html_ae4d1b05e299eae17c0c2ea8ba1dddb1d"><div class="ttname"><a href="structrte__crypto__auth__xform.html#ae4d1b05e299eae17c0c2ea8ba1dddb1d">rte_crypto_auth_xform::iv</a></div><div class="ttdeci">struct rte_crypto_auth_xform::@115 iv</div></div>
<div class="ttc" id="arte__mbuf_8h_html_a593921f13307803b94bbb4e0932db962"><div class="ttname"><a href="rte__mbuf_8h.html#a593921f13307803b94bbb4e0932db962">rte_pktmbuf_pool_create</a></div><div class="ttdeci">struct rte_mempool * rte_pktmbuf_pool_create(const char *name, unsigned n, unsigned cache_size, uint16_t priv_size, uint16_t data_room_size, int socket_id)</div></div>
<div class="ttc" id="arte__crypto_8h_html_ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc"><div class="ttname"><a href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc">RTE_CRYPTO_OP_TYPE_SYMMETRIC</a></div><div class="ttdeci">@ RTE_CRYPTO_OP_TYPE_SYMMETRIC</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00033">rte_crypto.h:32</a></div></div>
<div class="ttc" id="astructrte__crypto__sym__xform_html_a714d838357b795dd999dc8de04f1c7f4"><div class="ttname"><a href="structrte__crypto__sym__xform.html#a714d838357b795dd999dc8de04f1c7f4">rte_crypto_sym_xform::type</a></div><div class="ttdeci">enum rte_crypto_sym_xform_type type</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00544">rte_crypto_sym.h:546</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a648bc317af3ee238310fac9d87512508ab8b38d7173d30b7adf47116abb09c469"><div class="ttname"><a href="rte__crypto__sym_8h.html#a648bc317af3ee238310fac9d87512508ab8b38d7173d30b7adf47116abb09c469">RTE_CRYPTO_AEAD_AES_GCM</a></div><div class="ttdeci">@ RTE_CRYPTO_AEAD_AES_GCM</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00445">rte_crypto_sym.h:444</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9"><div class="ttname"><a href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9">RTE_CRYPTO_SYM_XFORM_AUTH</a></div><div class="ttdeci">@ RTE_CRYPTO_SYM_XFORM_AUTH</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00529">rte_crypto_sym.h:529</a></div></div>
<div class="ttc" id="astructrte__cryptodev__sym__session_html"><div class="ttname"><a href="structrte__cryptodev__sym__session.html">rte_cryptodev_sym_session</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l01002">rte_cryptodev.h:1002</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_a1215458932900b7cd5192326fa4a6902"><div class="ttname"><a href="rte__mbuf_8h.html#a1215458932900b7cd5192326fa4a6902">rte_pktmbuf_free</a></div><div class="ttdeci">static void rte_pktmbuf_free(struct rte_mbuf *m)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01397">rte_mbuf.h:1397</a></div></div>
<div class="ttc" id="arte__mempool_8h_html"><div class="ttname"><a href="rte__mempool_8h.html">rte_mempool.h</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c"><div class="ttname"><a href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c">RTE_CRYPTO_SYM_XFORM_CIPHER</a></div><div class="ttdeci">@ RTE_CRYPTO_SYM_XFORM_CIPHER</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00530">rte_crypto_sym.h:530</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a9aa918a5f6b561c0df3df2cdd65b7298"><div class="ttname"><a href="rte__cryptodev_8h.html#a9aa918a5f6b561c0df3df2cdd65b7298">rte_cryptodev_name_get</a></div><div class="ttdeci">const char * rte_cryptodev_name_get(uint8_t dev_id)</div></div>
<div class="ttc" id="arte__cryptodev_8h_html_aa2fc5b92f8ba59be669061e31d783fb2"><div class="ttname"><a href="rte__cryptodev_8h.html#aa2fc5b92f8ba59be669061e31d783fb2">rte_cryptodev_get_dev_id</a></div><div class="ttdeci">int rte_cryptodev_get_dev_id(const char *name)</div></div>
<div class="ttc" id="arte__log_8h_html_ac23caeb9833fd0fd0665c6c05ec806fe"><div class="ttname"><a href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a></div><div class="ttdeci">#define RTE_LOG(l, t,...)</div><div class="ttdef"><b>Definition:</b> <a href="rte__log_8h_source.html#l00331">rte_log.h:331</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html"><div class="ttname"><a href="rte__mbuf_8h.html">rte_mbuf.h</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_aa21ba0affdc8a7a267c879fb5599a57ea331ebd5a481118673489e7c580530179"><div class="ttname"><a href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57ea331ebd5a481118673489e7c580530179">RTE_CRYPTO_AEAD_OP_DECRYPT</a></div><div class="ttdeci">@ RTE_CRYPTO_AEAD_OP_DECRYPT</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00460">rte_crypto_sym.h:458</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a3c203be2dfa1c228cc8ccf0644422321a74a31028a7180f96bcbe6c1edc298c5b"><div class="ttname"><a href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321a74a31028a7180f96bcbe6c1edc298c5b">RTE_CRYPTO_CIPHER_OP_ENCRYPT</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_OP_ENCRYPT</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00174">rte_crypto_sym.h:173</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a3c203be2dfa1c228cc8ccf0644422321a4ec0ce9be05fae0758c95aadfb03c4ee"><div class="ttname"><a href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321a4ec0ce9be05fae0758c95aadfb03c4ee">RTE_CRYPTO_CIPHER_OP_DECRYPT</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_OP_DECRYPT</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00177">rte_crypto_sym.h:175</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a6e6d5d3329c585088678e9d52b50f75eaed8720577f149444ab479ee7415dbfb2"><div class="ttname"><a href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eaed8720577f149444ab479ee7415dbfb2">RTE_CRYPTO_CIPHER_3DES_CBC</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_3DES_CBC</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00120">rte_crypto_sym.h:119</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a46aecd6ebcceea1eba91d16a90e76782a87d8d14b56f41d42ca643d33a279912a"><div class="ttname"><a href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a87d8d14b56f41d42ca643d33a279912a">RTE_CRYPTO_SYM_XFORM_AEAD</a></div><div class="ttdeci">@ RTE_CRYPTO_SYM_XFORM_AEAD</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00532">rte_crypto_sym.h:531</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_a6023553536ea8c463fb703ac2437fa58"><div class="ttname"><a href="rte__mbuf__core_8h.html#a6023553536ea8c463fb703ac2437fa58">RTE_MBUF_MAX_NB_SEGS</a></div><div class="ttdeci">#define RTE_MBUF_MAX_NB_SEGS</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00665">rte_mbuf_core.h:665</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_aecf8ad2a113d395767f5b6cea89f3ee2"><div class="ttname"><a href="rte__cryptodev_8h.html#aecf8ad2a113d395767f5b6cea89f3ee2">rte_crypto_op_ctod_offset</a></div><div class="ttdeci">#define rte_crypto_op_ctod_offset(c, t, o)</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00066">rte_cryptodev.h:66</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a1a0c23adc25339b56bd19242194a002f"><div class="ttname"><a href="rte__cryptodev_8h.html#a1a0c23adc25339b56bd19242194a002f">rte_cryptodev_count</a></div><div class="ttdeci">uint8_t rte_cryptodev_count(void)</div></div>
<div class="ttc" id="arte__crypto_8h_html_a9c2eeaf1fa1cc3e1f4508eeee1b8c4d7"><div class="ttname"><a href="rte__crypto_8h.html#a9c2eeaf1fa1cc3e1f4508eeee1b8c4d7">rte_crypto_op_alloc</a></div><div class="ttdeci">static struct rte_crypto_op * rte_crypto_op_alloc(struct rte_mempool *mempool, enum rte_crypto_op_type type)</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00246">rte_crypto.h:246</a></div></div>
<div class="ttc" id="arte__cryptodev__pmd_8h_html"><div class="ttname"><a href="rte__cryptodev__pmd_8h.html">rte_cryptodev_pmd.h</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_a2a1e1b30162161ed11d3ba2faf7bbf13"><div class="ttname"><a href="rte__mbuf_8h.html#a2a1e1b30162161ed11d3ba2faf7bbf13">rte_pktmbuf_data_len</a></div><div class="ttdeci">#define rte_pktmbuf_data_len(m)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01555">rte_mbuf.h:1555</a></div></div>
<div class="ttc" id="astructrte__crypto__auth__xform_html_a00412ca4847e32cce6759541ca06ca86"><div class="ttname"><a href="structrte__crypto__auth__xform.html#a00412ca4847e32cce6759541ca06ca86">rte_crypto_auth_xform::algo</a></div><div class="ttdeci">enum rte_crypto_auth_algorithm algo</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00252">rte_crypto_sym.h:370</a></div></div>
<div class="ttc" id="astructrte__crypto__sym__xform_html_ac50ef6f5e9722a6125cad8e2547c9847"><div class="ttname"><a href="structrte__crypto__sym__xform.html#ac50ef6f5e9722a6125cad8e2547c9847">rte_crypto_sym_xform::cipher</a></div><div class="ttdeci">struct rte_crypto_cipher_xform cipher</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00548">rte_crypto_sym.h:552</a></div></div>
<div class="ttc" id="astructrte__cryptodev__qp__conf_html_a661ccdf79af65025fe9bde05b60ef9ca"><div class="ttname"><a href="structrte__cryptodev__qp__conf.html#a661ccdf79af65025fe9bde05b60ef9ca">rte_cryptodev_qp_conf::mp_session</a></div><div class="ttdeci">struct rte_mempool * mp_session</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00519">rte_cryptodev.h:519</a></div></div>
<div class="ttc" id="arte__malloc_8h_html_a1fc82f67711b13aca7e05dc9d58f9dbd"><div class="ttname"><a href="rte__malloc_8h.html#a1fc82f67711b13aca7e05dc9d58f9dbd">rte_free</a></div><div class="ttdeci">void void rte_free(void *ptr)</div></div>
<div class="ttc" id="astructrte__crypto__auth__xform_html_a579f5164b5b16e18ddcdb0296ef81799"><div class="ttname"><a href="structrte__crypto__auth__xform.html#a579f5164b5b16e18ddcdb0296ef81799">rte_crypto_auth_xform::data</a></div><div class="ttdeci">const uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00374">rte_crypto_sym.h:374</a></div></div>
<div class="ttc" id="astructrte__cryptodev__config_html"><div class="ttname"><a href="structrte__cryptodev__config.html">rte_cryptodev_config</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00628">rte_cryptodev.h:628</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a8998669d6c958fb1f0e31eeee515dd47aa4697c029df30850f9f01b1c641aca32"><div class="ttname"><a href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47aa4697c029df30850f9f01b1c641aca32">RTE_CRYPTO_AUTH_OP_GENERATE</a></div><div class="ttdeci">@ RTE_CRYPTO_AUTH_OP_GENERATE</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00354">rte_crypto_sym.h:353</a></div></div>
<div class="ttc" id="arte__crypto_8h_html_aca76406e3f1ab04ab44dfbe4ff26f4ba"><div class="ttname"><a href="rte__crypto_8h.html#aca76406e3f1ab04ab44dfbe4ff26f4ba">rte_crypto_op_free</a></div><div class="ttdeci">static void rte_crypto_op_free(struct rte_crypto_op *op)</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00334">rte_crypto.h:334</a></div></div>
<div class="ttc" id="astructrte__crypto__cipher__xform_html_abfc0b8c122ad81aec569d93a5eea0fe4"><div class="ttname"><a href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">rte_crypto_cipher_xform::iv</a></div><div class="ttdeci">struct rte_crypto_cipher_xform::@113 iv</div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a52884dfa1aa89cc83c879d5e8620e6eb"><div class="ttname"><a href="rte__cryptodev_8h.html#a52884dfa1aa89cc83c879d5e8620e6eb">rte_cryptodev_sym_capability_check_auth</a></div><div class="ttdeci">int rte_cryptodev_sym_capability_check_auth(const struct rte_cryptodev_symmetric_capability *capability, uint16_t key_size, uint16_t digest_size, uint16_t iv_size)</div></div>
<div class="ttc" id="astructrte__cryptodev__symmetric__capability_html"><div class="ttname"><a href="structrte__cryptodev__symmetric__capability.html">rte_cryptodev_symmetric_capability</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00100">rte_cryptodev.h:100</a></div></div>
<div class="ttc" id="astructrte__crypto__sym__op_html"><div class="ttname"><a href="structrte__crypto__sym__op.html">rte_crypto_sym_op</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00591">rte_crypto_sym.h:591</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_ad4d1c289d8cffc831dfb77c64f52447b"><div class="ttname"><a href="rte__mbuf_8h.html#ad4d1c289d8cffc831dfb77c64f52447b">rte_pktmbuf_alloc</a></div><div class="ttdeci">static struct rte_mbuf * rte_pktmbuf_alloc(struct rte_mempool *mp)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l00892">rte_mbuf.h:892</a></div></div>
<div class="ttc" id="astructrte__crypto__auth__xform_html_ac681806181c80437cfab37335f62ff39"><div class="ttname"><a href="structrte__crypto__auth__xform.html#ac681806181c80437cfab37335f62ff39">rte_crypto_auth_xform::offset</a></div><div class="ttdeci">uint16_t offset</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00385">rte_crypto_sym.h:385</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
