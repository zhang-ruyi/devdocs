<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DPDK: examples/ipsec-secgw/ipsec.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DPDK
   &#160;<span id="projectnumber">20.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">examples/ipsec-secgw/ipsec.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/* SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment"> * Copyright(c) 2016-2020 Intel Corporation</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/types.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;netinet/in.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;netinet/ip.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__branch__prediction_8h.html">rte_branch_prediction.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__log_8h.html">rte_log.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__crypto_8h.html">rte_crypto.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__security_8h.html">rte_security.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__cryptodev_8h.html">rte_cryptodev.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ipsec_8h.html">rte_ipsec.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ethdev_8h.html">rte_ethdev.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__mbuf_8h.html">rte_mbuf.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__hash_8h.html">rte_hash.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;ipsec.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;esp.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">set_ipsec_conf(<span class="keyword">struct</span> ipsec_sa *sa, <span class="keyword">struct</span> <a name="_a0"></a><a class="code" href="structrte__security__ipsec__xform.html">rte_security_ipsec_xform</a> *ipsec)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (ipsec-&gt;<a name="a1"></a><a class="code" href="structrte__security__ipsec__xform.html#acd1593fa6d838e374ca05311b4efd081">mode</a> == <a name="a2"></a><a class="code" href="rte__security_8h.html#a90a4754d59edd1bf3fbb81ddd6797ddda8360104a6e33ebeaa833f964492577ec">RTE_SECURITY_IPSEC_SA_MODE_TUNNEL</a>) {</div>
<div class="line">        <span class="keyword">struct </span><a name="_a3"></a><a class="code" href="structrte__security__ipsec__tunnel__param.html">rte_security_ipsec_tunnel_param</a> *tunnel =</div>
<div class="line">                &amp;ipsec-&gt;<a name="a4"></a><a class="code" href="structrte__security__ipsec__xform.html#a09effbe0c0a82be53c6c1023766d519a">tunnel</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (IS_IP4_TUNNEL(sa-&gt;flags)) {</div>
<div class="line">            tunnel-&gt;<a name="a5"></a><a class="code" href="structrte__security__ipsec__tunnel__param.html#a5dc131a2f6854751b5cf4120e724fe75">type</a> =</div>
<div class="line">                <a name="a6"></a><a class="code" href="rte__security_8h.html#afc6cccf055ce77715c4cb2d3ba3cd56da8d7464f943785202f18983676e659492">RTE_SECURITY_IPSEC_TUNNEL_IPV4</a>;</div>
<div class="line">            tunnel-&gt;<a name="a7"></a><a class="code" href="structrte__security__ipsec__tunnel__param.html#a8318aa6e744551b298a68ebb3122e20b">ipv4</a>.ttl = IPDEFTTL;</div>
<div class="line"> </div>
<div class="line">            memcpy((uint8_t *)&amp;tunnel-&gt;<a class="code" href="structrte__security__ipsec__tunnel__param.html#a8318aa6e744551b298a68ebb3122e20b">ipv4</a>.src_ip,</div>
<div class="line">                (uint8_t *)&amp;sa-&gt;src.ip.ip4, 4);</div>
<div class="line"> </div>
<div class="line">            memcpy((uint8_t *)&amp;tunnel-&gt;<a class="code" href="structrte__security__ipsec__tunnel__param.html#a8318aa6e744551b298a68ebb3122e20b">ipv4</a>.dst_ip,</div>
<div class="line">                (uint8_t *)&amp;sa-&gt;dst.ip.ip4, 4);</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IS_IP6_TUNNEL(sa-&gt;flags)) {</div>
<div class="line">            tunnel-&gt;<a class="code" href="structrte__security__ipsec__tunnel__param.html#a5dc131a2f6854751b5cf4120e724fe75">type</a> =</div>
<div class="line">                <a name="a8"></a><a class="code" href="rte__security_8h.html#afc6cccf055ce77715c4cb2d3ba3cd56da130fadc098deccd221f4ec369f8aeabe">RTE_SECURITY_IPSEC_TUNNEL_IPV6</a>;</div>
<div class="line">            tunnel-&gt;<a name="a9"></a><a class="code" href="structrte__security__ipsec__tunnel__param.html#a3ba6c20a9ae78d30229311bec9c6ba74">ipv6</a>.hlimit = IPDEFTTL;</div>
<div class="line">            tunnel-&gt;<a class="code" href="structrte__security__ipsec__tunnel__param.html#a3ba6c20a9ae78d30229311bec9c6ba74">ipv6</a>.dscp = 0;</div>
<div class="line">            tunnel-&gt;<a class="code" href="structrte__security__ipsec__tunnel__param.html#a3ba6c20a9ae78d30229311bec9c6ba74">ipv6</a>.flabel = 0;</div>
<div class="line"> </div>
<div class="line">            memcpy((uint8_t *)&amp;tunnel-&gt;<a class="code" href="structrte__security__ipsec__tunnel__param.html#a3ba6c20a9ae78d30229311bec9c6ba74">ipv6</a>.src_addr,</div>
<div class="line">                (uint8_t *)&amp;sa-&gt;src.ip.ip6.ip6_b, 16);</div>
<div class="line"> </div>
<div class="line">            memcpy((uint8_t *)&amp;tunnel-&gt;<a class="code" href="structrte__security__ipsec__tunnel__param.html#a3ba6c20a9ae78d30229311bec9c6ba74">ipv6</a>.dst_addr,</div>
<div class="line">                (uint8_t *)&amp;sa-&gt;dst.ip.ip6.ip6_b, 16);</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/* TODO support for Transport */</span></div>
<div class="line">    }</div>
<div class="line">    ipsec-&gt;<a name="a10"></a><a class="code" href="structrte__security__ipsec__xform.html#a5a6fb8c5d2a3299f6df0ba509a3aaf53">esn_soft_limit</a> = IPSEC_OFFLOAD_ESN_SOFTLIMIT;</div>
<div class="line">    ipsec-&gt;<a name="a11"></a><a class="code" href="structrte__security__ipsec__xform.html#a85eb02412c31f7fbf81890c32a231b95">replay_win_sz</a> = app_sa_prm.window_size;</div>
<div class="line">    ipsec-&gt;<a name="a12"></a><a class="code" href="structrte__security__ipsec__xform.html#aa6f69b0c59c4226f3b5934f459c118ff">options</a>.<a name="a13"></a><a class="code" href="structrte__security__ipsec__sa__options.html#ad24299d78626a8d6f177199748a6088c">esn</a> = app_sa_prm.enable_esn;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">create_lookaside_session(<span class="keyword">struct</span> ipsec_ctx *ipsec_ctx, <span class="keyword">struct</span> ipsec_sa *sa,</div>
<div class="line">        <span class="keyword">struct</span> <a name="_a14"></a><a class="code" href="structrte__ipsec__session.html">rte_ipsec_session</a> *ips)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a15"></a><a class="code" href="structrte__cryptodev__info.html">rte_cryptodev_info</a> cdev_info;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> cdev_id_qp = 0;</div>
<div class="line">    int32_t ret = 0;</div>
<div class="line">    <span class="keyword">struct </span>cdev_key key = { 0 };</div>
<div class="line"> </div>
<div class="line">    key.lcore_id = (uint8_t)<a name="a16"></a><a class="code" href="rte__lcore_8h.html#adfb2b334e7e73f534f25e8888a8a775f">rte_lcore_id</a>();</div>
<div class="line"> </div>
<div class="line">    key.cipher_algo = (uint8_t)sa-&gt;cipher_algo;</div>
<div class="line">    key.auth_algo = (uint8_t)sa-&gt;auth_algo;</div>
<div class="line">    key.aead_algo = (uint8_t)sa-&gt;aead_algo;</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a17"></a><a class="code" href="rte__hash_8h.html#a1bd8f85b9c99eea0a619acc1d6ce2b2c">rte_hash_lookup_data</a>(ipsec_ctx-&gt;cdev_map, &amp;key,</div>
<div class="line">            (<span class="keywordtype">void</span> **)&amp;cdev_id_qp);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">        <a name="a18"></a><a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">                <span class="stringliteral">&quot;No cryptodev: core %u, cipher_algo %u, &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;auth_algo %u, aead_algo %u\n&quot;</span>,</div>
<div class="line">                key.lcore_id,</div>
<div class="line">                key.cipher_algo,</div>
<div class="line">                key.auth_algo,</div>
<div class="line">                key.aead_algo);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a name="a19"></a><a class="code" href="rte__log_8h.html#aeed72aff1af9a59d2de85b96955e21f9">RTE_LOG_DP</a>(DEBUG, IPSEC, <span class="stringliteral">&quot;Create session for SA spi %u on cryptodev &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;%u qp %u\n&quot;</span>, sa-&gt;spi,</div>
<div class="line">            ipsec_ctx-&gt;tbl[cdev_id_qp].id,</div>
<div class="line">            ipsec_ctx-&gt;tbl[cdev_id_qp].qp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ips-&gt;<a name="a20"></a><a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> != <a name="a21"></a><a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a79eb9b51e068301f8839e759e08d2b52">RTE_SECURITY_ACTION_TYPE_NONE</a> &amp;&amp;</div>
<div class="line">        ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> != <a name="a22"></a><a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a32e56f07add678e64f24fb06d7e8b93c">RTE_SECURITY_ACTION_TYPE_CPU_CRYPTO</a>) {</div>
<div class="line">        <span class="keyword">struct </span><a name="_a23"></a><a class="code" href="structrte__security__session__conf.html">rte_security_session_conf</a> sess_conf = {</div>
<div class="line">            .<a name="a24"></a><a class="code" href="structrte__security__session__conf.html#a89cbc266019b64116143ada1e3f0b5c3">action_type</a> = ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a>,</div>
<div class="line">            .protocol = <a name="a25"></a><a class="code" href="rte__security_8h.html#a03e4e45b700bf9650209b11a48e293f2aa476f140e333d64059372915d4f0b432">RTE_SECURITY_PROTOCOL_IPSEC</a>,</div>
<div class="line">            {.ipsec = {</div>
<div class="line">                .spi = sa-&gt;spi,</div>
<div class="line">                .salt = sa-&gt;salt,</div>
<div class="line">                .options = { 0 },</div>
<div class="line">                .replay_win_sz = 0,</div>
<div class="line">                .direction = sa-&gt;direction,</div>
<div class="line">                .proto = <a name="a26"></a><a class="code" href="rte__security_8h.html#a41d5c17d1eba1fe9a6bf87dae42efceba41914b40959619c1634433120107a0fb">RTE_SECURITY_IPSEC_SA_PROTO_ESP</a>,</div>
<div class="line">                .mode = (IS_TUNNEL(sa-&gt;flags)) ?</div>
<div class="line">                    <a class="code" href="rte__security_8h.html#a90a4754d59edd1bf3fbb81ddd6797ddda8360104a6e33ebeaa833f964492577ec">RTE_SECURITY_IPSEC_SA_MODE_TUNNEL</a> :</div>
<div class="line">                    <a name="a27"></a><a class="code" href="rte__security_8h.html#a90a4754d59edd1bf3fbb81ddd6797dddaba196bf14f686ad65b7e951a171b236c">RTE_SECURITY_IPSEC_SA_MODE_TRANSPORT</a>,</div>
<div class="line">            } },</div>
<div class="line">            .crypto_xform = sa-&gt;xforms,</div>
<div class="line">            .userdata = NULL,</div>
<div class="line"> </div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> == <a name="a28"></a><a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a770b2f7ec6c90bba88ba546acaa2c17f">RTE_SECURITY_ACTION_TYPE_LOOKASIDE_PROTOCOL</a>) {</div>
<div class="line">            <span class="keyword">struct </span><a name="_a29"></a><a class="code" href="structrte__security__ctx.html">rte_security_ctx</a> *ctx = (<span class="keyword">struct </span><a class="code" href="structrte__security__ctx.html">rte_security_ctx</a> *)</div>
<div class="line">                            rte_cryptodev_get_sec_ctx(</div>
<div class="line">                            ipsec_ctx-&gt;tbl[cdev_id_qp].id);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Set IPsec parameters in conf */</span></div>
<div class="line">            set_ipsec_conf(sa, &amp;(sess_conf.<a name="a30"></a>ipsec));</div>
<div class="line"> </div>
<div class="line">            ips-&gt;<a name="a31"></a>security.ses = <a name="a32"></a><a class="code" href="rte__security_8h.html#ac74a41d31b6c3d57623607a7607dfda5">rte_security_session_create</a>(ctx,</div>
<div class="line">                    &amp;sess_conf, ipsec_ctx-&gt;session_pool,</div>
<div class="line">                    ipsec_ctx-&gt;session_priv_pool);</div>
<div class="line">            <span class="keywordflow">if</span> (ips-&gt;security.ses == NULL) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">                <span class="stringliteral">&quot;SEC Session init failed: err: %d\n&quot;</span>, ret);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC, <span class="stringliteral">&quot;Inline not supported\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">if</span> (ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> == <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a32e56f07add678e64f24fb06d7e8b93c">RTE_SECURITY_ACTION_TYPE_CPU_CRYPTO</a>) {</div>
<div class="line">            <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__info.html">rte_cryptodev_info</a> info;</div>
<div class="line">            uint16_t cdev_id;</div>
<div class="line"> </div>
<div class="line">            cdev_id = ipsec_ctx-&gt;tbl[cdev_id_qp].id;</div>
<div class="line">            <a name="a33"></a><a class="code" href="rte__cryptodev_8h.html#aeb677c03cea6fcc48a8caa533e3729f9">rte_cryptodev_info_get</a>(cdev_id, &amp;info);</div>
<div class="line">            <span class="keywordflow">if</span> (!(info.feature_flags &amp;</div>
<div class="line">                <a name="a34"></a><a class="code" href="rte__cryptodev_8h.html#a72971b7d0ff85ae8c4c1a97ada778d36">RTE_CRYPTODEV_FF_SYM_CPU_CRYPTO</a>))</div>
<div class="line">                <span class="keywordflow">return</span> -ENOTSUP;</div>
<div class="line"> </div>
<div class="line">            ips-&gt;<a name="a35"></a>crypto.dev_id = cdev_id;</div>
<div class="line">        }</div>
<div class="line">        ips-&gt;crypto.ses = <a name="a36"></a><a class="code" href="rte__cryptodev_8h.html#ad40470ee7e072f93f85f1bb584e64e39">rte_cryptodev_sym_session_create</a>(</div>
<div class="line">                ipsec_ctx-&gt;session_pool);</div>
<div class="line">        <a name="a37"></a><a class="code" href="rte__cryptodev_8h.html#a3b05f51fd91ec181c369e32908d55717">rte_cryptodev_sym_session_init</a>(ipsec_ctx-&gt;tbl[cdev_id_qp].id,</div>
<div class="line">                ips-&gt;crypto.ses, sa-&gt;xforms,</div>
<div class="line">                ipsec_ctx-&gt;session_priv_pool);</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="rte__cryptodev_8h.html#aeb677c03cea6fcc48a8caa533e3729f9">rte_cryptodev_info_get</a>(ipsec_ctx-&gt;tbl[cdev_id_qp].id,</div>
<div class="line">                &amp;cdev_info);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    sa-&gt;cdev_id_qp = cdev_id_qp;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">create_inline_session(<span class="keyword">struct</span> socket_ctx *skt_ctx, <span class="keyword">struct</span> ipsec_sa *sa,</div>
<div class="line">        <span class="keyword">struct</span> <a class="code" href="structrte__ipsec__session.html">rte_ipsec_session</a> *ips)</div>
<div class="line">{</div>
<div class="line">    int32_t ret = 0;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__security__ctx.html">rte_security_ctx</a> *sec_ctx;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__security__session__conf.html">rte_security_session_conf</a> sess_conf = {</div>
<div class="line">        .<a class="code" href="structrte__security__session__conf.html#a89cbc266019b64116143ada1e3f0b5c3">action_type</a> = ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a>,</div>
<div class="line">        .protocol = <a class="code" href="rte__security_8h.html#a03e4e45b700bf9650209b11a48e293f2aa476f140e333d64059372915d4f0b432">RTE_SECURITY_PROTOCOL_IPSEC</a>,</div>
<div class="line">        {.ipsec = {</div>
<div class="line">            .spi = sa-&gt;spi,</div>
<div class="line">            .salt = sa-&gt;salt,</div>
<div class="line">            .options = { 0 },</div>
<div class="line">            .replay_win_sz = 0,</div>
<div class="line">            .direction = sa-&gt;direction,</div>
<div class="line">            .proto = <a class="code" href="rte__security_8h.html#a41d5c17d1eba1fe9a6bf87dae42efceba41914b40959619c1634433120107a0fb">RTE_SECURITY_IPSEC_SA_PROTO_ESP</a>,</div>
<div class="line">            .mode = (sa-&gt;flags == IP4_TUNNEL ||</div>
<div class="line">                    sa-&gt;flags == IP6_TUNNEL) ?</div>
<div class="line">                    <a class="code" href="rte__security_8h.html#a90a4754d59edd1bf3fbb81ddd6797ddda8360104a6e33ebeaa833f964492577ec">RTE_SECURITY_IPSEC_SA_MODE_TUNNEL</a> :</div>
<div class="line">                    <a class="code" href="rte__security_8h.html#a90a4754d59edd1bf3fbb81ddd6797dddaba196bf14f686ad65b7e951a171b236c">RTE_SECURITY_IPSEC_SA_MODE_TRANSPORT</a>,</div>
<div class="line">        } },</div>
<div class="line">        .crypto_xform = sa-&gt;xforms,</div>
<div class="line">        .userdata = NULL,</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__log_8h.html#aeed72aff1af9a59d2de85b96955e21f9">RTE_LOG_DP</a>(DEBUG, IPSEC, <span class="stringliteral">&quot;Create session for SA spi %u on port %u\n&quot;</span>,</div>
<div class="line">        sa-&gt;spi, sa-&gt;portid);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> == <a name="a38"></a><a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116">RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</a>) {</div>
<div class="line">        <span class="keyword">struct </span><a name="_a39"></a><a class="code" href="structrte__flow__error.html">rte_flow_error</a> err;</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">struct </span><a name="_a40"></a><a class="code" href="structrte__security__capability.html">rte_security_capability</a> *sec_cap;</div>
<div class="line">        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"> </div>
<div class="line">        sec_ctx = (<span class="keyword">struct </span><a class="code" href="structrte__security__ctx.html">rte_security_ctx</a> *)</div>
<div class="line">                    <a name="a41"></a><a class="code" href="rte__ethdev_8h.html#a539fa8ee80c94d538a42d951e4bcb00e">rte_eth_dev_get_sec_ctx</a>(</div>
<div class="line">                    sa-&gt;portid);</div>
<div class="line">        <span class="keywordflow">if</span> (sec_ctx == NULL) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">                <span class="stringliteral">&quot; rte_eth_dev_get_sec_ctx failed\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        ips-&gt;security.ses = <a class="code" href="rte__security_8h.html#ac74a41d31b6c3d57623607a7607dfda5">rte_security_session_create</a>(sec_ctx,</div>
<div class="line">                &amp;sess_conf, skt_ctx-&gt;session_pool,</div>
<div class="line">                skt_ctx-&gt;session_priv_pool);</div>
<div class="line">        <span class="keywordflow">if</span> (ips-&gt;security.ses == NULL) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">                <span class="stringliteral">&quot;SEC Session init failed: err: %d\n&quot;</span>, ret);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        sec_cap = <a name="a42"></a><a class="code" href="rte__security_8h.html#adac3a0658251756f8832045babe60b83">rte_security_capabilities_get</a>(sec_ctx);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* iterate until ESP tunnel*/</span></div>
<div class="line">        <span class="keywordflow">while</span> (sec_cap-&gt;<a name="a43"></a><a class="code" href="structrte__security__capability.html#a67a170e529eee8ec126fb0e350f59b73">action</a> != <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a79eb9b51e068301f8839e759e08d2b52">RTE_SECURITY_ACTION_TYPE_NONE</a>) {</div>
<div class="line">            <span class="keywordflow">if</span> (sec_cap-&gt;<a class="code" href="structrte__security__capability.html#a67a170e529eee8ec126fb0e350f59b73">action</a> == ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> &amp;&amp;</div>
<div class="line">                sec_cap-&gt;<a name="a44"></a><a class="code" href="structrte__security__capability.html#ac9771e73fffbfa2e6fd004aaedc16267">protocol</a> ==</div>
<div class="line">                <a class="code" href="rte__security_8h.html#a03e4e45b700bf9650209b11a48e293f2aa476f140e333d64059372915d4f0b432">RTE_SECURITY_PROTOCOL_IPSEC</a> &amp;&amp;</div>
<div class="line">                sec_cap-&gt;<a name="a45"></a><a class="code" href="structrte__security__capability.html#a2fbd3c84a661bcf4013d722120476f43">ipsec</a>.mode ==</div>
<div class="line">                <a class="code" href="rte__security_8h.html#a90a4754d59edd1bf3fbb81ddd6797ddda8360104a6e33ebeaa833f964492577ec">RTE_SECURITY_IPSEC_SA_MODE_TUNNEL</a> &amp;&amp;</div>
<div class="line">                sec_cap-&gt;<a class="code" href="structrte__security__capability.html#a2fbd3c84a661bcf4013d722120476f43">ipsec</a>.direction == sa-&gt;direction)</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            sec_cap++;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (sec_cap-&gt;<a class="code" href="structrte__security__capability.html#a67a170e529eee8ec126fb0e350f59b73">action</a> == <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a79eb9b51e068301f8839e759e08d2b52">RTE_SECURITY_ACTION_TYPE_NONE</a>) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">                <span class="stringliteral">&quot;No suitable security capability found\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        ips-&gt;security.ol_flags = sec_cap-&gt;<a name="a46"></a><a class="code" href="structrte__security__capability.html#a1ea9e0895b70c465a21a009e5b94321d">ol_flags</a>;</div>
<div class="line">        ips-&gt;security.ctx = sec_ctx;</div>
<div class="line">        sa-&gt;pattern[0].type = <a name="a47"></a><a class="code" href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1abb502c9d1fc4678e1e36187090494aca">RTE_FLOW_ITEM_TYPE_ETH</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (IS_IP6(sa-&gt;flags)) {</div>
<div class="line">            sa-&gt;pattern[1].mask = &amp;<a name="a48"></a><a class="code" href="rte__flow_8h.html#a865bcafbcac0dc0ed5047a75ce24e6a0">rte_flow_item_ipv6_mask</a>;</div>
<div class="line">            sa-&gt;pattern[1].type = <a name="a49"></a><a class="code" href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1ae4196d14795c390875542f9c8c9e2d60">RTE_FLOW_ITEM_TYPE_IPV6</a>;</div>
<div class="line">            sa-&gt;pattern[1].spec = &amp;sa-&gt;ipv6_spec;</div>
<div class="line"> </div>
<div class="line">            memcpy(sa-&gt;ipv6_spec.hdr.dst_addr,</div>
<div class="line">                sa-&gt;dst.ip.ip6.ip6_b, 16);</div>
<div class="line">            memcpy(sa-&gt;ipv6_spec.hdr.src_addr,</div>
<div class="line">                   sa-&gt;src.ip.ip6.ip6_b, 16);</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IS_IP4(sa-&gt;flags)) {</div>
<div class="line">            sa-&gt;pattern[1].mask = &amp;<a name="a50"></a><a class="code" href="rte__flow_8h.html#ac2215329b636beb0199b939cbdc2a23e">rte_flow_item_ipv4_mask</a>;</div>
<div class="line">            sa-&gt;pattern[1].type = <a name="a51"></a><a class="code" href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1a04512db8022f42e5935cfc2ecdde66b2">RTE_FLOW_ITEM_TYPE_IPV4</a>;</div>
<div class="line">            sa-&gt;pattern[1].spec = &amp;sa-&gt;ipv4_spec;</div>
<div class="line"> </div>
<div class="line">            sa-&gt;ipv4_spec.hdr.dst_addr = sa-&gt;dst.ip.ip4;</div>
<div class="line">            sa-&gt;ipv4_spec.hdr.src_addr = sa-&gt;src.ip.ip4;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        sa-&gt;pattern[2].type = <a name="a52"></a><a class="code" href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1a378d681349151b147a42ecfe0023f826">RTE_FLOW_ITEM_TYPE_ESP</a>;</div>
<div class="line">        sa-&gt;pattern[2].spec = &amp;sa-&gt;esp_spec;</div>
<div class="line">        sa-&gt;pattern[2].mask = &amp;<a name="a53"></a><a class="code" href="rte__flow_8h.html#ad8d8fbd2462ffab6e7cd2d869000d86f">rte_flow_item_esp_mask</a>;</div>
<div class="line">        sa-&gt;esp_spec.<a name="a54"></a><a class="code" href="structrte__flow__item__esp.html#ace8372c9a582c14baa87cee1f280b0a5">hdr</a>.<a name="a55"></a><a class="code" href="structrte__esp__hdr.html#ade83e664f1375a837252e7bbb6d53a67">spi</a> = <a name="a56"></a><a class="code" href="rte__byteorder_8h.html#a6b1dd5d5a4c60c1d72ba48c523eba45c">rte_cpu_to_be_32</a>(sa-&gt;spi);</div>
<div class="line"> </div>
<div class="line">        sa-&gt;pattern[3].type = <a name="a57"></a><a class="code" href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1a51161f8ef75cba3968e32fc0472575d7">RTE_FLOW_ITEM_TYPE_END</a>;</div>
<div class="line"> </div>
<div class="line">        sa-&gt;action[0].type = <a name="a58"></a><a class="code" href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aaac9738009ac5b299c3c4facdbdf66890">RTE_FLOW_ACTION_TYPE_SECURITY</a>;</div>
<div class="line">        sa-&gt;action[0].conf = ips-&gt;security.ses;</div>
<div class="line"> </div>
<div class="line">        sa-&gt;action[1].type = <a name="a59"></a><a class="code" href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aa7bc270d4629785c13b81dccca71f67e3">RTE_FLOW_ACTION_TYPE_END</a>;</div>
<div class="line"> </div>
<div class="line">        sa-&gt;attr.egress = (sa-&gt;direction ==</div>
<div class="line">                <a name="a60"></a><a class="code" href="rte__security_8h.html#a6ff944ce0c3d11c12ea6bd77269a77b8a7181811ead51812b5e782cb9665a302f">RTE_SECURITY_IPSEC_SA_DIR_EGRESS</a>);</div>
<div class="line">        sa-&gt;attr.ingress = (sa-&gt;direction ==</div>
<div class="line">                <a name="a61"></a><a class="code" href="rte__security_8h.html#a6ff944ce0c3d11c12ea6bd77269a77b8a1f53b841897fdf71f3bda964406b67cc">RTE_SECURITY_IPSEC_SA_DIR_INGRESS</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (sa-&gt;attr.ingress) {</div>
<div class="line">            uint8_t rss_key[40];</div>
<div class="line">            <span class="keyword">struct </span><a name="_a62"></a><a class="code" href="structrte__eth__rss__conf.html">rte_eth_rss_conf</a> rss_conf = {</div>
<div class="line">                .<a name="a63"></a><a class="code" href="structrte__eth__rss__conf.html#a931e368ed1b5a8211a963bc05c503739">rss_key</a> = <a class="code" href="structrte__eth__rss__conf.html#a931e368ed1b5a8211a963bc05c503739">rss_key</a>,</div>
<div class="line">                .rss_key_len = 40,</div>
<div class="line">            };</div>
<div class="line">            <span class="keyword">struct </span><a name="_a64"></a><a class="code" href="structrte__eth__dev__info.html">rte_eth_dev_info</a> dev_info;</div>
<div class="line">            uint16_t queue[RTE_MAX_QUEUES_PER_PORT];</div>
<div class="line">            <span class="keyword">struct </span><a name="_a65"></a><a class="code" href="structrte__flow__action__rss.html">rte_flow_action_rss</a> action_rss;</div>
<div class="line">            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div>
<div class="line">            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Don&#39;t create flow if default flow is created */</span></div>
<div class="line">            <span class="keywordflow">if</span> (flow_info_tbl[sa-&gt;portid].rx_def_flow)</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">            ret = <a name="a66"></a><a class="code" href="rte__ethdev_8h.html#a7593f4fff04f4ae1b1d718db7ca7dc8c">rte_eth_dev_info_get</a>(sa-&gt;portid, &amp;dev_info);</div>
<div class="line">            <span class="keywordflow">if</span> (ret != 0) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">                    <span class="stringliteral">&quot;Error during getting device (port %u) info: %s\n&quot;</span>,</div>
<div class="line">                    sa-&gt;portid, strerror(-ret));</div>
<div class="line">                <span class="keywordflow">return</span> ret;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            sa-&gt;action[2].type = <a class="code" href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aa7bc270d4629785c13b81dccca71f67e3">RTE_FLOW_ACTION_TYPE_END</a>;</div>
<div class="line">            <span class="comment">/* Try RSS. */</span></div>
<div class="line">            sa-&gt;action[1].type = <a name="a67"></a><a class="code" href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aa72428c7c1896fe4dfdc2dbed85214d27">RTE_FLOW_ACTION_TYPE_RSS</a>;</div>
<div class="line">            sa-&gt;action[1].conf = &amp;action_rss;</div>
<div class="line">            ret = <a name="a68"></a><a class="code" href="rte__ethdev_8h.html#a6000dca62f9815414b3f3b9c5d8be62f">rte_eth_dev_rss_hash_conf_get</a>(sa-&gt;portid,</div>
<div class="line">                    &amp;rss_conf);</div>
<div class="line">            <span class="keywordflow">if</span> (ret != 0) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">                    <span class="stringliteral">&quot;rte_eth_dev_rss_hash_conf_get:ret=%d\n&quot;</span>,</div>
<div class="line">                    ret);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">for</span> (i = 0, j = 0; i &lt; dev_info.nb_rx_queues; ++i)</div>
<div class="line">                <a name="a69"></a><a class="code" href="structrte__flow__action__rss.html#a8a500410fe68a94958d3f97a602378e1">queue</a>[j++] = i;</div>
<div class="line"> </div>
<div class="line">            action_rss = (<span class="keyword">struct </span><a class="code" href="structrte__flow__action__rss.html">rte_flow_action_rss</a>){</div>
<div class="line">                    .types = rss_conf.<a name="a70"></a><a class="code" href="structrte__eth__rss__conf.html#ad70f17882a835e5d4e38c64a9f872fdc">rss_hf</a>,</div>
<div class="line">                    .key_len = rss_conf.<a name="a71"></a><a class="code" href="structrte__eth__rss__conf.html#ab8f32e03af342f65e890c42b24511866">rss_key_len</a>,</div>
<div class="line">                    .queue_num = j,</div>
<div class="line">                    .key = rss_key,</div>
<div class="line">                    .queue = <a class="code" href="structrte__flow__action__rss.html#a8a500410fe68a94958d3f97a602378e1">queue</a>,</div>
<div class="line">            };</div>
<div class="line">            ret = <a name="a72"></a><a class="code" href="rte__flow_8h.html#a3fc6e9416462572d5a978e77d9ea2ec8">rte_flow_validate</a>(sa-&gt;portid, &amp;sa-&gt;attr,</div>
<div class="line">                        sa-&gt;pattern, sa-&gt;action,</div>
<div class="line">                        &amp;err);</div>
<div class="line">            <span class="keywordflow">if</span> (!ret)</div>
<div class="line">                <span class="keywordflow">goto</span> flow_create;</div>
<div class="line">            <span class="comment">/* Try Queue. */</span></div>
<div class="line">            sa-&gt;action[1].type = <a name="a73"></a><a class="code" href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aa7a913800d2a0c7655ec296ce651b6306">RTE_FLOW_ACTION_TYPE_QUEUE</a>;</div>
<div class="line">            sa-&gt;action[1].conf =</div>
<div class="line">                &amp;(<span class="keyword">struct </span><a name="_a74"></a><a class="code" href="structrte__flow__action__queue.html">rte_flow_action_queue</a>){</div>
<div class="line">                .index = 0,</div>
<div class="line">            };</div>
<div class="line">            ret = <a class="code" href="rte__flow_8h.html#a3fc6e9416462572d5a978e77d9ea2ec8">rte_flow_validate</a>(sa-&gt;portid, &amp;sa-&gt;attr,</div>
<div class="line">                        sa-&gt;pattern, sa-&gt;action,</div>
<div class="line">                        &amp;err);</div>
<div class="line">            <span class="comment">/* Try End. */</span></div>
<div class="line">            sa-&gt;action[1].type = <a class="code" href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aa7bc270d4629785c13b81dccca71f67e3">RTE_FLOW_ACTION_TYPE_END</a>;</div>
<div class="line">            sa-&gt;action[1].conf = NULL;</div>
<div class="line">            ret = <a class="code" href="rte__flow_8h.html#a3fc6e9416462572d5a978e77d9ea2ec8">rte_flow_validate</a>(sa-&gt;portid, &amp;sa-&gt;attr,</div>
<div class="line">                        sa-&gt;pattern, sa-&gt;action,</div>
<div class="line">                        &amp;err);</div>
<div class="line">            <span class="keywordflow">if</span> (ret)</div>
<div class="line">                <span class="keywordflow">goto</span> flow_create_failure;</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sa-&gt;attr.egress &amp;&amp;</div>
<div class="line">                (ips-&gt;security.ol_flags &amp;</div>
<div class="line">                    <a name="a75"></a><a class="code" href="rte__security_8h.html#ae7a4e7b862ba5ce383229caccc45eee2">RTE_SECURITY_TX_HW_TRAILER_OFFLOAD</a>)) {</div>
<div class="line">            sa-&gt;action[1].type =</div>
<div class="line">                    <a name="a76"></a><a class="code" href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aa33147c5e8dbbd8b07ef471ff07e72f6a">RTE_FLOW_ACTION_TYPE_PASSTHRU</a>;</div>
<div class="line">            sa-&gt;action[2].type =</div>
<div class="line">                    <a class="code" href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aa7bc270d4629785c13b81dccca71f67e3">RTE_FLOW_ACTION_TYPE_END</a>;</div>
<div class="line">        }</div>
<div class="line">flow_create:</div>
<div class="line">        sa-&gt;flow = <a name="a77"></a><a class="code" href="rte__flow_8h.html#a698ab49350e51414a31b9c511a7abe4e">rte_flow_create</a>(sa-&gt;portid,</div>
<div class="line">                &amp;sa-&gt;attr, sa-&gt;pattern, sa-&gt;action, &amp;err);</div>
<div class="line">        <span class="keywordflow">if</span> (sa-&gt;flow == NULL) {</div>
<div class="line">flow_create_failure:</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">                <span class="stringliteral">&quot;Failed to create ipsec flow msg: %s\n&quot;</span>,</div>
<div class="line">                err.message);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> == <a name="a78"></a><a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f">RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</a>) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__security__capability.html">rte_security_capability</a> *sec_cap;</div>
<div class="line"> </div>
<div class="line">        sec_ctx = (<span class="keyword">struct </span><a class="code" href="structrte__security__ctx.html">rte_security_ctx</a> *)</div>
<div class="line">                <a class="code" href="rte__ethdev_8h.html#a539fa8ee80c94d538a42d951e4bcb00e">rte_eth_dev_get_sec_ctx</a>(sa-&gt;portid);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (sec_ctx == NULL) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">                <span class="stringliteral">&quot;Ethernet device doesn&#39;t have security features registered\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Set IPsec parameters in conf */</span></div>
<div class="line">        set_ipsec_conf(sa, &amp;(sess_conf.ipsec));</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Save SA as userdata for the security session. When</span></div>
<div class="line"><span class="comment">         * the packet is received, this userdata will be</span></div>
<div class="line"><span class="comment">         * retrieved using the metadata from the packet.</span></div>
<div class="line"><span class="comment">         *</span></div>
<div class="line"><span class="comment">         * The PMD is expected to set similar metadata for other</span></div>
<div class="line"><span class="comment">         * operations, like rte_eth_event, which are tied to</span></div>
<div class="line"><span class="comment">         * security session. In such cases, the userdata could</span></div>
<div class="line"><span class="comment">         * be obtained to uniquely identify the security</span></div>
<div class="line"><span class="comment">         * parameters denoted.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line"> </div>
<div class="line">        sess_conf.<a name="a79"></a><a class="code" href="structrte__security__session__conf.html#afd0ffb02780e738d4c0a10ab833b7834">userdata</a> = (<span class="keywordtype">void</span> *) sa;</div>
<div class="line"> </div>
<div class="line">        ips-&gt;security.ses = <a class="code" href="rte__security_8h.html#ac74a41d31b6c3d57623607a7607dfda5">rte_security_session_create</a>(sec_ctx,</div>
<div class="line">                    &amp;sess_conf, skt_ctx-&gt;session_pool,</div>
<div class="line">                    skt_ctx-&gt;session_priv_pool);</div>
<div class="line">        <span class="keywordflow">if</span> (ips-&gt;security.ses == NULL) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">                <span class="stringliteral">&quot;SEC Session init failed: err: %d\n&quot;</span>, ret);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        sec_cap = <a class="code" href="rte__security_8h.html#adac3a0658251756f8832045babe60b83">rte_security_capabilities_get</a>(sec_ctx);</div>
<div class="line">        <span class="keywordflow">if</span> (sec_cap == NULL) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">                <span class="stringliteral">&quot;No capabilities registered\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* iterate until ESP tunnel*/</span></div>
<div class="line">        <span class="keywordflow">while</span> (sec_cap-&gt;<a class="code" href="structrte__security__capability.html#a67a170e529eee8ec126fb0e350f59b73">action</a> !=</div>
<div class="line">                <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a79eb9b51e068301f8839e759e08d2b52">RTE_SECURITY_ACTION_TYPE_NONE</a>) {</div>
<div class="line">            <span class="keywordflow">if</span> (sec_cap-&gt;<a class="code" href="structrte__security__capability.html#a67a170e529eee8ec126fb0e350f59b73">action</a> == ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> &amp;&amp;</div>
<div class="line">                sec_cap-&gt;<a class="code" href="structrte__security__capability.html#ac9771e73fffbfa2e6fd004aaedc16267">protocol</a> ==</div>
<div class="line">                <a class="code" href="rte__security_8h.html#a03e4e45b700bf9650209b11a48e293f2aa476f140e333d64059372915d4f0b432">RTE_SECURITY_PROTOCOL_IPSEC</a> &amp;&amp;</div>
<div class="line">                sec_cap-&gt;<a class="code" href="structrte__security__capability.html#a2fbd3c84a661bcf4013d722120476f43">ipsec</a>.mode ==</div>
<div class="line">                sess_conf.ipsec.<a class="code" href="structrte__security__ipsec__xform.html#acd1593fa6d838e374ca05311b4efd081">mode</a> &amp;&amp;</div>
<div class="line">                sec_cap-&gt;<a class="code" href="structrte__security__capability.html#a2fbd3c84a661bcf4013d722120476f43">ipsec</a>.direction == sa-&gt;direction)</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            sec_cap++;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (sec_cap-&gt;<a class="code" href="structrte__security__capability.html#a67a170e529eee8ec126fb0e350f59b73">action</a> == <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a79eb9b51e068301f8839e759e08d2b52">RTE_SECURITY_ACTION_TYPE_NONE</a>) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">                <span class="stringliteral">&quot;No suitable security capability found\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        ips-&gt;security.ol_flags = sec_cap-&gt;<a class="code" href="structrte__security__capability.html#a1ea9e0895b70c465a21a009e5b94321d">ol_flags</a>;</div>
<div class="line">        ips-&gt;security.ctx = sec_ctx;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">create_ipsec_esp_flow(<span class="keyword">struct</span> ipsec_sa *sa)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> ret = 0;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__flow__error.html">rte_flow_error</a> err;</div>
<div class="line">    <span class="keywordflow">if</span> (sa-&gt;direction == <a class="code" href="rte__security_8h.html#a6ff944ce0c3d11c12ea6bd77269a77b8a7181811ead51812b5e782cb9665a302f">RTE_SECURITY_IPSEC_SA_DIR_EGRESS</a>) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">            <span class="stringliteral">&quot;No Flow director rule for Egress traffic\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (sa-&gt;flags == TRANSPORT) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">            <span class="stringliteral">&quot;No Flow director rule for transport mode\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    sa-&gt;action[0].type = <a class="code" href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aa7a913800d2a0c7655ec296ce651b6306">RTE_FLOW_ACTION_TYPE_QUEUE</a>;</div>
<div class="line">    sa-&gt;pattern[0].type = <a class="code" href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1abb502c9d1fc4678e1e36187090494aca">RTE_FLOW_ITEM_TYPE_ETH</a>;</div>
<div class="line">    sa-&gt;action[0].conf = &amp;(<span class="keyword">struct </span><a class="code" href="structrte__flow__action__queue.html">rte_flow_action_queue</a>) {</div>
<div class="line">                .index = sa-&gt;fdir_qid,</div>
<div class="line">    };</div>
<div class="line">    sa-&gt;attr.egress = 0;</div>
<div class="line">    sa-&gt;attr.ingress = 1;</div>
<div class="line">    <span class="keywordflow">if</span> (IS_IP6(sa-&gt;flags)) {</div>
<div class="line">        sa-&gt;pattern[1].mask = &amp;<a class="code" href="rte__flow_8h.html#a865bcafbcac0dc0ed5047a75ce24e6a0">rte_flow_item_ipv6_mask</a>;</div>
<div class="line">        sa-&gt;pattern[1].type = <a class="code" href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1ae4196d14795c390875542f9c8c9e2d60">RTE_FLOW_ITEM_TYPE_IPV6</a>;</div>
<div class="line">        sa-&gt;pattern[1].spec = &amp;sa-&gt;ipv6_spec;</div>
<div class="line">        memcpy(sa-&gt;ipv6_spec.hdr.dst_addr,</div>
<div class="line">            sa-&gt;dst.ip.ip6.ip6_b, <span class="keyword">sizeof</span>(sa-&gt;dst.ip.ip6.ip6_b));</div>
<div class="line">        memcpy(sa-&gt;ipv6_spec.hdr.src_addr,</div>
<div class="line">            sa-&gt;src.ip.ip6.ip6_b, <span class="keyword">sizeof</span>(sa-&gt;src.ip.ip6.ip6_b));</div>
<div class="line">        sa-&gt;pattern[2].type = <a class="code" href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1a378d681349151b147a42ecfe0023f826">RTE_FLOW_ITEM_TYPE_ESP</a>;</div>
<div class="line">        sa-&gt;pattern[2].spec = &amp;sa-&gt;esp_spec;</div>
<div class="line">        sa-&gt;pattern[2].mask = &amp;<a class="code" href="rte__flow_8h.html#ad8d8fbd2462ffab6e7cd2d869000d86f">rte_flow_item_esp_mask</a>;</div>
<div class="line">        sa-&gt;esp_spec.<a class="code" href="structrte__flow__item__esp.html#ace8372c9a582c14baa87cee1f280b0a5">hdr</a>.<a class="code" href="structrte__esp__hdr.html#ade83e664f1375a837252e7bbb6d53a67">spi</a> = <a class="code" href="rte__byteorder_8h.html#a6b1dd5d5a4c60c1d72ba48c523eba45c">rte_cpu_to_be_32</a>(sa-&gt;spi);</div>
<div class="line">        sa-&gt;pattern[3].type = <a class="code" href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1a51161f8ef75cba3968e32fc0472575d7">RTE_FLOW_ITEM_TYPE_END</a>;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IS_IP4(sa-&gt;flags)) {</div>
<div class="line">        sa-&gt;pattern[1].mask = &amp;<a class="code" href="rte__flow_8h.html#ac2215329b636beb0199b939cbdc2a23e">rte_flow_item_ipv4_mask</a>;</div>
<div class="line">        sa-&gt;pattern[1].type = <a class="code" href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1a04512db8022f42e5935cfc2ecdde66b2">RTE_FLOW_ITEM_TYPE_IPV4</a>;</div>
<div class="line">        sa-&gt;pattern[1].spec = &amp;sa-&gt;ipv4_spec;</div>
<div class="line">        sa-&gt;ipv4_spec.hdr.dst_addr = sa-&gt;dst.ip.ip4;</div>
<div class="line">        sa-&gt;ipv4_spec.hdr.src_addr = sa-&gt;src.ip.ip4;</div>
<div class="line">        sa-&gt;pattern[2].type = <a class="code" href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1a378d681349151b147a42ecfe0023f826">RTE_FLOW_ITEM_TYPE_ESP</a>;</div>
<div class="line">        sa-&gt;pattern[2].spec = &amp;sa-&gt;esp_spec;</div>
<div class="line">        sa-&gt;pattern[2].mask = &amp;<a class="code" href="rte__flow_8h.html#ad8d8fbd2462ffab6e7cd2d869000d86f">rte_flow_item_esp_mask</a>;</div>
<div class="line">        sa-&gt;esp_spec.<a class="code" href="structrte__flow__item__esp.html#ace8372c9a582c14baa87cee1f280b0a5">hdr</a>.<a class="code" href="structrte__esp__hdr.html#ade83e664f1375a837252e7bbb6d53a67">spi</a> = <a class="code" href="rte__byteorder_8h.html#a6b1dd5d5a4c60c1d72ba48c523eba45c">rte_cpu_to_be_32</a>(sa-&gt;spi);</div>
<div class="line">        sa-&gt;pattern[3].type = <a class="code" href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1a51161f8ef75cba3968e32fc0472575d7">RTE_FLOW_ITEM_TYPE_END</a>;</div>
<div class="line">    }</div>
<div class="line">    sa-&gt;action[1].type = <a class="code" href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aa7bc270d4629785c13b81dccca71f67e3">RTE_FLOW_ACTION_TYPE_END</a>;</div>
<div class="line"> </div>
<div class="line">    ret = <a class="code" href="rte__flow_8h.html#a3fc6e9416462572d5a978e77d9ea2ec8">rte_flow_validate</a>(sa-&gt;portid, &amp;sa-&gt;attr, sa-&gt;pattern, sa-&gt;action,</div>
<div class="line">                &amp;err);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC, <span class="stringliteral">&quot;Flow validation failed %s\n&quot;</span>, err.message);</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    sa-&gt;flow = <a class="code" href="rte__flow_8h.html#a698ab49350e51414a31b9c511a7abe4e">rte_flow_create</a>(sa-&gt;portid, &amp;sa-&gt;attr, sa-&gt;pattern,</div>
<div class="line">                    sa-&gt;action, &amp;err);</div>
<div class="line">    <span class="keywordflow">if</span> (!sa-&gt;flow) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC, <span class="stringliteral">&quot;Flow creation failed %s\n&quot;</span>, err.message);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * queue crypto-ops into PMD queue.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">enqueue_cop_burst(<span class="keyword">struct</span> cdev_qp *cqp)</div>
<div class="line">{</div>
<div class="line">    uint32_t i, len, ret;</div>
<div class="line"> </div>
<div class="line">    len = cqp-&gt;len;</div>
<div class="line">    ret = <a name="a80"></a><a class="code" href="rte__cryptodev_8h.html#a1e1336b0a8fe381ea03a52bad85e5734">rte_cryptodev_enqueue_burst</a>(cqp-&gt;id, cqp-&gt;qp, cqp-&gt;buf, len);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; len) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#aeed72aff1af9a59d2de85b96955e21f9">RTE_LOG_DP</a>(DEBUG, IPSEC, <span class="stringliteral">&quot;Cryptodev %u queue %u:&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot; enqueued %u crypto ops out of %u\n&quot;</span>,</div>
<div class="line">            cqp-&gt;id, cqp-&gt;qp, ret, len);</div>
<div class="line">            <span class="comment">/* drop packets that we fail to enqueue */</span></div>
<div class="line">            <span class="keywordflow">for</span> (i = ret; i &lt; len; i++)</div>
<div class="line">                free_pkts(&amp;cqp-&gt;buf[i]-&gt;sym-&gt;m_src, 1);</div>
<div class="line">    }</div>
<div class="line">    cqp-&gt;in_flight += ret;</div>
<div class="line">    cqp-&gt;len = 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">enqueue_cop(<span class="keyword">struct</span> cdev_qp *cqp, <span class="keyword">struct</span> <a name="_a81"></a><a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> *cop)</div>
<div class="line">{</div>
<div class="line">    cqp-&gt;buf[cqp-&gt;len++] = cop;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cqp-&gt;len == MAX_PKT_BURST)</div>
<div class="line">        enqueue_cop_burst(cqp);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">ipsec_enqueue(ipsec_xform_fn xform_func, <span class="keyword">struct</span> ipsec_ctx *ipsec_ctx,</div>
<div class="line">        <span class="keyword">struct</span> <a name="_a82"></a><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkts[], <span class="keywordtype">void</span> *sas[],</div>
<div class="line">        uint16_t nb_pkts)</div>
<div class="line">{</div>
<div class="line">    int32_t ret = 0, i;</div>
<div class="line">    <span class="keyword">struct </span>ipsec_mbuf_metadata *priv;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a83"></a><a class="code" href="structrte__crypto__sym__op.html">rte_crypto_sym_op</a> *sym_cop;</div>
<div class="line">    <span class="keyword">struct </span>ipsec_sa *sa;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ipsec__session.html">rte_ipsec_session</a> *ips;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; nb_pkts; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a84"></a><a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(sas[i] == NULL)) {</div>
<div class="line">            free_pkts(&amp;pkts[i], 1);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a name="a85"></a><a class="code" href="rte__prefetch_8h.html#a7f89cf66766e6bfd63feb370a7280de9">rte_prefetch0</a>(sas[i]);</div>
<div class="line">        <a class="code" href="rte__prefetch_8h.html#a7f89cf66766e6bfd63feb370a7280de9">rte_prefetch0</a>(pkts[i]);</div>
<div class="line"> </div>
<div class="line">        priv = get_priv(pkts[i]);</div>
<div class="line">        <a name="a86"></a><a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a> = ipsec_mask_saptr(sas[i]);</div>
<div class="line">        priv-&gt;sa = <a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>;</div>
<div class="line">        ips = ipsec_get_primary_session(<a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">switch</span> (ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a>) {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a770b2f7ec6c90bba88ba546acaa2c17f">RTE_SECURITY_ACTION_TYPE_LOOKASIDE_PROTOCOL</a>:</div>
<div class="line">            priv-&gt;cop.type = <a name="a87"></a><a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc">RTE_CRYPTO_OP_TYPE_SYMMETRIC</a>;</div>
<div class="line">            priv-&gt;cop.status = <a name="a88"></a><a class="code" href="rte__crypto_8h.html#afe16508b77c2a8dc5caf74a4e9850171abf99a223ed848ecec30ee7aa80743dc0">RTE_CRYPTO_OP_STATUS_NOT_PROCESSED</a>;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="rte__prefetch_8h.html#a7f89cf66766e6bfd63feb370a7280de9">rte_prefetch0</a>(&amp;priv-&gt;sym_cop);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> ((<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(ips-&gt;security.ses == NULL)) &amp;&amp;</div>
<div class="line">                create_lookaside_session(ipsec_ctx, <a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>, ips)) {</div>
<div class="line">                free_pkts(&amp;pkts[i], 1);</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            sym_cop = get_sym_cop(&amp;priv-&gt;cop);</div>
<div class="line">            sym_cop-&gt;<a name="a89"></a><a class="code" href="structrte__crypto__sym__op.html#af021669494a2806b0569587e2096e88e">m_src</a> = pkts[i];</div>
<div class="line"> </div>
<div class="line">            <a name="a90"></a><a class="code" href="rte__security_8h.html#a9806ea434f90d97e3a228c0258baee5d">rte_security_attach_session</a>(&amp;priv-&gt;cop,</div>
<div class="line">                ips-&gt;security.ses);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a32e56f07add678e64f24fb06d7e8b93c">RTE_SECURITY_ACTION_TYPE_CPU_CRYPTO</a>:</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC, <span class="stringliteral">&quot;CPU crypto is not supported by the&quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot; legacy mode.&quot;</span>);</div>
<div class="line">            free_pkts(&amp;pkts[i], 1);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a79eb9b51e068301f8839e759e08d2b52">RTE_SECURITY_ACTION_TYPE_NONE</a>:</div>
<div class="line"> </div>
<div class="line">            priv-&gt;cop.type = <a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc">RTE_CRYPTO_OP_TYPE_SYMMETRIC</a>;</div>
<div class="line">            priv-&gt;cop.status = <a class="code" href="rte__crypto_8h.html#afe16508b77c2a8dc5caf74a4e9850171abf99a223ed848ecec30ee7aa80743dc0">RTE_CRYPTO_OP_STATUS_NOT_PROCESSED</a>;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="rte__prefetch_8h.html#a7f89cf66766e6bfd63feb370a7280de9">rte_prefetch0</a>(&amp;priv-&gt;sym_cop);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> ((<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(ips-&gt;crypto.ses == NULL)) &amp;&amp;</div>
<div class="line">                create_lookaside_session(ipsec_ctx, <a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>, ips)) {</div>
<div class="line">                free_pkts(&amp;pkts[i], 1);</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a name="a91"></a><a class="code" href="rte__crypto_8h.html#affaf4fd29a51d350b387155494402a84">rte_crypto_op_attach_sym_session</a>(&amp;priv-&gt;cop,</div>
<div class="line">                    ips-&gt;crypto.ses);</div>
<div class="line"> </div>
<div class="line">            ret = xform_func(pkts[i], <a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>, &amp;priv-&gt;cop);</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(ret)) {</div>
<div class="line">                free_pkts(&amp;pkts[i], 1);</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f">RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</a>:</div>
<div class="line">            RTE_ASSERT(ips-&gt;security.ses != NULL);</div>
<div class="line">            ipsec_ctx-&gt;ol_pkts[ipsec_ctx-&gt;ol_pkts_cnt++] = pkts[i];</div>
<div class="line">            <span class="keywordflow">if</span> (ips-&gt;security.ol_flags &amp;</div>
<div class="line">                <a name="a92"></a><a class="code" href="rte__security_8h.html#aa37e473f2d863dedf92612e23e82d49c">RTE_SECURITY_TX_OLOAD_NEED_MDATA</a>)</div>
<div class="line">                <a name="a93"></a><a class="code" href="rte__security_8h.html#a052689b2d2d1afa7d14c98a1fd04cad0">rte_security_set_pkt_metadata</a>(</div>
<div class="line">                    ips-&gt;security.ctx, ips-&gt;security.ses,</div>
<div class="line">                    pkts[i], NULL);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116">RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</a>:</div>
<div class="line">            RTE_ASSERT(ips-&gt;security.ses != NULL);</div>
<div class="line">            priv-&gt;cop.type = <a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc">RTE_CRYPTO_OP_TYPE_SYMMETRIC</a>;</div>
<div class="line">            priv-&gt;cop.status = <a class="code" href="rte__crypto_8h.html#afe16508b77c2a8dc5caf74a4e9850171abf99a223ed848ecec30ee7aa80743dc0">RTE_CRYPTO_OP_STATUS_NOT_PROCESSED</a>;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="rte__prefetch_8h.html#a7f89cf66766e6bfd63feb370a7280de9">rte_prefetch0</a>(&amp;priv-&gt;sym_cop);</div>
<div class="line">            <a class="code" href="rte__security_8h.html#a9806ea434f90d97e3a228c0258baee5d">rte_security_attach_session</a>(&amp;priv-&gt;cop,</div>
<div class="line">                    ips-&gt;security.ses);</div>
<div class="line"> </div>
<div class="line">            ret = xform_func(pkts[i], <a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>, &amp;priv-&gt;cop);</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(ret)) {</div>
<div class="line">                free_pkts(&amp;pkts[i], 1);</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            ipsec_ctx-&gt;ol_pkts[ipsec_ctx-&gt;ol_pkts_cnt++] = pkts[i];</div>
<div class="line">            <span class="keywordflow">if</span> (ips-&gt;security.ol_flags &amp;</div>
<div class="line">                <a class="code" href="rte__security_8h.html#aa37e473f2d863dedf92612e23e82d49c">RTE_SECURITY_TX_OLOAD_NEED_MDATA</a>)</div>
<div class="line">                <a class="code" href="rte__security_8h.html#a052689b2d2d1afa7d14c98a1fd04cad0">rte_security_set_pkt_metadata</a>(</div>
<div class="line">                    ips-&gt;security.ctx, ips-&gt;security.ses,</div>
<div class="line">                    pkts[i], NULL);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        RTE_ASSERT(<a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>-&gt;cdev_id_qp &lt; ipsec_ctx-&gt;nb_qps);</div>
<div class="line">        enqueue_cop(&amp;ipsec_ctx-&gt;tbl[<a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>-&gt;cdev_id_qp], &amp;priv-&gt;cop);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> int32_t</div>
<div class="line">ipsec_inline_dequeue(ipsec_xform_fn xform_func, <span class="keyword">struct</span> ipsec_ctx *ipsec_ctx,</div>
<div class="line">          <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkts[], uint16_t max_pkts)</div>
<div class="line">{</div>
<div class="line">    int32_t nb_pkts, ret;</div>
<div class="line">    <span class="keyword">struct </span>ipsec_mbuf_metadata *priv;</div>
<div class="line">    <span class="keyword">struct </span>ipsec_sa *sa;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkt;</div>
<div class="line"> </div>
<div class="line">    nb_pkts = 0;</div>
<div class="line">    <span class="keywordflow">while</span> (ipsec_ctx-&gt;ol_pkts_cnt &gt; 0 &amp;&amp; nb_pkts &lt; max_pkts) {</div>
<div class="line">        pkt = ipsec_ctx-&gt;ol_pkts[--ipsec_ctx-&gt;ol_pkts_cnt];</div>
<div class="line">        <a class="code" href="rte__prefetch_8h.html#a7f89cf66766e6bfd63feb370a7280de9">rte_prefetch0</a>(pkt);</div>
<div class="line">        priv = get_priv(pkt);</div>
<div class="line">        sa = priv-&gt;sa;</div>
<div class="line">        ret = xform_func(pkt, sa, &amp;priv-&gt;cop);</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(ret)) {</div>
<div class="line">            free_pkts(&amp;pkt, 1);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line">        pkts[nb_pkts++] = pkt;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> nb_pkts;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span></div>
<div class="line">ipsec_dequeue(ipsec_xform_fn xform_func, <span class="keyword">struct</span> ipsec_ctx *ipsec_ctx,</div>
<div class="line">          <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkts[], uint16_t max_pkts)</div>
<div class="line">{</div>
<div class="line">    int32_t nb_pkts = 0, ret = 0, i, j, nb_cops;</div>
<div class="line">    <span class="keyword">struct </span>ipsec_mbuf_metadata *priv;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> *cops[max_pkts];</div>
<div class="line">    <span class="keyword">struct </span>ipsec_sa *sa;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkt;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; ipsec_ctx-&gt;nb_qps &amp;&amp; nb_pkts &lt; max_pkts; i++) {</div>
<div class="line">        <span class="keyword">struct </span>cdev_qp *cqp;</div>
<div class="line"> </div>
<div class="line">        cqp = &amp;ipsec_ctx-&gt;tbl[ipsec_ctx-&gt;last_qp++];</div>
<div class="line">        <span class="keywordflow">if</span> (ipsec_ctx-&gt;last_qp == ipsec_ctx-&gt;nb_qps)</div>
<div class="line">            ipsec_ctx-&gt;last_qp %= ipsec_ctx-&gt;nb_qps;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (cqp-&gt;in_flight == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        nb_cops = <a name="a94"></a><a class="code" href="rte__cryptodev_8h.html#a0032857587ce7e217b8c10ba392bef56">rte_cryptodev_dequeue_burst</a>(cqp-&gt;id, cqp-&gt;qp,</div>
<div class="line">                cops, max_pkts - nb_pkts);</div>
<div class="line"> </div>
<div class="line">        cqp-&gt;in_flight -= nb_cops;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (j = 0; j &lt; nb_cops; j++) {</div>
<div class="line">            pkt = cops[j]-&gt;<a name="a95"></a><a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;<a class="code" href="structrte__crypto__sym__op.html#af021669494a2806b0569587e2096e88e">m_src</a>;</div>
<div class="line">            <a class="code" href="rte__prefetch_8h.html#a7f89cf66766e6bfd63feb370a7280de9">rte_prefetch0</a>(pkt);</div>
<div class="line"> </div>
<div class="line">            priv = get_priv(pkt);</div>
<div class="line">            sa = priv-&gt;sa;</div>
<div class="line"> </div>
<div class="line">            RTE_ASSERT(sa != NULL);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (ipsec_get_action_type(sa) ==</div>
<div class="line">                <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a79eb9b51e068301f8839e759e08d2b52">RTE_SECURITY_ACTION_TYPE_NONE</a>) {</div>
<div class="line">                ret = xform_func(pkt, sa, cops[j]);</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(ret)) {</div>
<div class="line">                    free_pkts(&amp;pkt, 1);</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line">                }</div>
<div class="line">            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipsec_get_action_type(sa) ==</div>
<div class="line">                <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a770b2f7ec6c90bba88ba546acaa2c17f">RTE_SECURITY_ACTION_TYPE_LOOKASIDE_PROTOCOL</a>) {</div>
<div class="line">                <span class="keywordflow">if</span> (cops[j]-&gt;status) {</div>
<div class="line">                    free_pkts(&amp;pkt, 1);</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            pkts[nb_pkts++] = pkt;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* return packets */</span></div>
<div class="line">    <span class="keywordflow">return</span> nb_pkts;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">uint16_t</div>
<div class="line">ipsec_inbound(<span class="keyword">struct</span> ipsec_ctx *ctx, <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkts[],</div>
<div class="line">        uint16_t nb_pkts, uint16_t len)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">void</span> *sas[nb_pkts];</div>
<div class="line"> </div>
<div class="line">    inbound_sa_lookup(ctx-&gt;sa_ctx, pkts, sas, nb_pkts);</div>
<div class="line"> </div>
<div class="line">    ipsec_enqueue(esp_inbound, ctx, pkts, sas, nb_pkts);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> ipsec_inline_dequeue(esp_inbound_post, ctx, pkts, len);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">uint16_t</div>
<div class="line">ipsec_inbound_cqp_dequeue(<span class="keyword">struct</span> ipsec_ctx *ctx, <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkts[],</div>
<div class="line">        uint16_t len)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> ipsec_dequeue(esp_inbound_post, ctx, pkts, len);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">uint16_t</div>
<div class="line">ipsec_outbound(<span class="keyword">struct</span> ipsec_ctx *ctx, <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkts[],</div>
<div class="line">        uint32_t sa_idx[], uint16_t nb_pkts, uint16_t len)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">void</span> *sas[nb_pkts];</div>
<div class="line"> </div>
<div class="line">    outbound_sa_lookup(ctx-&gt;sa_ctx, sa_idx, sas, nb_pkts);</div>
<div class="line"> </div>
<div class="line">    ipsec_enqueue(esp_outbound, ctx, pkts, sas, nb_pkts);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> ipsec_inline_dequeue(esp_outbound_post, ctx, pkts, len);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">uint16_t</div>
<div class="line">ipsec_outbound_cqp_dequeue(<span class="keyword">struct</span> ipsec_ctx *ctx, <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkts[],</div>
<div class="line">        uint16_t len)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> ipsec_dequeue(esp_outbound_post, ctx, pkts, len);</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="arte__hash_8h_html"><div class="ttname"><a href="rte__hash_8h.html">rte_hash.h</a></div></div>
<div class="ttc" id="arte__security_8h_html_a4ace8d873b2a4832039eb2f964b12165a32e56f07add678e64f24fb06d7e8b93c"><div class="ttname"><a href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a32e56f07add678e64f24fb06d7e8b93c">RTE_SECURITY_ACTION_TYPE_CPU_CRYPTO</a></div><div class="ttdeci">@ RTE_SECURITY_ACTION_TYPE_CPU_CRYPTO</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00349">rte_security.h:345</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a0032857587ce7e217b8c10ba392bef56"><div class="ttname"><a href="rte__cryptodev_8h.html#a0032857587ce7e217b8c10ba392bef56">rte_cryptodev_dequeue_burst</a></div><div class="ttdeci">static uint16_t rte_cryptodev_dequeue_burst(uint8_t dev_id, uint16_t qp_id, struct rte_crypto_op **ops, uint16_t nb_ops)</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00943">rte_cryptodev.h:943</a></div></div>
<div class="ttc" id="astructrte__cryptodev__info_html"><div class="ttname"><a href="structrte__cryptodev__info.html">rte_cryptodev_info</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00477">rte_cryptodev.h:477</a></div></div>
<div class="ttc" id="arte__security_8h_html_a6ff944ce0c3d11c12ea6bd77269a77b8a1f53b841897fdf71f3bda964406b67cc"><div class="ttname"><a href="rte__security_8h.html#a6ff944ce0c3d11c12ea6bd77269a77b8a1f53b841897fdf71f3bda964406b67cc">RTE_SECURITY_IPSEC_SA_DIR_INGRESS</a></div><div class="ttdeci">@ RTE_SECURITY_IPSEC_SA_DIR_INGRESS</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00191">rte_security.h:190</a></div></div>
<div class="ttc" id="arte__security_8h_html_ae7a4e7b862ba5ce383229caccc45eee2"><div class="ttname"><a href="rte__security_8h.html#ae7a4e7b862ba5ce383229caccc45eee2">RTE_SECURITY_TX_HW_TRAILER_OFFLOAD</a></div><div class="ttdeci">#define RTE_SECURITY_TX_HW_TRAILER_OFFLOAD</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00712">rte_security.h:707</a></div></div>
<div class="ttc" id="astructrte__security__capability_html"><div class="ttname"><a href="structrte__security__capability.html">rte_security_capability</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00642">rte_security.h:642</a></div></div>
<div class="ttc" id="arte__security_8h_html_adac3a0658251756f8832045babe60b83"><div class="ttname"><a href="rte__security_8h.html#adac3a0658251756f8832045babe60b83">rte_security_capabilities_get</a></div><div class="ttdeci">const struct rte_security_capability * rte_security_capabilities_get(struct rte_security_ctx *instance)</div></div>
<div class="ttc" id="arte__security_8h_html"><div class="ttname"><a href="rte__security_8h.html">rte_security.h</a></div></div>
<div class="ttc" id="astructrte__security__capability_html_a1ea9e0895b70c465a21a009e5b94321d"><div class="ttname"><a href="structrte__security__capability.html#a1ea9e0895b70c465a21a009e5b94321d">rte_security_capability::ol_flags</a></div><div class="ttdeci">uint32_t ol_flags</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00686">rte_security.h:686</a></div></div>
<div class="ttc" id="arte__prefetch_8h_html_a7f89cf66766e6bfd63feb370a7280de9"><div class="ttname"><a href="rte__prefetch_8h.html#a7f89cf66766e6bfd63feb370a7280de9">rte_prefetch0</a></div><div class="ttdeci">static void rte_prefetch0(const volatile void *p)</div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a1e1336b0a8fe381ea03a52bad85e5734"><div class="ttname"><a href="rte__cryptodev_8h.html#a1e1336b0a8fe381ea03a52bad85e5734">rte_cryptodev_enqueue_burst</a></div><div class="ttdeci">static uint16_t rte_cryptodev_enqueue_burst(uint8_t dev_id, uint16_t qp_id, struct rte_crypto_op **ops, uint16_t nb_ops)</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00987">rte_cryptodev.h:987</a></div></div>
<div class="ttc" id="arte__security_8h_html_a6ff944ce0c3d11c12ea6bd77269a77b8a7181811ead51812b5e782cb9665a302f"><div class="ttname"><a href="rte__security_8h.html#a6ff944ce0c3d11c12ea6bd77269a77b8a7181811ead51812b5e782cb9665a302f">RTE_SECURITY_IPSEC_SA_DIR_EGRESS</a></div><div class="ttdeci">@ RTE_SECURITY_IPSEC_SA_DIR_EGRESS</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00189">rte_security.h:188</a></div></div>
<div class="ttc" id="arte__branch__prediction_8h_html_ac6c45889010c1bd68631771b64f18101"><div class="ttname"><a href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a></div><div class="ttdeci">#define unlikely(x)</div><div class="ttdef"><b>Definition:</b> <a href="rte__branch__prediction_8h_source.html#l00038">rte_branch_prediction.h:38</a></div></div>
<div class="ttc" id="arte__security_8h_html_a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f"><div class="ttname"><a href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f">RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</a></div><div class="ttdeci">@ RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00340">rte_security.h:337</a></div></div>
<div class="ttc" id="arte__crypto_8h_html"><div class="ttname"><a href="rte__crypto_8h.html">rte_crypto.h</a></div></div>
<div class="ttc" id="arte__security_8h_html_a052689b2d2d1afa7d14c98a1fd04cad0"><div class="ttname"><a href="rte__security_8h.html#a052689b2d2d1afa7d14c98a1fd04cad0">rte_security_set_pkt_metadata</a></div><div class="ttdeci">int rte_security_set_pkt_metadata(struct rte_security_ctx *instance, struct rte_security_session *sess, struct rte_mbuf *mb, void *params)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a539fa8ee80c94d538a42d951e4bcb00e"><div class="ttname"><a href="rte__ethdev_8h.html#a539fa8ee80c94d538a42d951e4bcb00e">rte_eth_dev_get_sec_ctx</a></div><div class="ttdeci">void * rte_eth_dev_get_sec_ctx(uint16_t port_id)</div></div>
<div class="ttc" id="astructrte__security__capability_html_a2fbd3c84a661bcf4013d722120476f43"><div class="ttname"><a href="structrte__security__capability.html#a2fbd3c84a661bcf4013d722120476f43">rte_security_capability::ipsec</a></div><div class="ttdeci">struct rte_security_capability::@315::@317 ipsec</div></div>
<div class="ttc" id="arte__cryptodev_8h_html_aeb677c03cea6fcc48a8caa533e3729f9"><div class="ttname"><a href="rte__cryptodev_8h.html#aeb677c03cea6fcc48a8caa533e3729f9">rte_cryptodev_info_get</a></div><div class="ttdeci">void rte_cryptodev_info_get(uint8_t dev_id, struct rte_cryptodev_info *dev_info)</div></div>
<div class="ttc" id="arte__log_8h_html"><div class="ttname"><a href="rte__log_8h.html">rte_log.h</a></div></div>
<div class="ttc" id="astructrte__security__ipsec__tunnel__param_html"><div class="ttname"><a href="structrte__security__ipsec__tunnel__param.html">rte_security_ipsec_tunnel_param</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00081">rte_security.h:81</a></div></div>
<div class="ttc" id="astructrte__security__ipsec__xform_html_acd1593fa6d838e374ca05311b4efd081"><div class="ttname"><a href="structrte__security__ipsec__xform.html#acd1593fa6d838e374ca05311b4efd081">rte_security_ipsec_xform::mode</a></div><div class="ttdeci">enum rte_security_ipsec_sa_mode mode</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00202">rte_security.h:210</a></div></div>
<div class="ttc" id="astructrte__security__ctx_html"><div class="ttname"><a href="structrte__security__ctx.html">rte_security_ctx</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00067">rte_security.h:67</a></div></div>
<div class="ttc" id="arte__security_8h_html_a90a4754d59edd1bf3fbb81ddd6797ddda8360104a6e33ebeaa833f964492577ec"><div class="ttname"><a href="rte__security_8h.html#a90a4754d59edd1bf3fbb81ddd6797ddda8360104a6e33ebeaa833f964492577ec">RTE_SECURITY_IPSEC_SA_MODE_TUNNEL</a></div><div class="ttdeci">@ RTE_SECURITY_IPSEC_SA_MODE_TUNNEL</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00039">rte_security.h:38</a></div></div>
<div class="ttc" id="arte__flow_8h_html_a78f0386e683cfc491462a771df8b971aa7bc270d4629785c13b81dccca71f67e3"><div class="ttname"><a href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aa7bc270d4629785c13b81dccca71f67e3">RTE_FLOW_ACTION_TYPE_END</a></div><div class="ttdeci">@ RTE_FLOW_ACTION_TYPE_END</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l01703">rte_flow.h:1703</a></div></div>
<div class="ttc" id="arte__flow_8h_html_a698ab49350e51414a31b9c511a7abe4e"><div class="ttname"><a href="rte__flow_8h.html#a698ab49350e51414a31b9c511a7abe4e">rte_flow_create</a></div><div class="ttdeci">struct rte_flow * rte_flow_create(uint16_t port_id, const struct rte_flow_attr *attr, const struct rte_flow_item pattern[], const struct rte_flow_action actions[], struct rte_flow_error *error)</div></div>
<div class="ttc" id="arte__flow_8h_html_a78f0386e683cfc491462a771df8b971aaac9738009ac5b299c3c4facdbdf66890"><div class="ttname"><a href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aaac9738009ac5b299c3c4facdbdf66890">RTE_FLOW_ACTION_TYPE_SECURITY</a></div><div class="ttdeci">@ RTE_FLOW_ACTION_TYPE_SECURITY</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l01827">rte_flow.h:1827</a></div></div>
<div class="ttc" id="arte__branch__prediction_8h_html"><div class="ttname"><a href="rte__branch__prediction_8h.html">rte_branch_prediction.h</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html"><div class="ttname"><a href="rte__cryptodev_8h.html">rte_cryptodev.h</a></div></div>
<div class="ttc" id="astructrte__esp__hdr_html_ade83e664f1375a837252e7bbb6d53a67"><div class="ttname"><a href="structrte__esp__hdr.html#ade83e664f1375a837252e7bbb6d53a67">rte_esp_hdr::spi</a></div><div class="ttdeci">rte_be32_t spi</div><div class="ttdef"><b>Definition:</b> <a href="rte__esp_8h_source.html#l00024">rte_esp.h:24</a></div></div>
<div class="ttc" id="arte__flow_8h_html_af10e2b0af33527be504e883406a84ca1a51161f8ef75cba3968e32fc0472575d7"><div class="ttname"><a href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1a51161f8ef75cba3968e32fc0472575d7">RTE_FLOW_ITEM_TYPE_END</a></div><div class="ttdeci">@ RTE_FLOW_ITEM_TYPE_END</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l00128">rte_flow.h:128</a></div></div>
<div class="ttc" id="astructrte__mbuf_html"><div class="ttname"><a href="structrte__mbuf.html">rte_mbuf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00473">rte_mbuf_core.h:473</a></div></div>
<div class="ttc" id="arte__security_8h_html_a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116"><div class="ttname"><a href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116">RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</a></div><div class="ttdeci">@ RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00336">rte_security.h:333</a></div></div>
<div class="ttc" id="astructrte__security__session__conf_html_afd0ffb02780e738d4c0a10ab833b7834"><div class="ttname"><a href="structrte__security__session__conf.html#afd0ffb02780e738d4c0a10ab833b7834">rte_security_session_conf::userdata</a></div><div class="ttdeci">void * userdata</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00381">rte_security.h:381</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a7593f4fff04f4ae1b1d718db7ca7dc8c"><div class="ttname"><a href="rte__ethdev_8h.html#a7593f4fff04f4ae1b1d718db7ca7dc8c">rte_eth_dev_info_get</a></div><div class="ttdeci">int rte_eth_dev_info_get(uint16_t port_id, struct rte_eth_dev_info *dev_info)</div></div>
<div class="ttc" id="arte__flow_8h_html_af10e2b0af33527be504e883406a84ca1a04512db8022f42e5935cfc2ecdde66b2"><div class="ttname"><a href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1a04512db8022f42e5935cfc2ecdde66b2">RTE_FLOW_ITEM_TYPE_IPV4</a></div><div class="ttdeci">@ RTE_FLOW_ITEM_TYPE_IPV4</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l00224">rte_flow.h:224</a></div></div>
<div class="ttc" id="astructrte__crypto__op_html"><div class="ttname"><a href="structrte__crypto__op.html">rte_crypto_op</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00078">rte_crypto.h:78</a></div></div>
<div class="ttc" id="astructrte__crypto__sym__op_html_af021669494a2806b0569587e2096e88e"><div class="ttname"><a href="structrte__crypto__sym__op.html#af021669494a2806b0569587e2096e88e">rte_crypto_sym_op::m_src</a></div><div class="ttdeci">struct rte_mbuf * m_src</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00592">rte_crypto_sym.h:592</a></div></div>
<div class="ttc" id="astructrte__eth__rss__conf_html_ab8f32e03af342f65e890c42b24511866"><div class="ttname"><a href="structrte__eth__rss__conf.html#ab8f32e03af342f65e890c42b24511866">rte_eth_rss_conf::rss_key_len</a></div><div class="ttdeci">uint8_t rss_key_len</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00456">rte_ethdev.h:456</a></div></div>
<div class="ttc" id="arte__security_8h_html_afc6cccf055ce77715c4cb2d3ba3cd56da8d7464f943785202f18983676e659492"><div class="ttname"><a href="rte__security_8h.html#afc6cccf055ce77715c4cb2d3ba3cd56da8d7464f943785202f18983676e659492">RTE_SECURITY_IPSEC_TUNNEL_IPV4</a></div><div class="ttdeci">@ RTE_SECURITY_IPSEC_TUNNEL_IPV4</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00053">rte_security.h:52</a></div></div>
<div class="ttc" id="astructrte__ipsec__session_html_aa8f42f3a36d2c036ccb27f0b74b25160"><div class="ttname"><a href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">rte_ipsec_session::sa</a></div><div class="ttdeci">struct rte_ipsec_sa * sa</div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec_8h_source.html#l00063">rte_ipsec.h:63</a></div></div>
<div class="ttc" id="arte__security_8h_html_ac74a41d31b6c3d57623607a7607dfda5"><div class="ttname"><a href="rte__security_8h.html#ac74a41d31b6c3d57623607a7607dfda5">rte_security_session_create</a></div><div class="ttdeci">struct rte_security_session * rte_security_session_create(struct rte_security_ctx *instance, struct rte_security_session_conf *conf, struct rte_mempool *mp, struct rte_mempool *priv_mp)</div></div>
<div class="ttc" id="astructrte__security__session__conf_html_a89cbc266019b64116143ada1e3f0b5c3"><div class="ttname"><a href="structrte__security__session__conf.html#a89cbc266019b64116143ada1e3f0b5c3">rte_security_session_conf::action_type</a></div><div class="ttdeci">enum rte_security_session_action_type action_type</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00302">rte_security.h:367</a></div></div>
<div class="ttc" id="arte__security_8h_html_aa37e473f2d863dedf92612e23e82d49c"><div class="ttname"><a href="rte__security_8h.html#aa37e473f2d863dedf92612e23e82d49c">RTE_SECURITY_TX_OLOAD_NEED_MDATA</a></div><div class="ttdeci">#define RTE_SECURITY_TX_OLOAD_NEED_MDATA</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00705">rte_security.h:703</a></div></div>
<div class="ttc" id="astructrte__flow__action__queue_html"><div class="ttname"><a href="structrte__flow__action__queue.html">rte_flow_action_queue</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l02238">rte_flow.h:2238</a></div></div>
<div class="ttc" id="arte__crypto_8h_html_affaf4fd29a51d350b387155494402a84"><div class="ttname"><a href="rte__crypto_8h.html#affaf4fd29a51d350b387155494402a84">rte_crypto_op_attach_sym_session</a></div><div class="ttdeci">static int rte_crypto_op_attach_sym_session(struct rte_crypto_op *op, struct rte_cryptodev_sym_session *sess)</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00412">rte_crypto.h:412</a></div></div>
<div class="ttc" id="astructrte__security__capability_html_a67a170e529eee8ec126fb0e350f59b73"><div class="ttname"><a href="structrte__security__capability.html#a67a170e529eee8ec126fb0e350f59b73">rte_security_capability::action</a></div><div class="ttdeci">enum rte_security_session_action_type action</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00611">rte_security.h:643</a></div></div>
<div class="ttc" id="astructrte__flow__item__esp_html_ace8372c9a582c14baa87cee1f280b0a5"><div class="ttname"><a href="structrte__flow__item__esp.html#ace8372c9a582c14baa87cee1f280b0a5">rte_flow_item_esp::hdr</a></div><div class="ttdeci">struct rte_esp_hdr hdr</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l01082">rte_flow.h:1098</a></div></div>
<div class="ttc" id="astructrte__crypto__op_html_a493a2a236148232b6e55a9a5b280d3b7"><div class="ttname"><a href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">rte_crypto_op::sym</a></div><div class="ttdeci">struct rte_crypto_sym_op sym[0]</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00100">rte_crypto.h:118</a></div></div>
<div class="ttc" id="arte__lcore_8h_html_adfb2b334e7e73f534f25e8888a8a775f"><div class="ttname"><a href="rte__lcore_8h.html#adfb2b334e7e73f534f25e8888a8a775f">rte_lcore_id</a></div><div class="ttdeci">static unsigned rte_lcore_id(void)</div><div class="ttdef"><b>Definition:</b> <a href="rte__lcore_8h_source.html#l00075">rte_lcore.h:75</a></div></div>
<div class="ttc" id="arte__crypto_8h_html_afe16508b77c2a8dc5caf74a4e9850171abf99a223ed848ecec30ee7aa80743dc0"><div class="ttname"><a href="rte__crypto_8h.html#afe16508b77c2a8dc5caf74a4e9850171abf99a223ed848ecec30ee7aa80743dc0">RTE_CRYPTO_OP_STATUS_NOT_PROCESSED</a></div><div class="ttdeci">@ RTE_CRYPTO_OP_STATUS_NOT_PROCESSED</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00043">rte_crypto.h:42</a></div></div>
<div class="ttc" id="astructrte__flow__action__rss_html"><div class="ttname"><a href="structrte__flow__action__rss.html">rte_flow_action_rss</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l02357">rte_flow.h:2357</a></div></div>
<div class="ttc" id="arte__hash_8h_html_a1bd8f85b9c99eea0a619acc1d6ce2b2c"><div class="ttname"><a href="rte__hash_8h.html#a1bd8f85b9c99eea0a619acc1d6ce2b2c">rte_hash_lookup_data</a></div><div class="ttdeci">int rte_hash_lookup_data(const struct rte_hash *h, const void *key, void **data)</div></div>
<div class="ttc" id="arte__flow_8h_html_a865bcafbcac0dc0ed5047a75ce24e6a0"><div class="ttname"><a href="rte__flow_8h.html#a865bcafbcac0dc0ed5047a75ce24e6a0">rte_flow_item_ipv6_mask</a></div><div class="ttdeci">static const struct rte_flow_item_ipv6 rte_flow_item_ipv6_mask</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l00553">rte_flow.h:838</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a6000dca62f9815414b3f3b9c5d8be62f"><div class="ttname"><a href="rte__ethdev_8h.html#a6000dca62f9815414b3f3b9c5d8be62f">rte_eth_dev_rss_hash_conf_get</a></div><div class="ttdeci">int rte_eth_dev_rss_hash_conf_get(uint16_t port_id, struct rte_eth_rss_conf *rss_conf)</div></div>
<div class="ttc" id="astructrte__eth__rss__conf_html_ad70f17882a835e5d4e38c64a9f872fdc"><div class="ttname"><a href="structrte__eth__rss__conf.html#ad70f17882a835e5d4e38c64a9f872fdc">rte_eth_rss_conf::rss_hf</a></div><div class="ttdeci">uint64_t rss_hf</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00457">rte_ethdev.h:457</a></div></div>
<div class="ttc" id="astructrte__security__ipsec__xform_html_a5a6fb8c5d2a3299f6df0ba509a3aaf53"><div class="ttname"><a href="structrte__security__ipsec__xform.html#a5a6fb8c5d2a3299f6df0ba509a3aaf53">rte_security_ipsec_xform::esn_soft_limit</a></div><div class="ttdeci">uint64_t esn_soft_limit</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00214">rte_security.h:214</a></div></div>
<div class="ttc" id="arte__flow_8h_html_ac2215329b636beb0199b939cbdc2a23e"><div class="ttname"><a href="rte__flow_8h.html#ac2215329b636beb0199b939cbdc2a23e">rte_flow_item_ipv4_mask</a></div><div class="ttdeci">static const struct rte_flow_item_ipv4 rte_flow_item_ipv4_mask</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l00553">rte_flow.h:797</a></div></div>
<div class="ttc" id="astructrte__security__ipsec__sa__options_html_ad24299d78626a8d6f177199748a6088c"><div class="ttname"><a href="structrte__security__ipsec__sa__options.html#ad24299d78626a8d6f177199748a6088c">rte_security_ipsec_sa_options::esn</a></div><div class="ttdeci">uint32_t esn</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00124">rte_security.h:124</a></div></div>
<div class="ttc" id="arte__flow_8h_html_ad8d8fbd2462ffab6e7cd2d869000d86f"><div class="ttname"><a href="rte__flow_8h.html#ad8d8fbd2462ffab6e7cd2d869000d86f">rte_flow_item_esp_mask</a></div><div class="ttdeci">static const struct rte_flow_item_esp rte_flow_item_esp_mask</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l00553">rte_flow.h:1103</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_ad40470ee7e072f93f85f1bb584e64e39"><div class="ttname"><a href="rte__cryptodev_8h.html#ad40470ee7e072f93f85f1bb584e64e39">rte_cryptodev_sym_session_create</a></div><div class="ttdeci">struct rte_cryptodev_sym_session * rte_cryptodev_sym_session_create(struct rte_mempool *mempool)</div></div>
<div class="ttc" id="arte__flow_8h_html_af10e2b0af33527be504e883406a84ca1ae4196d14795c390875542f9c8c9e2d60"><div class="ttname"><a href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1ae4196d14795c390875542f9c8c9e2d60">RTE_FLOW_ITEM_TYPE_IPV6</a></div><div class="ttdeci">@ RTE_FLOW_ITEM_TYPE_IPV6</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l00231">rte_flow.h:231</a></div></div>
<div class="ttc" id="astructrte__ipsec__session_html_adb36704cd7fc83a9e5f8e10720974165"><div class="ttname"><a href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">rte_ipsec_session::type</a></div><div class="ttdeci">enum rte_security_session_action_type type</div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec_8h_source.html#l00063">rte_ipsec.h:65</a></div></div>
<div class="ttc" id="astructrte__security__ipsec__tunnel__param_html_a3ba6c20a9ae78d30229311bec9c6ba74"><div class="ttname"><a href="structrte__security__ipsec__tunnel__param.html#a3ba6c20a9ae78d30229311bec9c6ba74">rte_security_ipsec_tunnel_param::ipv6</a></div><div class="ttdeci">struct rte_security_ipsec_tunnel_param::@307::@310 ipv6</div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a3b05f51fd91ec181c369e32908d55717"><div class="ttname"><a href="rte__cryptodev_8h.html#a3b05f51fd91ec181c369e32908d55717">rte_cryptodev_sym_session_init</a></div><div class="ttdeci">int rte_cryptodev_sym_session_init(uint8_t dev_id, struct rte_cryptodev_sym_session *sess, struct rte_crypto_sym_xform *xforms, struct rte_mempool *mempool)</div></div>
<div class="ttc" id="astructrte__security__ipsec__tunnel__param_html_a5dc131a2f6854751b5cf4120e724fe75"><div class="ttname"><a href="structrte__security__ipsec__tunnel__param.html#a5dc131a2f6854751b5cf4120e724fe75">rte_security_ipsec_tunnel_param::type</a></div><div class="ttdeci">enum rte_security_ipsec_tunnel_type type</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00072">rte_security.h:82</a></div></div>
<div class="ttc" id="arte__security_8h_html_afc6cccf055ce77715c4cb2d3ba3cd56da130fadc098deccd221f4ec369f8aeabe"><div class="ttname"><a href="rte__security_8h.html#afc6cccf055ce77715c4cb2d3ba3cd56da130fadc098deccd221f4ec369f8aeabe">RTE_SECURITY_IPSEC_TUNNEL_IPV6</a></div><div class="ttdeci">@ RTE_SECURITY_IPSEC_TUNNEL_IPV6</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00055">rte_security.h:54</a></div></div>
<div class="ttc" id="arte__flow_8h_html_a78f0386e683cfc491462a771df8b971aa7a913800d2a0c7655ec296ce651b6306"><div class="ttname"><a href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aa7a913800d2a0c7655ec296ce651b6306">RTE_FLOW_ACTION_TYPE_QUEUE</a></div><div class="ttdeci">@ RTE_FLOW_ACTION_TYPE_QUEUE</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l01751">rte_flow.h:1751</a></div></div>
<div class="ttc" id="arte__flow_8h_html_a3fc6e9416462572d5a978e77d9ea2ec8"><div class="ttname"><a href="rte__flow_8h.html#a3fc6e9416462572d5a978e77d9ea2ec8">rte_flow_validate</a></div><div class="ttdeci">int rte_flow_validate(uint16_t port_id, const struct rte_flow_attr *attr, const struct rte_flow_item pattern[], const struct rte_flow_action actions[], struct rte_flow_error *error)</div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a72971b7d0ff85ae8c4c1a97ada778d36"><div class="ttname"><a href="rte__cryptodev_8h.html#a72971b7d0ff85ae8c4c1a97ada778d36">RTE_CRYPTODEV_FF_SYM_CPU_CRYPTO</a></div><div class="ttdeci">#define RTE_CRYPTODEV_FF_SYM_CPU_CRYPTO</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00456">rte_cryptodev.h:455</a></div></div>
<div class="ttc" id="arte__flow_8h_html_af10e2b0af33527be504e883406a84ca1a378d681349151b147a42ecfe0023f826"><div class="ttname"><a href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1a378d681349151b147a42ecfe0023f826">RTE_FLOW_ITEM_TYPE_ESP</a></div><div class="ttdeci">@ RTE_FLOW_ITEM_TYPE_ESP</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l00340">rte_flow.h:340</a></div></div>
<div class="ttc" id="astructrte__ipsec__session_html"><div class="ttname"><a href="structrte__ipsec__session.html">rte_ipsec_session</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec_8h_source.html#l00058">rte_ipsec.h:58</a></div></div>
<div class="ttc" id="astructrte__security__ipsec__xform_html_aa6f69b0c59c4226f3b5934f459c118ff"><div class="ttname"><a href="structrte__security__ipsec__xform.html#aa6f69b0c59c4226f3b5934f459c118ff">rte_security_ipsec_xform::options</a></div><div class="ttdeci">struct rte_security_ipsec_sa_options options</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00202">rte_security.h:204</a></div></div>
<div class="ttc" id="arte__crypto_8h_html_ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc"><div class="ttname"><a href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc">RTE_CRYPTO_OP_TYPE_SYMMETRIC</a></div><div class="ttdeci">@ RTE_CRYPTO_OP_TYPE_SYMMETRIC</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00033">rte_crypto.h:32</a></div></div>
<div class="ttc" id="astructrte__security__ipsec__xform_html_a85eb02412c31f7fbf81890c32a231b95"><div class="ttname"><a href="structrte__security__ipsec__xform.html#a85eb02412c31f7fbf81890c32a231b95">rte_security_ipsec_xform::replay_win_sz</a></div><div class="ttdeci">uint32_t replay_win_sz</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00216">rte_security.h:216</a></div></div>
<div class="ttc" id="astructrte__security__capability_html_ac9771e73fffbfa2e6fd004aaedc16267"><div class="ttname"><a href="structrte__security__capability.html#ac9771e73fffbfa2e6fd004aaedc16267">rte_security_capability::protocol</a></div><div class="ttdeci">enum rte_security_session_protocol protocol</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00611">rte_security.h:645</a></div></div>
<div class="ttc" id="arte__security_8h_html_a03e4e45b700bf9650209b11a48e293f2aa476f140e333d64059372915d4f0b432"><div class="ttname"><a href="rte__security_8h.html#a03e4e45b700bf9650209b11a48e293f2aa476f140e333d64059372915d4f0b432">RTE_SECURITY_PROTOCOL_IPSEC</a></div><div class="ttdeci">@ RTE_SECURITY_PROTOCOL_IPSEC</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00354">rte_security.h:353</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html"><div class="ttname"><a href="rte__ethdev_8h.html">rte_ethdev.h</a></div></div>
<div class="ttc" id="arte__security_8h_html_a41d5c17d1eba1fe9a6bf87dae42efceba41914b40959619c1634433120107a0fb"><div class="ttname"><a href="rte__security_8h.html#a41d5c17d1eba1fe9a6bf87dae42efceba41914b40959619c1634433120107a0fb">RTE_SECURITY_IPSEC_SA_PROTO_ESP</a></div><div class="ttdeci">@ RTE_SECURITY_IPSEC_SA_PROTO_ESP</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00047">rte_security.h:46</a></div></div>
<div class="ttc" id="arte__byteorder_8h_html_a6b1dd5d5a4c60c1d72ba48c523eba45c"><div class="ttname"><a href="rte__byteorder_8h.html#a6b1dd5d5a4c60c1d72ba48c523eba45c">rte_cpu_to_be_32</a></div><div class="ttdeci">static rte_be32_t rte_cpu_to_be_32(uint32_t x)</div></div>
<div class="ttc" id="arte__log_8h_html_ac23caeb9833fd0fd0665c6c05ec806fe"><div class="ttname"><a href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a></div><div class="ttdeci">#define RTE_LOG(l, t,...)</div><div class="ttdef"><b>Definition:</b> <a href="rte__log_8h_source.html#l00331">rte_log.h:331</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html"><div class="ttname"><a href="rte__mbuf_8h.html">rte_mbuf.h</a></div></div>
<div class="ttc" id="arte__security_8h_html_a4ace8d873b2a4832039eb2f964b12165a770b2f7ec6c90bba88ba546acaa2c17f"><div class="ttname"><a href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a770b2f7ec6c90bba88ba546acaa2c17f">RTE_SECURITY_ACTION_TYPE_LOOKASIDE_PROTOCOL</a></div><div class="ttdeci">@ RTE_SECURITY_ACTION_TYPE_LOOKASIDE_PROTOCOL</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00344">rte_security.h:341</a></div></div>
<div class="ttc" id="astructrte__eth__rss__conf_html"><div class="ttname"><a href="structrte__eth__rss__conf.html">rte_eth_rss_conf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00454">rte_ethdev.h:454</a></div></div>
<div class="ttc" id="astructrte__flow__action__rss_html_a8a500410fe68a94958d3f97a602378e1"><div class="ttname"><a href="structrte__flow__action__rss.html#a8a500410fe68a94958d3f97a602378e1">rte_flow_action_rss::queue</a></div><div class="ttdeci">const uint16_t * queue</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l02389">rte_flow.h:2389</a></div></div>
<div class="ttc" id="astructrte__eth__rss__conf_html_a931e368ed1b5a8211a963bc05c503739"><div class="ttname"><a href="structrte__eth__rss__conf.html#a931e368ed1b5a8211a963bc05c503739">rte_eth_rss_conf::rss_key</a></div><div class="ttdeci">uint8_t * rss_key</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00455">rte_ethdev.h:455</a></div></div>
<div class="ttc" id="astructrte__flow__error_html"><div class="ttname"><a href="structrte__flow__error.html">rte_flow_error</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l02901">rte_flow.h:2901</a></div></div>
<div class="ttc" id="arte__log_8h_html_aeed72aff1af9a59d2de85b96955e21f9"><div class="ttname"><a href="rte__log_8h.html#aeed72aff1af9a59d2de85b96955e21f9">RTE_LOG_DP</a></div><div class="ttdeci">#define RTE_LOG_DP(l, t,...)</div><div class="ttdef"><b>Definition:</b> <a href="rte__log_8h_source.html#l00355">rte_log.h:355</a></div></div>
<div class="ttc" id="arte__flow_8h_html_af10e2b0af33527be504e883406a84ca1abb502c9d1fc4678e1e36187090494aca"><div class="ttname"><a href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1abb502c9d1fc4678e1e36187090494aca">RTE_FLOW_ITEM_TYPE_ETH</a></div><div class="ttdeci">@ RTE_FLOW_ITEM_TYPE_ETH</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l00210">rte_flow.h:210</a></div></div>
<div class="ttc" id="astructrte__eth__dev__info_html"><div class="ttname"><a href="structrte__eth__dev__info.html">rte_eth_dev_info</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01504">rte_ethdev.h:1504</a></div></div>
<div class="ttc" id="astructrte__security__ipsec__xform_html_a09effbe0c0a82be53c6c1023766d519a"><div class="ttname"><a href="structrte__security__ipsec__xform.html#a09effbe0c0a82be53c6c1023766d519a">rte_security_ipsec_xform::tunnel</a></div><div class="ttdeci">struct rte_security_ipsec_tunnel_param tunnel</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00202">rte_security.h:212</a></div></div>
<div class="ttc" id="astructrte__security__ipsec__tunnel__param_html_a8318aa6e744551b298a68ebb3122e20b"><div class="ttname"><a href="structrte__security__ipsec__tunnel__param.html#a8318aa6e744551b298a68ebb3122e20b">rte_security_ipsec_tunnel_param::ipv4</a></div><div class="ttdeci">struct rte_security_ipsec_tunnel_param::@307::@309 ipv4</div></div>
<div class="ttc" id="astructrte__security__session__conf_html"><div class="ttname"><a href="structrte__security__session__conf.html">rte_security_session_conf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00366">rte_security.h:366</a></div></div>
<div class="ttc" id="arte__flow_8h_html_a78f0386e683cfc491462a771df8b971aa33147c5e8dbbd8b07ef471ff07e72f6a"><div class="ttname"><a href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aa33147c5e8dbbd8b07ef471ff07e72f6a">RTE_FLOW_ACTION_TYPE_PASSTHRU</a></div><div class="ttdeci">@ RTE_FLOW_ACTION_TYPE_PASSTHRU</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l01719">rte_flow.h:1719</a></div></div>
<div class="ttc" id="astructrte__crypto__sym__op_html"><div class="ttname"><a href="structrte__crypto__sym__op.html">rte_crypto_sym_op</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00591">rte_crypto_sym.h:591</a></div></div>
<div class="ttc" id="astructrte__security__ipsec__xform_html"><div class="ttname"><a href="structrte__security__ipsec__xform.html">rte_security_ipsec_xform</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00199">rte_security.h:199</a></div></div>
<div class="ttc" id="arte__security_8h_html_a4ace8d873b2a4832039eb2f964b12165a79eb9b51e068301f8839e759e08d2b52"><div class="ttname"><a href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a79eb9b51e068301f8839e759e08d2b52">RTE_SECURITY_ACTION_TYPE_NONE</a></div><div class="ttdeci">@ RTE_SECURITY_ACTION_TYPE_NONE</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00332">rte_security.h:331</a></div></div>
<div class="ttc" id="arte__security_8h_html_a90a4754d59edd1bf3fbb81ddd6797dddaba196bf14f686ad65b7e951a171b236c"><div class="ttname"><a href="rte__security_8h.html#a90a4754d59edd1bf3fbb81ddd6797dddaba196bf14f686ad65b7e951a171b236c">RTE_SECURITY_IPSEC_SA_MODE_TRANSPORT</a></div><div class="ttdeci">@ RTE_SECURITY_IPSEC_SA_MODE_TRANSPORT</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00037">rte_security.h:36</a></div></div>
<div class="ttc" id="arte__security_8h_html_a9806ea434f90d97e3a228c0258baee5d"><div class="ttname"><a href="rte__security_8h.html#a9806ea434f90d97e3a228c0258baee5d">rte_security_attach_session</a></div><div class="ttdeci">static int rte_security_attach_session(struct rte_crypto_op *op, struct rte_security_session *sess)</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00573">rte_security.h:573</a></div></div>
<div class="ttc" id="arte__flow_8h_html_a78f0386e683cfc491462a771df8b971aa72428c7c1896fe4dfdc2dbed85214d27"><div class="ttname"><a href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aa72428c7c1896fe4dfdc2dbed85214d27">RTE_FLOW_ACTION_TYPE_RSS</a></div><div class="ttdeci">@ RTE_FLOW_ACTION_TYPE_RSS</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l01780">rte_flow.h:1780</a></div></div>
<div class="ttc" id="arte__ipsec_8h_html"><div class="ttname"><a href="rte__ipsec_8h.html">rte_ipsec.h</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
