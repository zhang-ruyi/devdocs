<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DPDK: examples/l2fwd-crypto/main.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DPDK
   &#160;<span id="projectnumber">20.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">examples/l2fwd-crypto/main.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/* SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment"> * Copyright(c) 2015-2016 Intel Corporation</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;time.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;inttypes.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/types.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/queue.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;netinet/in.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;setjmp.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdarg.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ctype.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;errno.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;getopt.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fcntl.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__string__fns_8h.html">rte_string_fns.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__atomic_8h.html">rte_atomic.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__branch__prediction_8h.html">rte_branch_prediction.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__common_8h.html">rte_common.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__cryptodev_8h.html">rte_cryptodev.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__cycles_8h.html">rte_cycles.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__debug_8h.html">rte_debug.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__eal_8h.html">rte_eal.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ether_8h.html">rte_ether.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ethdev_8h.html">rte_ethdev.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__interrupts_8h.html">rte_interrupts.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ip_8h.html">rte_ip.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__launch_8h.html">rte_launch.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__lcore_8h.html">rte_lcore.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__log_8h.html">rte_log.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__malloc_8h.html">rte_malloc.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__mbuf_8h.html">rte_mbuf.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__memcpy_8h.html">rte_memcpy.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__memory_8h.html">rte_memory.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__mempool_8h.html">rte_mempool.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__per__lcore_8h.html">rte_per_lcore.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__prefetch_8h.html">rte_prefetch.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__random_8h.html">rte_random.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__hexdump_8h.html">rte_hexdump.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#ifdef RTE_CRYPTO_SCHEDULER</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__cryptodev__scheduler_8h.html">rte_cryptodev_scheduler.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum</span> cdev_type {</div>
<div class="line">    CDEV_TYPE_ANY,</div>
<div class="line">    CDEV_TYPE_HW,</div>
<div class="line">    CDEV_TYPE_SW</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define RTE_LOGTYPE_L2FWD RTE_LOGTYPE_USER1</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define NB_MBUF   8192</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MAX_STR_LEN 32</span></div>
<div class="line"><span class="preprocessor">#define MAX_KEY_SIZE 128</span></div>
<div class="line"><span class="preprocessor">#define MAX_IV_SIZE 16</span></div>
<div class="line"><span class="preprocessor">#define MAX_AAD_SIZE 65535</span></div>
<div class="line"><span class="preprocessor">#define MAX_PKT_BURST 32</span></div>
<div class="line"><span class="preprocessor">#define BURST_TX_DRAIN_US 100 </span><span class="comment">/* TX drain every ~100us */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define SESSION_POOL_CACHE_SIZE 0</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MAXIMUM_IV_LENGTH   16</span></div>
<div class="line"><span class="preprocessor">#define IV_OFFSET       (sizeof(struct rte_crypto_op) + \</span></div>
<div class="line"><span class="preprocessor">                sizeof(struct rte_crypto_sym_op))</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Configurable number of RX/TX ring descriptors</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="preprocessor">#define RTE_TEST_RX_DESC_DEFAULT 1024</span></div>
<div class="line"><span class="preprocessor">#define RTE_TEST_TX_DESC_DEFAULT 1024</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint16_t nb_rxd = RTE_TEST_RX_DESC_DEFAULT;</div>
<div class="line"><span class="keyword">static</span> uint16_t nb_txd = RTE_TEST_TX_DESC_DEFAULT;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* ethernet addresses of ports */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a name="_a0"></a><a class="code" href="structrte__ether__addr.html">rte_ether_addr</a> l2fwd_ports_eth_addr[RTE_MAX_ETHPORTS];</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* mask of enabled ports */</span></div>
<div class="line"><span class="keyword">static</span> uint64_t l2fwd_enabled_port_mask;</div>
<div class="line"><span class="keyword">static</span> uint64_t l2fwd_enabled_crypto_mask;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* list of enabled ports */</span></div>
<div class="line"><span class="keyword">static</span> uint16_t l2fwd_dst_ports[RTE_MAX_ETHPORTS];</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pkt_buffer {</div>
<div class="line">    <span class="keywordtype">unsigned</span> len;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a1"></a><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *buffer[MAX_PKT_BURST];</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>op_buffer {</div>
<div class="line">    <span class="keywordtype">unsigned</span> len;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a2"></a><a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> *buffer[MAX_PKT_BURST];</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MAX_RX_QUEUE_PER_LCORE 16</span></div>
<div class="line"><span class="preprocessor">#define MAX_TX_QUEUE_PER_PORT 16</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum</span> l2fwd_crypto_xform_chain {</div>
<div class="line">    L2FWD_CRYPTO_CIPHER_HASH,</div>
<div class="line">    L2FWD_CRYPTO_HASH_CIPHER,</div>
<div class="line">    L2FWD_CRYPTO_CIPHER_ONLY,</div>
<div class="line">    L2FWD_CRYPTO_HASH_ONLY,</div>
<div class="line">    L2FWD_CRYPTO_AEAD</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>l2fwd_key {</div>
<div class="line">    uint8_t *data;</div>
<div class="line">    uint32_t length;</div>
<div class="line">    <a class="code" href="rte__common_8h.html#a6bbae0c1ede15e66dea0cc8ec17a3d87">rte_iova_t</a> phys_addr;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>l2fwd_iv {</div>
<div class="line">    uint8_t *data;</div>
<div class="line">    uint16_t length;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>l2fwd_crypto_options {</div>
<div class="line">    <span class="keywordtype">unsigned</span> portmask;</div>
<div class="line">    <span class="keywordtype">unsigned</span> nb_ports_per_lcore;</div>
<div class="line">    <span class="keywordtype">unsigned</span> refresh_period;</div>
<div class="line">    <span class="keywordtype">unsigned</span> single_lcore:1;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">enum</span> cdev_type type;</div>
<div class="line">    <span class="keywordtype">unsigned</span> sessionless:1;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">enum</span> l2fwd_crypto_xform_chain xform_chain;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span><a name="_a3"></a><a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> cipher_xform;</div>
<div class="line">    <span class="keywordtype">unsigned</span> ckey_param;</div>
<div class="line">    <span class="keywordtype">int</span> ckey_random_size;</div>
<div class="line">    uint8_t cipher_key[MAX_KEY_SIZE];</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span>l2fwd_iv cipher_iv;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cipher_iv_param;</div>
<div class="line">    <span class="keywordtype">int</span> cipher_iv_random_size;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> auth_xform;</div>
<div class="line">    uint8_t akey_param;</div>
<div class="line">    <span class="keywordtype">int</span> akey_random_size;</div>
<div class="line">    uint8_t auth_key[MAX_KEY_SIZE];</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span>l2fwd_iv auth_iv;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> auth_iv_param;</div>
<div class="line">    <span class="keywordtype">int</span> auth_iv_random_size;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> aead_xform;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> aead_key_param;</div>
<div class="line">    <span class="keywordtype">int</span> aead_key_random_size;</div>
<div class="line">    uint8_t aead_key[MAX_KEY_SIZE];</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span>l2fwd_iv aead_iv;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> aead_iv_param;</div>
<div class="line">    <span class="keywordtype">int</span> aead_iv_random_size;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span>l2fwd_key aad;</div>
<div class="line">    <span class="keywordtype">unsigned</span> aad_param;</div>
<div class="line">    <span class="keywordtype">int</span> aad_random_size;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> digest_size;</div>
<div class="line"> </div>
<div class="line">    uint16_t block_size;</div>
<div class="line">    <span class="keywordtype">char</span> string_type[MAX_STR_LEN];</div>
<div class="line"> </div>
<div class="line">    uint64_t cryptodev_mask;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mac_updating;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>l2fwd_crypto_params {</div>
<div class="line">    uint8_t dev_id;</div>
<div class="line">    uint8_t qp_id;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> digest_length;</div>
<div class="line">    <span class="keywordtype">unsigned</span> block_size;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span>l2fwd_iv cipher_iv;</div>
<div class="line">    <span class="keyword">struct </span>l2fwd_iv auth_iv;</div>
<div class="line">    <span class="keyword">struct </span>l2fwd_iv aead_iv;</div>
<div class="line">    <span class="keyword">struct </span>l2fwd_key aad;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a4"></a><a class="code" href="structrte__cryptodev__sym__session.html">rte_cryptodev_sym_session</a> *session;</div>
<div class="line"> </div>
<div class="line">    uint8_t do_cipher;</div>
<div class="line">    uint8_t do_hash;</div>
<div class="line">    uint8_t do_aead;</div>
<div class="line">    uint8_t hash_verify;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75e">rte_crypto_cipher_algorithm</a> cipher_algo;</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793">rte_crypto_auth_algorithm</a> auth_algo;</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="rte__crypto__sym_8h.html#a648bc317af3ee238310fac9d87512508">rte_crypto_aead_algorithm</a> aead_algo;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>lcore_queue_conf {</div>
<div class="line">    <span class="keywordtype">unsigned</span> nb_rx_ports;</div>
<div class="line">    uint16_t rx_port_list[MAX_RX_QUEUE_PER_LCORE];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> nb_crypto_devs;</div>
<div class="line">    <span class="keywordtype">unsigned</span> cryptodev_list[MAX_RX_QUEUE_PER_LCORE];</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span>op_buffer op_buf[RTE_CRYPTO_MAX_DEVS];</div>
<div class="line">    <span class="keyword">struct </span>pkt_buffer pkt_buf[RTE_MAX_ETHPORTS];</div>
<div class="line">} <a name="a5"></a><a class="code" href="rte__common_8h.html#a38e32f822bc941e90fdcbe5a9c69b178">__rte_cache_aligned</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>lcore_queue_conf lcore_queue_conf[RTE_MAX_LCORE];</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a name="_a6"></a><a class="code" href="structrte__eth__conf.html">rte_eth_conf</a> port_conf = {</div>
<div class="line">    .<a name="a7"></a><a class="code" href="structrte__eth__conf.html#a346eef99c24f617b74c440c1aa565d01">rxmode</a> = {</div>
<div class="line">        .<a name="a8"></a><a class="code" href="structrte__eth__rxmode.html#aa0562513c4569f1aa53050f1beac6b5d">mq_mode</a> = <a name="a9"></a><a class="code" href="rte__ethdev_8h.html#a586b8e86131b4ec0ccaf464e847ccf3ea4600ff07419327deb9b8534bc66daf19">ETH_MQ_RX_NONE</a>,</div>
<div class="line">        .max_rx_pkt_len = <a name="a10"></a><a class="code" href="rte__ether_8h.html#af1fb088707ce5b2ebb7825cb69b5cb58">RTE_ETHER_MAX_LEN</a>,</div>
<div class="line">        .split_hdr_size = 0,</div>
<div class="line">    },</div>
<div class="line">    .txmode = {</div>
<div class="line">        .mq_mode = <a name="a11"></a><a class="code" href="rte__ethdev_8h.html#a4834f572f4dd4e46d81ad09b7d5fffd5aada568551470d5f419cd2f3d6b6bfedc">ETH_MQ_TX_NONE</a>,</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a name="_a12"></a><a class="code" href="structrte__mempool.html">rte_mempool</a> *l2fwd_pktmbuf_pool;</div>
<div class="line"><span class="keyword">struct </span><a class="code" href="structrte__mempool.html">rte_mempool</a> *l2fwd_crypto_op_pool;</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mempool.html">rte_mempool</a> *sess_mp;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mempool.html">rte_mempool</a> *priv_mp;</div>
<div class="line">} session_pool_socket[RTE_MAX_NUMA_NODES];</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Per-port statistics struct */</span></div>
<div class="line"><span class="keyword">struct </span>l2fwd_port_statistics {</div>
<div class="line">    uint64_t tx;</div>
<div class="line">    uint64_t rx;</div>
<div class="line"> </div>
<div class="line">    uint64_t crypto_enqueued;</div>
<div class="line">    uint64_t crypto_dequeued;</div>
<div class="line"> </div>
<div class="line">    uint64_t dropped;</div>
<div class="line">} <a class="code" href="rte__common_8h.html#a38e32f822bc941e90fdcbe5a9c69b178">__rte_cache_aligned</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>l2fwd_crypto_statistics {</div>
<div class="line">    uint64_t enqueued;</div>
<div class="line">    uint64_t dequeued;</div>
<div class="line"> </div>
<div class="line">    uint64_t errors;</div>
<div class="line">} <a class="code" href="rte__common_8h.html#a38e32f822bc941e90fdcbe5a9c69b178">__rte_cache_aligned</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>l2fwd_port_statistics port_statistics[RTE_MAX_ETHPORTS];</div>
<div class="line"><span class="keyword">struct </span>l2fwd_crypto_statistics crypto_statistics[RTE_CRYPTO_MAX_DEVS];</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* A tsc-based timer responsible for triggering statistics printout */</span></div>
<div class="line"><span class="preprocessor">#define TIMER_MILLISECOND 2000000ULL </span><span class="comment">/* around 1ms at 2 Ghz */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define MAX_TIMER_PERIOD 86400UL </span><span class="comment">/* 1 day max */</span><span class="preprocessor"></span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* default period is 10 seconds */</span></div>
<div class="line"><span class="keyword">static</span> int64_t timer_period = 10 * TIMER_MILLISECOND * 1000;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Print out statistics on packets dropped */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">print_stats(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    uint64_t total_packets_dropped, total_packets_tx, total_packets_rx;</div>
<div class="line">    uint64_t total_packets_enqueued, total_packets_dequeued,</div>
<div class="line">        total_packets_errors;</div>
<div class="line">    uint16_t portid;</div>
<div class="line">    uint64_t cdevid;</div>
<div class="line"> </div>
<div class="line">    total_packets_dropped = 0;</div>
<div class="line">    total_packets_tx = 0;</div>
<div class="line">    total_packets_rx = 0;</div>
<div class="line">    total_packets_enqueued = 0;</div>
<div class="line">    total_packets_dequeued = 0;</div>
<div class="line">    total_packets_errors = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> clr[] = { 27, <span class="charliteral">&#39;[&#39;</span>, <span class="charliteral">&#39;2&#39;</span>, <span class="charliteral">&#39;J&#39;</span>, <span class="charliteral">&#39;\0&#39;</span> };</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> topLeft[] = { 27, <span class="charliteral">&#39;[&#39;</span>, <span class="charliteral">&#39;1&#39;</span>, <span class="charliteral">&#39;;&#39;</span>, <span class="charliteral">&#39;1&#39;</span>, <span class="charliteral">&#39;H&#39;</span>, <span class="charliteral">&#39;\0&#39;</span> };</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Clear screen and move to top left */</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;%s%s&quot;</span>, clr, topLeft);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;\nPort statistics ====================================&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (portid = 0; portid &lt; RTE_MAX_ETHPORTS; portid++) {</div>
<div class="line">        <span class="comment">/* skip disabled ports */</span></div>
<div class="line">        <span class="keywordflow">if</span> ((l2fwd_enabled_port_mask &amp; (1 &lt;&lt; portid)) == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        printf(<span class="stringliteral">&quot;\nStatistics for port %u ------------------------------&quot;</span></div>
<div class="line">               <span class="stringliteral">&quot;\nPackets sent: %32&quot;</span>PRIu64</div>
<div class="line">               <span class="stringliteral">&quot;\nPackets received: %28&quot;</span>PRIu64</div>
<div class="line">               <span class="stringliteral">&quot;\nPackets dropped: %29&quot;</span>PRIu64,</div>
<div class="line">               portid,</div>
<div class="line">               port_statistics[portid].tx,</div>
<div class="line">               port_statistics[portid].rx,</div>
<div class="line">               port_statistics[portid].dropped);</div>
<div class="line"> </div>
<div class="line">        total_packets_dropped += port_statistics[portid].dropped;</div>
<div class="line">        total_packets_tx += port_statistics[portid].tx;</div>
<div class="line">        total_packets_rx += port_statistics[portid].rx;</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;\nCrypto statistics ==================================&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (cdevid = 0; cdevid &lt; RTE_CRYPTO_MAX_DEVS; cdevid++) {</div>
<div class="line">        <span class="comment">/* skip disabled ports */</span></div>
<div class="line">        <span class="keywordflow">if</span> ((l2fwd_enabled_crypto_mask &amp; (((uint64_t)1) &lt;&lt; cdevid)) == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        printf(<span class="stringliteral">&quot;\nStatistics for cryptodev %&quot;</span>PRIu64</div>
<div class="line">                <span class="stringliteral">&quot; -------------------------&quot;</span></div>
<div class="line">               <span class="stringliteral">&quot;\nPackets enqueued: %28&quot;</span>PRIu64</div>
<div class="line">               <span class="stringliteral">&quot;\nPackets dequeued: %28&quot;</span>PRIu64</div>
<div class="line">               <span class="stringliteral">&quot;\nPackets errors: %30&quot;</span>PRIu64,</div>
<div class="line">               cdevid,</div>
<div class="line">               crypto_statistics[cdevid].enqueued,</div>
<div class="line">               crypto_statistics[cdevid].dequeued,</div>
<div class="line">               crypto_statistics[cdevid].errors);</div>
<div class="line"> </div>
<div class="line">        total_packets_enqueued += crypto_statistics[cdevid].enqueued;</div>
<div class="line">        total_packets_dequeued += crypto_statistics[cdevid].dequeued;</div>
<div class="line">        total_packets_errors += crypto_statistics[cdevid].errors;</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;\nAggregate statistics ===============================&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;\nTotal packets received: %22&quot;</span>PRIu64</div>
<div class="line">           <span class="stringliteral">&quot;\nTotal packets enqueued: %22&quot;</span>PRIu64</div>
<div class="line">           <span class="stringliteral">&quot;\nTotal packets dequeued: %22&quot;</span>PRIu64</div>
<div class="line">           <span class="stringliteral">&quot;\nTotal packets sent: %26&quot;</span>PRIu64</div>
<div class="line">           <span class="stringliteral">&quot;\nTotal packets dropped: %23&quot;</span>PRIu64</div>
<div class="line">           <span class="stringliteral">&quot;\nTotal packets crypto errors: %17&quot;</span>PRIu64,</div>
<div class="line">           total_packets_rx,</div>
<div class="line">           total_packets_enqueued,</div>
<div class="line">           total_packets_dequeued,</div>
<div class="line">           total_packets_tx,</div>
<div class="line">           total_packets_dropped,</div>
<div class="line">           total_packets_errors);</div>
<div class="line">    printf(<span class="stringliteral">&quot;\n====================================================\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    fflush(stdout);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">l2fwd_crypto_send_burst(<span class="keyword">struct</span> lcore_queue_conf *qconf, <span class="keywordtype">unsigned</span> n,</div>
<div class="line">        <span class="keyword">struct</span> l2fwd_crypto_params *cparams)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> **op_buffer;</div>
<div class="line">    <span class="keywordtype">unsigned</span> ret;</div>
<div class="line"> </div>
<div class="line">    op_buffer = (<span class="keyword">struct </span><a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> **)</div>
<div class="line">            qconf-&gt;op_buf[cparams-&gt;dev_id].buffer;</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a13"></a><a class="code" href="rte__cryptodev_8h.html#a1e1336b0a8fe381ea03a52bad85e5734">rte_cryptodev_enqueue_burst</a>(cparams-&gt;dev_id,</div>
<div class="line">            cparams-&gt;qp_id, op_buffer, (uint16_t) n);</div>
<div class="line"> </div>
<div class="line">    crypto_statistics[cparams-&gt;dev_id].enqueued += ret;</div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a14"></a><a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(ret &lt; n)) {</div>
<div class="line">        crypto_statistics[cparams-&gt;dev_id].errors += (n - ret);</div>
<div class="line">        <span class="keywordflow">do</span> {</div>
<div class="line">            <a name="a15"></a><a class="code" href="rte__mbuf_8h.html#a1215458932900b7cd5192326fa4a6902">rte_pktmbuf_free</a>(op_buffer[ret]-&gt;<a name="a16"></a><a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;<a name="a17"></a><a class="code" href="structrte__crypto__sym__op.html#af021669494a2806b0569587e2096e88e">m_src</a>);</div>
<div class="line">            <a name="a18"></a><a class="code" href="rte__crypto_8h.html#aca76406e3f1ab04ab44dfbe4ff26f4ba">rte_crypto_op_free</a>(op_buffer[ret]);</div>
<div class="line">        } <span class="keywordflow">while</span> (++ret &lt; n);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">l2fwd_crypto_enqueue(<span class="keyword">struct</span> <a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> *op,</div>
<div class="line">        <span class="keyword">struct</span> l2fwd_crypto_params *cparams)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">unsigned</span> lcore_id, len;</div>
<div class="line">    <span class="keyword">struct </span>lcore_queue_conf *qconf;</div>
<div class="line"> </div>
<div class="line">    lcore_id = <a name="a19"></a><a class="code" href="rte__lcore_8h.html#adfb2b334e7e73f534f25e8888a8a775f">rte_lcore_id</a>();</div>
<div class="line"> </div>
<div class="line">    qconf = &amp;lcore_queue_conf[lcore_id];</div>
<div class="line">    len = qconf-&gt;op_buf[cparams-&gt;dev_id].len;</div>
<div class="line">    qconf-&gt;op_buf[cparams-&gt;dev_id].buffer[len] = op;</div>
<div class="line">    len++;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* enough ops to be sent */</span></div>
<div class="line">    <span class="keywordflow">if</span> (len == MAX_PKT_BURST) {</div>
<div class="line">        l2fwd_crypto_send_burst(qconf, MAX_PKT_BURST, cparams);</div>
<div class="line">        len = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    qconf-&gt;op_buf[cparams-&gt;dev_id].len = len;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">l2fwd_simple_crypto_enqueue(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m,</div>
<div class="line">        <span class="keyword">struct</span> <a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> *op,</div>
<div class="line">        <span class="keyword">struct</span> l2fwd_crypto_params *cparams)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a20"></a><a class="code" href="structrte__ether__hdr.html">rte_ether_hdr</a> *eth_hdr;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a21"></a><a class="code" href="structrte__ipv4__hdr.html">rte_ipv4_hdr</a> *ip_hdr;</div>
<div class="line"> </div>
<div class="line">    uint32_t ipdata_offset, data_len;</div>
<div class="line">    uint32_t pad_len = 0;</div>
<div class="line">    <span class="keywordtype">char</span> *padding;</div>
<div class="line"> </div>
<div class="line">    eth_hdr = <a name="a22"></a><a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(m, <span class="keyword">struct</span> <a class="code" href="structrte__ether__hdr.html">rte_ether_hdr</a> *);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (eth_hdr-&gt;<a name="a23"></a><a class="code" href="structrte__ether__hdr.html#ad6312397ccc57d322b1a037c7080d340">ether_type</a> != <a name="a24"></a><a class="code" href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a>(<a name="a25"></a><a class="code" href="rte__ether_8h.html#a15583fc4e341572ad37c8beace664ea8">RTE_ETHER_TYPE_IPV4</a>))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    ipdata_offset = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrte__ether__hdr.html">rte_ether_hdr</a>);</div>
<div class="line"> </div>
<div class="line">    ip_hdr = (<span class="keyword">struct </span><a class="code" href="structrte__ipv4__hdr.html">rte_ipv4_hdr</a> *)(<a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(m, <span class="keywordtype">char</span> *) +</div>
<div class="line">            ipdata_offset);</div>
<div class="line"> </div>
<div class="line">    ipdata_offset += (ip_hdr-&gt;<a name="a26"></a><a class="code" href="structrte__ipv4__hdr.html#a0f143df6fd0e09aba2963a160e33ce16">version_ihl</a> &amp; <a name="a27"></a><a class="code" href="rte__ip_8h.html#ae7775437ee87698e6f6b3c5003f0f22f">RTE_IPV4_HDR_IHL_MASK</a>)</div>
<div class="line">            * <a name="a28"></a><a class="code" href="rte__ip_8h.html#aef4776060d8fc0d40e2a7df40a39b633">RTE_IPV4_IHL_MULTIPLIER</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Zero pad data to be crypto&#39;d so it is block aligned */</span></div>
<div class="line">    data_len  = <a name="a29"></a><a class="code" href="rte__mbuf_8h.html#a2a1e1b30162161ed11d3ba2faf7bbf13">rte_pktmbuf_data_len</a>(m) - ipdata_offset;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((cparams-&gt;do_hash || cparams-&gt;do_aead) &amp;&amp; cparams-&gt;hash_verify)</div>
<div class="line">        data_len -= cparams-&gt;digest_length;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cparams-&gt;do_cipher) {</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Following algorithms are block cipher algorithms,</span></div>
<div class="line"><span class="comment">         * and might need padding</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">switch</span> (cparams-&gt;cipher_algo) {</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a30"></a><a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ead9f8e28815f3dd2b77e7ce93b7b8a7ca">RTE_CRYPTO_CIPHER_AES_CBC</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a31"></a><a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eaf7d6407f595eafe9d16b372e7d256f9e">RTE_CRYPTO_CIPHER_AES_ECB</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a32"></a><a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ea178a49c654f4b4e16b9c3de03833dc58">RTE_CRYPTO_CIPHER_DES_CBC</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a33"></a><a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eaed8720577f149444ab479ee7415dbfb2">RTE_CRYPTO_CIPHER_3DES_CBC</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a34"></a><a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eab8a2eee308e346ed3b076e2d400615b2">RTE_CRYPTO_CIPHER_3DES_ECB</a>:</div>
<div class="line">            <span class="keywordflow">if</span> (data_len % cparams-&gt;block_size)</div>
<div class="line">                pad_len = cparams-&gt;block_size -</div>
<div class="line">                    (data_len % cparams-&gt;block_size);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            pad_len = 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (pad_len) {</div>
<div class="line">            padding = <a name="a35"></a><a class="code" href="rte__mbuf_8h.html#ad5b0cd686ad3bcbb83416ca8395a080b">rte_pktmbuf_append</a>(m, pad_len);</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(!padding))</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">            data_len += pad_len;</div>
<div class="line">            memset(padding, 0, pad_len);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Set crypto operation data parameters */</span></div>
<div class="line">    <a name="a36"></a><a class="code" href="rte__crypto_8h.html#affaf4fd29a51d350b387155494402a84">rte_crypto_op_attach_sym_session</a>(op, cparams-&gt;session);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cparams-&gt;do_hash) {</div>
<div class="line">        <span class="keywordflow">if</span> (cparams-&gt;auth_iv.length) {</div>
<div class="line">            uint8_t *iv_ptr = <a name="a37"></a><a class="code" href="rte__cryptodev_8h.html#aecf8ad2a113d395767f5b6cea89f3ee2">rte_crypto_op_ctod_offset</a>(op,</div>
<div class="line">                        uint8_t *,</div>
<div class="line">                        IV_OFFSET +</div>
<div class="line">                        cparams-&gt;cipher_iv.length);</div>
<div class="line">            <span class="comment">/*</span></div>
<div class="line"><span class="comment">             * Copy IV at the end of the crypto operation,</span></div>
<div class="line"><span class="comment">             * after the cipher IV, if added</span></div>
<div class="line"><span class="comment">             */</span></div>
<div class="line">            <a name="a38"></a><a class="code" href="rte__memcpy_8h.html#a09f4d8cdb1a7c25398a363906e1db8cd">rte_memcpy</a>(iv_ptr, cparams-&gt;auth_iv.data,</div>
<div class="line">                    cparams-&gt;auth_iv.length);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (!cparams-&gt;hash_verify) {</div>
<div class="line">            <span class="comment">/* Append space for digest to end of packet */</span></div>
<div class="line">            op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;<a name="a39"></a>auth.digest.data = (uint8_t *)<a class="code" href="rte__mbuf_8h.html#ad5b0cd686ad3bcbb83416ca8395a080b">rte_pktmbuf_append</a>(m,</div>
<div class="line">                cparams-&gt;digest_length);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;auth.digest.data = <a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(m,</div>
<div class="line">                uint8_t *) + ipdata_offset + data_len;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;auth.digest.phys_addr = <a name="a40"></a><a class="code" href="rte__mbuf__core_8h.html#a0aba9fed77ad814d952958d448c71f38">rte_pktmbuf_iova_offset</a>(m,</div>
<div class="line">                <a name="a41"></a><a class="code" href="rte__mbuf_8h.html#a7a7ea614c79d5b9ed790a56c1c79189d">rte_pktmbuf_pkt_len</a>(m) - cparams-&gt;digest_length);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* For wireless algorithms, offset/length must be in bits */</span></div>
<div class="line">        <span class="keywordflow">if</span> (cparams-&gt;auth_algo == <a name="a42"></a><a class="code" href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793a3a068d41ffd387e294fade7fbe0b11af">RTE_CRYPTO_AUTH_SNOW3G_UIA2</a> ||</div>
<div class="line">                cparams-&gt;auth_algo == <a name="a43"></a><a class="code" href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793a661553033b1672fa832c9f27b90ec52a">RTE_CRYPTO_AUTH_KASUMI_F9</a> ||</div>
<div class="line">                cparams-&gt;auth_algo == <a name="a44"></a><a class="code" href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793a063c8faf0e4a6607311ec8061a29ab80">RTE_CRYPTO_AUTH_ZUC_EIA3</a>) {</div>
<div class="line">            op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;auth.data.offset = ipdata_offset &lt;&lt; 3;</div>
<div class="line">            op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;auth.data.length = data_len &lt;&lt; 3;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;auth.data.offset = ipdata_offset;</div>
<div class="line">            op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;auth.data.length = data_len;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cparams-&gt;do_cipher) {</div>
<div class="line">        uint8_t *iv_ptr = <a class="code" href="rte__cryptodev_8h.html#aecf8ad2a113d395767f5b6cea89f3ee2">rte_crypto_op_ctod_offset</a>(op, uint8_t *,</div>
<div class="line">                            IV_OFFSET);</div>
<div class="line">        <span class="comment">/* Copy IV at the end of the crypto operation */</span></div>
<div class="line">        <a class="code" href="rte__memcpy_8h.html#a09f4d8cdb1a7c25398a363906e1db8cd">rte_memcpy</a>(iv_ptr, cparams-&gt;cipher_iv.data,</div>
<div class="line">                cparams-&gt;cipher_iv.length);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* For wireless algorithms, offset/length must be in bits */</span></div>
<div class="line">        <span class="keywordflow">if</span> (cparams-&gt;cipher_algo == <a name="a45"></a><a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ea8598018741a79db99387a47133c94525">RTE_CRYPTO_CIPHER_SNOW3G_UEA2</a> ||</div>
<div class="line">                cparams-&gt;cipher_algo == <a name="a46"></a><a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eacc7628ed85ee9261caac0faed94332f1">RTE_CRYPTO_CIPHER_KASUMI_F8</a> ||</div>
<div class="line">                cparams-&gt;cipher_algo == <a name="a47"></a><a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eabb5eac5873c92998ba42395614df0800">RTE_CRYPTO_CIPHER_ZUC_EEA3</a>) {</div>
<div class="line">            op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;<a name="a48"></a>cipher.data.offset = ipdata_offset &lt;&lt; 3;</div>
<div class="line">            op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;cipher.data.length = data_len &lt;&lt; 3;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;cipher.data.offset = ipdata_offset;</div>
<div class="line">            op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;cipher.data.length = data_len;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cparams-&gt;do_aead) {</div>
<div class="line">        uint8_t *iv_ptr = <a class="code" href="rte__cryptodev_8h.html#aecf8ad2a113d395767f5b6cea89f3ee2">rte_crypto_op_ctod_offset</a>(op, uint8_t *,</div>
<div class="line">                            IV_OFFSET);</div>
<div class="line">        <span class="comment">/* Copy IV at the end of the crypto operation */</span></div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * If doing AES-CCM, nonce is copied one byte</span></div>
<div class="line"><span class="comment">         * after the start of IV field</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> (cparams-&gt;aead_algo == <a name="a49"></a><a class="code" href="rte__crypto__sym_8h.html#a648bc317af3ee238310fac9d87512508a27d121171b5e292d8a7313a38b91bf3e">RTE_CRYPTO_AEAD_AES_CCM</a>)</div>
<div class="line">            <a class="code" href="rte__memcpy_8h.html#a09f4d8cdb1a7c25398a363906e1db8cd">rte_memcpy</a>(iv_ptr + 1, cparams-&gt;aead_iv.data,</div>
<div class="line">                    cparams-&gt;aead_iv.length);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <a class="code" href="rte__memcpy_8h.html#a09f4d8cdb1a7c25398a363906e1db8cd">rte_memcpy</a>(iv_ptr, cparams-&gt;aead_iv.data,</div>
<div class="line">                    cparams-&gt;aead_iv.length);</div>
<div class="line"> </div>
<div class="line">        op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;<a name="a50"></a>aead.data.offset = ipdata_offset;</div>
<div class="line">        op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;aead.data.length = data_len;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (!cparams-&gt;hash_verify) {</div>
<div class="line">            <span class="comment">/* Append space for digest to end of packet */</span></div>
<div class="line">            op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;aead.digest.data = (uint8_t *)<a class="code" href="rte__mbuf_8h.html#ad5b0cd686ad3bcbb83416ca8395a080b">rte_pktmbuf_append</a>(m,</div>
<div class="line">                cparams-&gt;digest_length);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;aead.digest.data = <a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(m,</div>
<div class="line">                uint8_t *) + ipdata_offset + data_len;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;aead.digest.phys_addr = <a class="code" href="rte__mbuf__core_8h.html#a0aba9fed77ad814d952958d448c71f38">rte_pktmbuf_iova_offset</a>(m,</div>
<div class="line">                <a class="code" href="rte__mbuf_8h.html#a7a7ea614c79d5b9ed790a56c1c79189d">rte_pktmbuf_pkt_len</a>(m) - cparams-&gt;digest_length);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (cparams-&gt;aad.length) {</div>
<div class="line">            op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;aead.aad.data = cparams-&gt;aad.data;</div>
<div class="line">            op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;aead.aad.phys_addr = cparams-&gt;aad.phys_addr;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    op-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;<a class="code" href="structrte__crypto__sym__op.html#af021669494a2806b0569587e2096e88e">m_src</a> = m;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> l2fwd_crypto_enqueue(op, cparams);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Send the burst of packets on an output interface */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">l2fwd_send_burst(<span class="keyword">struct</span> lcore_queue_conf *qconf, <span class="keywordtype">unsigned</span> n,</div>
<div class="line">        uint16_t port)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> **pkt_buffer;</div>
<div class="line">    <span class="keywordtype">unsigned</span> ret;</div>
<div class="line"> </div>
<div class="line">    pkt_buffer = (<span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> **)qconf-&gt;pkt_buf[<a name="a51"></a><a class="code" href="structrte__mbuf.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>].buffer;</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a52"></a><a class="code" href="rte__ethdev_8h.html#a83e56cabbd31637efd648e3fc010392b">rte_eth_tx_burst</a>(<a class="code" href="structrte__mbuf.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>, 0, pkt_buffer, (uint16_t)n);</div>
<div class="line">    port_statistics[<a class="code" href="structrte__mbuf.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>].tx += ret;</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(ret &lt; n)) {</div>
<div class="line">        port_statistics[<a class="code" href="structrte__mbuf.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>].dropped += (n - ret);</div>
<div class="line">        <span class="keywordflow">do</span> {</div>
<div class="line">            <a class="code" href="rte__mbuf_8h.html#a1215458932900b7cd5192326fa4a6902">rte_pktmbuf_free</a>(pkt_buffer[ret]);</div>
<div class="line">        } <span class="keywordflow">while</span> (++ret &lt; n);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Enqueue packets for TX and prepare them to be sent */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">l2fwd_send_packet(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m, uint16_t <a class="code" href="structrte__mbuf.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">unsigned</span> lcore_id, len;</div>
<div class="line">    <span class="keyword">struct </span>lcore_queue_conf *qconf;</div>
<div class="line"> </div>
<div class="line">    lcore_id = <a class="code" href="rte__lcore_8h.html#adfb2b334e7e73f534f25e8888a8a775f">rte_lcore_id</a>();</div>
<div class="line"> </div>
<div class="line">    qconf = &amp;lcore_queue_conf[lcore_id];</div>
<div class="line">    len = qconf-&gt;pkt_buf[port].len;</div>
<div class="line">    qconf-&gt;pkt_buf[port].buffer[len] = m;</div>
<div class="line">    len++;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* enough pkts to be sent */</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(len == MAX_PKT_BURST)) {</div>
<div class="line">        l2fwd_send_burst(qconf, MAX_PKT_BURST, port);</div>
<div class="line">        len = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    qconf-&gt;pkt_buf[port].len = len;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">l2fwd_mac_updating(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m, uint16_t dest_portid)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ether__hdr.html">rte_ether_hdr</a> *eth;</div>
<div class="line">    <span class="keywordtype">void</span> *tmp;</div>
<div class="line"> </div>
<div class="line">    eth = <a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(m, <span class="keyword">struct</span> <a class="code" href="structrte__ether__hdr.html">rte_ether_hdr</a> *);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* 02:00:00:00:00:xx */</span></div>
<div class="line">    tmp = &amp;eth-&gt;<a name="a53"></a><a class="code" href="structrte__ether__hdr.html#a1d579e2782d36729c1f73608d8663124">d_addr</a>.<a name="a54"></a><a class="code" href="structrte__ether__addr.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[0];</div>
<div class="line">    *((uint64_t *)tmp) = 0x000000000002 + ((uint64_t)dest_portid &lt;&lt; 40);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* src addr */</span></div>
<div class="line">    <a name="a55"></a><a class="code" href="rte__ether_8h.html#af5e7040b36584eacec1c5b9eee086eac">rte_ether_addr_copy</a>(&amp;l2fwd_ports_eth_addr[dest_portid], &amp;eth-&gt;<a name="a56"></a><a class="code" href="structrte__ether__hdr.html#acce632e0fded0f728a1ee1a1ffb5c9bf">s_addr</a>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">l2fwd_simple_forward(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m, uint16_t portid,</div>
<div class="line">        <span class="keyword">struct</span> l2fwd_crypto_options *options)</div>
<div class="line">{</div>
<div class="line">    uint16_t dst_port;</div>
<div class="line"> </div>
<div class="line">    dst_port = l2fwd_dst_ports[portid];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;mac_updating)</div>
<div class="line">        l2fwd_mac_updating(m, dst_port);</div>
<div class="line"> </div>
<div class="line">    l2fwd_send_packet(m, dst_port);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">generate_random_key(uint8_t *key, <span class="keywordtype">unsigned</span> length)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> fd;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    fd = open(<span class="stringliteral">&quot;/dev/urandom&quot;</span>, O_RDONLY);</div>
<div class="line">    <span class="keywordflow">if</span> (fd &lt; 0)</div>
<div class="line">        <a name="a57"></a><a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Failed to generate random key\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    ret = read(fd, key, length);</div>
<div class="line">    close(fd);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ret != (<span class="keywordtype">signed</span>)length)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Failed to generate random key\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__sym__session.html">rte_cryptodev_sym_session</a> *</div>
<div class="line">initialize_crypto_session(<span class="keyword">struct</span> l2fwd_crypto_options *options, uint8_t cdev_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *first_xform;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__sym__session.html">rte_cryptodev_sym_session</a> *session;</div>
<div class="line">    <span class="keywordtype">int</span> retval = rte_cryptodev_socket_id(cdev_id);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (retval &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    uint8_t socket_id = (uint8_t) retval;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;xform_chain == L2FWD_CRYPTO_AEAD) {</div>
<div class="line">        first_xform = &amp;options-&gt;aead_xform;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (options-&gt;xform_chain == L2FWD_CRYPTO_CIPHER_HASH) {</div>
<div class="line">        first_xform = &amp;options-&gt;cipher_xform;</div>
<div class="line">        first_xform-&gt;<a name="a58"></a><a class="code" href="structrte__crypto__sym__xform.html#aa8c788b7f832e2a4183a8924ff8dab97">next</a> = &amp;options-&gt;auth_xform;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (options-&gt;xform_chain == L2FWD_CRYPTO_HASH_CIPHER) {</div>
<div class="line">        first_xform = &amp;options-&gt;auth_xform;</div>
<div class="line">        first_xform-&gt;<a class="code" href="structrte__crypto__sym__xform.html#aa8c788b7f832e2a4183a8924ff8dab97">next</a> = &amp;options-&gt;cipher_xform;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (options-&gt;xform_chain == L2FWD_CRYPTO_CIPHER_ONLY) {</div>
<div class="line">        first_xform = &amp;options-&gt;cipher_xform;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        first_xform = &amp;options-&gt;auth_xform;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    session = <a name="a59"></a><a class="code" href="rte__cryptodev_8h.html#ad40470ee7e072f93f85f1bb584e64e39">rte_cryptodev_sym_session_create</a>(</div>
<div class="line">            session_pool_socket[socket_id].sess_mp);</div>
<div class="line">    <span class="keywordflow">if</span> (session == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a60"></a><a class="code" href="rte__cryptodev_8h.html#a3b05f51fd91ec181c369e32908d55717">rte_cryptodev_sym_session_init</a>(cdev_id, session,</div>
<div class="line">                first_xform,</div>
<div class="line">                session_pool_socket[socket_id].priv_mp) &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> session;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">l2fwd_crypto_options_print(<span class="keyword">struct</span> l2fwd_crypto_options *options);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* main processing loop */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">l2fwd_main_loop(<span class="keyword">struct</span> l2fwd_crypto_options *options)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m, *pkts_burst[MAX_PKT_BURST];</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> *ops_burst[MAX_PKT_BURST];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> lcore_id = <a class="code" href="rte__lcore_8h.html#adfb2b334e7e73f534f25e8888a8a775f">rte_lcore_id</a>();</div>
<div class="line">    uint64_t prev_tsc = 0, diff_tsc, cur_tsc, timer_tsc = 0;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, j, nb_rx, len;</div>
<div class="line">    uint16_t portid;</div>
<div class="line">    <span class="keyword">struct </span>lcore_queue_conf *qconf = &amp;lcore_queue_conf[lcore_id];</div>
<div class="line">    <span class="keyword">const</span> uint64_t drain_tsc = (<a name="a61"></a><a class="code" href="rte__cycles_8h.html#ae016e608f344823e677819d8f04264c5">rte_get_tsc_hz</a>() + US_PER_S - 1) /</div>
<div class="line">            US_PER_S * BURST_TX_DRAIN_US;</div>
<div class="line">    <span class="keyword">struct </span>l2fwd_crypto_params *cparams;</div>
<div class="line">    <span class="keyword">struct </span>l2fwd_crypto_params port_cparams[qconf-&gt;nb_crypto_devs];</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__sym__session.html">rte_cryptodev_sym_session</a> *session;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (qconf-&gt;nb_rx_ports == 0) {</div>
<div class="line">        <a name="a62"></a><a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(INFO, L2FWD, <span class="stringliteral">&quot;lcore %u has nothing to do\n&quot;</span>, lcore_id);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(INFO, L2FWD, <span class="stringliteral">&quot;entering main loop on lcore %u\n&quot;</span>, lcore_id);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; qconf-&gt;nb_rx_ports; i++) {</div>
<div class="line"> </div>
<div class="line">        portid = qconf-&gt;rx_port_list[i];</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(INFO, L2FWD, <span class="stringliteral">&quot; -- lcoreid=%u portid=%u\n&quot;</span>, lcore_id,</div>
<div class="line">            portid);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; qconf-&gt;nb_crypto_devs; i++) {</div>
<div class="line">        port_cparams[i].do_cipher = 0;</div>
<div class="line">        port_cparams[i].do_hash = 0;</div>
<div class="line">        port_cparams[i].do_aead = 0;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">switch</span> (options-&gt;xform_chain) {</div>
<div class="line">        <span class="keywordflow">case</span> L2FWD_CRYPTO_AEAD:</div>
<div class="line">            port_cparams[i].do_aead = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> L2FWD_CRYPTO_CIPHER_HASH:</div>
<div class="line">        <span class="keywordflow">case</span> L2FWD_CRYPTO_HASH_CIPHER:</div>
<div class="line">            port_cparams[i].do_cipher = 1;</div>
<div class="line">            port_cparams[i].do_hash = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> L2FWD_CRYPTO_HASH_ONLY:</div>
<div class="line">            port_cparams[i].do_hash = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> L2FWD_CRYPTO_CIPHER_ONLY:</div>
<div class="line">            port_cparams[i].do_cipher = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        port_cparams[i].dev_id = qconf-&gt;cryptodev_list[i];</div>
<div class="line">        port_cparams[i].qp_id = 0;</div>
<div class="line"> </div>
<div class="line">        port_cparams[i].block_size = options-&gt;block_size;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (port_cparams[i].do_hash) {</div>
<div class="line">            port_cparams[i].auth_iv.data = options-&gt;auth_iv.data;</div>
<div class="line">            port_cparams[i].auth_iv.length = options-&gt;auth_iv.length;</div>
<div class="line">            <span class="keywordflow">if</span> (!options-&gt;auth_iv_param)</div>
<div class="line">                generate_random_key(port_cparams[i].auth_iv.data,</div>
<div class="line">                        port_cparams[i].auth_iv.length);</div>
<div class="line">            <span class="keywordflow">if</span> (options-&gt;auth_xform.auth.op == <a name="a63"></a><a class="code" href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47a99f910b408b48db113988c3b841972b9">RTE_CRYPTO_AUTH_OP_VERIFY</a>)</div>
<div class="line">                port_cparams[i].hash_verify = 1;</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                port_cparams[i].hash_verify = 0;</div>
<div class="line"> </div>
<div class="line">            port_cparams[i].auth_algo = options-&gt;auth_xform.auth.algo;</div>
<div class="line">            port_cparams[i].digest_length =</div>
<div class="line">                    options-&gt;auth_xform.auth.digest_length;</div>
<div class="line">            <span class="comment">/* Set IV parameters */</span></div>
<div class="line">            <span class="keywordflow">if</span> (options-&gt;auth_iv.length) {</div>
<div class="line">                options-&gt;auth_xform.auth.iv.offset =</div>
<div class="line">                    IV_OFFSET + options-&gt;cipher_iv.length;</div>
<div class="line">                options-&gt;auth_xform.auth.iv.length =</div>
<div class="line">                    options-&gt;auth_iv.length;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (port_cparams[i].do_aead) {</div>
<div class="line">            port_cparams[i].aead_iv.data = options-&gt;aead_iv.data;</div>
<div class="line">            port_cparams[i].aead_iv.length = options-&gt;aead_iv.length;</div>
<div class="line">            <span class="keywordflow">if</span> (!options-&gt;aead_iv_param)</div>
<div class="line">                generate_random_key(port_cparams[i].aead_iv.data,</div>
<div class="line">                        port_cparams[i].aead_iv.length);</div>
<div class="line">            port_cparams[i].aead_algo = options-&gt;aead_xform.aead.algo;</div>
<div class="line">            port_cparams[i].digest_length =</div>
<div class="line">                    options-&gt;aead_xform.aead.digest_length;</div>
<div class="line">            <span class="keywordflow">if</span> (options-&gt;aead_xform.aead.aad_length) {</div>
<div class="line">                port_cparams[i].aad.data = options-&gt;aad.data;</div>
<div class="line">                port_cparams[i].aad.phys_addr = options-&gt;aad.phys_addr;</div>
<div class="line">                port_cparams[i].aad.length = options-&gt;aad.length;</div>
<div class="line">                <span class="keywordflow">if</span> (!options-&gt;aad_param)</div>
<div class="line">                    generate_random_key(port_cparams[i].aad.data,</div>
<div class="line">                        port_cparams[i].aad.length);</div>
<div class="line">                <span class="comment">/*</span></div>
<div class="line"><span class="comment">                 * If doing AES-CCM, first 18 bytes has to be reserved,</span></div>
<div class="line"><span class="comment">                 * and actual AAD should start from byte 18</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                <span class="keywordflow">if</span> (port_cparams[i].aead_algo == <a class="code" href="rte__crypto__sym_8h.html#a648bc317af3ee238310fac9d87512508a27d121171b5e292d8a7313a38b91bf3e">RTE_CRYPTO_AEAD_AES_CCM</a>)</div>
<div class="line">                    memmove(port_cparams[i].aad.data + 18,</div>
<div class="line">                            port_cparams[i].aad.data,</div>
<div class="line">                            port_cparams[i].aad.length);</div>
<div class="line"> </div>
<div class="line">            } <span class="keywordflow">else</span></div>
<div class="line">                port_cparams[i].aad.length = 0;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (options-&gt;aead_xform.aead.op == <a name="a64"></a><a class="code" href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57ea331ebd5a481118673489e7c580530179">RTE_CRYPTO_AEAD_OP_DECRYPT</a>)</div>
<div class="line">                port_cparams[i].hash_verify = 1;</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                port_cparams[i].hash_verify = 0;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Set IV parameters */</span></div>
<div class="line">            options-&gt;aead_xform.aead.iv.offset = IV_OFFSET;</div>
<div class="line">            options-&gt;aead_xform.aead.iv.length = options-&gt;aead_iv.length;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (port_cparams[i].do_cipher) {</div>
<div class="line">            port_cparams[i].cipher_iv.data = options-&gt;cipher_iv.data;</div>
<div class="line">            port_cparams[i].cipher_iv.length = options-&gt;cipher_iv.length;</div>
<div class="line">            <span class="keywordflow">if</span> (!options-&gt;cipher_iv_param)</div>
<div class="line">                generate_random_key(port_cparams[i].cipher_iv.data,</div>
<div class="line">                        port_cparams[i].cipher_iv.length);</div>
<div class="line"> </div>
<div class="line">            port_cparams[i].cipher_algo = options-&gt;cipher_xform.cipher.algo;</div>
<div class="line">            <span class="comment">/* Set IV parameters */</span></div>
<div class="line">            options-&gt;cipher_xform.cipher.iv.offset = IV_OFFSET;</div>
<div class="line">            options-&gt;cipher_xform.cipher.iv.length =</div>
<div class="line">                        options-&gt;cipher_iv.length;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        session = initialize_crypto_session(options,</div>
<div class="line">                port_cparams[i].dev_id);</div>
<div class="line">        <span class="keywordflow">if</span> (session == NULL)</div>
<div class="line">            <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Failed to initialize crypto session\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        port_cparams[i].session = session;</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(INFO, L2FWD, <span class="stringliteral">&quot; -- lcoreid=%u cryptoid=%u\n&quot;</span>, lcore_id,</div>
<div class="line">                port_cparams[i].dev_id);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    l2fwd_crypto_options_print(options);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Initialize previous tsc timestamp before the loop,</span></div>
<div class="line"><span class="comment">     * to avoid showing the port statistics immediately,</span></div>
<div class="line"><span class="comment">     * so user can see the crypto information.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    prev_tsc = rte_rdtsc();</div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line"> </div>
<div class="line">        cur_tsc = rte_rdtsc();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Crypto device/TX burst queue drain</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        diff_tsc = cur_tsc - prev_tsc;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(diff_tsc &gt; drain_tsc)) {</div>
<div class="line">            <span class="comment">/* Enqueue all crypto ops remaining in buffers */</span></div>
<div class="line">            <span class="keywordflow">for</span> (i = 0; i &lt; qconf-&gt;nb_crypto_devs; i++) {</div>
<div class="line">                cparams = &amp;port_cparams[i];</div>
<div class="line">                len = qconf-&gt;op_buf[cparams-&gt;dev_id].len;</div>
<div class="line">                l2fwd_crypto_send_burst(qconf, len, cparams);</div>
<div class="line">                qconf-&gt;op_buf[cparams-&gt;dev_id].len = 0;</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">/* Transmit all packets remaining in buffers */</span></div>
<div class="line">            <span class="keywordflow">for</span> (portid = 0; portid &lt; RTE_MAX_ETHPORTS; portid++) {</div>
<div class="line">                <span class="keywordflow">if</span> (qconf-&gt;pkt_buf[portid].len == 0)</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line">                l2fwd_send_burst(&amp;lcore_queue_conf[lcore_id],</div>
<div class="line">                         qconf-&gt;pkt_buf[portid].len,</div>
<div class="line">                         portid);</div>
<div class="line">                qconf-&gt;pkt_buf[portid].len = 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* if timer is enabled */</span></div>
<div class="line">            <span class="keywordflow">if</span> (timer_period &gt; 0) {</div>
<div class="line"> </div>
<div class="line">                <span class="comment">/* advance the timer */</span></div>
<div class="line">                timer_tsc += diff_tsc;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">/* if timer has reached its timeout */</span></div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(timer_tsc &gt;=</div>
<div class="line">                        (uint64_t)timer_period)) {</div>
<div class="line"> </div>
<div class="line">                    <span class="comment">/* do this only on main core */</span></div>
<div class="line">                    <span class="keywordflow">if</span> (lcore_id == <a name="a65"></a><a class="code" href="rte__lcore_8h.html#a5449c6ee062fe3641520374152ce6c67">rte_get_main_lcore</a>()</div>
<div class="line">                        &amp;&amp; options-&gt;refresh_period) {</div>
<div class="line">                        print_stats();</div>
<div class="line">                        timer_tsc = 0;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            prev_tsc = cur_tsc;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Read packet from RX queues</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; qconf-&gt;nb_rx_ports; i++) {</div>
<div class="line">            portid = qconf-&gt;rx_port_list[i];</div>
<div class="line"> </div>
<div class="line">            cparams = &amp;port_cparams[i];</div>
<div class="line"> </div>
<div class="line">            nb_rx = <a name="a66"></a><a class="code" href="rte__ethdev_8h.html#a3e7d76a451b46348686ea97d6367f102">rte_eth_rx_burst</a>(portid, 0,</div>
<div class="line">                         pkts_burst, MAX_PKT_BURST);</div>
<div class="line"> </div>
<div class="line">            port_statistics[portid].rx += nb_rx;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (nb_rx) {</div>
<div class="line">                <span class="comment">/*</span></div>
<div class="line"><span class="comment">                 * If we can&#39;t allocate a crypto_ops, then drop</span></div>
<div class="line"><span class="comment">                 * the rest of the burst and dequeue and</span></div>
<div class="line"><span class="comment">                 * process the packets to free offload structs</span></div>
<div class="line"><span class="comment">                 */</span></div>
<div class="line">                <span class="keywordflow">if</span> (<a name="a67"></a><a class="code" href="rte__crypto_8h.html#a31a63194763a5a9e689170becddc3ae6">rte_crypto_op_bulk_alloc</a>(</div>
<div class="line">                        l2fwd_crypto_op_pool,</div>
<div class="line">                        <a name="a68"></a><a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc">RTE_CRYPTO_OP_TYPE_SYMMETRIC</a>,</div>
<div class="line">                        ops_burst, nb_rx) !=</div>
<div class="line">                                nb_rx) {</div>
<div class="line">                    <span class="keywordflow">for</span> (j = 0; j &lt; nb_rx; j++)</div>
<div class="line">                        <a class="code" href="rte__mbuf_8h.html#a1215458932900b7cd5192326fa4a6902">rte_pktmbuf_free</a>(pkts_burst[j]);</div>
<div class="line"> </div>
<div class="line">                    nb_rx = 0;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="comment">/* Enqueue packets from Crypto device*/</span></div>
<div class="line">                <span class="keywordflow">for</span> (j = 0; j &lt; nb_rx; j++) {</div>
<div class="line">                    m = pkts_burst[j];</div>
<div class="line"> </div>
<div class="line">                    l2fwd_simple_crypto_enqueue(m,</div>
<div class="line">                            ops_burst[j], cparams);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Dequeue packets from Crypto device */</span></div>
<div class="line">            <span class="keywordflow">do</span> {</div>
<div class="line">                nb_rx = <a name="a69"></a><a class="code" href="rte__cryptodev_8h.html#a0032857587ce7e217b8c10ba392bef56">rte_cryptodev_dequeue_burst</a>(</div>
<div class="line">                        cparams-&gt;dev_id, cparams-&gt;qp_id,</div>
<div class="line">                        ops_burst, MAX_PKT_BURST);</div>
<div class="line"> </div>
<div class="line">                crypto_statistics[cparams-&gt;dev_id].dequeued +=</div>
<div class="line">                        nb_rx;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">/* Forward crypto&#39;d packets */</span></div>
<div class="line">                <span class="keywordflow">for</span> (j = 0; j &lt; nb_rx; j++) {</div>
<div class="line">                    m = ops_burst[j]-&gt;<a class="code" href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">sym</a>-&gt;<a class="code" href="structrte__crypto__sym__op.html#af021669494a2806b0569587e2096e88e">m_src</a>;</div>
<div class="line"> </div>
<div class="line">                    <a class="code" href="rte__crypto_8h.html#aca76406e3f1ab04ab44dfbe4ff26f4ba">rte_crypto_op_free</a>(ops_burst[j]);</div>
<div class="line">                    l2fwd_simple_forward(m, portid,</div>
<div class="line">                            options);</div>
<div class="line">                }</div>
<div class="line">            } <span class="keywordflow">while</span> (nb_rx == MAX_PKT_BURST);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">l2fwd_launch_one_lcore(<span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    l2fwd_main_loop((<span class="keyword">struct</span> l2fwd_crypto_options *)arg);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Display command line arguments usage */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">l2fwd_crypto_usage(<span class="keyword">const</span> <span class="keywordtype">char</span> *prgname)</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;%s [EAL options] --\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  -p PORTMASK: hexadecimal bitmask of ports to configure\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  -q NQ: number of queue (=ports) per lcore (default is 1)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  -s manage all ports from single lcore\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  -T PERIOD: statistics will be refreshed each PERIOD seconds&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; (0 to disable, 10 default, 86400 maximum)\n&quot;</span></div>
<div class="line"> </div>
<div class="line">        <span class="stringliteral">&quot;  --cdev_type HW / SW / ANY\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --chain HASH_CIPHER / CIPHER_HASH / CIPHER_ONLY /&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; HASH_ONLY / AEAD\n&quot;</span></div>
<div class="line"> </div>
<div class="line">        <span class="stringliteral">&quot;  --cipher_algo ALGO\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --cipher_op ENCRYPT / DECRYPT\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --cipher_key KEY (bytes separated with \&quot;:\&quot;)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --cipher_key_random_size SIZE: size of cipher key when generated randomly\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --cipher_iv IV (bytes separated with \&quot;:\&quot;)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --cipher_iv_random_size SIZE: size of cipher IV when generated randomly\n&quot;</span></div>
<div class="line"> </div>
<div class="line">        <span class="stringliteral">&quot;  --auth_algo ALGO\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --auth_op GENERATE / VERIFY\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --auth_key KEY (bytes separated with \&quot;:\&quot;)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --auth_key_random_size SIZE: size of auth key when generated randomly\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --auth_iv IV (bytes separated with \&quot;:\&quot;)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --auth_iv_random_size SIZE: size of auth IV when generated randomly\n&quot;</span></div>
<div class="line"> </div>
<div class="line">        <span class="stringliteral">&quot;  --aead_algo ALGO\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --aead_op ENCRYPT / DECRYPT\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --aead_key KEY (bytes separated with \&quot;:\&quot;)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --aead_key_random_size SIZE: size of AEAD key when generated randomly\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --aead_iv IV (bytes separated with \&quot;:\&quot;)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --aead_iv_random_size SIZE: size of AEAD IV when generated randomly\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --aad AAD (bytes separated with \&quot;:\&quot;)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --aad_random_size SIZE: size of AAD when generated randomly\n&quot;</span></div>
<div class="line"> </div>
<div class="line">        <span class="stringliteral">&quot;  --digest_size SIZE: size of digest to be generated/verified\n&quot;</span></div>
<div class="line"> </div>
<div class="line">        <span class="stringliteral">&quot;  --sessionless\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --cryptodev_mask MASK: hexadecimal bitmask of crypto devices to configure\n&quot;</span></div>
<div class="line"> </div>
<div class="line">        <span class="stringliteral">&quot;  --[no-]mac-updating: Enable or disable MAC addresses updating (enabled by default)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;      When enabled:\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;       - The source MAC address is replaced by the TX port MAC address\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;       - The destination MAC address is replaced by 02:00:00:00:00:TX_PORT_ID\n&quot;</span>,</div>
<div class="line">           prgname);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_cryptodev_type(<span class="keyword">enum</span> cdev_type *type, <span class="keywordtype">char</span> *optarg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;HW&quot;</span>, optarg) == 0) {</div>
<div class="line">        *type = CDEV_TYPE_HW;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;SW&quot;</span>, optarg) == 0) {</div>
<div class="line">        *type = CDEV_TYPE_SW;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;ANY&quot;</span>, optarg) == 0) {</div>
<div class="line">        *type = CDEV_TYPE_ANY;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_crypto_opt_chain(<span class="keyword">struct</span> l2fwd_crypto_options *options, <span class="keywordtype">char</span> *optarg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;CIPHER_HASH&quot;</span>, optarg) == 0) {</div>
<div class="line">        options-&gt;xform_chain = L2FWD_CRYPTO_CIPHER_HASH;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;HASH_CIPHER&quot;</span>, optarg) == 0) {</div>
<div class="line">        options-&gt;xform_chain = L2FWD_CRYPTO_HASH_CIPHER;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;CIPHER_ONLY&quot;</span>, optarg) == 0) {</div>
<div class="line">        options-&gt;xform_chain = L2FWD_CRYPTO_CIPHER_ONLY;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;HASH_ONLY&quot;</span>, optarg) == 0) {</div>
<div class="line">        options-&gt;xform_chain = L2FWD_CRYPTO_HASH_ONLY;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;AEAD&quot;</span>, optarg) == 0) {</div>
<div class="line">        options-&gt;xform_chain = L2FWD_CRYPTO_AEAD;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_cipher_algo(<span class="keyword">enum</span> <a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75e">rte_crypto_cipher_algorithm</a> *algo, <span class="keywordtype">char</span> *optarg)</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a70"></a><a class="code" href="rte__cryptodev_8h.html#aac0e6b2a8cb903ccad7118b8c8155067">rte_cryptodev_get_cipher_algo_enum</a>(algo, optarg) &lt; 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Cipher algorithm specified &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;not supported!\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_cipher_op(<span class="keyword">enum</span> <a class="code" href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321">rte_crypto_cipher_operation</a> *op, <span class="keywordtype">char</span> *optarg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;ENCRYPT&quot;</span>, optarg) == 0) {</div>
<div class="line">        *op = <a name="a71"></a><a class="code" href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321a74a31028a7180f96bcbe6c1edc298c5b">RTE_CRYPTO_CIPHER_OP_ENCRYPT</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;DECRYPT&quot;</span>, optarg) == 0) {</div>
<div class="line">        *op = <a name="a72"></a><a class="code" href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321a4ec0ce9be05fae0758c95aadfb03c4ee">RTE_CRYPTO_CIPHER_OP_DECRYPT</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Cipher operation not supported!\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_bytes(uint8_t *data, <span class="keywordtype">char</span> *input_arg, uint16_t max_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">unsigned</span> byte_count;</div>
<div class="line">    <span class="keywordtype">char</span> *token;</div>
<div class="line"> </div>
<div class="line">    errno = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (byte_count = 0, token = strtok(input_arg, <span class="stringliteral">&quot;:&quot;</span>);</div>
<div class="line">            (byte_count &lt; max_size) &amp;&amp; (token != NULL);</div>
<div class="line">            token = strtok(NULL, <span class="stringliteral">&quot;:&quot;</span>)) {</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">int</span> number = (int)strtol(token, NULL, 16);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (errno == EINVAL || errno == ERANGE || number &gt; 0xFF)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">        data[byte_count++] = (uint8_t)number;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> byte_count;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_size(<span class="keywordtype">int</span> *size, <span class="keyword">const</span> <span class="keywordtype">char</span> *q_arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *end = NULL;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* parse hexadecimal string */</span></div>
<div class="line">    n = strtoul(q_arg, &amp;end, 10);</div>
<div class="line">    <span class="keywordflow">if</span> ((q_arg[0] == <span class="charliteral">&#39;\0&#39;</span>) || (end == NULL) || (*end != <span class="charliteral">&#39;\0&#39;</span>))</div>
<div class="line">        n = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;invalid size\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    *size = n;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_auth_algo(<span class="keyword">enum</span> <a class="code" href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793">rte_crypto_auth_algorithm</a> *algo, <span class="keywordtype">char</span> *optarg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a73"></a><a class="code" href="rte__cryptodev_8h.html#a385cf406030abf07a1581b6ae3aa03f2">rte_cryptodev_get_auth_algo_enum</a>(algo, optarg) &lt; 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;Authentication algorithm specified &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;not supported!\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_auth_op(<span class="keyword">enum</span> <a class="code" href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47">rte_crypto_auth_operation</a> *op, <span class="keywordtype">char</span> *optarg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;VERIFY&quot;</span>, optarg) == 0) {</div>
<div class="line">        *op = <a class="code" href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47a99f910b408b48db113988c3b841972b9">RTE_CRYPTO_AUTH_OP_VERIFY</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;GENERATE&quot;</span>, optarg) == 0) {</div>
<div class="line">        *op = <a name="a74"></a><a class="code" href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47aa4697c029df30850f9f01b1c641aca32">RTE_CRYPTO_AUTH_OP_GENERATE</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Authentication operation specified not supported!\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_aead_algo(<span class="keyword">enum</span> <a class="code" href="rte__crypto__sym_8h.html#a648bc317af3ee238310fac9d87512508">rte_crypto_aead_algorithm</a> *algo, <span class="keywordtype">char</span> *optarg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a75"></a><a class="code" href="rte__cryptodev_8h.html#ad57cb5966e6545c495651953f55f057d">rte_cryptodev_get_aead_algo_enum</a>(algo, optarg) &lt; 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, USER1, <span class="stringliteral">&quot;AEAD algorithm specified &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;not supported!\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_aead_op(<span class="keyword">enum</span> <a class="code" href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57e">rte_crypto_aead_operation</a> *op, <span class="keywordtype">char</span> *optarg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;ENCRYPT&quot;</span>, optarg) == 0) {</div>
<div class="line">        *op = <a name="a76"></a><a class="code" href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57ea80f5756a76a8c903cc56a3b475576e2c">RTE_CRYPTO_AEAD_OP_ENCRYPT</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;DECRYPT&quot;</span>, optarg) == 0) {</div>
<div class="line">        *op = <a class="code" href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57ea331ebd5a481118673489e7c580530179">RTE_CRYPTO_AEAD_OP_DECRYPT</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;AEAD operation specified not supported!\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_cryptodev_mask(<span class="keyword">struct</span> l2fwd_crypto_options *options,</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *q_arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *end = NULL;</div>
<div class="line">    uint64_t pm;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* parse hexadecimal string */</span></div>
<div class="line">    pm = strtoul(q_arg, &amp;end, 16);</div>
<div class="line">    <span class="keywordflow">if</span> ((pm == <span class="charliteral">&#39;\0&#39;</span>) || (end == NULL) || (*end != <span class="charliteral">&#39;\0&#39;</span>))</div>
<div class="line">        pm = 0;</div>
<div class="line"> </div>
<div class="line">    options-&gt;cryptodev_mask = pm;</div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;cryptodev_mask == 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;invalid cryptodev_mask specified\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">l2fwd_crypto_parse_args_long_options(<span class="keyword">struct</span> l2fwd_crypto_options *options,</div>
<div class="line">        <span class="keyword">struct</span> option *lgopts, <span class="keywordtype">int</span> option_index)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> retval;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;cdev_type&quot;</span>) == 0) {</div>
<div class="line">        retval = parse_cryptodev_type(&amp;options-&gt;type, optarg);</div>
<div class="line">        <span class="keywordflow">if</span> (retval == 0)</div>
<div class="line">            strlcpy(options-&gt;string_type, optarg, MAX_STR_LEN);</div>
<div class="line">        <span class="keywordflow">return</span> retval;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;chain&quot;</span>) == 0)</div>
<div class="line">        <span class="keywordflow">return</span> parse_crypto_opt_chain(options, optarg);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Cipher options */</span></div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;cipher_algo&quot;</span>) == 0)</div>
<div class="line">        <span class="keywordflow">return</span> parse_cipher_algo(&amp;options-&gt;cipher_xform.cipher.algo,</div>
<div class="line">                optarg);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;cipher_op&quot;</span>) == 0)</div>
<div class="line">        <span class="keywordflow">return</span> parse_cipher_op(&amp;options-&gt;cipher_xform.cipher.op,</div>
<div class="line">                optarg);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;cipher_key&quot;</span>) == 0) {</div>
<div class="line">        options-&gt;ckey_param = 1;</div>
<div class="line">        options-&gt;cipher_xform.cipher.key.length =</div>
<div class="line">            parse_bytes(options-&gt;cipher_key, optarg, MAX_KEY_SIZE);</div>
<div class="line">        <span class="keywordflow">if</span> (options-&gt;cipher_xform.cipher.key.length &gt; 0)</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;cipher_key_random_size&quot;</span>) == 0)</div>
<div class="line">        <span class="keywordflow">return</span> parse_size(&amp;options-&gt;ckey_random_size, optarg);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;cipher_iv&quot;</span>) == 0) {</div>
<div class="line">        options-&gt;cipher_iv_param = 1;</div>
<div class="line">        options-&gt;cipher_iv.length =</div>
<div class="line">            parse_bytes(options-&gt;cipher_iv.data, optarg, MAX_IV_SIZE);</div>
<div class="line">        <span class="keywordflow">if</span> (options-&gt;cipher_iv.length &gt; 0)</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;cipher_iv_random_size&quot;</span>) == 0)</div>
<div class="line">        <span class="keywordflow">return</span> parse_size(&amp;options-&gt;cipher_iv_random_size, optarg);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Authentication options */</span></div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;auth_algo&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">return</span> parse_auth_algo(&amp;options-&gt;auth_xform.auth.algo,</div>
<div class="line">                optarg);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;auth_op&quot;</span>) == 0)</div>
<div class="line">        <span class="keywordflow">return</span> parse_auth_op(&amp;options-&gt;auth_xform.auth.op,</div>
<div class="line">                optarg);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;auth_key&quot;</span>) == 0) {</div>
<div class="line">        options-&gt;akey_param = 1;</div>
<div class="line">        options-&gt;auth_xform.auth.key.length =</div>
<div class="line">            parse_bytes(options-&gt;auth_key, optarg, MAX_KEY_SIZE);</div>
<div class="line">        <span class="keywordflow">if</span> (options-&gt;auth_xform.auth.key.length &gt; 0)</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;auth_key_random_size&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">return</span> parse_size(&amp;options-&gt;akey_random_size, optarg);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;auth_iv&quot;</span>) == 0) {</div>
<div class="line">        options-&gt;auth_iv_param = 1;</div>
<div class="line">        options-&gt;auth_iv.length =</div>
<div class="line">            parse_bytes(options-&gt;auth_iv.data, optarg, MAX_IV_SIZE);</div>
<div class="line">        <span class="keywordflow">if</span> (options-&gt;auth_iv.length &gt; 0)</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;auth_iv_random_size&quot;</span>) == 0)</div>
<div class="line">        <span class="keywordflow">return</span> parse_size(&amp;options-&gt;auth_iv_random_size, optarg);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* AEAD options */</span></div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;aead_algo&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">return</span> parse_aead_algo(&amp;options-&gt;aead_xform.aead.algo,</div>
<div class="line">                optarg);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;aead_op&quot;</span>) == 0)</div>
<div class="line">        <span class="keywordflow">return</span> parse_aead_op(&amp;options-&gt;aead_xform.aead.op,</div>
<div class="line">                optarg);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;aead_key&quot;</span>) == 0) {</div>
<div class="line">        options-&gt;aead_key_param = 1;</div>
<div class="line">        options-&gt;aead_xform.aead.key.length =</div>
<div class="line">            parse_bytes(options-&gt;aead_key, optarg, MAX_KEY_SIZE);</div>
<div class="line">        <span class="keywordflow">if</span> (options-&gt;aead_xform.aead.key.length &gt; 0)</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;aead_key_random_size&quot;</span>) == 0)</div>
<div class="line">        <span class="keywordflow">return</span> parse_size(&amp;options-&gt;aead_key_random_size, optarg);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;aead_iv&quot;</span>) == 0) {</div>
<div class="line">        options-&gt;aead_iv_param = 1;</div>
<div class="line">        options-&gt;aead_iv.length =</div>
<div class="line">            parse_bytes(options-&gt;aead_iv.data, optarg, MAX_IV_SIZE);</div>
<div class="line">        <span class="keywordflow">if</span> (options-&gt;aead_iv.length &gt; 0)</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;aead_iv_random_size&quot;</span>) == 0)</div>
<div class="line">        <span class="keywordflow">return</span> parse_size(&amp;options-&gt;aead_iv_random_size, optarg);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;aad&quot;</span>) == 0) {</div>
<div class="line">        options-&gt;aad_param = 1;</div>
<div class="line">        options-&gt;aad.length =</div>
<div class="line">            parse_bytes(options-&gt;aad.data, optarg, MAX_AAD_SIZE);</div>
<div class="line">        <span class="keywordflow">if</span> (options-&gt;aad.length &gt; 0)</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;aad_random_size&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">return</span> parse_size(&amp;options-&gt;aad_random_size, optarg);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;digest_size&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">return</span> parse_size(&amp;options-&gt;digest_size, optarg);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;sessionless&quot;</span>) == 0) {</div>
<div class="line">        options-&gt;sessionless = 1;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;cryptodev_mask&quot;</span>) == 0)</div>
<div class="line">        <span class="keywordflow">return</span> parse_cryptodev_mask(options, optarg);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;mac-updating&quot;</span>) == 0) {</div>
<div class="line">        options-&gt;mac_updating = 1;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;no-mac-updating&quot;</span>) == 0) {</div>
<div class="line">        options-&gt;mac_updating = 0;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">l2fwd_crypto_parse_portmask(<span class="keyword">struct</span> l2fwd_crypto_options *options,</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *q_arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *end = NULL;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> pm;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* parse hexadecimal string */</span></div>
<div class="line">    pm = strtoul(q_arg, &amp;end, 16);</div>
<div class="line">    <span class="keywordflow">if</span> ((pm == <span class="charliteral">&#39;\0&#39;</span>) || (end == NULL) || (*end != <span class="charliteral">&#39;\0&#39;</span>))</div>
<div class="line">        pm = 0;</div>
<div class="line"> </div>
<div class="line">    options-&gt;portmask = pm;</div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;portmask == 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;invalid portmask specified\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> pm;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">l2fwd_crypto_parse_nqueue(<span class="keyword">struct</span> l2fwd_crypto_options *options,</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *q_arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *end = NULL;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* parse hexadecimal string */</span></div>
<div class="line">    n = strtoul(q_arg, &amp;end, 10);</div>
<div class="line">    <span class="keywordflow">if</span> ((q_arg[0] == <span class="charliteral">&#39;\0&#39;</span>) || (end == NULL) || (*end != <span class="charliteral">&#39;\0&#39;</span>))</div>
<div class="line">        n = 0;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &gt;= MAX_RX_QUEUE_PER_LCORE)</div>
<div class="line">        n = 0;</div>
<div class="line"> </div>
<div class="line">    options-&gt;nb_ports_per_lcore = n;</div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;nb_ports_per_lcore == 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;invalid number of ports selected\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">l2fwd_crypto_parse_timer_period(<span class="keyword">struct</span> l2fwd_crypto_options *options,</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *q_arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *end = NULL;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* parse number string */</span></div>
<div class="line">    n = (unsigned)strtol(q_arg, &amp;end, 10);</div>
<div class="line">    <span class="keywordflow">if</span> ((q_arg[0] == <span class="charliteral">&#39;\0&#39;</span>) || (end == NULL) || (*end != <span class="charliteral">&#39;\0&#39;</span>))</div>
<div class="line">        n = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n &gt;= MAX_TIMER_PERIOD) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Warning refresh period specified %lu is greater than &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;max value %lu! using max value&quot;</span>,</div>
<div class="line">                n, MAX_TIMER_PERIOD);</div>
<div class="line">        n = MAX_TIMER_PERIOD;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    options-&gt;refresh_period = n * 1000 * TIMER_MILLISECOND;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">l2fwd_crypto_default_options(<span class="keyword">struct</span> l2fwd_crypto_options *options)</div>
<div class="line">{</div>
<div class="line">    options-&gt;portmask = 0xffffffff;</div>
<div class="line">    options-&gt;nb_ports_per_lcore = 1;</div>
<div class="line">    options-&gt;refresh_period = 10000;</div>
<div class="line">    options-&gt;single_lcore = 0;</div>
<div class="line">    options-&gt;sessionless = 0;</div>
<div class="line"> </div>
<div class="line">    options-&gt;xform_chain = L2FWD_CRYPTO_CIPHER_HASH;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Cipher Data */</span></div>
<div class="line">    options-&gt;cipher_xform.type = <a name="a77"></a><a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c">RTE_CRYPTO_SYM_XFORM_CIPHER</a>;</div>
<div class="line">    options-&gt;cipher_xform.next = NULL;</div>
<div class="line">    options-&gt;ckey_param = 0;</div>
<div class="line">    options-&gt;ckey_random_size = -1;</div>
<div class="line">    options-&gt;cipher_xform.cipher.key.length = 0;</div>
<div class="line">    options-&gt;cipher_iv_param = 0;</div>
<div class="line">    options-&gt;cipher_iv_random_size = -1;</div>
<div class="line">    options-&gt;cipher_iv.length = 0;</div>
<div class="line"> </div>
<div class="line">    options-&gt;cipher_xform.cipher.algo = <a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ead9f8e28815f3dd2b77e7ce93b7b8a7ca">RTE_CRYPTO_CIPHER_AES_CBC</a>;</div>
<div class="line">    options-&gt;cipher_xform.cipher.op = <a class="code" href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321a74a31028a7180f96bcbe6c1edc298c5b">RTE_CRYPTO_CIPHER_OP_ENCRYPT</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Authentication Data */</span></div>
<div class="line">    options-&gt;auth_xform.type = <a name="a78"></a><a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9">RTE_CRYPTO_SYM_XFORM_AUTH</a>;</div>
<div class="line">    options-&gt;auth_xform.next = NULL;</div>
<div class="line">    options-&gt;akey_param = 0;</div>
<div class="line">    options-&gt;akey_random_size = -1;</div>
<div class="line">    options-&gt;auth_xform.auth.key.length = 0;</div>
<div class="line">    options-&gt;auth_iv_param = 0;</div>
<div class="line">    options-&gt;auth_iv_random_size = -1;</div>
<div class="line">    options-&gt;auth_iv.length = 0;</div>
<div class="line"> </div>
<div class="line">    options-&gt;auth_xform.auth.algo = <a name="a79"></a><a class="code" href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793a98921a1d0174e6ec9f252b408dd39d20">RTE_CRYPTO_AUTH_SHA1_HMAC</a>;</div>
<div class="line">    options-&gt;auth_xform.auth.op = <a class="code" href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47aa4697c029df30850f9f01b1c641aca32">RTE_CRYPTO_AUTH_OP_GENERATE</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* AEAD Data */</span></div>
<div class="line">    options-&gt;aead_xform.type = <a name="a80"></a><a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a87d8d14b56f41d42ca643d33a279912a">RTE_CRYPTO_SYM_XFORM_AEAD</a>;</div>
<div class="line">    options-&gt;aead_xform.next = NULL;</div>
<div class="line">    options-&gt;aead_key_param = 0;</div>
<div class="line">    options-&gt;aead_key_random_size = -1;</div>
<div class="line">    options-&gt;aead_xform.aead.key.length = 0;</div>
<div class="line">    options-&gt;aead_iv_param = 0;</div>
<div class="line">    options-&gt;aead_iv_random_size = -1;</div>
<div class="line">    options-&gt;aead_iv.length = 0;</div>
<div class="line"> </div>
<div class="line">    options-&gt;aead_xform.aead.algo = <a name="a81"></a><a class="code" href="rte__crypto__sym_8h.html#a648bc317af3ee238310fac9d87512508ab8b38d7173d30b7adf47116abb09c469">RTE_CRYPTO_AEAD_AES_GCM</a>;</div>
<div class="line">    options-&gt;aead_xform.aead.op = <a class="code" href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57ea80f5756a76a8c903cc56a3b475576e2c">RTE_CRYPTO_AEAD_OP_ENCRYPT</a>;</div>
<div class="line"> </div>
<div class="line">    options-&gt;aad_param = 0;</div>
<div class="line">    options-&gt;aad_random_size = -1;</div>
<div class="line">    options-&gt;aad.length = 0;</div>
<div class="line"> </div>
<div class="line">    options-&gt;digest_size = -1;</div>
<div class="line"> </div>
<div class="line">    options-&gt;type = CDEV_TYPE_ANY;</div>
<div class="line">    options-&gt;cryptodev_mask = UINT64_MAX;</div>
<div class="line"> </div>
<div class="line">    options-&gt;mac_updating = 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">display_cipher_info(<span class="keyword">struct</span> l2fwd_crypto_options *options)</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;\n---- Cipher information ---\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;Algorithm: %s\n&quot;</span>,</div>
<div class="line">        <a name="a82"></a><a class="code" href="rte__crypto__sym_8h.html#ad0accb8ac900700f160f1dd12fa8b19b">rte_crypto_cipher_algorithm_strings</a>[options-&gt;cipher_xform.cipher.algo]);</div>
<div class="line">    <a name="a83"></a><a class="code" href="rte__hexdump_8h.html#ad29a838fbd4c22051204e8055c6593ed">rte_hexdump</a>(stdout, <span class="stringliteral">&quot;Cipher key:&quot;</span>,</div>
<div class="line">            options-&gt;cipher_xform.cipher.key.data,</div>
<div class="line">            options-&gt;cipher_xform.cipher.key.length);</div>
<div class="line">    <a class="code" href="rte__hexdump_8h.html#ad29a838fbd4c22051204e8055c6593ed">rte_hexdump</a>(stdout, <span class="stringliteral">&quot;IV:&quot;</span>, options-&gt;cipher_iv.data, options-&gt;cipher_iv.length);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">display_auth_info(<span class="keyword">struct</span> l2fwd_crypto_options *options)</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;\n---- Authentication information ---\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;Algorithm: %s\n&quot;</span>,</div>
<div class="line">        <a name="a84"></a><a class="code" href="rte__crypto__sym_8h.html#a307c9b83491f12f87af8187715a01153">rte_crypto_auth_algorithm_strings</a>[options-&gt;auth_xform.auth.algo]);</div>
<div class="line">    <a class="code" href="rte__hexdump_8h.html#ad29a838fbd4c22051204e8055c6593ed">rte_hexdump</a>(stdout, <span class="stringliteral">&quot;Auth key:&quot;</span>,</div>
<div class="line">            options-&gt;auth_xform.auth.key.data,</div>
<div class="line">            options-&gt;auth_xform.auth.key.length);</div>
<div class="line">    <a class="code" href="rte__hexdump_8h.html#ad29a838fbd4c22051204e8055c6593ed">rte_hexdump</a>(stdout, <span class="stringliteral">&quot;IV:&quot;</span>, options-&gt;auth_iv.data, options-&gt;auth_iv.length);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">display_aead_info(<span class="keyword">struct</span> l2fwd_crypto_options *options)</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;\n---- AEAD information ---\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;Algorithm: %s\n&quot;</span>,</div>
<div class="line">        <a name="a85"></a><a class="code" href="rte__crypto__sym_8h.html#a958771db424879b8de3ca82f5da0d399">rte_crypto_aead_algorithm_strings</a>[options-&gt;aead_xform.aead.algo]);</div>
<div class="line">    <a class="code" href="rte__hexdump_8h.html#ad29a838fbd4c22051204e8055c6593ed">rte_hexdump</a>(stdout, <span class="stringliteral">&quot;AEAD key:&quot;</span>,</div>
<div class="line">            options-&gt;aead_xform.aead.key.data,</div>
<div class="line">            options-&gt;aead_xform.aead.key.length);</div>
<div class="line">    <a class="code" href="rte__hexdump_8h.html#ad29a838fbd4c22051204e8055c6593ed">rte_hexdump</a>(stdout, <span class="stringliteral">&quot;IV:&quot;</span>, options-&gt;aead_iv.data, options-&gt;aead_iv.length);</div>
<div class="line">    <a class="code" href="rte__hexdump_8h.html#ad29a838fbd4c22051204e8055c6593ed">rte_hexdump</a>(stdout, <span class="stringliteral">&quot;AAD:&quot;</span>, options-&gt;aad.data, options-&gt;aad.length);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">l2fwd_crypto_options_print(<span class="keyword">struct</span> l2fwd_crypto_options *options)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> string_cipher_op[MAX_STR_LEN];</div>
<div class="line">    <span class="keywordtype">char</span> string_auth_op[MAX_STR_LEN];</div>
<div class="line">    <span class="keywordtype">char</span> string_aead_op[MAX_STR_LEN];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;cipher_xform.cipher.op == <a class="code" href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321a74a31028a7180f96bcbe6c1edc298c5b">RTE_CRYPTO_CIPHER_OP_ENCRYPT</a>)</div>
<div class="line">        strcpy(string_cipher_op, <span class="stringliteral">&quot;Encrypt&quot;</span>);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        strcpy(string_cipher_op, <span class="stringliteral">&quot;Decrypt&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;auth_xform.auth.op == <a class="code" href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47aa4697c029df30850f9f01b1c641aca32">RTE_CRYPTO_AUTH_OP_GENERATE</a>)</div>
<div class="line">        strcpy(string_auth_op, <span class="stringliteral">&quot;Auth generate&quot;</span>);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        strcpy(string_auth_op, <span class="stringliteral">&quot;Auth verify&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;aead_xform.aead.op == <a class="code" href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57ea80f5756a76a8c903cc56a3b475576e2c">RTE_CRYPTO_AEAD_OP_ENCRYPT</a>)</div>
<div class="line">        strcpy(string_aead_op, <span class="stringliteral">&quot;Authenticated encryption&quot;</span>);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        strcpy(string_aead_op, <span class="stringliteral">&quot;Authenticated decryption&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Options:-\nn&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;portmask: %x\n&quot;</span>, options-&gt;portmask);</div>
<div class="line">    printf(<span class="stringliteral">&quot;ports per lcore: %u\n&quot;</span>, options-&gt;nb_ports_per_lcore);</div>
<div class="line">    printf(<span class="stringliteral">&quot;refresh period : %u\n&quot;</span>, options-&gt;refresh_period);</div>
<div class="line">    printf(<span class="stringliteral">&quot;single lcore mode: %s\n&quot;</span>,</div>
<div class="line">            options-&gt;single_lcore ? <span class="stringliteral">&quot;enabled&quot;</span> : <span class="stringliteral">&quot;disabled&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;stats_printing: %s\n&quot;</span>,</div>
<div class="line">            options-&gt;refresh_period == 0 ? <span class="stringliteral">&quot;disabled&quot;</span> : <span class="stringliteral">&quot;enabled&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;sessionless crypto: %s\n&quot;</span>,</div>
<div class="line">            options-&gt;sessionless ? <span class="stringliteral">&quot;enabled&quot;</span> : <span class="stringliteral">&quot;disabled&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;ckey_param &amp;&amp; (options-&gt;ckey_random_size != -1))</div>
<div class="line">        printf(<span class="stringliteral">&quot;Cipher key already parsed, ignoring size of random key\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;akey_param &amp;&amp; (options-&gt;akey_random_size != -1))</div>
<div class="line">        printf(<span class="stringliteral">&quot;Auth key already parsed, ignoring size of random key\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;cipher_iv_param &amp;&amp; (options-&gt;cipher_iv_random_size != -1))</div>
<div class="line">        printf(<span class="stringliteral">&quot;Cipher IV already parsed, ignoring size of random IV\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;auth_iv_param &amp;&amp; (options-&gt;auth_iv_random_size != -1))</div>
<div class="line">        printf(<span class="stringliteral">&quot;Auth IV already parsed, ignoring size of random IV\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;aad_param &amp;&amp; (options-&gt;aad_random_size != -1))</div>
<div class="line">        printf(<span class="stringliteral">&quot;AAD already parsed, ignoring size of random AAD\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;\nCrypto chain: &quot;</span>);</div>
<div class="line">    <span class="keywordflow">switch</span> (options-&gt;xform_chain) {</div>
<div class="line">    <span class="keywordflow">case</span> L2FWD_CRYPTO_AEAD:</div>
<div class="line">        printf(<span class="stringliteral">&quot;Input --&gt; %s --&gt; Output\n&quot;</span>, string_aead_op);</div>
<div class="line">        display_aead_info(options);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> L2FWD_CRYPTO_CIPHER_HASH:</div>
<div class="line">        printf(<span class="stringliteral">&quot;Input --&gt; %s --&gt; %s --&gt; Output\n&quot;</span>,</div>
<div class="line">            string_cipher_op, string_auth_op);</div>
<div class="line">        display_cipher_info(options);</div>
<div class="line">        display_auth_info(options);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> L2FWD_CRYPTO_HASH_CIPHER:</div>
<div class="line">        printf(<span class="stringliteral">&quot;Input --&gt; %s --&gt; %s --&gt; Output\n&quot;</span>,</div>
<div class="line">            string_auth_op, string_cipher_op);</div>
<div class="line">        display_cipher_info(options);</div>
<div class="line">        display_auth_info(options);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> L2FWD_CRYPTO_HASH_ONLY:</div>
<div class="line">        printf(<span class="stringliteral">&quot;Input --&gt; %s --&gt; Output\n&quot;</span>, string_auth_op);</div>
<div class="line">        display_auth_info(options);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> L2FWD_CRYPTO_CIPHER_ONLY:</div>
<div class="line">        printf(<span class="stringliteral">&quot;Input --&gt; %s --&gt; Output\n&quot;</span>, string_cipher_op);</div>
<div class="line">        display_cipher_info(options);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Parse the argument given in the command line of the application */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">l2fwd_crypto_parse_args(<span class="keyword">struct</span> l2fwd_crypto_options *options,</div>
<div class="line">        <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> opt, retval, option_index;</div>
<div class="line">    <span class="keywordtype">char</span> **argvopt = argv, *prgname = argv[0];</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">struct </span>option lgopts[] = {</div>
<div class="line">            { <span class="stringliteral">&quot;sessionless&quot;</span>, no_argument, 0, 0 },</div>
<div class="line"> </div>
<div class="line">            { <span class="stringliteral">&quot;cdev_type&quot;</span>, required_argument, 0, 0 },</div>
<div class="line">            { <span class="stringliteral">&quot;chain&quot;</span>, required_argument, 0, 0 },</div>
<div class="line"> </div>
<div class="line">            { <span class="stringliteral">&quot;cipher_algo&quot;</span>, required_argument, 0, 0 },</div>
<div class="line">            { <span class="stringliteral">&quot;cipher_op&quot;</span>, required_argument, 0, 0 },</div>
<div class="line">            { <span class="stringliteral">&quot;cipher_key&quot;</span>, required_argument, 0, 0 },</div>
<div class="line">            { <span class="stringliteral">&quot;cipher_key_random_size&quot;</span>, required_argument, 0, 0 },</div>
<div class="line">            { <span class="stringliteral">&quot;cipher_iv&quot;</span>, required_argument, 0, 0 },</div>
<div class="line">            { <span class="stringliteral">&quot;cipher_iv_random_size&quot;</span>, required_argument, 0, 0 },</div>
<div class="line"> </div>
<div class="line">            { <span class="stringliteral">&quot;auth_algo&quot;</span>, required_argument, 0, 0 },</div>
<div class="line">            { <span class="stringliteral">&quot;auth_op&quot;</span>, required_argument, 0, 0 },</div>
<div class="line">            { <span class="stringliteral">&quot;auth_key&quot;</span>, required_argument, 0, 0 },</div>
<div class="line">            { <span class="stringliteral">&quot;auth_key_random_size&quot;</span>, required_argument, 0, 0 },</div>
<div class="line">            { <span class="stringliteral">&quot;auth_iv&quot;</span>, required_argument, 0, 0 },</div>
<div class="line">            { <span class="stringliteral">&quot;auth_iv_random_size&quot;</span>, required_argument, 0, 0 },</div>
<div class="line"> </div>
<div class="line">            { <span class="stringliteral">&quot;aead_algo&quot;</span>, required_argument, 0, 0 },</div>
<div class="line">            { <span class="stringliteral">&quot;aead_op&quot;</span>, required_argument, 0, 0 },</div>
<div class="line">            { <span class="stringliteral">&quot;aead_key&quot;</span>, required_argument, 0, 0 },</div>
<div class="line">            { <span class="stringliteral">&quot;aead_key_random_size&quot;</span>, required_argument, 0, 0 },</div>
<div class="line">            { <span class="stringliteral">&quot;aead_iv&quot;</span>, required_argument, 0, 0 },</div>
<div class="line">            { <span class="stringliteral">&quot;aead_iv_random_size&quot;</span>, required_argument, 0, 0 },</div>
<div class="line"> </div>
<div class="line">            { <span class="stringliteral">&quot;aad&quot;</span>, required_argument, 0, 0 },</div>
<div class="line">            { <span class="stringliteral">&quot;aad_random_size&quot;</span>, required_argument, 0, 0 },</div>
<div class="line"> </div>
<div class="line">            { <span class="stringliteral">&quot;digest_size&quot;</span>, required_argument, 0, 0 },</div>
<div class="line"> </div>
<div class="line">            { <span class="stringliteral">&quot;sessionless&quot;</span>, no_argument, 0, 0 },</div>
<div class="line">            { <span class="stringliteral">&quot;cryptodev_mask&quot;</span>, required_argument, 0, 0},</div>
<div class="line"> </div>
<div class="line">            { <span class="stringliteral">&quot;mac-updating&quot;</span>, no_argument, 0, 0},</div>
<div class="line">            { <span class="stringliteral">&quot;no-mac-updating&quot;</span>, no_argument, 0, 0},</div>
<div class="line"> </div>
<div class="line">            { NULL, 0, 0, 0 }</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    l2fwd_crypto_default_options(options);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> ((opt = getopt_long(argc, argvopt, <span class="stringliteral">&quot;p:q:sT:&quot;</span>, lgopts,</div>
<div class="line">            &amp;option_index)) != EOF) {</div>
<div class="line">        <span class="keywordflow">switch</span> (opt) {</div>
<div class="line">        <span class="comment">/* long options */</span></div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">            retval = l2fwd_crypto_parse_args_long_options(options,</div>
<div class="line">                    lgopts, option_index);</div>
<div class="line">            <span class="keywordflow">if</span> (retval &lt; 0) {</div>
<div class="line">                l2fwd_crypto_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* portmask */</span></div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>:</div>
<div class="line">            retval = l2fwd_crypto_parse_portmask(options, optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (retval &lt; 0) {</div>
<div class="line">                l2fwd_crypto_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* nqueue */</span></div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;q&#39;</span>:</div>
<div class="line">            retval = l2fwd_crypto_parse_nqueue(options, optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (retval &lt; 0) {</div>
<div class="line">                l2fwd_crypto_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* single  */</span></div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:</div>
<div class="line">            options-&gt;single_lcore = 1;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* timer period */</span></div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:</div>
<div class="line">            retval = l2fwd_crypto_parse_timer_period(options,</div>
<div class="line">                    optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (retval &lt; 0) {</div>
<div class="line">                l2fwd_crypto_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            l2fwd_crypto_usage(prgname);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (optind &gt;= 0)</div>
<div class="line">        argv[optind-1] = prgname;</div>
<div class="line"> </div>
<div class="line">    retval = optind-1;</div>
<div class="line">    optind = 1; <span class="comment">/* reset getopt lib */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> retval;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Check the link status of all ports in up to 9s, and print them finally */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">check_all_ports_link_status(uint32_t port_mask)</div>
<div class="line">{</div>
<div class="line"><span class="preprocessor">#define CHECK_INTERVAL 100 </span><span class="comment">/* 100ms */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define MAX_CHECK_TIME 90 </span><span class="comment">/* 9s (90 * 100ms) in total */</span><span class="preprocessor"></span></div>
<div class="line">    uint16_t portid;</div>
<div class="line">    uint8_t count, all_ports_up, print_flag = 0;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a86"></a><a class="code" href="structrte__eth__link.html">rte_eth_link</a> link;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line">    <span class="keywordtype">char</span> link_status_text[<a name="a87"></a><a class="code" href="rte__ethdev_8h.html#a7a31d6736244603b6a1d7efdd32a8834">RTE_ETH_LINK_MAX_STR_LEN</a>];</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;\nChecking link status&quot;</span>);</div>
<div class="line">    fflush(stdout);</div>
<div class="line">    <span class="keywordflow">for</span> (count = 0; count &lt;= MAX_CHECK_TIME; count++) {</div>
<div class="line">        all_ports_up = 1;</div>
<div class="line">        <a name="a88"></a><a class="code" href="rte__ethdev_8h.html#ad7b46c67203d37fe3a34f11076d970d6">RTE_ETH_FOREACH_DEV</a>(portid) {</div>
<div class="line">            <span class="keywordflow">if</span> ((port_mask &amp; (1 &lt;&lt; portid)) == 0)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            memset(&amp;link, 0, <span class="keyword">sizeof</span>(link));</div>
<div class="line">            ret = <a name="a89"></a><a class="code" href="rte__ethdev_8h.html#ad1263899f41301923c483c3b4ce0486f">rte_eth_link_get_nowait</a>(portid, &amp;link);</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">                all_ports_up = 0;</div>
<div class="line">                <span class="keywordflow">if</span> (print_flag == 1)</div>
<div class="line">                    printf(<span class="stringliteral">&quot;Port %u link get failed: %s\n&quot;</span>,</div>
<div class="line">                        portid, <a name="a90"></a><a class="code" href="rte__errno_8h.html#a129a7eb4cfa1f5bdac5783bf49137d06">rte_strerror</a>(-ret));</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">/* print link status if flag set */</span></div>
<div class="line">            <span class="keywordflow">if</span> (print_flag == 1) {</div>
<div class="line">                <a name="a91"></a><a class="code" href="rte__ethdev_8h.html#a5f51139368b8d1a2c22fdecd90bc4d98">rte_eth_link_to_str</a>(link_status_text,</div>
<div class="line">                    <span class="keyword">sizeof</span>(link_status_text), &amp;link);</div>
<div class="line">                printf(<span class="stringliteral">&quot;Port %d %s\n&quot;</span>, portid,</div>
<div class="line">                    link_status_text);</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">/* clear all_ports_up flag if any link down */</span></div>
<div class="line">            <span class="keywordflow">if</span> (link.link_status == <a name="a92"></a><a class="code" href="rte__ethdev_8h.html#a08c012f37e07726170ff67daf667d850">ETH_LINK_DOWN</a>) {</div>
<div class="line">                all_ports_up = 0;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/* after finally printing all link status, get out */</span></div>
<div class="line">        <span class="keywordflow">if</span> (print_flag == 1)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (all_ports_up == 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line">            fflush(stdout);</div>
<div class="line">            <a name="a93"></a><a class="code" href="rte__cycles_8h.html#af73b844d50b98de74b1a0e1730262f85">rte_delay_ms</a>(CHECK_INTERVAL);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* set the print_flag if all ports up or timeout */</span></div>
<div class="line">        <span class="keywordflow">if</span> (all_ports_up == 1 || count == (MAX_CHECK_TIME - 1)) {</div>
<div class="line">            print_flag = 1;</div>
<div class="line">            printf(<span class="stringliteral">&quot;done\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Check if device has to be HW/SW or any */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">check_type(<span class="keyword">const</span> <span class="keyword">struct</span> l2fwd_crypto_options *options,</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">struct</span> <a name="_a94"></a><a class="code" href="structrte__cryptodev__info.html">rte_cryptodev_info</a> *dev_info)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;type == CDEV_TYPE_HW &amp;&amp;</div>
<div class="line">            (dev_info-&gt;<a name="a95"></a><a class="code" href="structrte__cryptodev__info.html#aaccbcc3ce862dbe5af189ee0c3e345b1">feature_flags</a> &amp; <a name="a96"></a><a class="code" href="rte__cryptodev_8h.html#a3b1d740f9da225aebc2dc6762b9758b0">RTE_CRYPTODEV_FF_HW_ACCELERATED</a>))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;type == CDEV_TYPE_SW &amp;&amp;</div>
<div class="line">            !(dev_info-&gt;<a class="code" href="structrte__cryptodev__info.html#aaccbcc3ce862dbe5af189ee0c3e345b1">feature_flags</a> &amp; <a class="code" href="rte__cryptodev_8h.html#a3b1d740f9da225aebc2dc6762b9758b0">RTE_CRYPTODEV_FF_HW_ACCELERATED</a>))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;type == CDEV_TYPE_ANY)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a name="_a97"></a><a class="code" href="structrte__cryptodev__capabilities.html">rte_cryptodev_capabilities</a> *</div>
<div class="line">check_device_support_cipher_algo(<span class="keyword">const</span> <span class="keyword">struct</span> l2fwd_crypto_options *options,</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structrte__cryptodev__info.html">rte_cryptodev_info</a> *dev_info,</div>
<div class="line">        uint8_t cdev_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__capabilities.html">rte_cryptodev_capabilities</a> *cap = &amp;dev_info-&gt;<a name="a98"></a><a class="code" href="structrte__cryptodev__info.html#a65b9cdbb3719f657c9d8e581ba2a904b">capabilities</a>[0];</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75e">rte_crypto_cipher_algorithm</a> cap_cipher_algo;</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75e">rte_crypto_cipher_algorithm</a> opt_cipher_algo =</div>
<div class="line">                    options-&gt;cipher_xform.cipher.algo;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (cap-&gt;<a name="a99"></a><a class="code" href="structrte__cryptodev__capabilities.html#a394c79d7e4c59bafe3bc7678dd69c03d">op</a> != <a name="a100"></a><a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739ad7a72984dd85b1c8b59cad6971b02248">RTE_CRYPTO_OP_TYPE_UNDEFINED</a>) {</div>
<div class="line">        cap_cipher_algo = cap-&gt;<a name="a101"></a><a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a name="a102"></a><a class="code" href="structrte__cryptodev__symmetric__capability.html#a05863077b6b0802857a85984a19857c8">cipher</a>.algo;</div>
<div class="line">        <span class="keywordflow">if</span> (cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a name="a103"></a><a class="code" href="structrte__cryptodev__symmetric__capability.html#afe276edbba98b3f82f0826d7feaeb82f">xform_type</a> == <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c">RTE_CRYPTO_SYM_XFORM_CIPHER</a>) {</div>
<div class="line">            <span class="keywordflow">if</span> (cap_cipher_algo == opt_cipher_algo) {</div>
<div class="line">                <span class="keywordflow">if</span> (check_type(options, dev_info) == 0)</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        cap = &amp;dev_info-&gt;<a class="code" href="structrte__cryptodev__info.html#a65b9cdbb3719f657c9d8e581ba2a904b">capabilities</a>[++i];</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a394c79d7e4c59bafe3bc7678dd69c03d">op</a> == <a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739ad7a72984dd85b1c8b59cad6971b02248">RTE_CRYPTO_OP_TYPE_UNDEFINED</a>) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Algorithm %s not supported by cryptodev %u&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot; or device not of preferred type (%s)\n&quot;</span>,</div>
<div class="line">            <a class="code" href="rte__crypto__sym_8h.html#ad0accb8ac900700f160f1dd12fa8b19b">rte_crypto_cipher_algorithm_strings</a>[opt_cipher_algo],</div>
<div class="line">            cdev_id,</div>
<div class="line">            options-&gt;string_type);</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> cap;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__capabilities.html">rte_cryptodev_capabilities</a> *</div>
<div class="line">check_device_support_auth_algo(<span class="keyword">const</span> <span class="keyword">struct</span> l2fwd_crypto_options *options,</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structrte__cryptodev__info.html">rte_cryptodev_info</a> *dev_info,</div>
<div class="line">        uint8_t cdev_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__capabilities.html">rte_cryptodev_capabilities</a> *cap = &amp;dev_info-&gt;<a class="code" href="structrte__cryptodev__info.html#a65b9cdbb3719f657c9d8e581ba2a904b">capabilities</a>[0];</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793">rte_crypto_auth_algorithm</a> cap_auth_algo;</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793">rte_crypto_auth_algorithm</a> opt_auth_algo =</div>
<div class="line">                    options-&gt;auth_xform.auth.algo;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a394c79d7e4c59bafe3bc7678dd69c03d">op</a> != <a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739ad7a72984dd85b1c8b59cad6971b02248">RTE_CRYPTO_OP_TYPE_UNDEFINED</a>) {</div>
<div class="line">        cap_auth_algo = cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a name="a104"></a><a class="code" href="structrte__cryptodev__symmetric__capability.html#a690a3258912ca541695442ea102c55d8">auth</a>.algo;</div>
<div class="line">        <span class="keywordflow">if</span> (cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#afe276edbba98b3f82f0826d7feaeb82f">xform_type</a> == <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9">RTE_CRYPTO_SYM_XFORM_AUTH</a>) {</div>
<div class="line">            <span class="keywordflow">if</span> (cap_auth_algo == opt_auth_algo) {</div>
<div class="line">                <span class="keywordflow">if</span> (check_type(options, dev_info) == 0)</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        cap = &amp;dev_info-&gt;<a class="code" href="structrte__cryptodev__info.html#a65b9cdbb3719f657c9d8e581ba2a904b">capabilities</a>[++i];</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a394c79d7e4c59bafe3bc7678dd69c03d">op</a> == <a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739ad7a72984dd85b1c8b59cad6971b02248">RTE_CRYPTO_OP_TYPE_UNDEFINED</a>) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Algorithm %s not supported by cryptodev %u&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot; or device not of preferred type (%s)\n&quot;</span>,</div>
<div class="line">            <a class="code" href="rte__crypto__sym_8h.html#a307c9b83491f12f87af8187715a01153">rte_crypto_auth_algorithm_strings</a>[opt_auth_algo],</div>
<div class="line">            cdev_id,</div>
<div class="line">            options-&gt;string_type);</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> cap;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__capabilities.html">rte_cryptodev_capabilities</a> *</div>
<div class="line">check_device_support_aead_algo(<span class="keyword">const</span> <span class="keyword">struct</span> l2fwd_crypto_options *options,</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structrte__cryptodev__info.html">rte_cryptodev_info</a> *dev_info,</div>
<div class="line">        uint8_t cdev_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__capabilities.html">rte_cryptodev_capabilities</a> *cap = &amp;dev_info-&gt;<a class="code" href="structrte__cryptodev__info.html#a65b9cdbb3719f657c9d8e581ba2a904b">capabilities</a>[0];</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="rte__crypto__sym_8h.html#a648bc317af3ee238310fac9d87512508">rte_crypto_aead_algorithm</a> cap_aead_algo;</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="rte__crypto__sym_8h.html#a648bc317af3ee238310fac9d87512508">rte_crypto_aead_algorithm</a> opt_aead_algo =</div>
<div class="line">                    options-&gt;aead_xform.aead.algo;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a394c79d7e4c59bafe3bc7678dd69c03d">op</a> != <a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739ad7a72984dd85b1c8b59cad6971b02248">RTE_CRYPTO_OP_TYPE_UNDEFINED</a>) {</div>
<div class="line">        cap_aead_algo = cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a name="a105"></a>aead.algo;</div>
<div class="line">        <span class="keywordflow">if</span> (cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#afe276edbba98b3f82f0826d7feaeb82f">xform_type</a> == <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a87d8d14b56f41d42ca643d33a279912a">RTE_CRYPTO_SYM_XFORM_AEAD</a>) {</div>
<div class="line">            <span class="keywordflow">if</span> (cap_aead_algo == opt_aead_algo) {</div>
<div class="line">                <span class="keywordflow">if</span> (check_type(options, dev_info) == 0)</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        cap = &amp;dev_info-&gt;<a class="code" href="structrte__cryptodev__info.html#a65b9cdbb3719f657c9d8e581ba2a904b">capabilities</a>[++i];</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a394c79d7e4c59bafe3bc7678dd69c03d">op</a> == <a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739ad7a72984dd85b1c8b59cad6971b02248">RTE_CRYPTO_OP_TYPE_UNDEFINED</a>) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Algorithm %s not supported by cryptodev %u&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot; or device not of preferred type (%s)\n&quot;</span>,</div>
<div class="line">            <a class="code" href="rte__crypto__sym_8h.html#a958771db424879b8de3ca82f5da0d399">rte_crypto_aead_algorithm_strings</a>[opt_aead_algo],</div>
<div class="line">            cdev_id,</div>
<div class="line">            options-&gt;string_type);</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> cap;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Check if the device is enabled by cryptodev_mask */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">check_cryptodev_mask(<span class="keyword">struct</span> l2fwd_crypto_options *options,</div>
<div class="line">        uint8_t cdev_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;cryptodev_mask &amp; (1 &lt;&lt; cdev_id))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span></div>
<div class="line">check_supported_size(uint16_t length, uint16_t min, uint16_t max,</div>
<div class="line">        uint16_t increment)</div>
<div class="line">{</div>
<div class="line">    uint16_t supp_size;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Single value */</span></div>
<div class="line">    <span class="keywordflow">if</span> (increment == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (length == min)</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Range of values */</span></div>
<div class="line">    <span class="keywordflow">for</span> (supp_size = min; supp_size &lt;= max; supp_size += increment) {</div>
<div class="line">        <span class="keywordflow">if</span> (length == supp_size)</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">check_iv_param(<span class="keyword">const</span> <span class="keyword">struct</span> <a name="_a106"></a><a class="code" href="structrte__crypto__param__range.html">rte_crypto_param_range</a> *iv_range_size,</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iv_param, <span class="keywordtype">int</span> iv_random_size,</div>
<div class="line">        uint16_t iv_length)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Check if length of provided IV is supported</span></div>
<div class="line"><span class="comment">     * by the algorithm chosen.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordflow">if</span> (iv_param) {</div>
<div class="line">        <span class="keywordflow">if</span> (check_supported_size(iv_length,</div>
<div class="line">                iv_range_size-&gt;<a name="a107"></a><a class="code" href="structrte__crypto__param__range.html#a1a1f4624f66ab0b2eb0b98316514c369">min</a>,</div>
<div class="line">                iv_range_size-&gt;<a name="a108"></a><a class="code" href="structrte__crypto__param__range.html#ac66b569507cc273bbf83ce5dd5f70e84">max</a>,</div>
<div class="line">                iv_range_size-&gt;<a name="a109"></a><a class="code" href="structrte__crypto__param__range.html#ade26a9703d9d6ea9c466d0e40aefca32">increment</a>)</div>
<div class="line">                    != 0)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Check if length of IV to be randomly generated</span></div>
<div class="line"><span class="comment">     * is supported by the algorithm chosen.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iv_random_size != -1) {</div>
<div class="line">        <span class="keywordflow">if</span> (check_supported_size(iv_random_size,</div>
<div class="line">                iv_range_size-&gt;<a class="code" href="structrte__crypto__param__range.html#a1a1f4624f66ab0b2eb0b98316514c369">min</a>,</div>
<div class="line">                iv_range_size-&gt;<a class="code" href="structrte__crypto__param__range.html#ac66b569507cc273bbf83ce5dd5f70e84">max</a>,</div>
<div class="line">                iv_range_size-&gt;<a class="code" href="structrte__crypto__param__range.html#ade26a9703d9d6ea9c466d0e40aefca32">increment</a>)</div>
<div class="line">                    != 0)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">check_capabilities(<span class="keyword">struct</span> l2fwd_crypto_options *options, uint8_t cdev_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__info.html">rte_cryptodev_info</a> dev_info;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__capabilities.html">rte_cryptodev_capabilities</a> *cap;</div>
<div class="line"> </div>
<div class="line">    <a name="a110"></a><a class="code" href="rte__cryptodev_8h.html#aeb677c03cea6fcc48a8caa533e3729f9">rte_cryptodev_info_get</a>(cdev_id, &amp;dev_info);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Set AEAD parameters */</span></div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;xform_chain == L2FWD_CRYPTO_AEAD) {</div>
<div class="line">        <span class="comment">/* Check if device supports AEAD algo */</span></div>
<div class="line">        cap = check_device_support_aead_algo(options, &amp;dev_info,</div>
<div class="line">                        cdev_id);</div>
<div class="line">        <span class="keywordflow">if</span> (cap == NULL)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (check_iv_param(&amp;cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.iv_size,</div>
<div class="line">                options-&gt;aead_iv_param,</div>
<div class="line">                options-&gt;aead_iv_random_size,</div>
<div class="line">                options-&gt;aead_iv.length) != 0) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(DEBUG, USER1,</div>
<div class="line">                <span class="stringliteral">&quot;Device %u does not support IV length\n&quot;</span>,</div>
<div class="line">                cdev_id);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Check if length of provided AEAD key is supported</span></div>
<div class="line"><span class="comment">         * by the algorithm chosen.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> (options-&gt;aead_key_param) {</div>
<div class="line">            <span class="keywordflow">if</span> (check_supported_size(</div>
<div class="line">                    options-&gt;aead_xform.aead.key.length,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.key_size.min,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.key_size.max,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.key_size.increment)</div>
<div class="line">                        != 0) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(DEBUG, USER1,</div>
<div class="line">                    <span class="stringliteral">&quot;Device %u does not support &quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;AEAD key length\n&quot;</span>,</div>
<div class="line">                    cdev_id);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Check if length of the aead key to be randomly generated</span></div>
<div class="line"><span class="comment">         * is supported by the algorithm chosen.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (options-&gt;aead_key_random_size != -1) {</div>
<div class="line">            <span class="keywordflow">if</span> (check_supported_size(options-&gt;aead_key_random_size,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.key_size.min,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.key_size.max,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.key_size.increment)</div>
<div class="line">                        != 0) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(DEBUG, USER1,</div>
<div class="line">                    <span class="stringliteral">&quot;Device %u does not support &quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;AEAD key length\n&quot;</span>,</div>
<div class="line">                    cdev_id);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Check if length of provided AAD is supported</span></div>
<div class="line"><span class="comment">         * by the algorithm chosen.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> (options-&gt;aad_param) {</div>
<div class="line">            <span class="keywordflow">if</span> (check_supported_size(options-&gt;aad.length,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.aad_size.min,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.aad_size.max,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.aad_size.increment)</div>
<div class="line">                        != 0) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(DEBUG, USER1,</div>
<div class="line">                    <span class="stringliteral">&quot;Device %u does not support &quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;AAD length\n&quot;</span>,</div>
<div class="line">                    cdev_id);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Check if length of AAD to be randomly generated</span></div>
<div class="line"><span class="comment">         * is supported by the algorithm chosen.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (options-&gt;aad_random_size != -1) {</div>
<div class="line">            <span class="keywordflow">if</span> (check_supported_size(options-&gt;aad_random_size,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.aad_size.min,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.aad_size.max,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.aad_size.increment)</div>
<div class="line">                        != 0) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(DEBUG, USER1,</div>
<div class="line">                    <span class="stringliteral">&quot;Device %u does not support &quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;AAD length\n&quot;</span>,</div>
<div class="line">                    cdev_id);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Check if digest size is supported by the algorithm. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (options-&gt;digest_size != -1) {</div>
<div class="line">            <span class="keywordflow">if</span> (check_supported_size(options-&gt;digest_size,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.digest_size.min,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.digest_size.max,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.digest_size.increment)</div>
<div class="line">                        != 0) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(DEBUG, USER1,</div>
<div class="line">                    <span class="stringliteral">&quot;Device %u does not support &quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;digest length\n&quot;</span>,</div>
<div class="line">                    cdev_id);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Set cipher parameters */</span></div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;xform_chain == L2FWD_CRYPTO_CIPHER_HASH ||</div>
<div class="line">            options-&gt;xform_chain == L2FWD_CRYPTO_HASH_CIPHER ||</div>
<div class="line">            options-&gt;xform_chain == L2FWD_CRYPTO_CIPHER_ONLY) {</div>
<div class="line">        <span class="comment">/* Check if device supports cipher algo */</span></div>
<div class="line">        cap = check_device_support_cipher_algo(options, &amp;dev_info,</div>
<div class="line">                        cdev_id);</div>
<div class="line">        <span class="keywordflow">if</span> (cap == NULL)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (check_iv_param(&amp;cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a05863077b6b0802857a85984a19857c8">cipher</a>.iv_size,</div>
<div class="line">                options-&gt;cipher_iv_param,</div>
<div class="line">                options-&gt;cipher_iv_random_size,</div>
<div class="line">                options-&gt;cipher_iv.length) != 0) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(DEBUG, USER1,</div>
<div class="line">                <span class="stringliteral">&quot;Device %u does not support IV length\n&quot;</span>,</div>
<div class="line">                cdev_id);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Check if length of provided cipher key is supported</span></div>
<div class="line"><span class="comment">         * by the algorithm chosen.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> (options-&gt;ckey_param) {</div>
<div class="line">            <span class="keywordflow">if</span> (check_supported_size(</div>
<div class="line">                    options-&gt;cipher_xform.cipher.key.length,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a05863077b6b0802857a85984a19857c8">cipher</a>.key_size.min,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a05863077b6b0802857a85984a19857c8">cipher</a>.key_size.max,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a05863077b6b0802857a85984a19857c8">cipher</a>.key_size.increment)</div>
<div class="line">                        != 0) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(DEBUG, USER1,</div>
<div class="line">                    <span class="stringliteral">&quot;Device %u does not support cipher &quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;key length\n&quot;</span>,</div>
<div class="line">                    cdev_id);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Check if length of the cipher key to be randomly generated</span></div>
<div class="line"><span class="comment">         * is supported by the algorithm chosen.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (options-&gt;ckey_random_size != -1) {</div>
<div class="line">            <span class="keywordflow">if</span> (check_supported_size(options-&gt;ckey_random_size,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a05863077b6b0802857a85984a19857c8">cipher</a>.key_size.min,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a05863077b6b0802857a85984a19857c8">cipher</a>.key_size.max,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a05863077b6b0802857a85984a19857c8">cipher</a>.key_size.increment)</div>
<div class="line">                        != 0) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(DEBUG, USER1,</div>
<div class="line">                    <span class="stringliteral">&quot;Device %u does not support cipher &quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;key length\n&quot;</span>,</div>
<div class="line">                    cdev_id);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Set auth parameters */</span></div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;xform_chain == L2FWD_CRYPTO_CIPHER_HASH ||</div>
<div class="line">            options-&gt;xform_chain == L2FWD_CRYPTO_HASH_CIPHER ||</div>
<div class="line">            options-&gt;xform_chain == L2FWD_CRYPTO_HASH_ONLY) {</div>
<div class="line">        <span class="comment">/* Check if device supports auth algo */</span></div>
<div class="line">        cap = check_device_support_auth_algo(options, &amp;dev_info,</div>
<div class="line">                        cdev_id);</div>
<div class="line">        <span class="keywordflow">if</span> (cap == NULL)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (check_iv_param(&amp;cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a690a3258912ca541695442ea102c55d8">auth</a>.iv_size,</div>
<div class="line">                options-&gt;auth_iv_param,</div>
<div class="line">                options-&gt;auth_iv_random_size,</div>
<div class="line">                options-&gt;auth_iv.length) != 0) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(DEBUG, USER1,</div>
<div class="line">                <span class="stringliteral">&quot;Device %u does not support IV length\n&quot;</span>,</div>
<div class="line">                cdev_id);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Check if length of provided auth key is supported</span></div>
<div class="line"><span class="comment">         * by the algorithm chosen.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> (options-&gt;akey_param) {</div>
<div class="line">            <span class="keywordflow">if</span> (check_supported_size(</div>
<div class="line">                    options-&gt;auth_xform.auth.key.length,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a690a3258912ca541695442ea102c55d8">auth</a>.key_size.min,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a690a3258912ca541695442ea102c55d8">auth</a>.key_size.max,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a690a3258912ca541695442ea102c55d8">auth</a>.key_size.increment)</div>
<div class="line">                        != 0) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(DEBUG, USER1,</div>
<div class="line">                    <span class="stringliteral">&quot;Device %u does not support auth &quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;key length\n&quot;</span>,</div>
<div class="line">                    cdev_id);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Check if length of the auth key to be randomly generated</span></div>
<div class="line"><span class="comment">         * is supported by the algorithm chosen.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (options-&gt;akey_random_size != -1) {</div>
<div class="line">            <span class="keywordflow">if</span> (check_supported_size(options-&gt;akey_random_size,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a690a3258912ca541695442ea102c55d8">auth</a>.key_size.min,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a690a3258912ca541695442ea102c55d8">auth</a>.key_size.max,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a690a3258912ca541695442ea102c55d8">auth</a>.key_size.increment)</div>
<div class="line">                        != 0) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(DEBUG, USER1,</div>
<div class="line">                    <span class="stringliteral">&quot;Device %u does not support auth &quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;key length\n&quot;</span>,</div>
<div class="line">                    cdev_id);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Check if digest size is supported by the algorithm. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (options-&gt;digest_size != -1) {</div>
<div class="line">            <span class="keywordflow">if</span> (check_supported_size(options-&gt;digest_size,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a690a3258912ca541695442ea102c55d8">auth</a>.digest_size.min,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a690a3258912ca541695442ea102c55d8">auth</a>.digest_size.max,</div>
<div class="line">                    cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a690a3258912ca541695442ea102c55d8">auth</a>.digest_size.increment)</div>
<div class="line">                        != 0) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(DEBUG, USER1,</div>
<div class="line">                    <span class="stringliteral">&quot;Device %u does not support &quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;digest length\n&quot;</span>,</div>
<div class="line">                    cdev_id);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">initialize_cryptodevs(<span class="keyword">struct</span> l2fwd_crypto_options *options, <span class="keywordtype">unsigned</span> nb_ports,</div>
<div class="line">        uint8_t *enabled_cdevs)</div>
<div class="line">{</div>
<div class="line">    uint8_t cdev_id, cdev_count, enabled_cdev_count = 0;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__capabilities.html">rte_cryptodev_capabilities</a> *cap;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sess_sz, max_sess_sz = 0;</div>
<div class="line">    uint32_t sessions_needed = 0;</div>
<div class="line">    <span class="keywordtype">int</span> retval;</div>
<div class="line"> </div>
<div class="line">    cdev_count = <a name="a111"></a><a class="code" href="rte__cryptodev_8h.html#a1a0c23adc25339b56bd19242194a002f">rte_cryptodev_count</a>();</div>
<div class="line">    <span class="keywordflow">if</span> (cdev_count == 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;No crypto devices available\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (cdev_id = 0; cdev_id &lt; cdev_count &amp;&amp; enabled_cdev_count &lt; nb_ports;</div>
<div class="line">            cdev_id++) {</div>
<div class="line">        <span class="keywordflow">if</span> (check_cryptodev_mask(options, cdev_id) &lt; 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (check_capabilities(options, cdev_id) &lt; 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        sess_sz = <a name="a112"></a><a class="code" href="rte__cryptodev_8h.html#a34a54ae38920d21d95aa6049640e8c0e">rte_cryptodev_sym_get_private_session_size</a>(cdev_id);</div>
<div class="line">        <span class="keywordflow">if</span> (sess_sz &gt; max_sess_sz)</div>
<div class="line">            max_sess_sz = sess_sz;</div>
<div class="line"> </div>
<div class="line">        l2fwd_enabled_crypto_mask |= (((uint64_t)1) &lt;&lt; cdev_id);</div>
<div class="line"> </div>
<div class="line">        enabled_cdevs[cdev_id] = 1;</div>
<div class="line">        enabled_cdev_count++;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (cdev_id = 0; cdev_id &lt; cdev_count; cdev_id++) {</div>
<div class="line">        <span class="keyword">struct </span><a name="_a113"></a><a class="code" href="structrte__cryptodev__qp__conf.html">rte_cryptodev_qp_conf</a> qp_conf;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__info.html">rte_cryptodev_info</a> dev_info;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (enabled_cdevs[cdev_id] == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        retval = rte_cryptodev_socket_id(cdev_id);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (retval &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Invalid crypto device id used\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        uint8_t socket_id = (uint8_t) retval;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">struct </span><a name="_a114"></a><a class="code" href="structrte__cryptodev__config.html">rte_cryptodev_config</a> conf = {</div>
<div class="line">            .<a name="a115"></a><a class="code" href="structrte__cryptodev__config.html#ab6b5a902514f586f964c368ef5993cd7">nb_queue_pairs</a> = 1,</div>
<div class="line">            .socket_id = <a name="a116"></a><a class="code" href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>,</div>
<div class="line">            .ff_disable = <a name="a117"></a><a class="code" href="rte__cryptodev_8h.html#a1ffaab4a2885220015c21d9bc6f05808">RTE_CRYPTODEV_FF_SECURITY</a>,</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="rte__cryptodev_8h.html#aeb677c03cea6fcc48a8caa533e3729f9">rte_cryptodev_info_get</a>(cdev_id, &amp;dev_info);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Two sessions objects are required for each session</span></div>
<div class="line"><span class="comment">         * (one for the header, one for the private data)</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!strcmp(dev_info.<a name="a118"></a><a class="code" href="structrte__cryptodev__info.html#ab3fdbf22ceb27dc84c580c6478e1175b">driver_name</a>, <span class="stringliteral">&quot;crypto_scheduler&quot;</span>)) {</div>
<div class="line"><span class="preprocessor">#ifdef RTE_CRYPTO_SCHEDULER</span></div>
<div class="line">            uint32_t nb_workers =</div>
<div class="line">                <a name="a119"></a><a class="code" href="rte__cryptodev__scheduler_8h.html#ac208d2560137811abb2c31a3fb625f28">rte_cryptodev_scheduler_workers_get</a>(cdev_id,</div>
<div class="line">                                NULL);</div>
<div class="line"> </div>
<div class="line">            sessions_needed = enabled_cdev_count * nb_workers;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line">            sessions_needed = enabled_cdev_count;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (session_pool_socket[<a class="code" href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>].priv_mp == NULL) {</div>
<div class="line">            <span class="keywordtype">char</span> mp_name[RTE_MEMPOOL_NAMESIZE];</div>
<div class="line"> </div>
<div class="line">            snprintf(mp_name, RTE_MEMPOOL_NAMESIZE,</div>
<div class="line">                <span class="stringliteral">&quot;priv_sess_mp_%u&quot;</span>, <a class="code" href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line"> </div>
<div class="line">            session_pool_socket[<a class="code" href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>].priv_mp =</div>
<div class="line">                    <a name="a120"></a><a class="code" href="rte__mempool_8h.html#a503f2f889043a48ca9995878846db2fd">rte_mempool_create</a>(mp_name,</div>
<div class="line">                        sessions_needed,</div>
<div class="line">                        max_sess_sz,</div>
<div class="line">                        0, 0, NULL, NULL, NULL,</div>
<div class="line">                        NULL, <a class="code" href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>,</div>
<div class="line">                        0);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (session_pool_socket[<a class="code" href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>].priv_mp == NULL) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Cannot create pool on socket %d\n&quot;</span>,</div>
<div class="line">                    <a class="code" href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line">                <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            printf(<span class="stringliteral">&quot;Allocated pool \&quot;%s\&quot; on socket %d\n&quot;</span>,</div>
<div class="line">                mp_name, <a class="code" href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (session_pool_socket[<a class="code" href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>].sess_mp == NULL) {</div>
<div class="line">            <span class="keywordtype">char</span> mp_name[RTE_MEMPOOL_NAMESIZE];</div>
<div class="line">            snprintf(mp_name, RTE_MEMPOOL_NAMESIZE,</div>
<div class="line">                <span class="stringliteral">&quot;sess_mp_%u&quot;</span>, <a class="code" href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line"> </div>
<div class="line">            session_pool_socket[<a class="code" href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>].sess_mp =</div>
<div class="line">                    <a name="a121"></a><a class="code" href="rte__cryptodev_8h.html#ac86bc0178d39db9734c594c35f9aee4e">rte_cryptodev_sym_session_pool_create</a>(</div>
<div class="line">                            mp_name,</div>
<div class="line">                            sessions_needed,</div>
<div class="line">                            0, 0, 0, <a class="code" href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (session_pool_socket[<a class="code" href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>].sess_mp == NULL) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Cannot create pool on socket %d\n&quot;</span>,</div>
<div class="line">                    <a class="code" href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line">                <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            printf(<span class="stringliteral">&quot;Allocated pool \&quot;%s\&quot; on socket %d\n&quot;</span>,</div>
<div class="line">                mp_name, <a class="code" href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Set AEAD parameters */</span></div>
<div class="line">        <span class="keywordflow">if</span> (options-&gt;xform_chain == L2FWD_CRYPTO_AEAD) {</div>
<div class="line">            cap = check_device_support_aead_algo(options, &amp;dev_info,</div>
<div class="line">                            cdev_id);</div>
<div class="line"> </div>
<div class="line">            options-&gt;block_size = cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.block_size;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Set IV if not provided from command line */</span></div>
<div class="line">            <span class="keywordflow">if</span> (options-&gt;aead_iv_param == 0) {</div>
<div class="line">                <span class="keywordflow">if</span> (options-&gt;aead_iv_random_size != -1)</div>
<div class="line">                    options-&gt;aead_iv.length =</div>
<div class="line">                        options-&gt;aead_iv_random_size;</div>
<div class="line">                <span class="comment">/* No size provided, use minimum size. */</span></div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    options-&gt;aead_iv.length =</div>
<div class="line">                        cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.iv_size.min;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Set key if not provided from command line */</span></div>
<div class="line">            <span class="keywordflow">if</span> (options-&gt;aead_key_param == 0) {</div>
<div class="line">                <span class="keywordflow">if</span> (options-&gt;aead_key_random_size != -1)</div>
<div class="line">                    options-&gt;aead_xform.aead.key.length =</div>
<div class="line">                        options-&gt;aead_key_random_size;</div>
<div class="line">                <span class="comment">/* No size provided, use minimum size. */</span></div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    options-&gt;aead_xform.aead.key.length =</div>
<div class="line">                        cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.key_size.min;</div>
<div class="line"> </div>
<div class="line">                generate_random_key(options-&gt;aead_key,</div>
<div class="line">                    options-&gt;aead_xform.aead.key.length);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Set AAD if not provided from command line */</span></div>
<div class="line">            <span class="keywordflow">if</span> (options-&gt;aad_param == 0) {</div>
<div class="line">                <span class="keywordflow">if</span> (options-&gt;aad_random_size != -1)</div>
<div class="line">                    options-&gt;aad.length =</div>
<div class="line">                        options-&gt;aad_random_size;</div>
<div class="line">                <span class="comment">/* No size provided, use minimum size. */</span></div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    options-&gt;aad.length =</div>
<div class="line">                        cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a690a3258912ca541695442ea102c55d8">auth</a>.aad_size.min;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            options-&gt;aead_xform.aead.aad_length =</div>
<div class="line">                        options-&gt;aad.length;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Set digest size if not provided from command line */</span></div>
<div class="line">            <span class="keywordflow">if</span> (options-&gt;digest_size != -1)</div>
<div class="line">                options-&gt;aead_xform.aead.digest_length =</div>
<div class="line">                            options-&gt;digest_size;</div>
<div class="line">                <span class="comment">/* No size provided, use minimum size. */</span></div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                options-&gt;aead_xform.aead.digest_length =</div>
<div class="line">                        cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.aead.digest_size.min;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Set cipher parameters */</span></div>
<div class="line">        <span class="keywordflow">if</span> (options-&gt;xform_chain == L2FWD_CRYPTO_CIPHER_HASH ||</div>
<div class="line">                options-&gt;xform_chain == L2FWD_CRYPTO_HASH_CIPHER ||</div>
<div class="line">                options-&gt;xform_chain == L2FWD_CRYPTO_CIPHER_ONLY) {</div>
<div class="line">            cap = check_device_support_cipher_algo(options, &amp;dev_info,</div>
<div class="line">                            cdev_id);</div>
<div class="line">            options-&gt;block_size = cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a05863077b6b0802857a85984a19857c8">cipher</a>.block_size;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Set IV if not provided from command line */</span></div>
<div class="line">            <span class="keywordflow">if</span> (options-&gt;cipher_iv_param == 0) {</div>
<div class="line">                <span class="keywordflow">if</span> (options-&gt;cipher_iv_random_size != -1)</div>
<div class="line">                    options-&gt;cipher_iv.length =</div>
<div class="line">                        options-&gt;cipher_iv_random_size;</div>
<div class="line">                <span class="comment">/* No size provided, use minimum size. */</span></div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    options-&gt;cipher_iv.length =</div>
<div class="line">                        cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a05863077b6b0802857a85984a19857c8">cipher</a>.iv_size.min;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Set key if not provided from command line */</span></div>
<div class="line">            <span class="keywordflow">if</span> (options-&gt;ckey_param == 0) {</div>
<div class="line">                <span class="keywordflow">if</span> (options-&gt;ckey_random_size != -1)</div>
<div class="line">                    options-&gt;cipher_xform.cipher.key.length =</div>
<div class="line">                        options-&gt;ckey_random_size;</div>
<div class="line">                <span class="comment">/* No size provided, use minimum size. */</span></div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    options-&gt;cipher_xform.cipher.key.length =</div>
<div class="line">                        cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a05863077b6b0802857a85984a19857c8">cipher</a>.key_size.min;</div>
<div class="line"> </div>
<div class="line">                generate_random_key(options-&gt;cipher_key,</div>
<div class="line">                    options-&gt;cipher_xform.cipher.key.length);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Set auth parameters */</span></div>
<div class="line">        <span class="keywordflow">if</span> (options-&gt;xform_chain == L2FWD_CRYPTO_CIPHER_HASH ||</div>
<div class="line">                options-&gt;xform_chain == L2FWD_CRYPTO_HASH_CIPHER ||</div>
<div class="line">                options-&gt;xform_chain == L2FWD_CRYPTO_HASH_ONLY) {</div>
<div class="line">            cap = check_device_support_auth_algo(options, &amp;dev_info,</div>
<div class="line">                            cdev_id);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Set IV if not provided from command line */</span></div>
<div class="line">            <span class="keywordflow">if</span> (options-&gt;auth_iv_param == 0) {</div>
<div class="line">                <span class="keywordflow">if</span> (options-&gt;auth_iv_random_size != -1)</div>
<div class="line">                    options-&gt;auth_iv.length =</div>
<div class="line">                        options-&gt;auth_iv_random_size;</div>
<div class="line">                <span class="comment">/* No size provided, use minimum size. */</span></div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    options-&gt;auth_iv.length =</div>
<div class="line">                        cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a690a3258912ca541695442ea102c55d8">auth</a>.iv_size.min;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Set key if not provided from command line */</span></div>
<div class="line">            <span class="keywordflow">if</span> (options-&gt;akey_param == 0) {</div>
<div class="line">                <span class="keywordflow">if</span> (options-&gt;akey_random_size != -1)</div>
<div class="line">                    options-&gt;auth_xform.auth.key.length =</div>
<div class="line">                        options-&gt;akey_random_size;</div>
<div class="line">                <span class="comment">/* No size provided, use minimum size. */</span></div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    options-&gt;auth_xform.auth.key.length =</div>
<div class="line">                        cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a690a3258912ca541695442ea102c55d8">auth</a>.key_size.min;</div>
<div class="line"> </div>
<div class="line">                generate_random_key(options-&gt;auth_key,</div>
<div class="line">                    options-&gt;auth_xform.auth.key.length);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Set digest size if not provided from command line */</span></div>
<div class="line">            <span class="keywordflow">if</span> (options-&gt;digest_size != -1)</div>
<div class="line">                options-&gt;auth_xform.auth.digest_length =</div>
<div class="line">                            options-&gt;digest_size;</div>
<div class="line">                <span class="comment">/* No size provided, use minimum size. */</span></div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                options-&gt;auth_xform.auth.digest_length =</div>
<div class="line">                        cap-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#a690a3258912ca541695442ea102c55d8">auth</a>.digest_size.min;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        retval = <a name="a122"></a><a class="code" href="rte__cryptodev_8h.html#a58207367533ac9e65e4a611ba78090e5">rte_cryptodev_configure</a>(cdev_id, &amp;conf);</div>
<div class="line">        <span class="keywordflow">if</span> (retval &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Failed to configure cryptodev %u&quot;</span>, cdev_id);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        qp_conf.nb_descriptors = 2048;</div>
<div class="line">        qp_conf.mp_session = session_pool_socket[<a class="code" href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>].sess_mp;</div>
<div class="line">        qp_conf.mp_session_private =</div>
<div class="line">                session_pool_socket[<a class="code" href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>].priv_mp;</div>
<div class="line"> </div>
<div class="line">        retval = <a name="a123"></a><a class="code" href="rte__cryptodev_8h.html#ae4388e0326c8789ddf39e32044dc4187">rte_cryptodev_queue_pair_setup</a>(cdev_id, 0, &amp;qp_conf,</div>
<div class="line">                <a class="code" href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (retval &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Failed to setup queue pair %u on cryptodev %u&quot;</span>,</div>
<div class="line">                    0, cdev_id);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        retval = <a name="a124"></a><a class="code" href="rte__cryptodev_8h.html#a1fa401bd6c01129823669ac68deaa993">rte_cryptodev_start</a>(cdev_id);</div>
<div class="line">        <span class="keywordflow">if</span> (retval &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Failed to start device %u: error %d\n&quot;</span>,</div>
<div class="line">                    cdev_id, retval);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> enabled_cdev_count;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">initialize_ports(<span class="keyword">struct</span> l2fwd_crypto_options *options)</div>
<div class="line">{</div>
<div class="line">    uint16_t last_portid = 0, portid;</div>
<div class="line">    <span class="keywordtype">unsigned</span> enabled_portcount = 0;</div>
<div class="line">    <span class="keywordtype">unsigned</span> nb_ports = <a name="a125"></a><a class="code" href="rte__ethdev_8h.html#a9ab708089665bebcd65cefe5383b24f2">rte_eth_dev_count_avail</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (nb_ports == 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;No Ethernet ports - bye\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Reset l2fwd_dst_ports */</span></div>
<div class="line">    <span class="keywordflow">for</span> (portid = 0; portid &lt; RTE_MAX_ETHPORTS; portid++)</div>
<div class="line">        l2fwd_dst_ports[portid] = 0;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__ethdev_8h.html#ad7b46c67203d37fe3a34f11076d970d6">RTE_ETH_FOREACH_DEV</a>(portid) {</div>
<div class="line">        <span class="keywordtype">int</span> retval;</div>
<div class="line">        <span class="keyword">struct </span><a name="_a126"></a><a class="code" href="structrte__eth__dev__info.html">rte_eth_dev_info</a> dev_info;</div>
<div class="line">        <span class="keyword">struct </span><a name="_a127"></a><a class="code" href="structrte__eth__rxconf.html">rte_eth_rxconf</a> rxq_conf;</div>
<div class="line">        <span class="keyword">struct </span><a name="_a128"></a><a class="code" href="structrte__eth__txconf.html">rte_eth_txconf</a> txq_conf;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structrte__eth__conf.html">rte_eth_conf</a> local_port_conf = port_conf;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Skip ports that are not enabled */</span></div>
<div class="line">        <span class="keywordflow">if</span> ((options-&gt;portmask &amp; (1 &lt;&lt; portid)) == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* init port */</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Initializing port %u... &quot;</span>, portid);</div>
<div class="line">        fflush(stdout);</div>
<div class="line"> </div>
<div class="line">        retval = <a name="a129"></a><a class="code" href="rte__ethdev_8h.html#a7593f4fff04f4ae1b1d718db7ca7dc8c">rte_eth_dev_info_get</a>(portid, &amp;dev_info);</div>
<div class="line">        <span class="keywordflow">if</span> (retval != 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Error during getting device (port %u) info: %s\n&quot;</span>,</div>
<div class="line">                    portid, strerror(-retval));</div>
<div class="line">            <span class="keywordflow">return</span> retval;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (dev_info.tx_offload_capa &amp; <a name="a130"></a><a class="code" href="rte__ethdev_8h.html#ae7110b5d5dced8f42505bff5d9e3f0ea">DEV_TX_OFFLOAD_MBUF_FAST_FREE</a>)</div>
<div class="line">            local_port_conf.<a name="a131"></a><a class="code" href="structrte__eth__conf.html#a1c33c9d2e5cdb14b62ed386bf3159e07">txmode</a>.<a name="a132"></a><a class="code" href="structrte__eth__txmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a> |=</div>
<div class="line">                <a class="code" href="rte__ethdev_8h.html#ae7110b5d5dced8f42505bff5d9e3f0ea">DEV_TX_OFFLOAD_MBUF_FAST_FREE</a>;</div>
<div class="line">        retval = <a name="a133"></a><a class="code" href="rte__ethdev_8h.html#a1a7d3a20b102fee222541fda50fd87bd">rte_eth_dev_configure</a>(portid, 1, 1, &amp;local_port_conf);</div>
<div class="line">        <span class="keywordflow">if</span> (retval &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Cannot configure device: err=%d, port=%u\n&quot;</span>,</div>
<div class="line">                  retval, portid);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        retval = <a name="a134"></a><a class="code" href="rte__ethdev_8h.html#ad31219b87a1733d5b367a7c04c7f7b48">rte_eth_dev_adjust_nb_rx_tx_desc</a>(portid, &amp;nb_rxd,</div>
<div class="line">                              &amp;nb_txd);</div>
<div class="line">        <span class="keywordflow">if</span> (retval &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Cannot adjust number of descriptors: err=%d, port=%u\n&quot;</span>,</div>
<div class="line">                retval, portid);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* init one RX queue */</span></div>
<div class="line">        fflush(stdout);</div>
<div class="line">        rxq_conf = dev_info.default_rxconf;</div>
<div class="line">        rxq_conf.offloads = local_port_conf.<a class="code" href="structrte__eth__conf.html#a346eef99c24f617b74c440c1aa565d01">rxmode</a>.<a name="a135"></a><a class="code" href="structrte__eth__rxmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a>;</div>
<div class="line">        retval = <a name="a136"></a><a class="code" href="rte__ethdev_8h.html#a36ba70a5a6fce2c2c1f774828ba78f8d">rte_eth_rx_queue_setup</a>(portid, 0, nb_rxd,</div>
<div class="line">                         <a name="a137"></a><a class="code" href="rte__ethdev_8h.html#ad032e25f712e6ffeb0c19eab1ec1fd2e">rte_eth_dev_socket_id</a>(portid),</div>
<div class="line">                         &amp;rxq_conf, l2fwd_pktmbuf_pool);</div>
<div class="line">        <span class="keywordflow">if</span> (retval &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;rte_eth_rx_queue_setup:err=%d, port=%u\n&quot;</span>,</div>
<div class="line">                    retval, portid);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* init one TX queue on each port */</span></div>
<div class="line">        fflush(stdout);</div>
<div class="line">        txq_conf = dev_info.default_txconf;</div>
<div class="line">        txq_conf.offloads = local_port_conf.<a class="code" href="structrte__eth__conf.html#a1c33c9d2e5cdb14b62ed386bf3159e07">txmode</a>.<a class="code" href="structrte__eth__txmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a>;</div>
<div class="line">        retval = <a name="a138"></a><a class="code" href="rte__ethdev_8h.html#a796c2f20778984c6f41b271e36bae50e">rte_eth_tx_queue_setup</a>(portid, 0, nb_txd,</div>
<div class="line">                <a class="code" href="rte__ethdev_8h.html#ad032e25f712e6ffeb0c19eab1ec1fd2e">rte_eth_dev_socket_id</a>(portid),</div>
<div class="line">                &amp;txq_conf);</div>
<div class="line">        <span class="keywordflow">if</span> (retval &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;rte_eth_tx_queue_setup:err=%d, port=%u\n&quot;</span>,</div>
<div class="line">                retval, portid);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Start device */</span></div>
<div class="line">        retval = <a name="a139"></a><a class="code" href="rte__ethdev_8h.html#afdc834c1c52e9fb512301990468ca7c2">rte_eth_dev_start</a>(portid);</div>
<div class="line">        <span class="keywordflow">if</span> (retval &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;rte_eth_dev_start:err=%d, port=%u\n&quot;</span>,</div>
<div class="line">                    retval, portid);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        retval = <a name="a140"></a><a class="code" href="rte__ethdev_8h.html#a5dd1dedaa45f05c72bcc35495e441e91">rte_eth_promiscuous_enable</a>(portid);</div>
<div class="line">        <span class="keywordflow">if</span> (retval != 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;rte_eth_promiscuous_enable:err=%s, port=%u\n&quot;</span>,</div>
<div class="line">                <a class="code" href="rte__errno_8h.html#a129a7eb4cfa1f5bdac5783bf49137d06">rte_strerror</a>(-retval), portid);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        retval = <a name="a141"></a><a class="code" href="rte__ethdev_8h.html#a8a28375b279ded9125c99a46bf3956ef">rte_eth_macaddr_get</a>(portid,</div>
<div class="line">                         &amp;l2fwd_ports_eth_addr[portid]);</div>
<div class="line">        <span class="keywordflow">if</span> (retval &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;rte_eth_macaddr_get :err=%d, port=%u\n&quot;</span>,</div>
<div class="line">                    retval, portid);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %u, MAC address: %02X:%02X:%02X:%02X:%02X:%02X\n\n&quot;</span>,</div>
<div class="line">                portid,</div>
<div class="line">                l2fwd_ports_eth_addr[portid].<a name="a142"></a><a class="code" href="rte__ether_8h.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[0],</div>
<div class="line">                l2fwd_ports_eth_addr[portid].<a class="code" href="rte__ether_8h.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[1],</div>
<div class="line">                l2fwd_ports_eth_addr[portid].<a class="code" href="rte__ether_8h.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[2],</div>
<div class="line">                l2fwd_ports_eth_addr[portid].<a class="code" href="rte__ether_8h.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[3],</div>
<div class="line">                l2fwd_ports_eth_addr[portid].<a class="code" href="rte__ether_8h.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[4],</div>
<div class="line">                l2fwd_ports_eth_addr[portid].<a class="code" href="rte__ether_8h.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[5]);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* initialize port stats */</span></div>
<div class="line">        memset(&amp;port_statistics, 0, <span class="keyword">sizeof</span>(port_statistics));</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Setup port forwarding table */</span></div>
<div class="line">        <span class="keywordflow">if</span> (enabled_portcount % 2) {</div>
<div class="line">            l2fwd_dst_ports[portid] = last_portid;</div>
<div class="line">            l2fwd_dst_ports[last_portid] = portid;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            last_portid = portid;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        l2fwd_enabled_port_mask |= (1 &lt;&lt; portid);</div>
<div class="line">        enabled_portcount++;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (enabled_portcount == 1) {</div>
<div class="line">        l2fwd_dst_ports[last_portid] = last_portid;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (enabled_portcount % 2) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;odd number of ports in portmask- bye\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    check_all_ports_link_status(l2fwd_enabled_port_mask);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> enabled_portcount;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">reserve_key_memory(<span class="keyword">struct</span> l2fwd_crypto_options *options)</div>
<div class="line">{</div>
<div class="line">    options-&gt;cipher_xform.cipher.key.data = options-&gt;cipher_key;</div>
<div class="line"> </div>
<div class="line">    options-&gt;auth_xform.auth.key.data = options-&gt;auth_key;</div>
<div class="line"> </div>
<div class="line">    options-&gt;aead_xform.aead.key.data = options-&gt;aead_key;</div>
<div class="line"> </div>
<div class="line">    options-&gt;cipher_iv.data = <a name="a143"></a><a class="code" href="rte__malloc_8h.html#a247c99e8d36300c52729c9ee58c2b489">rte_malloc</a>(<span class="stringliteral">&quot;cipher iv&quot;</span>, MAX_KEY_SIZE, 0);</div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;cipher_iv.data == NULL)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Failed to allocate memory for cipher IV&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    options-&gt;auth_iv.data = <a class="code" href="rte__malloc_8h.html#a247c99e8d36300c52729c9ee58c2b489">rte_malloc</a>(<span class="stringliteral">&quot;auth iv&quot;</span>, MAX_KEY_SIZE, 0);</div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;auth_iv.data == NULL)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Failed to allocate memory for auth IV&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    options-&gt;aead_iv.data = <a class="code" href="rte__malloc_8h.html#a247c99e8d36300c52729c9ee58c2b489">rte_malloc</a>(<span class="stringliteral">&quot;aead_iv&quot;</span>, MAX_KEY_SIZE, 0);</div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;aead_iv.data == NULL)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Failed to allocate memory for AEAD iv&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    options-&gt;aad.data = <a class="code" href="rte__malloc_8h.html#a247c99e8d36300c52729c9ee58c2b489">rte_malloc</a>(<span class="stringliteral">&quot;aad&quot;</span>, MAX_KEY_SIZE, 0);</div>
<div class="line">    <span class="keywordflow">if</span> (options-&gt;aad.data == NULL)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Failed to allocate memory for AAD&quot;</span>);</div>
<div class="line">    options-&gt;aad.phys_addr = <a name="a144"></a><a class="code" href="rte__malloc_8h.html#a9fa8949fa521967981829b2afe40702b">rte_malloc_virt2iova</a>(options-&gt;aad.data);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>lcore_queue_conf *qconf = NULL;</div>
<div class="line">    <span class="keyword">struct </span>l2fwd_crypto_options options;</div>
<div class="line"> </div>
<div class="line">    uint8_t nb_cryptodevs, cdev_id;</div>
<div class="line">    uint16_t portid;</div>
<div class="line">    <span class="keywordtype">unsigned</span> lcore_id, rx_lcore_id = 0;</div>
<div class="line">    <span class="keywordtype">int</span> ret, enabled_cdevcount, enabled_portcount;</div>
<div class="line">    uint8_t enabled_cdevs[RTE_CRYPTO_MAX_DEVS] = {0};</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* init EAL */</span></div>
<div class="line">    ret = <a name="a145"></a><a class="code" href="rte__eal_8h.html#a5c3f4dddc25e38c5a186ecd8a69260e3">rte_eal_init</a>(argc, argv);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Invalid EAL arguments\n&quot;</span>);</div>
<div class="line">    argc -= ret;</div>
<div class="line">    argv += ret;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* reserve memory for Cipher/Auth key and IV */</span></div>
<div class="line">    reserve_key_memory(&amp;options);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* parse application arguments (after the EAL ones) */</span></div>
<div class="line">    ret = l2fwd_crypto_parse_args(&amp;options, argc, argv);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Invalid L2FWD-CRYPTO arguments\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;MAC updating %s\n&quot;</span>,</div>
<div class="line">            options.mac_updating ? <span class="stringliteral">&quot;enabled&quot;</span> : <span class="stringliteral">&quot;disabled&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* create the mbuf pool */</span></div>
<div class="line">    l2fwd_pktmbuf_pool = <a name="a146"></a><a class="code" href="rte__mbuf_8h.html#a593921f13307803b94bbb4e0932db962">rte_pktmbuf_pool_create</a>(<span class="stringliteral">&quot;mbuf_pool&quot;</span>, NB_MBUF, 512,</div>
<div class="line">            <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrte__crypto__op.html">rte_crypto_op</a>),</div>
<div class="line">            RTE_MBUF_DEFAULT_BUF_SIZE, <a name="a147"></a><a class="code" href="rte__lcore_8h.html#a7c8da4664df26a64cf05dc508a4f26df">rte_socket_id</a>());</div>
<div class="line">    <span class="keywordflow">if</span> (l2fwd_pktmbuf_pool == NULL)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Cannot create mbuf pool\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* create crypto op pool */</span></div>
<div class="line">    l2fwd_crypto_op_pool = <a name="a148"></a><a class="code" href="rte__crypto_8h.html#aa3035c7b271a4736dc9654b2eb85d1fd">rte_crypto_op_pool_create</a>(<span class="stringliteral">&quot;crypto_op_pool&quot;</span>,</div>
<div class="line">            <a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc">RTE_CRYPTO_OP_TYPE_SYMMETRIC</a>, NB_MBUF, 128, MAXIMUM_IV_LENGTH,</div>
<div class="line">            <a class="code" href="rte__lcore_8h.html#a7c8da4664df26a64cf05dc508a4f26df">rte_socket_id</a>());</div>
<div class="line">    <span class="keywordflow">if</span> (l2fwd_crypto_op_pool == NULL)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Cannot create crypto op pool\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Enable Ethernet ports */</span></div>
<div class="line">    enabled_portcount = initialize_ports(&amp;options);</div>
<div class="line">    <span class="keywordflow">if</span> (enabled_portcount &lt; 1)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Failed to initial Ethernet ports\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Initialize the port/queue configuration of each logical core */</span></div>
<div class="line">    <a class="code" href="rte__ethdev_8h.html#ad7b46c67203d37fe3a34f11076d970d6">RTE_ETH_FOREACH_DEV</a>(portid) {</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* skip ports that are not enabled */</span></div>
<div class="line">        <span class="keywordflow">if</span> ((options.portmask &amp; (1 &lt;&lt; portid)) == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (options.single_lcore &amp;&amp; qconf == NULL) {</div>
<div class="line">            <span class="keywordflow">while</span> (<a name="a149"></a><a class="code" href="rte__lcore_8h.html#a5404ee6ac26cbe5a4f4ddef44d690b76">rte_lcore_is_enabled</a>(rx_lcore_id) == 0) {</div>
<div class="line">                rx_lcore_id++;</div>
<div class="line">                <span class="keywordflow">if</span> (rx_lcore_id &gt;= RTE_MAX_LCORE)</div>
<div class="line">                    <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE,</div>
<div class="line">                            <span class="stringliteral">&quot;Not enough cores\n&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!options.single_lcore) {</div>
<div class="line">            <span class="comment">/* get the lcore_id for this port */</span></div>
<div class="line">            <span class="keywordflow">while</span> (<a class="code" href="rte__lcore_8h.html#a5404ee6ac26cbe5a4f4ddef44d690b76">rte_lcore_is_enabled</a>(rx_lcore_id) == 0 ||</div>
<div class="line">                   lcore_queue_conf[rx_lcore_id].nb_rx_ports ==</div>
<div class="line">                   options.nb_ports_per_lcore) {</div>
<div class="line">                rx_lcore_id++;</div>
<div class="line">                <span class="keywordflow">if</span> (rx_lcore_id &gt;= RTE_MAX_LCORE)</div>
<div class="line">                    <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE,</div>
<div class="line">                            <span class="stringliteral">&quot;Not enough cores\n&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Assigned a new logical core in the loop above. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (qconf != &amp;lcore_queue_conf[rx_lcore_id])</div>
<div class="line">            qconf = &amp;lcore_queue_conf[rx_lcore_id];</div>
<div class="line"> </div>
<div class="line">        qconf-&gt;rx_port_list[qconf-&gt;nb_rx_ports] = portid;</div>
<div class="line">        qconf-&gt;nb_rx_ports++;</div>
<div class="line"> </div>
<div class="line">        printf(<span class="stringliteral">&quot;Lcore %u: RX port %u\n&quot;</span>, rx_lcore_id, portid);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Enable Crypto devices */</span></div>
<div class="line">    enabled_cdevcount = initialize_cryptodevs(&amp;options, enabled_portcount,</div>
<div class="line">            enabled_cdevs);</div>
<div class="line">    <span class="keywordflow">if</span> (enabled_cdevcount &lt; 0)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Failed to initialize crypto devices\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (enabled_cdevcount &lt; enabled_portcount)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Number of capable crypto devices (%d) &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;has to be more or equal to number of ports (%d)\n&quot;</span>,</div>
<div class="line">                enabled_cdevcount, enabled_portcount);</div>
<div class="line"> </div>
<div class="line">    nb_cryptodevs = <a class="code" href="rte__cryptodev_8h.html#a1a0c23adc25339b56bd19242194a002f">rte_cryptodev_count</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Initialize the port/cryptodev configuration of each logical core */</span></div>
<div class="line">    <span class="keywordflow">for</span> (rx_lcore_id = 0, qconf = NULL, cdev_id = 0;</div>
<div class="line">            cdev_id &lt; nb_cryptodevs &amp;&amp; enabled_cdevcount;</div>
<div class="line">            cdev_id++) {</div>
<div class="line">        <span class="comment">/* Crypto op not supported by crypto device */</span></div>
<div class="line">        <span class="keywordflow">if</span> (!enabled_cdevs[cdev_id])</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (options.single_lcore &amp;&amp; qconf == NULL) {</div>
<div class="line">            <span class="keywordflow">while</span> (<a class="code" href="rte__lcore_8h.html#a5404ee6ac26cbe5a4f4ddef44d690b76">rte_lcore_is_enabled</a>(rx_lcore_id) == 0) {</div>
<div class="line">                rx_lcore_id++;</div>
<div class="line">                <span class="keywordflow">if</span> (rx_lcore_id &gt;= RTE_MAX_LCORE)</div>
<div class="line">                    <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE,</div>
<div class="line">                            <span class="stringliteral">&quot;Not enough cores\n&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!options.single_lcore) {</div>
<div class="line">            <span class="comment">/* get the lcore_id for this port */</span></div>
<div class="line">            <span class="keywordflow">while</span> (<a class="code" href="rte__lcore_8h.html#a5404ee6ac26cbe5a4f4ddef44d690b76">rte_lcore_is_enabled</a>(rx_lcore_id) == 0 ||</div>
<div class="line">                   lcore_queue_conf[rx_lcore_id].nb_crypto_devs ==</div>
<div class="line">                   options.nb_ports_per_lcore) {</div>
<div class="line">                rx_lcore_id++;</div>
<div class="line">                <span class="keywordflow">if</span> (rx_lcore_id &gt;= RTE_MAX_LCORE)</div>
<div class="line">                    <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE,</div>
<div class="line">                            <span class="stringliteral">&quot;Not enough cores\n&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Assigned a new logical core in the loop above. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (qconf != &amp;lcore_queue_conf[rx_lcore_id])</div>
<div class="line">            qconf = &amp;lcore_queue_conf[rx_lcore_id];</div>
<div class="line"> </div>
<div class="line">        qconf-&gt;cryptodev_list[qconf-&gt;nb_crypto_devs] = cdev_id;</div>
<div class="line">        qconf-&gt;nb_crypto_devs++;</div>
<div class="line"> </div>
<div class="line">        enabled_cdevcount--;</div>
<div class="line"> </div>
<div class="line">        printf(<span class="stringliteral">&quot;Lcore %u: cryptodev %u\n&quot;</span>, rx_lcore_id,</div>
<div class="line">                (<span class="keywordtype">unsigned</span>)cdev_id);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* launch per-lcore init on every lcore */</span></div>
<div class="line">    <a name="a150"></a><a class="code" href="rte__launch_8h.html#acc0b1cfdc31fa73329acd51dcea31210">rte_eal_mp_remote_launch</a>(l2fwd_launch_one_lcore, (<span class="keywordtype">void</span> *)&amp;options,</div>
<div class="line">            <a name="a151"></a><a class="code" href="rte__launch_8h.html#a7fe96b0e5d3a6a8cf9b8d1a27cf3f159ad00c59bb386320b2ba3198d3149a0c35">CALL_MAIN</a>);</div>
<div class="line">    <a name="a152"></a><a class="code" href="rte__lcore_8h.html#ac779e61584eb9d087c3e20bf2d1150c8">RTE_LCORE_FOREACH_WORKER</a>(lcore_id) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a153"></a><a class="code" href="rte__launch_8h.html#ae9500e1d35bd4cfb95d18c0be863cb1e">rte_eal_wait_lcore</a>(lcore_id) &lt; 0)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="astructrte__cryptodev__info_html"><div class="ttname"><a href="structrte__cryptodev__info.html">rte_cryptodev_info</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00477">rte_cryptodev.h:477</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a0032857587ce7e217b8c10ba392bef56"><div class="ttname"><a href="rte__cryptodev_8h.html#a0032857587ce7e217b8c10ba392bef56">rte_cryptodev_dequeue_burst</a></div><div class="ttdeci">static uint16_t rte_cryptodev_dequeue_burst(uint8_t dev_id, uint16_t qp_id, struct rte_crypto_op **ops, uint16_t nb_ops)</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00943">rte_cryptodev.h:943</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a5f51139368b8d1a2c22fdecd90bc4d98"><div class="ttname"><a href="rte__ethdev_8h.html#a5f51139368b8d1a2c22fdecd90bc4d98">rte_eth_link_to_str</a></div><div class="ttdeci">__rte_experimental int rte_eth_link_to_str(char *str, size_t len, const struct rte_eth_link *eth_link)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_ad31219b87a1733d5b367a7c04c7f7b48"><div class="ttname"><a href="rte__ethdev_8h.html#ad31219b87a1733d5b367a7c04c7f7b48">rte_eth_dev_adjust_nb_rx_tx_desc</a></div><div class="ttdeci">int rte_eth_dev_adjust_nb_rx_tx_desc(uint16_t port_id, uint16_t *nb_rx_desc, uint16_t *nb_tx_desc)</div></div>
<div class="ttc" id="astructrte__ether__hdr_html_acce632e0fded0f728a1ee1a1ffb5c9bf"><div class="ttname"><a href="structrte__ether__hdr.html#acce632e0fded0f728a1ee1a1ffb5c9bf">rte_ether_hdr::s_addr</a></div><div class="ttdeci">struct rte_ether_addr s_addr</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00000">rte_ether.h:266</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a307c9b83491f12f87af8187715a01153"><div class="ttname"><a href="rte__crypto__sym_8h.html#a307c9b83491f12f87af8187715a01153">rte_crypto_auth_algorithm_strings</a></div><div class="ttdeci">const char * rte_crypto_auth_algorithm_strings[]</div></div>
<div class="ttc" id="astructrte__crypto__param__range_html_ade26a9703d9d6ea9c466d0e40aefca32"><div class="ttname"><a href="structrte__crypto__param__range.html#ade26a9703d9d6ea9c466d0e40aefca32">rte_crypto_param_range::increment</a></div><div class="ttdeci">uint16_t increment</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00089">rte_cryptodev.h:89</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a6e6d5d3329c585088678e9d52b50f75eacc7628ed85ee9261caac0faed94332f1"><div class="ttname"><a href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eacc7628ed85ee9261caac0faed94332f1">RTE_CRYPTO_CIPHER_KASUMI_F8</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_KASUMI_F8</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00141">rte_crypto_sym.h:140</a></div></div>
<div class="ttc" id="arte__malloc_8h_html"><div class="ttname"><a href="rte__malloc_8h.html">rte_malloc.h</a></div></div>
<div class="ttc" id="astructrte__eth__rxconf_html"><div class="ttname"><a href="structrte__eth__rxconf.html">rte_eth_rxconf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01032">rte_ethdev.h:1032</a></div></div>
<div class="ttc" id="arte__hexdump_8h_html_ad29a838fbd4c22051204e8055c6593ed"><div class="ttname"><a href="rte__hexdump_8h.html#ad29a838fbd4c22051204e8055c6593ed">rte_hexdump</a></div><div class="ttdeci">void rte_hexdump(FILE *f, const char *title, const void *buf, unsigned int len)</div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a6e6d5d3329c585088678e9d52b50f75e"><div class="ttname"><a href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75e">rte_crypto_cipher_algorithm</a></div><div class="ttdeci">rte_crypto_cipher_algorithm</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00115">rte_crypto_sym.h:115</a></div></div>
<div class="ttc" id="arte__crypto_8h_html_a31a63194763a5a9e689170becddc3ae6"><div class="ttname"><a href="rte__crypto_8h.html#a31a63194763a5a9e689170becddc3ae6">rte_crypto_op_bulk_alloc</a></div><div class="ttdeci">static unsigned rte_crypto_op_bulk_alloc(struct rte_mempool *mempool, enum rte_crypto_op_type type, struct rte_crypto_op **ops, uint16_t nb_ops)</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00276">rte_crypto.h:276</a></div></div>
<div class="ttc" id="arte__lcore_8h_html_a5404ee6ac26cbe5a4f4ddef44d690b76"><div class="ttname"><a href="rte__lcore_8h.html#a5404ee6ac26cbe5a4f4ddef44d690b76">rte_lcore_is_enabled</a></div><div class="ttdeci">int rte_lcore_is_enabled(unsigned int lcore_id)</div></div>
<div class="ttc" id="arte__memory_8h_html"><div class="ttname"><a href="rte__memory_8h.html">rte_memory.h</a></div></div>
<div class="ttc" id="arte__byteorder_8h_html_a6ec4cb000fc67785792d18728cf45563"><div class="ttname"><a href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a></div><div class="ttdeci">static rte_be16_t rte_cpu_to_be_16(uint16_t x)</div></div>
<div class="ttc" id="astructrte__cryptodev__capabilities_html"><div class="ttname"><a href="structrte__cryptodev__capabilities.html">rte_cryptodev_capabilities</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00178">rte_cryptodev.h:178</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a1e1336b0a8fe381ea03a52bad85e5734"><div class="ttname"><a href="rte__cryptodev_8h.html#a1e1336b0a8fe381ea03a52bad85e5734">rte_cryptodev_enqueue_burst</a></div><div class="ttdeci">static uint16_t rte_cryptodev_enqueue_burst(uint8_t dev_id, uint16_t qp_id, struct rte_crypto_op **ops, uint16_t nb_ops)</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00987">rte_cryptodev.h:987</a></div></div>
<div class="ttc" id="arte__branch__prediction_8h_html_ac6c45889010c1bd68631771b64f18101"><div class="ttname"><a href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a></div><div class="ttdeci">#define unlikely(x)</div><div class="ttdef"><b>Definition:</b> <a href="rte__branch__prediction_8h_source.html#l00038">rte_branch_prediction.h:38</a></div></div>
<div class="ttc" id="arte__launch_8h_html_acc0b1cfdc31fa73329acd51dcea31210"><div class="ttname"><a href="rte__launch_8h.html#acc0b1cfdc31fa73329acd51dcea31210">rte_eal_mp_remote_launch</a></div><div class="ttdeci">int rte_eal_mp_remote_launch(lcore_function_t *f, void *arg, enum rte_rmt_call_main_t call_main)</div></div>
<div class="ttc" id="astructrte__ether__hdr_html_ad6312397ccc57d322b1a037c7080d340"><div class="ttname"><a href="structrte__ether__hdr.html#ad6312397ccc57d322b1a037c7080d340">rte_ether_hdr::ether_type</a></div><div class="ttdeci">uint16_t ether_type</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00267">rte_ether.h:267</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a6e6d5d3329c585088678e9d52b50f75eab8a2eee308e346ed3b076e2d400615b2"><div class="ttname"><a href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eab8a2eee308e346ed3b076e2d400615b2">RTE_CRYPTO_CIPHER_3DES_ECB</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_3DES_ECB</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00124">rte_crypto_sym.h:123</a></div></div>
<div class="ttc" id="arte__common_8h_html_a6bbae0c1ede15e66dea0cc8ec17a3d87"><div class="ttname"><a href="rte__common_8h.html#a6bbae0c1ede15e66dea0cc8ec17a3d87">rte_iova_t</a></div><div class="ttdeci">uint64_t rte_iova_t</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00418">rte_common.h:418</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a648bc317af3ee238310fac9d87512508a27d121171b5e292d8a7313a38b91bf3e"><div class="ttname"><a href="rte__crypto__sym_8h.html#a648bc317af3ee238310fac9d87512508a27d121171b5e292d8a7313a38b91bf3e">RTE_CRYPTO_AEAD_AES_CCM</a></div><div class="ttdeci">@ RTE_CRYPTO_AEAD_AES_CCM</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00443">rte_crypto_sym.h:442</a></div></div>
<div class="ttc" id="arte__lcore_8h_html"><div class="ttname"><a href="rte__lcore_8h.html">rte_lcore.h</a></div></div>
<div class="ttc" id="arte__mempool_8h_html_a503f2f889043a48ca9995878846db2fd"><div class="ttname"><a href="rte__mempool_8h.html#a503f2f889043a48ca9995878846db2fd">rte_mempool_create</a></div><div class="ttdeci">struct rte_mempool * rte_mempool_create(const char *name, unsigned n, unsigned elt_size, unsigned cache_size, unsigned private_data_size, rte_mempool_ctor_t *mp_init, void *mp_init_arg, rte_mempool_obj_cb_t *obj_init, void *obj_init_arg, int socket_id, unsigned flags)</div></div>
<div class="ttc" id="arte__lcore_8h_html_a7c8da4664df26a64cf05dc508a4f26df"><div class="ttname"><a href="rte__lcore_8h.html#a7c8da4664df26a64cf05dc508a4f26df">rte_socket_id</a></div><div class="ttdeci">unsigned int rte_socket_id(void)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a4834f572f4dd4e46d81ad09b7d5fffd5aada568551470d5f419cd2f3d6b6bfedc"><div class="ttname"><a href="rte__ethdev_8h.html#a4834f572f4dd4e46d81ad09b7d5fffd5aada568551470d5f419cd2f3d6b6bfedc">ETH_MQ_TX_NONE</a></div><div class="ttdeci">@ ETH_MQ_TX_NONE</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00384">rte_ethdev.h:384</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_aeb677c03cea6fcc48a8caa533e3729f9"><div class="ttname"><a href="rte__cryptodev_8h.html#aeb677c03cea6fcc48a8caa533e3729f9">rte_cryptodev_info_get</a></div><div class="ttdeci">void rte_cryptodev_info_get(uint8_t dev_id, struct rte_cryptodev_info *dev_info)</div></div>
<div class="ttc" id="arte__log_8h_html"><div class="ttname"><a href="rte__log_8h.html">rte_log.h</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a796c2f20778984c6f41b271e36bae50e"><div class="ttname"><a href="rte__ethdev_8h.html#a796c2f20778984c6f41b271e36bae50e">rte_eth_tx_queue_setup</a></div><div class="ttdeci">int rte_eth_tx_queue_setup(uint16_t port_id, uint16_t tx_queue_id, uint16_t nb_tx_desc, unsigned int socket_id, const struct rte_eth_txconf *tx_conf)</div></div>
<div class="ttc" id="astructrte__eth__txconf_html"><div class="ttname"><a href="structrte__eth__txconf.html">rte_eth_txconf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01060">rte_ethdev.h:1060</a></div></div>
<div class="ttc" id="arte__crypto_8h_html_ae6cf2c3fcd46c5ef3a43fbcb8b658739ad7a72984dd85b1c8b59cad6971b02248"><div class="ttname"><a href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739ad7a72984dd85b1c8b59cad6971b02248">RTE_CRYPTO_OP_TYPE_UNDEFINED</a></div><div class="ttdeci">@ RTE_CRYPTO_OP_TYPE_UNDEFINED</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00031">rte_crypto.h:30</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a1a7d3a20b102fee222541fda50fd87bd"><div class="ttname"><a href="rte__ethdev_8h.html#a1a7d3a20b102fee222541fda50fd87bd">rte_eth_dev_configure</a></div><div class="ttdeci">int rte_eth_dev_configure(uint16_t port_id, uint16_t nb_rx_queue, uint16_t nb_tx_queue, const struct rte_eth_conf *eth_conf)</div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a275814f8c016f661c72b320295d91793a661553033b1672fa832c9f27b90ec52a"><div class="ttname"><a href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793a661553033b1672fa832c9f27b90ec52a">RTE_CRYPTO_AUTH_KASUMI_F9</a></div><div class="ttdeci">@ RTE_CRYPTO_AUTH_KASUMI_F9</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00291">rte_crypto_sym.h:290</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a8998669d6c958fb1f0e31eeee515dd47"><div class="ttname"><a href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47">rte_crypto_auth_operation</a></div><div class="ttdeci">rte_crypto_auth_operation</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00351">rte_crypto_sym.h:351</a></div></div>
<div class="ttc" id="arte__errno_8h_html_a129a7eb4cfa1f5bdac5783bf49137d06"><div class="ttname"><a href="rte__errno_8h.html#a129a7eb4cfa1f5bdac5783bf49137d06">rte_strerror</a></div><div class="ttdeci">const char * rte_strerror(int errnum)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a586b8e86131b4ec0ccaf464e847ccf3ea4600ff07419327deb9b8534bc66daf19"><div class="ttname"><a href="rte__ethdev_8h.html#a586b8e86131b4ec0ccaf464e847ccf3ea4600ff07419327deb9b8534bc66daf19">ETH_MQ_RX_NONE</a></div><div class="ttdeci">@ ETH_MQ_RX_NONE</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00352">rte_ethdev.h:352</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_ac86bc0178d39db9734c594c35f9aee4e"><div class="ttname"><a href="rte__cryptodev_8h.html#ac86bc0178d39db9734c594c35f9aee4e">rte_cryptodev_sym_session_pool_create</a></div><div class="ttdeci">__rte_experimental struct rte_mempool * rte_cryptodev_sym_session_pool_create(const char *name, uint32_t nb_elts, uint32_t elt_size, uint32_t cache_size, uint16_t priv_size, int socket_id)</div></div>
<div class="ttc" id="astructrte__eth__link_html"><div class="ttname"><a href="structrte__eth__link.html">rte_eth_link</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00313">rte_ethdev.h:313</a></div></div>
<div class="ttc" id="arte__string__fns_8h_html"><div class="ttname"><a href="rte__string__fns_8h.html">rte_string_fns.h</a></div></div>
<div class="ttc" id="arte__malloc_8h_html_a9fa8949fa521967981829b2afe40702b"><div class="ttname"><a href="rte__malloc_8h.html#a9fa8949fa521967981829b2afe40702b">rte_malloc_virt2iova</a></div><div class="ttdeci">rte_iova_t rte_malloc_virt2iova(const void *addr)</div></div>
<div class="ttc" id="arte__interrupts_8h_html"><div class="ttname"><a href="rte__interrupts_8h.html">rte_interrupts.h</a></div></div>
<div class="ttc" id="astructrte__eth__conf_html_a346eef99c24f617b74c440c1aa565d01"><div class="ttname"><a href="structrte__eth__conf.html#a346eef99c24f617b74c440c1aa565d01">rte_eth_conf::rxmode</a></div><div class="ttdeci">struct rte_eth_rxmode rxmode</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01294">rte_ethdev.h:1301</a></div></div>
<div class="ttc" id="arte__common_8h_html_a38e32f822bc941e90fdcbe5a9c69b178"><div class="ttname"><a href="rte__common_8h.html#a38e32f822bc941e90fdcbe5a9c69b178">__rte_cache_aligned</a></div><div class="ttdeci">#define __rte_cache_aligned</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00400">rte_common.h:400</a></div></div>
<div class="ttc" id="arte__crypto_8h_html_aa3035c7b271a4736dc9654b2eb85d1fd"><div class="ttname"><a href="rte__crypto_8h.html#aa3035c7b271a4736dc9654b2eb85d1fd">rte_crypto_op_pool_create</a></div><div class="ttdeci">struct rte_mempool * rte_crypto_op_pool_create(const char *name, enum rte_crypto_op_type type, unsigned nb_elts, unsigned cache_size, uint16_t priv_size, int socket_id)</div></div>
<div class="ttc" id="arte__branch__prediction_8h_html"><div class="ttname"><a href="rte__branch__prediction_8h.html">rte_branch_prediction.h</a></div></div>
<div class="ttc" id="arte__eal_8h_html"><div class="ttname"><a href="rte__eal_8h.html">rte_eal.h</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html"><div class="ttname"><a href="rte__cryptodev_8h.html">rte_cryptodev.h</a></div></div>
<div class="ttc" id="astructrte__eth__rxmode_html_aa0562513c4569f1aa53050f1beac6b5d"><div class="ttname"><a href="structrte__eth__rxmode.html#aa0562513c4569f1aa53050f1beac6b5d">rte_eth_rxmode::mq_mode</a></div><div class="ttdeci">enum rte_eth_rx_mq_mode mq_mode</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00336">rte_ethdev.h:402</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_ae4388e0326c8789ddf39e32044dc4187"><div class="ttname"><a href="rte__cryptodev_8h.html#ae4388e0326c8789ddf39e32044dc4187">rte_cryptodev_queue_pair_setup</a></div><div class="ttdeci">int rte_cryptodev_queue_pair_setup(uint8_t dev_id, uint16_t queue_pair_id, const struct rte_cryptodev_qp_conf *qp_conf, int socket_id)</div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a275814f8c016f661c72b320295d91793a98921a1d0174e6ec9f252b408dd39d20"><div class="ttname"><a href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793a98921a1d0174e6ec9f252b408dd39d20">RTE_CRYPTO_AUTH_SHA1_HMAC</a></div><div class="ttdeci">@ RTE_CRYPTO_AUTH_SHA1_HMAC</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00304">rte_crypto_sym.h:300</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a3e7d76a451b46348686ea97d6367f102"><div class="ttname"><a href="rte__ethdev_8h.html#a3e7d76a451b46348686ea97d6367f102">rte_eth_rx_burst</a></div><div class="ttdeci">static uint16_t rte_eth_rx_burst(uint16_t port_id, uint16_t queue_id, struct rte_mbuf **rx_pkts, const uint16_t nb_pkts)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l04834">rte_ethdev.h:4834</a></div></div>
<div class="ttc" id="arte__memcpy_8h_html_a09f4d8cdb1a7c25398a363906e1db8cd"><div class="ttname"><a href="rte__memcpy_8h.html#a09f4d8cdb1a7c25398a363906e1db8cd">rte_memcpy</a></div><div class="ttdeci">static void * rte_memcpy(void *dst, const void *src, size_t n)</div></div>
<div class="ttc" id="arte__ether_8h_html_ad6f7cb65b39d12b5250ecf82c8ffaa45"><div class="ttname"><a href="rte__ether_8h.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a></div><div class="ttdeci">uint8_t addr_bytes[RTE_ETHER_ADDR_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00000">rte_ether.h:0</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a6e6d5d3329c585088678e9d52b50f75ea178a49c654f4b4e16b9c3de03833dc58"><div class="ttname"><a href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ea178a49c654f4b4e16b9c3de03833dc58">RTE_CRYPTO_CIPHER_DES_CBC</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_DES_CBC</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00150">rte_crypto_sym.h:149</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_aa21ba0affdc8a7a267c879fb5599a57ea80f5756a76a8c903cc56a3b475576e2c"><div class="ttname"><a href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57ea80f5756a76a8c903cc56a3b475576e2c">RTE_CRYPTO_AEAD_OP_ENCRYPT</a></div><div class="ttdeci">@ RTE_CRYPTO_AEAD_OP_ENCRYPT</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00457">rte_crypto_sym.h:456</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a6e6d5d3329c585088678e9d52b50f75eabb5eac5873c92998ba42395614df0800"><div class="ttname"><a href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eabb5eac5873c92998ba42395614df0800">RTE_CRYPTO_CIPHER_ZUC_EEA3</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_ZUC_EEA3</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00147">rte_crypto_sym.h:146</a></div></div>
<div class="ttc" id="astructrte__cryptodev__qp__conf_html"><div class="ttname"><a href="structrte__cryptodev__qp__conf.html">rte_cryptodev_qp_conf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00517">rte_cryptodev.h:517</a></div></div>
<div class="ttc" id="arte__ether_8h_html"><div class="ttname"><a href="rte__ether_8h.html">rte_ether.h</a></div></div>
<div class="ttc" id="astructrte__mbuf_html"><div class="ttname"><a href="structrte__mbuf.html">rte_mbuf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00473">rte_mbuf_core.h:473</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_ad1263899f41301923c483c3b4ce0486f"><div class="ttname"><a href="rte__ethdev_8h.html#ad1263899f41301923c483c3b4ce0486f">rte_eth_link_get_nowait</a></div><div class="ttdeci">int rte_eth_link_get_nowait(uint16_t port_id, struct rte_eth_link *link)</div></div>
<div class="ttc" id="astructrte__cryptodev__symmetric__capability_html_a05863077b6b0802857a85984a19857c8"><div class="ttname"><a href="structrte__cryptodev__symmetric__capability.html#a05863077b6b0802857a85984a19857c8">rte_cryptodev_symmetric_capability::cipher</a></div><div class="ttdeci">struct rte_cryptodev_symmetric_capability::@135::@138 cipher</div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a275814f8c016f661c72b320295d91793a063c8faf0e4a6607311ec8061a29ab80"><div class="ttname"><a href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793a063c8faf0e4a6607311ec8061a29ab80">RTE_CRYPTO_AUTH_ZUC_EIA3</a></div><div class="ttdeci">@ RTE_CRYPTO_AUTH_ZUC_EIA3</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00326">rte_crypto_sym.h:325</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a7593f4fff04f4ae1b1d718db7ca7dc8c"><div class="ttname"><a href="rte__ethdev_8h.html#a7593f4fff04f4ae1b1d718db7ca7dc8c">rte_eth_dev_info_get</a></div><div class="ttdeci">int rte_eth_dev_info_get(uint16_t port_id, struct rte_eth_dev_info *dev_info)</div></div>
<div class="ttc" id="astructrte__crypto__op_html"><div class="ttname"><a href="structrte__crypto__op.html">rte_crypto_op</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00078">rte_crypto.h:78</a></div></div>
<div class="ttc" id="astructrte__crypto__sym__op_html_af021669494a2806b0569587e2096e88e"><div class="ttname"><a href="structrte__crypto__sym__op.html#af021669494a2806b0569587e2096e88e">rte_crypto_sym_op::m_src</a></div><div class="ttdeci">struct rte_mbuf * m_src</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00592">rte_crypto_sym.h:592</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a8998669d6c958fb1f0e31eeee515dd47a99f910b408b48db113988c3b841972b9"><div class="ttname"><a href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47a99f910b408b48db113988c3b841972b9">RTE_CRYPTO_AUTH_OP_VERIFY</a></div><div class="ttdeci">@ RTE_CRYPTO_AUTH_OP_VERIFY</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00352">rte_crypto_sym.h:352</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a5dd1dedaa45f05c72bcc35495e441e91"><div class="ttname"><a href="rte__ethdev_8h.html#a5dd1dedaa45f05c72bcc35495e441e91">rte_eth_promiscuous_enable</a></div><div class="ttdeci">int rte_eth_promiscuous_enable(uint16_t port_id)</div></div>
<div class="ttc" id="arte__mbuf_8h_html_a7a7ea614c79d5b9ed790a56c1c79189d"><div class="ttname"><a href="rte__mbuf_8h.html#a7a7ea614c79d5b9ed790a56c1c79189d">rte_pktmbuf_pkt_len</a></div><div class="ttdeci">#define rte_pktmbuf_pkt_len(m)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01545">rte_mbuf.h:1545</a></div></div>
<div class="ttc" id="arte__atomic_8h_html"><div class="ttname"><a href="rte__atomic_8h.html">rte_atomic.h</a></div></div>
<div class="ttc" id="arte__malloc_8h_html_a247c99e8d36300c52729c9ee58c2b489"><div class="ttname"><a href="rte__malloc_8h.html#a247c99e8d36300c52729c9ee58c2b489">rte_malloc</a></div><div class="ttdeci">void * rte_malloc(const char *type, size_t size, unsigned align) __rte_alloc_size(2)</div></div>
<div class="ttc" id="astructrte__crypto__param__range_html_ac66b569507cc273bbf83ce5dd5f70e84"><div class="ttname"><a href="structrte__crypto__param__range.html#ac66b569507cc273bbf83ce5dd5f70e84">rte_crypto_param_range::max</a></div><div class="ttdeci">uint16_t max</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00088">rte_cryptodev.h:88</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a8a28375b279ded9125c99a46bf3956ef"><div class="ttname"><a href="rte__ethdev_8h.html#a8a28375b279ded9125c99a46bf3956ef">rte_eth_macaddr_get</a></div><div class="ttdeci">int rte_eth_macaddr_get(uint16_t port_id, struct rte_ether_addr *mac_addr)</div></div>
<div class="ttc" id="arte__common_8h_html_ac5169870c983b3463cb226bdb8a94880"><div class="ttname"><a href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a></div><div class="ttdeci">__rte_noreturn void rte_exit(int exit_code, const char *format,...) __rte_format_printf(2</div></div>
<div class="ttc" id="arte__crypto_8h_html_affaf4fd29a51d350b387155494402a84"><div class="ttname"><a href="rte__crypto_8h.html#affaf4fd29a51d350b387155494402a84">rte_crypto_op_attach_sym_session</a></div><div class="ttdeci">static int rte_crypto_op_attach_sym_session(struct rte_crypto_op *op, struct rte_cryptodev_sym_session *sess)</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00412">rte_crypto.h:412</a></div></div>
<div class="ttc" id="astructrte__cryptodev__capabilities_html_a394c79d7e4c59bafe3bc7678dd69c03d"><div class="ttname"><a href="structrte__cryptodev__capabilities.html#a394c79d7e4c59bafe3bc7678dd69c03d">rte_cryptodev_capabilities::op</a></div><div class="ttdeci">enum rte_crypto_op_type op</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00159">rte_cryptodev.h:179</a></div></div>
<div class="ttc" id="arte__ip_8h_html"><div class="ttname"><a href="rte__ip_8h.html">rte_ip.h</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a83e56cabbd31637efd648e3fc010392b"><div class="ttname"><a href="rte__ethdev_8h.html#a83e56cabbd31637efd648e3fc010392b">rte_eth_tx_burst</a></div><div class="ttdeci">static uint16_t rte_eth_tx_burst(uint16_t port_id, uint16_t queue_id, struct rte_mbuf **tx_pkts, uint16_t nb_pkts)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l05112">rte_ethdev.h:5112</a></div></div>
<div class="ttc" id="arte__cycles_8h_html_ae016e608f344823e677819d8f04264c5"><div class="ttname"><a href="rte__cycles_8h.html#ae016e608f344823e677819d8f04264c5">rte_get_tsc_hz</a></div><div class="ttdeci">uint64_t rte_get_tsc_hz(void)</div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a6e6d5d3329c585088678e9d52b50f75ead9f8e28815f3dd2b77e7ce93b7b8a7ca"><div class="ttname"><a href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ead9f8e28815f3dd2b77e7ce93b7b8a7ca">RTE_CRYPTO_CIPHER_AES_CBC</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_AES_CBC</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00127">rte_crypto_sym.h:126</a></div></div>
<div class="ttc" id="astructrte__ipv4__hdr_html_a0f143df6fd0e09aba2963a160e33ce16"><div class="ttname"><a href="structrte__ipv4__hdr.html#a0f143df6fd0e09aba2963a160e33ce16">rte_ipv4_hdr::version_ihl</a></div><div class="ttdeci">uint8_t version_ihl</div><div class="ttdef"><b>Definition:</b> <a href="rte__ip_8h_source.html#l00034">rte_ip.h:34</a></div></div>
<div class="ttc" id="astructrte__crypto__op_html_a493a2a236148232b6e55a9a5b280d3b7"><div class="ttname"><a href="structrte__crypto__op.html#a493a2a236148232b6e55a9a5b280d3b7">rte_crypto_op::sym</a></div><div class="ttdeci">struct rte_crypto_sym_op sym[0]</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00100">rte_crypto.h:118</a></div></div>
<div class="ttc" id="arte__lcore_8h_html_adfb2b334e7e73f534f25e8888a8a775f"><div class="ttname"><a href="rte__lcore_8h.html#adfb2b334e7e73f534f25e8888a8a775f">rte_lcore_id</a></div><div class="ttdeci">static unsigned rte_lcore_id(void)</div><div class="ttdef"><b>Definition:</b> <a href="rte__lcore_8h_source.html#l00075">rte_lcore.h:75</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a275814f8c016f661c72b320295d91793a3a068d41ffd387e294fade7fbe0b11af"><div class="ttname"><a href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793a3a068d41ffd387e294fade7fbe0b11af">RTE_CRYPTO_AUTH_SNOW3G_UIA2</a></div><div class="ttdeci">@ RTE_CRYPTO_AUTH_SNOW3G_UIA2</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00323">rte_crypto_sym.h:322</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a6e6d5d3329c585088678e9d52b50f75eaf7d6407f595eafe9d16b372e7d256f9e"><div class="ttname"><a href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eaf7d6407f595eafe9d16b372e7d256f9e">RTE_CRYPTO_CIPHER_AES_ECB</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_AES_ECB</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00131">rte_crypto_sym.h:130</a></div></div>
<div class="ttc" id="arte__cycles_8h_html"><div class="ttname"><a href="rte__cycles_8h.html">rte_cycles.h</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_ae7110b5d5dced8f42505bff5d9e3f0ea"><div class="ttname"><a href="rte__ethdev_8h.html#ae7110b5d5dced8f42505bff5d9e3f0ea">DEV_TX_OFFLOAD_MBUF_FAST_FREE</a></div><div class="ttdeci">#define DEV_TX_OFFLOAD_MBUF_FAST_FREE</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01401">rte_ethdev.h:1397</a></div></div>
<div class="ttc" id="astructrte__cryptodev__info_html_aaccbcc3ce862dbe5af189ee0c3e345b1"><div class="ttname"><a href="structrte__cryptodev__info.html#aaccbcc3ce862dbe5af189ee0c3e345b1">rte_cryptodev_info::feature_flags</a></div><div class="ttdeci">uint64_t feature_flags</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00482">rte_cryptodev.h:482</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a58207367533ac9e65e4a611ba78090e5"><div class="ttname"><a href="rte__cryptodev_8h.html#a58207367533ac9e65e4a611ba78090e5">rte_cryptodev_configure</a></div><div class="ttdeci">int rte_cryptodev_configure(uint8_t dev_id, struct rte_cryptodev_config *config)</div></div>
<div class="ttc" id="astructrte__mbuf_html_a8e0798404bf2cf5dabb84c5ba9a4f236"><div class="ttname"><a href="structrte__mbuf.html#a8e0798404bf2cf5dabb84c5ba9a4f236">rte_mbuf::port</a></div><div class="ttdeci">uint16_t port</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00503">rte_mbuf_core.h:503</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a3c203be2dfa1c228cc8ccf0644422321"><div class="ttname"><a href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321">rte_crypto_cipher_operation</a></div><div class="ttdeci">rte_crypto_cipher_operation</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00172">rte_crypto_sym.h:172</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_ad5b0cd686ad3bcbb83416ca8395a080b"><div class="ttname"><a href="rte__mbuf_8h.html#ad5b0cd686ad3bcbb83416ca8395a080b">rte_pktmbuf_append</a></div><div class="ttdeci">static char * rte_pktmbuf_append(struct rte_mbuf *m, uint16_t len)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01605">rte_mbuf.h:1605</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_a2a8b10263496c7b580e9d0c7f2a1f073"><div class="ttname"><a href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a></div><div class="ttdeci">#define rte_pktmbuf_mtod(m, t)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00726">rte_mbuf_core.h:726</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_afdc834c1c52e9fb512301990468ca7c2"><div class="ttname"><a href="rte__ethdev_8h.html#afdc834c1c52e9fb512301990468ca7c2">rte_eth_dev_start</a></div><div class="ttdeci">int rte_eth_dev_start(uint16_t port_id)</div></div>
<div class="ttc" id="arte__ether_8h_html_af5e7040b36584eacec1c5b9eee086eac"><div class="ttname"><a href="rte__ether_8h.html#af5e7040b36584eacec1c5b9eee086eac">rte_ether_addr_copy</a></div><div class="ttdeci">static void rte_ether_addr_copy(const struct rte_ether_addr *__restrict ea_from, struct rte_ether_addr *__restrict ea_to)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00222">rte_ether.h:222</a></div></div>
<div class="ttc" id="arte__random_8h_html"><div class="ttname"><a href="rte__random_8h.html">rte_random.h</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a3b1d740f9da225aebc2dc6762b9758b0"><div class="ttname"><a href="rte__cryptodev_8h.html#a3b1d740f9da225aebc2dc6762b9758b0">RTE_CRYPTODEV_FF_HW_ACCELERATED</a></div><div class="ttdeci">#define RTE_CRYPTODEV_FF_HW_ACCELERATED</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00419">rte_cryptodev.h:416</a></div></div>
<div class="ttc" id="astructrte__cryptodev__symmetric__capability_html_a690a3258912ca541695442ea102c55d8"><div class="ttname"><a href="structrte__cryptodev__symmetric__capability.html#a690a3258912ca541695442ea102c55d8">rte_cryptodev_symmetric_capability::auth</a></div><div class="ttdeci">struct rte_cryptodev_symmetric_capability::@135::@137 auth</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a08c012f37e07726170ff67daf667d850"><div class="ttname"><a href="rte__ethdev_8h.html#a08c012f37e07726170ff67daf667d850">ETH_LINK_DOWN</a></div><div class="ttdeci">#define ETH_LINK_DOWN</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00323">rte_ethdev.h:323</a></div></div>
<div class="ttc" id="astructrte__ether__hdr_html"><div class="ttname"><a href="structrte__ether__hdr.html">rte_ether_hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00264">rte_ether.h:264</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a648bc317af3ee238310fac9d87512508"><div class="ttname"><a href="rte__crypto__sym_8h.html#a648bc317af3ee238310fac9d87512508">rte_crypto_aead_algorithm</a></div><div class="ttdeci">rte_crypto_aead_algorithm</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00441">rte_crypto_sym.h:441</a></div></div>
<div class="ttc" id="arte__common_8h_html"><div class="ttname"><a href="rte__common_8h.html">rte_common.h</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a34a54ae38920d21d95aa6049640e8c0e"><div class="ttname"><a href="rte__cryptodev_8h.html#a34a54ae38920d21d95aa6049640e8c0e">rte_cryptodev_sym_get_private_session_size</a></div><div class="ttdeci">unsigned int rte_cryptodev_sym_get_private_session_size(uint8_t dev_id)</div></div>
<div class="ttc" id="arte__cryptodev_8h_html_ad40470ee7e072f93f85f1bb584e64e39"><div class="ttname"><a href="rte__cryptodev_8h.html#ad40470ee7e072f93f85f1bb584e64e39">rte_cryptodev_sym_session_create</a></div><div class="ttdeci">struct rte_cryptodev_sym_session * rte_cryptodev_sym_session_create(struct rte_mempool *mempool)</div></div>
<div class="ttc" id="astructrte__eth__txmode_html_a6cfe3b3ee46e9a8b8c62a64294b0b564"><div class="ttname"><a href="structrte__eth__txmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">rte_eth_txmode::offloads</a></div><div class="ttdeci">uint64_t offloads</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00959">rte_ethdev.h:959</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a3b05f51fd91ec181c369e32908d55717"><div class="ttname"><a href="rte__cryptodev_8h.html#a3b05f51fd91ec181c369e32908d55717">rte_cryptodev_sym_session_init</a></div><div class="ttdeci">int rte_cryptodev_sym_session_init(uint8_t dev_id, struct rte_cryptodev_sym_session *sess, struct rte_crypto_sym_xform *xforms, struct rte_mempool *mempool)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a9ab708089665bebcd65cefe5383b24f2"><div class="ttname"><a href="rte__ethdev_8h.html#a9ab708089665bebcd65cefe5383b24f2">rte_eth_dev_count_avail</a></div><div class="ttdeci">uint16_t rte_eth_dev_count_avail(void)</div></div>
<div class="ttc" id="arte__debug_8h_html"><div class="ttname"><a href="rte__debug_8h.html">rte_debug.h</a></div></div>
<div class="ttc" id="arte__hexdump_8h_html"><div class="ttname"><a href="rte__hexdump_8h.html">rte_hexdump.h</a></div></div>
<div class="ttc" id="astructrte__eth__rxmode_html_a6cfe3b3ee46e9a8b8c62a64294b0b564"><div class="ttname"><a href="structrte__eth__rxmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">rte_eth_rxmode::offloads</a></div><div class="ttdeci">uint64_t offloads</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00412">rte_ethdev.h:412</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a1fa401bd6c01129823669ac68deaa993"><div class="ttname"><a href="rte__cryptodev_8h.html#a1fa401bd6c01129823669ac68deaa993">rte_cryptodev_start</a></div><div class="ttdeci">int rte_cryptodev_start(uint8_t dev_id)</div></div>
<div class="ttc" id="arte__memcpy_8h_html"><div class="ttname"><a href="rte__memcpy_8h.html">rte_memcpy.h</a></div></div>
<div class="ttc" id="astructrte__crypto__sym__xform_html"><div class="ttname"><a href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00543">rte_crypto_sym.h:543</a></div></div>
<div class="ttc" id="arte__eal_8h_html_a5c3f4dddc25e38c5a186ecd8a69260e3"><div class="ttname"><a href="rte__eal_8h.html#a5c3f4dddc25e38c5a186ecd8a69260e3">rte_eal_init</a></div><div class="ttdeci">int rte_eal_init(int argc, char **argv)</div></div>
<div class="ttc" id="astructrte__mempool_html"><div class="ttname"><a href="structrte__mempool.html">rte_mempool</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__mempool_8h_source.html#l00207">rte_mempool.h:207</a></div></div>
<div class="ttc" id="astructrte__cryptodev__config_html_a229cb0bd24215f0cb940e0724dbd4d55"><div class="ttname"><a href="structrte__cryptodev__config.html#a229cb0bd24215f0cb940e0724dbd4d55">rte_cryptodev_config::socket_id</a></div><div class="ttdeci">int socket_id</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00629">rte_cryptodev.h:629</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_a593921f13307803b94bbb4e0932db962"><div class="ttname"><a href="rte__mbuf_8h.html#a593921f13307803b94bbb4e0932db962">rte_pktmbuf_pool_create</a></div><div class="ttdeci">struct rte_mempool * rte_pktmbuf_pool_create(const char *name, unsigned n, unsigned cache_size, uint16_t priv_size, uint16_t data_room_size, int socket_id)</div></div>
<div class="ttc" id="astructrte__ipv4__hdr_html"><div class="ttname"><a href="structrte__ipv4__hdr.html">rte_ipv4_hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ip_8h_source.html#l00033">rte_ip.h:33</a></div></div>
<div class="ttc" id="arte__crypto_8h_html_ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc"><div class="ttname"><a href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc">RTE_CRYPTO_OP_TYPE_SYMMETRIC</a></div><div class="ttdeci">@ RTE_CRYPTO_OP_TYPE_SYMMETRIC</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00033">rte_crypto.h:32</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a648bc317af3ee238310fac9d87512508ab8b38d7173d30b7adf47116abb09c469"><div class="ttname"><a href="rte__crypto__sym_8h.html#a648bc317af3ee238310fac9d87512508ab8b38d7173d30b7adf47116abb09c469">RTE_CRYPTO_AEAD_AES_GCM</a></div><div class="ttdeci">@ RTE_CRYPTO_AEAD_AES_GCM</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00445">rte_crypto_sym.h:444</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9"><div class="ttname"><a href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9">RTE_CRYPTO_SYM_XFORM_AUTH</a></div><div class="ttdeci">@ RTE_CRYPTO_SYM_XFORM_AUTH</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00529">rte_crypto_sym.h:529</a></div></div>
<div class="ttc" id="astructrte__cryptodev__sym__session_html"><div class="ttname"><a href="structrte__cryptodev__sym__session.html">rte_cryptodev_sym_session</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l01002">rte_cryptodev.h:1002</a></div></div>
<div class="ttc" id="arte__lcore_8h_html_a5449c6ee062fe3641520374152ce6c67"><div class="ttname"><a href="rte__lcore_8h.html#a5449c6ee062fe3641520374152ce6c67">rte_get_main_lcore</a></div><div class="ttdeci">unsigned int rte_get_main_lcore(void)</div></div>
<div class="ttc" id="arte__mbuf_8h_html_a1215458932900b7cd5192326fa4a6902"><div class="ttname"><a href="rte__mbuf_8h.html#a1215458932900b7cd5192326fa4a6902">rte_pktmbuf_free</a></div><div class="ttdeci">static void rte_pktmbuf_free(struct rte_mbuf *m)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01397">rte_mbuf.h:1397</a></div></div>
<div class="ttc" id="astructrte__cryptodev__config_html_ab6b5a902514f586f964c368ef5993cd7"><div class="ttname"><a href="structrte__cryptodev__config.html#ab6b5a902514f586f964c368ef5993cd7">rte_cryptodev_config::nb_queue_pairs</a></div><div class="ttdeci">uint16_t nb_queue_pairs</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00630">rte_cryptodev.h:630</a></div></div>
<div class="ttc" id="arte__lcore_8h_html_ac779e61584eb9d087c3e20bf2d1150c8"><div class="ttname"><a href="rte__lcore_8h.html#ac779e61584eb9d087c3e20bf2d1150c8">RTE_LCORE_FOREACH_WORKER</a></div><div class="ttdeci">#define RTE_LCORE_FOREACH_WORKER(i)</div><div class="ttdef"><b>Definition:</b> <a href="rte__lcore_8h_source.html#l00239">rte_lcore.h:239</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a36ba70a5a6fce2c2c1f774828ba78f8d"><div class="ttname"><a href="rte__ethdev_8h.html#a36ba70a5a6fce2c2c1f774828ba78f8d">rte_eth_rx_queue_setup</a></div><div class="ttdeci">int rte_eth_rx_queue_setup(uint16_t port_id, uint16_t rx_queue_id, uint16_t nb_rx_desc, unsigned int socket_id, const struct rte_eth_rxconf *rx_conf, struct rte_mempool *mb_pool)</div></div>
<div class="ttc" id="arte__mempool_8h_html"><div class="ttname"><a href="rte__mempool_8h.html">rte_mempool.h</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c"><div class="ttname"><a href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c">RTE_CRYPTO_SYM_XFORM_CIPHER</a></div><div class="ttdeci">@ RTE_CRYPTO_SYM_XFORM_CIPHER</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00530">rte_crypto_sym.h:530</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html"><div class="ttname"><a href="rte__ethdev_8h.html">rte_ethdev.h</a></div></div>
<div class="ttc" id="astructrte__crypto__param__range_html"><div class="ttname"><a href="structrte__crypto__param__range.html">rte_crypto_param_range</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00086">rte_cryptodev.h:86</a></div></div>
<div class="ttc" id="arte__ip_8h_html_ae7775437ee87698e6f6b3c5003f0f22f"><div class="ttname"><a href="rte__ip_8h.html#ae7775437ee87698e6f6b3c5003f0f22f">RTE_IPV4_HDR_IHL_MASK</a></div><div class="ttdeci">#define RTE_IPV4_HDR_IHL_MASK</div><div class="ttdef"><b>Definition:</b> <a href="rte__ip_8h_source.html#l00056">rte_ip.h:56</a></div></div>
<div class="ttc" id="arte__log_8h_html_ac23caeb9833fd0fd0665c6c05ec806fe"><div class="ttname"><a href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a></div><div class="ttdeci">#define RTE_LOG(l, t,...)</div><div class="ttdef"><b>Definition:</b> <a href="rte__log_8h_source.html#l00331">rte_log.h:331</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_aa21ba0affdc8a7a267c879fb5599a57e"><div class="ttname"><a href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57e">rte_crypto_aead_operation</a></div><div class="ttdeci">rte_crypto_aead_operation</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00455">rte_crypto_sym.h:455</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html"><div class="ttname"><a href="rte__mbuf_8h.html">rte_mbuf.h</a></div></div>
<div class="ttc" id="arte__launch_8h_html"><div class="ttname"><a href="rte__launch_8h.html">rte_launch.h</a></div></div>
<div class="ttc" id="astructrte__cryptodev__info_html_ab3fdbf22ceb27dc84c580c6478e1175b"><div class="ttname"><a href="structrte__cryptodev__info.html#ab3fdbf22ceb27dc84c580c6478e1175b">rte_cryptodev_info::driver_name</a></div><div class="ttdeci">const char * driver_name</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00478">rte_cryptodev.h:478</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_aa21ba0affdc8a7a267c879fb5599a57ea331ebd5a481118673489e7c580530179"><div class="ttname"><a href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57ea331ebd5a481118673489e7c580530179">RTE_CRYPTO_AEAD_OP_DECRYPT</a></div><div class="ttdeci">@ RTE_CRYPTO_AEAD_OP_DECRYPT</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00460">rte_crypto_sym.h:458</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a3c203be2dfa1c228cc8ccf0644422321a74a31028a7180f96bcbe6c1edc298c5b"><div class="ttname"><a href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321a74a31028a7180f96bcbe6c1edc298c5b">RTE_CRYPTO_CIPHER_OP_ENCRYPT</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_OP_ENCRYPT</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00174">rte_crypto_sym.h:173</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a275814f8c016f661c72b320295d91793"><div class="ttname"><a href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793">rte_crypto_auth_algorithm</a></div><div class="ttdeci">rte_crypto_auth_algorithm</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00277">rte_crypto_sym.h:277</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a3c203be2dfa1c228cc8ccf0644422321a4ec0ce9be05fae0758c95aadfb03c4ee"><div class="ttname"><a href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321a4ec0ce9be05fae0758c95aadfb03c4ee">RTE_CRYPTO_CIPHER_OP_DECRYPT</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_OP_DECRYPT</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00177">rte_crypto_sym.h:175</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a1ffaab4a2885220015c21d9bc6f05808"><div class="ttname"><a href="rte__cryptodev_8h.html#a1ffaab4a2885220015c21d9bc6f05808">RTE_CRYPTODEV_FF_SECURITY</a></div><div class="ttdeci">#define RTE_CRYPTODEV_FF_SECURITY</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00446">rte_cryptodev.h:445</a></div></div>
<div class="ttc" id="astructrte__eth__conf_html_a1c33c9d2e5cdb14b62ed386bf3159e07"><div class="ttname"><a href="structrte__eth__conf.html#a1c33c9d2e5cdb14b62ed386bf3159e07">rte_eth_conf::txmode</a></div><div class="ttdeci">struct rte_eth_txmode txmode</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01294">rte_ethdev.h:1302</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a6e6d5d3329c585088678e9d52b50f75eaed8720577f149444ab479ee7415dbfb2"><div class="ttname"><a href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eaed8720577f149444ab479ee7415dbfb2">RTE_CRYPTO_CIPHER_3DES_CBC</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_3DES_CBC</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00120">rte_crypto_sym.h:119</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a46aecd6ebcceea1eba91d16a90e76782a87d8d14b56f41d42ca643d33a279912a"><div class="ttname"><a href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a87d8d14b56f41d42ca643d33a279912a">RTE_CRYPTO_SYM_XFORM_AEAD</a></div><div class="ttdeci">@ RTE_CRYPTO_SYM_XFORM_AEAD</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00532">rte_crypto_sym.h:531</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a7a31d6736244603b6a1d7efdd32a8834"><div class="ttname"><a href="rte__ethdev_8h.html#a7a31d6736244603b6a1d7efdd32a8834">RTE_ETH_LINK_MAX_STR_LEN</a></div><div class="ttdeci">#define RTE_ETH_LINK_MAX_STR_LEN</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00327">rte_ethdev.h:327</a></div></div>
<div class="ttc" id="astructrte__crypto__sym__xform_html_aa8c788b7f832e2a4183a8924ff8dab97"><div class="ttname"><a href="structrte__crypto__sym__xform.html#aa8c788b7f832e2a4183a8924ff8dab97">rte_crypto_sym_xform::next</a></div><div class="ttdeci">struct rte_crypto_sym_xform * next</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00544">rte_crypto_sym.h:544</a></div></div>
<div class="ttc" id="arte__cryptodev__scheduler_8h_html_ac208d2560137811abb2c31a3fb625f28"><div class="ttname"><a href="rte__cryptodev__scheduler_8h.html#ac208d2560137811abb2c31a3fb625f28">rte_cryptodev_scheduler_workers_get</a></div><div class="ttdeci">int rte_cryptodev_scheduler_workers_get(uint8_t scheduler_id, uint8_t *workers)</div></div>
<div class="ttc" id="arte__launch_8h_html_a7fe96b0e5d3a6a8cf9b8d1a27cf3f159ad00c59bb386320b2ba3198d3149a0c35"><div class="ttname"><a href="rte__launch_8h.html#a7fe96b0e5d3a6a8cf9b8d1a27cf3f159ad00c59bb386320b2ba3198d3149a0c35">CALL_MAIN</a></div><div class="ttdeci">@ CALL_MAIN</div><div class="ttdef"><b>Definition:</b> <a href="rte__launch_8h_source.html#l00073">rte_launch.h:73</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_aecf8ad2a113d395767f5b6cea89f3ee2"><div class="ttname"><a href="rte__cryptodev_8h.html#aecf8ad2a113d395767f5b6cea89f3ee2">rte_crypto_op_ctod_offset</a></div><div class="ttdeci">#define rte_crypto_op_ctod_offset(c, t, o)</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00066">rte_cryptodev.h:66</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a1a0c23adc25339b56bd19242194a002f"><div class="ttname"><a href="rte__cryptodev_8h.html#a1a0c23adc25339b56bd19242194a002f">rte_cryptodev_count</a></div><div class="ttdeci">uint8_t rte_cryptodev_count(void)</div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_ad0accb8ac900700f160f1dd12fa8b19b"><div class="ttname"><a href="rte__crypto__sym_8h.html#ad0accb8ac900700f160f1dd12fa8b19b">rte_crypto_cipher_algorithm_strings</a></div><div class="ttdeci">const char * rte_crypto_cipher_algorithm_strings[]</div></div>
<div class="ttc" id="arte__ether_8h_html_a15583fc4e341572ad37c8beace664ea8"><div class="ttname"><a href="rte__ether_8h.html#a15583fc4e341572ad37c8beace664ea8">RTE_ETHER_TYPE_IPV4</a></div><div class="ttdeci">#define RTE_ETHER_TYPE_IPV4</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00283">rte_ether.h:283</a></div></div>
<div class="ttc" id="astructrte__eth__dev__info_html"><div class="ttname"><a href="structrte__eth__dev__info.html">rte_eth_dev_info</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01504">rte_ethdev.h:1504</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_a2a1e1b30162161ed11d3ba2faf7bbf13"><div class="ttname"><a href="rte__mbuf_8h.html#a2a1e1b30162161ed11d3ba2faf7bbf13">rte_pktmbuf_data_len</a></div><div class="ttdeci">#define rte_pktmbuf_data_len(m)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01555">rte_mbuf.h:1555</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_a0aba9fed77ad814d952958d448c71f38"><div class="ttname"><a href="rte__mbuf__core_8h.html#a0aba9fed77ad814d952958d448c71f38">rte_pktmbuf_iova_offset</a></div><div class="ttdeci">#define rte_pktmbuf_iova_offset(m, o)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00737">rte_mbuf_core.h:737</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a958771db424879b8de3ca82f5da0d399"><div class="ttname"><a href="rte__crypto__sym_8h.html#a958771db424879b8de3ca82f5da0d399">rte_crypto_aead_algorithm_strings</a></div><div class="ttdeci">const char * rte_crypto_aead_algorithm_strings[]</div></div>
<div class="ttc" id="astructrte__crypto__param__range_html_a1a1f4624f66ab0b2eb0b98316514c369"><div class="ttname"><a href="structrte__crypto__param__range.html#a1a1f4624f66ab0b2eb0b98316514c369">rte_crypto_param_range::min</a></div><div class="ttdeci">uint16_t min</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00087">rte_cryptodev.h:87</a></div></div>
<div class="ttc" id="astructrte__ether__addr_html"><div class="ttname"><a href="structrte__ether__addr.html">rte_ether_addr</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00064">rte_ether.h:64</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_ad7b46c67203d37fe3a34f11076d970d6"><div class="ttname"><a href="rte__ethdev_8h.html#ad7b46c67203d37fe3a34f11076d970d6">RTE_ETH_FOREACH_DEV</a></div><div class="ttdeci">#define RTE_ETH_FOREACH_DEV(p)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01858">rte_ethdev.h:1858</a></div></div>
<div class="ttc" id="astructrte__eth__conf_html"><div class="ttname"><a href="structrte__eth__conf.html">rte_eth_conf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01293">rte_ethdev.h:1293</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_ad032e25f712e6ffeb0c19eab1ec1fd2e"><div class="ttname"><a href="rte__ethdev_8h.html#ad032e25f712e6ffeb0c19eab1ec1fd2e">rte_eth_dev_socket_id</a></div><div class="ttdeci">int rte_eth_dev_socket_id(uint16_t port_id)</div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a6e6d5d3329c585088678e9d52b50f75ea8598018741a79db99387a47133c94525"><div class="ttname"><a href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ea8598018741a79db99387a47133c94525">RTE_CRYPTO_CIPHER_SNOW3G_UEA2</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_SNOW3G_UEA2</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00144">rte_crypto_sym.h:143</a></div></div>
<div class="ttc" id="arte__ip_8h_html_aef4776060d8fc0d40e2a7df40a39b633"><div class="ttname"><a href="rte__ip_8h.html#aef4776060d8fc0d40e2a7df40a39b633">RTE_IPV4_IHL_MULTIPLIER</a></div><div class="ttdeci">#define RTE_IPV4_IHL_MULTIPLIER</div><div class="ttdef"><b>Definition:</b> <a href="rte__ip_8h_source.html#l00061">rte_ip.h:61</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_ad57cb5966e6545c495651953f55f057d"><div class="ttname"><a href="rte__cryptodev_8h.html#ad57cb5966e6545c495651953f55f057d">rte_cryptodev_get_aead_algo_enum</a></div><div class="ttdeci">int rte_cryptodev_get_aead_algo_enum(enum rte_crypto_aead_algorithm *algo_enum, const char *algo_string)</div></div>
<div class="ttc" id="arte__per__lcore_8h_html"><div class="ttname"><a href="rte__per__lcore_8h.html">rte_per_lcore.h</a></div></div>
<div class="ttc" id="astructrte__cryptodev__capabilities_html_a632781b6c57a8ece1eb98dd4d06e1e8c"><div class="ttname"><a href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">rte_cryptodev_capabilities::sym</a></div><div class="ttdeci">struct rte_cryptodev_symmetric_capability sym</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00182">rte_cryptodev.h:184</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_aac0e6b2a8cb903ccad7118b8c8155067"><div class="ttname"><a href="rte__cryptodev_8h.html#aac0e6b2a8cb903ccad7118b8c8155067">rte_cryptodev_get_cipher_algo_enum</a></div><div class="ttdeci">int rte_cryptodev_get_cipher_algo_enum(enum rte_crypto_cipher_algorithm *algo_enum, const char *algo_string)</div></div>
<div class="ttc" id="astructrte__cryptodev__config_html"><div class="ttname"><a href="structrte__cryptodev__config.html">rte_cryptodev_config</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00628">rte_cryptodev.h:628</a></div></div>
<div class="ttc" id="astructrte__cryptodev__info_html_a65b9cdbb3719f657c9d8e581ba2a904b"><div class="ttname"><a href="structrte__cryptodev__info.html#a65b9cdbb3719f657c9d8e581ba2a904b">rte_cryptodev_info::capabilities</a></div><div class="ttdeci">const struct rte_cryptodev_capabilities * capabilities</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00485">rte_cryptodev.h:485</a></div></div>
<div class="ttc" id="astructrte__cryptodev__symmetric__capability_html_afe276edbba98b3f82f0826d7feaeb82f"><div class="ttname"><a href="structrte__cryptodev__symmetric__capability.html#afe276edbba98b3f82f0826d7feaeb82f">rte_cryptodev_symmetric_capability::xform_type</a></div><div class="ttdeci">enum rte_crypto_sym_xform_type xform_type</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00089">rte_cryptodev.h:101</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a8998669d6c958fb1f0e31eeee515dd47aa4697c029df30850f9f01b1c641aca32"><div class="ttname"><a href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47aa4697c029df30850f9f01b1c641aca32">RTE_CRYPTO_AUTH_OP_GENERATE</a></div><div class="ttdeci">@ RTE_CRYPTO_AUTH_OP_GENERATE</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00354">rte_crypto_sym.h:353</a></div></div>
<div class="ttc" id="arte__cycles_8h_html_af73b844d50b98de74b1a0e1730262f85"><div class="ttname"><a href="rte__cycles_8h.html#af73b844d50b98de74b1a0e1730262f85">rte_delay_ms</a></div><div class="ttdeci">static void rte_delay_ms(unsigned ms)</div><div class="ttdef"><b>Definition:</b> <a href="rte__cycles_8h_source.html#l00148">rte_cycles.h:148</a></div></div>
<div class="ttc" id="arte__crypto_8h_html_aca76406e3f1ab04ab44dfbe4ff26f4ba"><div class="ttname"><a href="rte__crypto_8h.html#aca76406e3f1ab04ab44dfbe4ff26f4ba">rte_crypto_op_free</a></div><div class="ttdeci">static void rte_crypto_op_free(struct rte_crypto_op *op)</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00334">rte_crypto.h:334</a></div></div>
<div class="ttc" id="arte__ether_8h_html_af1fb088707ce5b2ebb7825cb69b5cb58"><div class="ttname"><a href="rte__ether_8h.html#af1fb088707ce5b2ebb7825cb69b5cb58">RTE_ETHER_MAX_LEN</a></div><div class="ttdeci">#define RTE_ETHER_MAX_LEN</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00037">rte_ether.h:37</a></div></div>
<div class="ttc" id="astructrte__ether__hdr_html_a1d579e2782d36729c1f73608d8663124"><div class="ttname"><a href="structrte__ether__hdr.html#a1d579e2782d36729c1f73608d8663124">rte_ether_hdr::d_addr</a></div><div class="ttdeci">struct rte_ether_addr d_addr</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00000">rte_ether.h:265</a></div></div>
<div class="ttc" id="astructrte__ether__addr_html_ad6f7cb65b39d12b5250ecf82c8ffaa45"><div class="ttname"><a href="structrte__ether__addr.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">rte_ether_addr::addr_bytes</a></div><div class="ttdeci">uint8_t addr_bytes[RTE_ETHER_ADDR_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00065">rte_ether.h:65</a></div></div>
<div class="ttc" id="arte__launch_8h_html_ae9500e1d35bd4cfb95d18c0be863cb1e"><div class="ttname"><a href="rte__launch_8h.html#ae9500e1d35bd4cfb95d18c0be863cb1e">rte_eal_wait_lcore</a></div><div class="ttdeci">int rte_eal_wait_lcore(unsigned worker_id)</div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a385cf406030abf07a1581b6ae3aa03f2"><div class="ttname"><a href="rte__cryptodev_8h.html#a385cf406030abf07a1581b6ae3aa03f2">rte_cryptodev_get_auth_algo_enum</a></div><div class="ttdeci">int rte_cryptodev_get_auth_algo_enum(enum rte_crypto_auth_algorithm *algo_enum, const char *algo_string)</div></div>
<div class="ttc" id="arte__prefetch_8h_html"><div class="ttname"><a href="rte__prefetch_8h.html">rte_prefetch.h</a></div></div>
<div class="ttc" id="arte__cryptodev__scheduler_8h_html"><div class="ttname"><a href="rte__cryptodev__scheduler_8h.html">rte_cryptodev_scheduler.h</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
