<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DPDK: examples/vmdq/main.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DPDK
   &#160;<span id="projectnumber">20.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">examples/vmdq/main.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/* SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment"> * Copyright(c) 2010-2014 Intel Corporation</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/queue.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;errno.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;signal.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdarg.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;inttypes.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;getopt.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__common_8h.html">rte_common.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__log_8h.html">rte_log.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__memory_8h.html">rte_memory.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__memcpy_8h.html">rte_memcpy.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__eal_8h.html">rte_eal.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__launch_8h.html">rte_launch.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__atomic_8h.html">rte_atomic.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__cycles_8h.html">rte_cycles.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__prefetch_8h.html">rte_prefetch.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__lcore_8h.html">rte_lcore.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__per__lcore_8h.html">rte_per_lcore.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__branch__prediction_8h.html">rte_branch_prediction.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__interrupts_8h.html">rte_interrupts.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__random_8h.html">rte_random.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__debug_8h.html">rte_debug.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ether_8h.html">rte_ether.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ethdev_8h.html">rte_ethdev.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__mempool_8h.html">rte_mempool.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__mbuf_8h.html">rte_mbuf.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MAX_QUEUES 1024</span></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * 1024 queues require to meet the needs of a large number of vmdq_pools.</span></div>
<div class="line"><span class="comment"> * (RX/TX_queue_nb * RX/TX_ring_descriptors_nb) per port.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="preprocessor">#define NUM_MBUFS_PER_PORT (MAX_QUEUES * RTE_MAX(RTE_TEST_RX_DESC_DEFAULT, \</span></div>
<div class="line"><span class="preprocessor">                        RTE_TEST_TX_DESC_DEFAULT))</span></div>
<div class="line"><span class="preprocessor">#define MBUF_CACHE_SIZE 64</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MAX_PKT_BURST 32</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Configurable number of RX/TX ring descriptors</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="preprocessor">#define RTE_TEST_RX_DESC_DEFAULT 1024</span></div>
<div class="line"><span class="preprocessor">#define RTE_TEST_TX_DESC_DEFAULT 1024</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define INVALID_PORT_ID 0xFF</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* mask of enabled ports */</span></div>
<div class="line"><span class="keyword">static</span> uint32_t enabled_port_mask;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* number of pools (if user does not specify any, 8 by default */</span></div>
<div class="line"><span class="keyword">static</span> uint32_t num_queues = 8;</div>
<div class="line"><span class="keyword">static</span> uint32_t num_pools = 8;</div>
<div class="line"><span class="keyword">static</span> uint8_t rss_enable;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* empty vmdq configuration structure. Filled in programatically */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a name="_a0"></a><a class="code" href="structrte__eth__conf.html">rte_eth_conf</a> vmdq_conf_default = {</div>
<div class="line">    .<a name="a1"></a><a class="code" href="structrte__eth__conf.html#a346eef99c24f617b74c440c1aa565d01">rxmode</a> = {</div>
<div class="line">        .<a name="a2"></a><a class="code" href="structrte__eth__rxmode.html#aa0562513c4569f1aa53050f1beac6b5d">mq_mode</a>        = <a name="a3"></a><a class="code" href="rte__ethdev_8h.html#a586b8e86131b4ec0ccaf464e847ccf3ea66316d2ff53011a3209207734c124f3c">ETH_MQ_RX_VMDQ_ONLY</a>,</div>
<div class="line">        .split_hdr_size = 0,</div>
<div class="line">    },</div>
<div class="line"> </div>
<div class="line">    .txmode = {</div>
<div class="line">        .mq_mode = <a name="a4"></a><a class="code" href="rte__ethdev_8h.html#a4834f572f4dd4e46d81ad09b7d5fffd5aada568551470d5f419cd2f3d6b6bfedc">ETH_MQ_TX_NONE</a>,</div>
<div class="line">    },</div>
<div class="line">    .rx_adv_conf = {</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * should be overridden separately in code with</span></div>
<div class="line"><span class="comment">         * appropriate values</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        .vmdq_rx_conf = {</div>
<div class="line">            .nb_queue_pools = <a name="a5"></a><a class="code" href="rte__ethdev_8h.html#a012a874434677984af1f026ad585dd0da308323e3152afc591f57f613d2418eae">ETH_8_POOLS</a>,</div>
<div class="line">            .enable_default_pool = 0,</div>
<div class="line">            .default_pool = 0,</div>
<div class="line">            .nb_pool_maps = 0,</div>
<div class="line">            .pool_map = {{0, 0},},</div>
<div class="line">        },</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">unsigned</span> lcore_ids[RTE_MAX_LCORE];</div>
<div class="line"><span class="keyword">static</span> uint16_t ports[RTE_MAX_ETHPORTS];</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">unsigned</span> num_ports; </div>
<div class="line"><span class="comment">/* array used for printing out statistics */</span></div>
<div class="line"><span class="keyword">volatile</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> rxPackets[MAX_QUEUES] = {0};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> uint16_t vlan_tags[] = {</div>
<div class="line">    0,  1,  2,  3,  4,  5,  6,  7,</div>
<div class="line">    8,  9, 10, 11,  12, 13, 14, 15,</div>
<div class="line">    16, 17, 18, 19, 20, 21, 22, 23,</div>
<div class="line">    24, 25, 26, 27, 28, 29, 30, 31,</div>
<div class="line">    32, 33, 34, 35, 36, 37, 38, 39,</div>
<div class="line">    40, 41, 42, 43, 44, 45, 46, 47,</div>
<div class="line">    48, 49, 50, 51, 52, 53, 54, 55,</div>
<div class="line">    56, 57, 58, 59, 60, 61, 62, 63,</div>
<div class="line">};</div>
<div class="line"><span class="keyword">const</span> uint16_t num_vlans = <a name="a6"></a><a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(vlan_tags);</div>
<div class="line"><span class="keyword">static</span> uint16_t num_pf_queues,  num_vmdq_queues;</div>
<div class="line"><span class="keyword">static</span> uint16_t vmdq_pool_base, vmdq_queue_base;</div>
<div class="line"><span class="comment">/* pool mac addr template, pool mac addr is like: 52 54 00 12 port# pool# */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a name="_a7"></a><a class="code" href="structrte__ether__addr.html">rte_ether_addr</a> pool_addr_template = {</div>
<div class="line">    .<a name="a8"></a><a class="code" href="structrte__ether__addr.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a> = {0x52, 0x54, 0x00, 0x12, 0x00, 0x00}</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* ethernet addresses of ports */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structrte__ether__addr.html">rte_ether_addr</a> vmdq_ports_eth_addr[RTE_MAX_ETHPORTS];</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MAX_QUEUE_NUM_10G 128</span></div>
<div class="line"><span class="preprocessor">#define MAX_QUEUE_NUM_1G 8</span></div>
<div class="line"><span class="preprocessor">#define MAX_POOL_MAP_NUM_10G 64</span></div>
<div class="line"><span class="preprocessor">#define MAX_POOL_MAP_NUM_1G 32</span></div>
<div class="line"><span class="preprocessor">#define MAX_POOL_NUM_10G 64</span></div>
<div class="line"><span class="preprocessor">#define MAX_POOL_NUM_1G 8</span></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Builds up the correct configuration for vmdq based on the vlan tags array</span></div>
<div class="line"><span class="comment"> * given above, and determine the queue number and pool map number according to</span></div>
<div class="line"><span class="comment"> * valid pool number</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span></div>
<div class="line">get_eth_conf(<span class="keyword">struct</span> <a class="code" href="structrte__eth__conf.html">rte_eth_conf</a> *eth_conf, uint32_t num_pools)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a9"></a><a class="code" href="structrte__eth__vmdq__rx__conf.html">rte_eth_vmdq_rx_conf</a> conf;</div>
<div class="line">    <span class="keywordtype">unsigned</span> i;</div>
<div class="line"> </div>
<div class="line">    conf.<a name="a10"></a><a class="code" href="structrte__eth__vmdq__rx__conf.html#a1576f028debf3f0a3d4a09ee5285895c">nb_queue_pools</a> = (<span class="keyword">enum</span> <a name="a11"></a><a class="code" href="rte__ethdev_8h.html#a012a874434677984af1f026ad585dd0d">rte_eth_nb_pools</a>)num_pools;</div>
<div class="line">    conf.nb_pool_maps = num_pools;</div>
<div class="line">    conf.enable_default_pool = 0;</div>
<div class="line">    conf.default_pool = 0; <span class="comment">/* set explicit value, even if not used */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; conf.nb_pool_maps; i++) {</div>
<div class="line">        conf.pool_map[i].vlan_id = vlan_tags[i];</div>
<div class="line">        conf.pool_map[i].pools = (1UL &lt;&lt; (i % num_pools));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    (void)(<a name="a12"></a><a class="code" href="rte__memcpy_8h.html#a09f4d8cdb1a7c25398a363906e1db8cd">rte_memcpy</a>(eth_conf, &amp;vmdq_conf_default, <span class="keyword">sizeof</span>(*eth_conf)));</div>
<div class="line">    (void)(<a class="code" href="rte__memcpy_8h.html#a09f4d8cdb1a7c25398a363906e1db8cd">rte_memcpy</a>(&amp;eth_conf-&gt;<a name="a13"></a><a class="code" href="structrte__eth__conf.html#a084e132696e8d0f59f643d822c8cedb7">rx_adv_conf</a>.<a name="a14"></a><a class="code" href="structrte__eth__conf.html#a17845d02c4ddfdc09982bd899b6df06e">vmdq_rx_conf</a>, &amp;conf,</div>
<div class="line">           <span class="keyword">sizeof</span>(eth_conf-&gt;<a class="code" href="structrte__eth__conf.html#a084e132696e8d0f59f643d822c8cedb7">rx_adv_conf</a>.<a class="code" href="structrte__eth__conf.html#a17845d02c4ddfdc09982bd899b6df06e">vmdq_rx_conf</a>)));</div>
<div class="line">    <span class="keywordflow">if</span> (rss_enable) {</div>
<div class="line">        eth_conf-&gt;<a class="code" href="structrte__eth__conf.html#a346eef99c24f617b74c440c1aa565d01">rxmode</a>.<a class="code" href="structrte__eth__rxmode.html#aa0562513c4569f1aa53050f1beac6b5d">mq_mode</a> = <a name="a15"></a><a class="code" href="rte__ethdev_8h.html#a586b8e86131b4ec0ccaf464e847ccf3ea2986c2bbbe392a5e9edade916d25ab5a">ETH_MQ_RX_VMDQ_RSS</a>;</div>
<div class="line">        eth_conf-&gt;<a class="code" href="structrte__eth__conf.html#a084e132696e8d0f59f643d822c8cedb7">rx_adv_conf</a>.<a name="a16"></a><a class="code" href="structrte__eth__conf.html#addc9c7bb19ed12f1171c543493553806">rss_conf</a>.<a name="a17"></a><a class="code" href="structrte__eth__rss__conf.html#ad70f17882a835e5d4e38c64a9f872fdc">rss_hf</a> = ETH_RSS_IP |</div>
<div class="line">                            ETH_RSS_UDP |</div>
<div class="line">                            ETH_RSS_TCP |</div>
<div class="line">                            ETH_RSS_SCTP;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Initialises a given port using global settings and with the rx buffers</span></div>
<div class="line"><span class="comment"> * coming from the mbuf_pool passed as parameter</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span></div>
<div class="line">port_init(uint16_t port, <span class="keyword">struct</span> <a name="_a18"></a><a class="code" href="structrte__mempool.html">rte_mempool</a> *mbuf_pool)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a19"></a><a class="code" href="structrte__eth__dev__info.html">rte_eth_dev_info</a> dev_info;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a20"></a><a class="code" href="structrte__eth__rxconf.html">rte_eth_rxconf</a> *rxconf;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a21"></a><a class="code" href="structrte__eth__txconf.html">rte_eth_txconf</a> *txconf;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__eth__conf.html">rte_eth_conf</a> port_conf;</div>
<div class="line">    uint16_t rxRings, txRings;</div>
<div class="line">    uint16_t rxRingSize = RTE_TEST_RX_DESC_DEFAULT;</div>
<div class="line">    uint16_t txRingSize = RTE_TEST_TX_DESC_DEFAULT;</div>
<div class="line">    <span class="keywordtype">int</span> retval;</div>
<div class="line">    uint16_t q;</div>
<div class="line">    uint16_t queues_per_pool;</div>
<div class="line">    uint32_t max_nb_pools;</div>
<div class="line">    uint64_t rss_hf_tmp;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * The max pool number from dev_info will be used to validate the pool</span></div>
<div class="line"><span class="comment">     * number specified in cmd line</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    retval = <a name="a22"></a><a class="code" href="rte__ethdev_8h.html#a7593f4fff04f4ae1b1d718db7ca7dc8c">rte_eth_dev_info_get</a>(port, &amp;dev_info);</div>
<div class="line">    <span class="keywordflow">if</span> (retval != 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error during getting device (port %u) info: %s\n&quot;</span>,</div>
<div class="line">                port, strerror(-retval));</div>
<div class="line">        <span class="keywordflow">return</span> retval;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    max_nb_pools = (uint32_t)dev_info.max_vmdq_pools;</div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * We allow to process part of VMDQ pools specified by num_pools in</span></div>
<div class="line"><span class="comment">     * command line.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    if (num_pools &gt; max_nb_pools) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;num_pools %d &gt;max_nb_pools %d\n&quot;</span>,</div>
<div class="line">            num_pools, max_nb_pools);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    retval = get_eth_conf(&amp;port_conf, max_nb_pools);</div>
<div class="line">    <span class="keywordflow">if</span> (retval &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> retval;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * NIC queues are divided into pf queues and vmdq queues.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="comment">/* There is assumption here all ports have the same configuration! */</span></div>
<div class="line">    num_pf_queues = dev_info.max_rx_queues - dev_info.vmdq_queue_num;</div>
<div class="line">    queues_per_pool = dev_info.vmdq_queue_num / dev_info.max_vmdq_pools;</div>
<div class="line">    num_vmdq_queues = num_pools * queues_per_pool;</div>
<div class="line">    num_queues = num_pf_queues + num_vmdq_queues;</div>
<div class="line">    vmdq_queue_base = dev_info.vmdq_queue_base;</div>
<div class="line">    vmdq_pool_base  = dev_info.vmdq_pool_base;</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;pf queue num: %u, configured vmdq pool num: %u,&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; each vmdq pool has %u queues\n&quot;</span>,</div>
<div class="line">        num_pf_queues, num_pools, queues_per_pool);</div>
<div class="line">    printf(<span class="stringliteral">&quot;vmdq queue base: %d pool base %d\n&quot;</span>,</div>
<div class="line">        vmdq_queue_base, vmdq_pool_base);</div>
<div class="line">    <span class="keywordflow">if</span> (!<a name="a23"></a><a class="code" href="rte__ethdev_8h.html#a22dcfd3f5f2b34f657131d66132e23a7">rte_eth_dev_is_valid_port</a>(port))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    rss_hf_tmp = port_conf.rx_adv_conf.rss_conf.rss_hf;</div>
<div class="line">    port_conf.rx_adv_conf.rss_conf.rss_hf &amp;=</div>
<div class="line">        dev_info.flow_type_rss_offloads;</div>
<div class="line">    <span class="keywordflow">if</span> (port_conf.rx_adv_conf.rss_conf.rss_hf != rss_hf_tmp) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %u modified RSS hash function based on hardware support,&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;requested:%#&quot;</span>PRIx64<span class="stringliteral">&quot; configured:%#&quot;</span>PRIx64<span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line">            port,</div>
<div class="line">            rss_hf_tmp,</div>
<div class="line">            port_conf.rx_adv_conf.rss_conf.rss_hf);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Though in this example, we only receive packets from the first queue</span></div>
<div class="line"><span class="comment">     * of each pool and send packets through first rte_lcore_count() tx</span></div>
<div class="line"><span class="comment">     * queues of vmdq queues, all queues including pf queues are setup.</span></div>
<div class="line"><span class="comment">     * This is because VMDQ queues doesn&#39;t always start from zero, and the</span></div>
<div class="line"><span class="comment">     * PMD layer doesn&#39;t support selectively initialising part of rx/tx</span></div>
<div class="line"><span class="comment">     * queues.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    rxRings = (uint16_t)dev_info.max_rx_queues;</div>
<div class="line">    txRings = (uint16_t)dev_info.max_tx_queues;</div>
<div class="line"> </div>
<div class="line">    retval = <a class="code" href="rte__ethdev_8h.html#a7593f4fff04f4ae1b1d718db7ca7dc8c">rte_eth_dev_info_get</a>(port, &amp;dev_info);</div>
<div class="line">    <span class="keywordflow">if</span> (retval != 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error during getting device (port %u) info: %s\n&quot;</span>,</div>
<div class="line">                port, strerror(-retval));</div>
<div class="line">        <span class="keywordflow">return</span> retval;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (dev_info.tx_offload_capa &amp; <a name="a24"></a><a class="code" href="rte__ethdev_8h.html#ae7110b5d5dced8f42505bff5d9e3f0ea">DEV_TX_OFFLOAD_MBUF_FAST_FREE</a>)</div>
<div class="line">        port_conf.txmode.offloads |=</div>
<div class="line">            <a class="code" href="rte__ethdev_8h.html#ae7110b5d5dced8f42505bff5d9e3f0ea">DEV_TX_OFFLOAD_MBUF_FAST_FREE</a>;</div>
<div class="line">    retval = <a name="a25"></a><a class="code" href="rte__ethdev_8h.html#a1a7d3a20b102fee222541fda50fd87bd">rte_eth_dev_configure</a>(port, rxRings, txRings, &amp;port_conf);</div>
<div class="line">    <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line">        <span class="keywordflow">return</span> retval;</div>
<div class="line"> </div>
<div class="line">    retval = <a name="a26"></a><a class="code" href="rte__ethdev_8h.html#ad31219b87a1733d5b367a7c04c7f7b48">rte_eth_dev_adjust_nb_rx_tx_desc</a>(port, &amp;rxRingSize,</div>
<div class="line">                &amp;txRingSize);</div>
<div class="line">    <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line">        <span class="keywordflow">return</span> retval;</div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a27"></a><a class="code" href="rte__common_8h.html#a8df8b303b8ea240cf6aebf937fd21eaf">RTE_MAX</a>(rxRingSize, txRingSize) &gt; <a class="code" href="rte__common_8h.html#a8df8b303b8ea240cf6aebf937fd21eaf">RTE_MAX</a>(RTE_TEST_RX_DESC_DEFAULT,</div>
<div class="line">            RTE_TEST_TX_DESC_DEFAULT)) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Mbuf pool has an insufficient size for port %u.\n&quot;</span>,</div>
<div class="line">            port);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    rxconf = &amp;dev_info.default_rxconf;</div>
<div class="line">    rxconf-&gt;<a name="a28"></a><a class="code" href="structrte__eth__rxconf.html#aaccf5b8238b9207f8102d69959ac3391">rx_drop_en</a> = 1;</div>
<div class="line">    txconf = &amp;dev_info.default_txconf;</div>
<div class="line">    txconf-&gt;<a name="a29"></a><a class="code" href="structrte__eth__txconf.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a> = port_conf.txmode.offloads;</div>
<div class="line">    <span class="keywordflow">for</span> (q = 0; q &lt; rxRings; q++) {</div>
<div class="line">        retval = <a name="a30"></a><a class="code" href="rte__ethdev_8h.html#a36ba70a5a6fce2c2c1f774828ba78f8d">rte_eth_rx_queue_setup</a>(port, q, rxRingSize,</div>
<div class="line">                    <a name="a31"></a><a class="code" href="rte__ethdev_8h.html#ad032e25f712e6ffeb0c19eab1ec1fd2e">rte_eth_dev_socket_id</a>(port),</div>
<div class="line">                    rxconf,</div>
<div class="line">                    mbuf_pool);</div>
<div class="line">        <span class="keywordflow">if</span> (retval &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;initialise rx queue %d failed\n&quot;</span>, q);</div>
<div class="line">            <span class="keywordflow">return</span> retval;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (q = 0; q &lt; txRings; q++) {</div>
<div class="line">        retval = <a name="a32"></a><a class="code" href="rte__ethdev_8h.html#a796c2f20778984c6f41b271e36bae50e">rte_eth_tx_queue_setup</a>(port, q, txRingSize,</div>
<div class="line">                    <a class="code" href="rte__ethdev_8h.html#ad032e25f712e6ffeb0c19eab1ec1fd2e">rte_eth_dev_socket_id</a>(port),</div>
<div class="line">                    txconf);</div>
<div class="line">        <span class="keywordflow">if</span> (retval &lt; 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;initialise tx queue %d failed\n&quot;</span>, q);</div>
<div class="line">            <span class="keywordflow">return</span> retval;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    retval  = <a name="a33"></a><a class="code" href="rte__ethdev_8h.html#afdc834c1c52e9fb512301990468ca7c2">rte_eth_dev_start</a>(port);</div>
<div class="line">    <span class="keywordflow">if</span> (retval &lt; 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;port %d start failed\n&quot;</span>, port);</div>
<div class="line">        <span class="keywordflow">return</span> retval;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    retval = <a name="a34"></a><a class="code" href="rte__ethdev_8h.html#a8a28375b279ded9125c99a46bf3956ef">rte_eth_macaddr_get</a>(port, &amp;vmdq_ports_eth_addr[port]);</div>
<div class="line">    <span class="keywordflow">if</span> (retval &lt; 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;port %d MAC address get failed: %s\n&quot;</span>, port,</div>
<div class="line">               <a name="a35"></a><a class="code" href="rte__errno_8h.html#a129a7eb4cfa1f5bdac5783bf49137d06">rte_strerror</a>(-retval));</div>
<div class="line">        <span class="keywordflow">return</span> retval;</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;Port %u MAC: %02&quot;</span>PRIx8<span class="stringliteral">&quot; %02&quot;</span>PRIx8<span class="stringliteral">&quot; %02&quot;</span>PRIx8</div>
<div class="line">            <span class="stringliteral">&quot; %02&quot;</span>PRIx8<span class="stringliteral">&quot; %02&quot;</span>PRIx8<span class="stringliteral">&quot; %02&quot;</span>PRIx8<span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line">            (<span class="keywordtype">unsigned</span>)port,</div>
<div class="line">            vmdq_ports_eth_addr[port].<a name="a36"></a><a class="code" href="rte__ether_8h.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[0],</div>
<div class="line">            vmdq_ports_eth_addr[port].<a class="code" href="rte__ether_8h.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[1],</div>
<div class="line">            vmdq_ports_eth_addr[port].<a class="code" href="rte__ether_8h.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[2],</div>
<div class="line">            vmdq_ports_eth_addr[port].<a class="code" href="rte__ether_8h.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[3],</div>
<div class="line">            vmdq_ports_eth_addr[port].<a class="code" href="rte__ether_8h.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[4],</div>
<div class="line">            vmdq_ports_eth_addr[port].<a class="code" href="rte__ether_8h.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[5]);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Set mac for each pool.</span></div>
<div class="line"><span class="comment">     * There is no default mac for the pools in i40.</span></div>
<div class="line"><span class="comment">     * Removes this after i40e fixes this issue.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordflow">for</span> (q = 0; q &lt; num_pools; q++) {</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structrte__ether__addr.html">rte_ether_addr</a> mac;</div>
<div class="line">        mac = pool_addr_template;</div>
<div class="line">        mac.<a class="code" href="structrte__ether__addr.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[4] = port;</div>
<div class="line">        mac.addr_bytes[5] = q;</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %u vmdq pool %u set mac %02x:%02x:%02x:%02x:%02x:%02x\n&quot;</span>,</div>
<div class="line">            port, q,</div>
<div class="line">            mac.addr_bytes[0], mac.addr_bytes[1],</div>
<div class="line">            mac.addr_bytes[2], mac.addr_bytes[3],</div>
<div class="line">            mac.addr_bytes[4], mac.addr_bytes[5]);</div>
<div class="line">        retval = <a name="a37"></a><a class="code" href="rte__ethdev_8h.html#aae1a98a4ba67296647a29abb8cce1031">rte_eth_dev_mac_addr_add</a>(port, &amp;mac,</div>
<div class="line">                q + vmdq_pool_base);</div>
<div class="line">        <span class="keywordflow">if</span> (retval) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;mac addr add failed at pool %d\n&quot;</span>, q);</div>
<div class="line">            <span class="keywordflow">return</span> retval;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Check num_pools parameter and set it if OK*/</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">vmdq_parse_num_pools(<span class="keyword">const</span> <span class="keywordtype">char</span> *q_arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *end = NULL;</div>
<div class="line">    <span class="keywordtype">int</span> n;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* parse number string */</span></div>
<div class="line">    n = strtol(q_arg, &amp;end, 10);</div>
<div class="line">    <span class="keywordflow">if</span> ((q_arg[0] == <span class="charliteral">&#39;\0&#39;</span>) || (end == NULL) || (*end != <span class="charliteral">&#39;\0&#39;</span>))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (num_pools &gt; num_vlans) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;num_pools %d &gt; num_vlans %d\n&quot;</span>, num_pools, num_vlans);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    num_pools = n;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_portmask(<span class="keyword">const</span> <span class="keywordtype">char</span> *portmask)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *end = NULL;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> pm;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* parse hexadecimal string */</span></div>
<div class="line">    pm = strtoul(portmask, &amp;end, 16);</div>
<div class="line">    <span class="keywordflow">if</span> ((portmask[0] == <span class="charliteral">&#39;\0&#39;</span>) || (end == NULL) || (*end != <span class="charliteral">&#39;\0&#39;</span>))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> pm;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Display usage */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">vmdq_usage(<span class="keyword">const</span> <span class="keywordtype">char</span> *prgname)</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;%s [EAL options] -- -p PORTMASK]\n&quot;</span></div>
<div class="line">    <span class="stringliteral">&quot;  --nb-pools NP: number of pools\n&quot;</span></div>
<div class="line">    <span class="stringliteral">&quot;  --enable-rss: enable RSS (disabled by default)\n&quot;</span>,</div>
<div class="line">           prgname);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*  Parse the argument (num_pools) given in the command line of the application */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">vmdq_parse_args(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> opt;</div>
<div class="line">    <span class="keywordtype">int</span> option_index;</div>
<div class="line">    <span class="keywordtype">unsigned</span> i;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *prgname = argv[0];</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">struct </span>option long_option[] = {</div>
<div class="line">        {<span class="stringliteral">&quot;nb-pools&quot;</span>, required_argument, NULL, 0},</div>
<div class="line">        {<span class="stringliteral">&quot;enable-rss&quot;</span>, 0, NULL, 0},</div>
<div class="line">        {NULL, 0, 0, 0}</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Parse command line */</span></div>
<div class="line">    <span class="keywordflow">while</span> ((opt = getopt_long(argc, argv, <span class="stringliteral">&quot;p:&quot;</span>, long_option,</div>
<div class="line">        &amp;option_index)) != EOF) {</div>
<div class="line">        <span class="keywordflow">switch</span> (opt) {</div>
<div class="line">        <span class="comment">/* portmask */</span></div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>:</div>
<div class="line">            enabled_port_mask = parse_portmask(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (enabled_port_mask == 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;invalid portmask\n&quot;</span>);</div>
<div class="line">                vmdq_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">            <span class="keywordflow">if</span> (!strcmp(long_option[option_index].name,</div>
<div class="line">                <span class="stringliteral">&quot;nb-pools&quot;</span>)) {</div>
<div class="line">                <span class="keywordflow">if</span> (vmdq_parse_num_pools(optarg) == -1) {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;invalid number of pools\n&quot;</span>);</div>
<div class="line">                    vmdq_usage(prgname);</div>
<div class="line">                    <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (!strcmp(long_option[option_index].name,</div>
<div class="line">                <span class="stringliteral">&quot;enable-rss&quot;</span>))</div>
<div class="line">                rss_enable = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            vmdq_usage(prgname);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; RTE_MAX_ETHPORTS; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (enabled_port_mask &amp; (1 &lt;&lt; i))</div>
<div class="line">            ports[num_ports++] = (uint8_t)i;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (num_ports &lt; 2 || num_ports % 2) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Current enabled port number is %u,&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;but it should be even and at least 2\n&quot;</span>, num_ports);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">update_mac_address(<span class="keyword">struct</span> <a name="_a38"></a><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m, <span class="keywordtype">unsigned</span> dst_port)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a39"></a><a class="code" href="structrte__ether__hdr.html">rte_ether_hdr</a> *eth;</div>
<div class="line">    <span class="keywordtype">void</span> *tmp;</div>
<div class="line"> </div>
<div class="line">    eth = <a name="a40"></a><a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(m, <span class="keyword">struct</span> <a class="code" href="structrte__ether__hdr.html">rte_ether_hdr</a> *);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* 02:00:00:00:00:xx */</span></div>
<div class="line">    tmp = &amp;eth-&gt;<a name="a41"></a><a class="code" href="structrte__ether__hdr.html#a1d579e2782d36729c1f73608d8663124">d_addr</a>.<a class="code" href="structrte__ether__addr.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[0];</div>
<div class="line">    *((uint64_t *)tmp) = 0x000000000002 + ((uint64_t)dst_port &lt;&lt; 40);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* src addr */</span></div>
<div class="line">    <a name="a42"></a><a class="code" href="rte__ether_8h.html#af5e7040b36584eacec1c5b9eee086eac">rte_ether_addr_copy</a>(&amp;vmdq_ports_eth_addr[dst_port], &amp;eth-&gt;<a name="a43"></a><a class="code" href="structrte__ether__hdr.html#acce632e0fded0f728a1ee1a1ffb5c9bf">s_addr</a>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* When we receive a HUP signal, print out our stats */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">sighup_handler(<span class="keywordtype">int</span> signum)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = vmdq_queue_base;</div>
<div class="line">    <span class="keywordflow">for</span> (; q &lt; num_queues; q++) {</div>
<div class="line">        <span class="keywordflow">if</span> ((q - vmdq_queue_base) % (num_vmdq_queues / num_pools) == 0)</div>
<div class="line">            printf(<span class="stringliteral">&quot;\nPool %u: &quot;</span>, (q - vmdq_queue_base) /</div>
<div class="line">                   (num_vmdq_queues / num_pools));</div>
<div class="line">        printf(<span class="stringliteral">&quot;%lu &quot;</span>, rxPackets[q]);</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;\nFinished handling signal %d\n&quot;</span>, signum);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Main thread that does the work, reading from INPUT_PORT</span></div>
<div class="line"><span class="comment"> * and writing to OUTPUT_PORT</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">lcore_main(<a name="a44"></a><a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *dummy)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> uint16_t lcore_id = (uint16_t)<a name="a45"></a><a class="code" href="rte__lcore_8h.html#adfb2b334e7e73f534f25e8888a8a775f">rte_lcore_id</a>();</div>
<div class="line">    <span class="keyword">const</span> uint16_t num_cores = (uint16_t)<a name="a46"></a><a class="code" href="rte__lcore_8h.html#a1728dc7f14571ba778d3b5b41aa09283">rte_lcore_count</a>();</div>
<div class="line">    uint16_t core_id = 0;</div>
<div class="line">    uint16_t startQueue, endQueue;</div>
<div class="line">    uint16_t q, i, p;</div>
<div class="line">    <span class="keyword">const</span> uint16_t remainder = (uint16_t)(num_vmdq_queues % num_cores);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; num_cores; i++)</div>
<div class="line">        <span class="keywordflow">if</span> (lcore_ids[i] == lcore_id) {</div>
<div class="line">            core_id = i;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (remainder != 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (core_id &lt; remainder) {</div>
<div class="line">            startQueue = (uint16_t)(core_id *</div>
<div class="line">                    (num_vmdq_queues / num_cores + 1));</div>
<div class="line">            endQueue = (uint16_t)(startQueue +</div>
<div class="line">                    (num_vmdq_queues / num_cores) + 1);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            startQueue = (uint16_t)(core_id *</div>
<div class="line">                    (num_vmdq_queues / num_cores) +</div>
<div class="line">                    remainder);</div>
<div class="line">            endQueue = (uint16_t)(startQueue +</div>
<div class="line">                    (num_vmdq_queues / num_cores));</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        startQueue = (uint16_t)(core_id *</div>
<div class="line">                (num_vmdq_queues / num_cores));</div>
<div class="line">        endQueue = (uint16_t)(startQueue +</div>
<div class="line">                (num_vmdq_queues / num_cores));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* vmdq queue idx doesn&#39;t always start from zero.*/</span></div>
<div class="line">    startQueue += vmdq_queue_base;</div>
<div class="line">    endQueue   += vmdq_queue_base;</div>
<div class="line">    printf(<span class="stringliteral">&quot;core %u(lcore %u) reading queues %i-%i\n&quot;</span>, (<span class="keywordtype">unsigned</span>)core_id,</div>
<div class="line">        (<span class="keywordtype">unsigned</span>)lcore_id, startQueue, endQueue - 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (startQueue == endQueue) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;lcore %u has nothing to do\n&quot;</span>, lcore_id);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (;;) {</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *buf[MAX_PKT_BURST];</div>
<div class="line">        <span class="keyword">const</span> uint16_t buf_size = <a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(buf);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (p = 0; p &lt; num_ports; p++) {</div>
<div class="line">            <span class="keyword">const</span> uint8_t sport = ports[p];</div>
<div class="line">            <span class="comment">/* 0 &lt;-&gt; 1, 2 &lt;-&gt; 3 etc */</span></div>
<div class="line">            <span class="keyword">const</span> uint8_t dport = ports[p ^ 1];</div>
<div class="line">            <span class="keywordflow">if</span> ((sport == INVALID_PORT_ID) || (dport == INVALID_PORT_ID))</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (q = startQueue; q &lt; endQueue; q++) {</div>
<div class="line">                <span class="keyword">const</span> uint16_t rxCount = <a name="a47"></a><a class="code" href="rte__ethdev_8h.html#a3e7d76a451b46348686ea97d6367f102">rte_eth_rx_burst</a>(sport,</div>
<div class="line">                    q, buf, buf_size);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (<a name="a48"></a><a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(rxCount == 0))</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">                rxPackets[q] += rxCount;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (i = 0; i &lt; rxCount; i++)</div>
<div class="line">                    update_mac_address(buf[i], dport);</div>
<div class="line"> </div>
<div class="line">                <span class="keyword">const</span> uint16_t txCount = <a name="a49"></a><a class="code" href="rte__ethdev_8h.html#a83e56cabbd31637efd648e3fc010392b">rte_eth_tx_burst</a>(dport,</div>
<div class="line">                    vmdq_queue_base + core_id,</div>
<div class="line">                    buf,</div>
<div class="line">                    rxCount);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (txCount != rxCount) {</div>
<div class="line">                    <span class="keywordflow">for</span> (i = txCount; i &lt; rxCount; i++)</div>
<div class="line">                        <a name="a50"></a><a class="code" href="rte__mbuf_8h.html#a1215458932900b7cd5192326fa4a6902">rte_pktmbuf_free</a>(buf[i]);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Update the global var NUM_PORTS and array PORTS according to system ports number</span></div>
<div class="line"><span class="comment"> * and return valid ports number</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">unsigned</span> check_ports_num(<span class="keywordtype">unsigned</span> nb_ports)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">unsigned</span> valid_num_ports = num_ports;</div>
<div class="line">    <span class="keywordtype">unsigned</span> portid;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (num_ports &gt; nb_ports) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;\nSpecified port number(%u) exceeds total system port number(%u)\n&quot;</span>,</div>
<div class="line">            num_ports, nb_ports);</div>
<div class="line">        num_ports = nb_ports;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (portid = 0; portid &lt; num_ports; portid++) {</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="rte__ethdev_8h.html#a22dcfd3f5f2b34f657131d66132e23a7">rte_eth_dev_is_valid_port</a>(ports[portid])) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;\nSpecified port ID(%u) is not valid\n&quot;</span>,</div>
<div class="line">                ports[portid]);</div>
<div class="line">            ports[portid] = INVALID_PORT_ID;</div>
<div class="line">            valid_num_ports--;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> valid_num_ports;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Main function, does initialisation and calls the per-lcore functions */</span></div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mempool.html">rte_mempool</a> *mbuf_pool;</div>
<div class="line">    <span class="keywordtype">unsigned</span> lcore_id, core_id = 0;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line">    <span class="keywordtype">unsigned</span> nb_ports, valid_num_ports;</div>
<div class="line">    uint16_t portid;</div>
<div class="line"> </div>
<div class="line">    signal(SIGHUP, sighup_handler);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* init EAL */</span></div>
<div class="line">    ret = <a name="a51"></a><a class="code" href="rte__eal_8h.html#a5c3f4dddc25e38c5a186ecd8a69260e3">rte_eal_init</a>(argc, argv);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <a name="a52"></a><a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Error with EAL initialization\n&quot;</span>);</div>
<div class="line">    argc -= ret;</div>
<div class="line">    argv += ret;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* parse app arguments */</span></div>
<div class="line">    ret = vmdq_parse_args(argc, argv);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Invalid VMDQ argument\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (lcore_id = 0; lcore_id &lt; RTE_MAX_LCORE; lcore_id++)</div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a53"></a><a class="code" href="rte__lcore_8h.html#a5404ee6ac26cbe5a4f4ddef44d690b76">rte_lcore_is_enabled</a>(lcore_id))</div>
<div class="line">            lcore_ids[core_id++] = lcore_id;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__lcore_8h.html#a1728dc7f14571ba778d3b5b41aa09283">rte_lcore_count</a>() &gt; RTE_MAX_LCORE)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Not enough cores\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    nb_ports = <a name="a54"></a><a class="code" href="rte__ethdev_8h.html#a9ab708089665bebcd65cefe5383b24f2">rte_eth_dev_count_avail</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Update the global var NUM_PORTS and global array PORTS</span></div>
<div class="line"><span class="comment">     * and get value of var VALID_NUM_PORTS according to system ports number</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    valid_num_ports = check_ports_num(nb_ports);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (valid_num_ports &lt; 2 || valid_num_ports % 2) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Current valid ports number is %u\n&quot;</span>, valid_num_ports);</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Error with valid ports number is not even or less than 2\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    mbuf_pool = <a name="a55"></a><a class="code" href="rte__mbuf_8h.html#a593921f13307803b94bbb4e0932db962">rte_pktmbuf_pool_create</a>(<span class="stringliteral">&quot;MBUF_POOL&quot;</span>,</div>
<div class="line">        NUM_MBUFS_PER_PORT * nb_ports, MBUF_CACHE_SIZE,</div>
<div class="line">        0, RTE_MBUF_DEFAULT_BUF_SIZE, <a name="a56"></a><a class="code" href="rte__lcore_8h.html#a7c8da4664df26a64cf05dc508a4f26df">rte_socket_id</a>());</div>
<div class="line">    <span class="keywordflow">if</span> (mbuf_pool == NULL)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Cannot create mbuf pool\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* initialize all ports */</span></div>
<div class="line">    <a name="a57"></a><a class="code" href="rte__ethdev_8h.html#ad7b46c67203d37fe3a34f11076d970d6">RTE_ETH_FOREACH_DEV</a>(portid) {</div>
<div class="line">        <span class="comment">/* skip ports that are not enabled */</span></div>
<div class="line">        <span class="keywordflow">if</span> ((enabled_port_mask &amp; (1 &lt;&lt; portid)) == 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;\nSkipping disabled port %d\n&quot;</span>, portid);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (port_init(portid, mbuf_pool) != 0)</div>
<div class="line">            <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Cannot initialize network ports\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* call lcore_main() on every lcore */</span></div>
<div class="line">    <a name="a58"></a><a class="code" href="rte__launch_8h.html#acc0b1cfdc31fa73329acd51dcea31210">rte_eal_mp_remote_launch</a>(lcore_main, NULL, <a name="a59"></a><a class="code" href="rte__launch_8h.html#a7fe96b0e5d3a6a8cf9b8d1a27cf3f159ad00c59bb386320b2ba3198d3149a0c35">CALL_MAIN</a>);</div>
<div class="line">    <a name="a60"></a><a class="code" href="rte__lcore_8h.html#ac779e61584eb9d087c3e20bf2d1150c8">RTE_LCORE_FOREACH_WORKER</a>(lcore_id) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a61"></a><a class="code" href="rte__launch_8h.html#ae9500e1d35bd4cfb95d18c0be863cb1e">rte_eal_wait_lcore</a>(lcore_id) &lt; 0)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="arte__ethdev_8h_html_a586b8e86131b4ec0ccaf464e847ccf3ea2986c2bbbe392a5e9edade916d25ab5a"><div class="ttname"><a href="rte__ethdev_8h.html#a586b8e86131b4ec0ccaf464e847ccf3ea2986c2bbbe392a5e9edade916d25ab5a">ETH_MQ_RX_VMDQ_RSS</a></div><div class="ttdeci">@ ETH_MQ_RX_VMDQ_RSS</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00364">rte_ethdev.h:364</a></div></div>
<div class="ttc" id="arte__common_8h_html_a8df8b303b8ea240cf6aebf937fd21eaf"><div class="ttname"><a href="rte__common_8h.html#a8df8b303b8ea240cf6aebf937fd21eaf">RTE_MAX</a></div><div class="ttdeci">#define RTE_MAX(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00583">rte_common.h:583</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_ad31219b87a1733d5b367a7c04c7f7b48"><div class="ttname"><a href="rte__ethdev_8h.html#ad31219b87a1733d5b367a7c04c7f7b48">rte_eth_dev_adjust_nb_rx_tx_desc</a></div><div class="ttdeci">int rte_eth_dev_adjust_nb_rx_tx_desc(uint16_t port_id, uint16_t *nb_rx_desc, uint16_t *nb_tx_desc)</div></div>
<div class="ttc" id="astructrte__ether__hdr_html_acce632e0fded0f728a1ee1a1ffb5c9bf"><div class="ttname"><a href="structrte__ether__hdr.html#acce632e0fded0f728a1ee1a1ffb5c9bf">rte_ether_hdr::s_addr</a></div><div class="ttdeci">struct rte_ether_addr s_addr</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00000">rte_ether.h:266</a></div></div>
<div class="ttc" id="astructrte__eth__rxconf_html"><div class="ttname"><a href="structrte__eth__rxconf.html">rte_eth_rxconf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01032">rte_ethdev.h:1032</a></div></div>
<div class="ttc" id="arte__lcore_8h_html_a5404ee6ac26cbe5a4f4ddef44d690b76"><div class="ttname"><a href="rte__lcore_8h.html#a5404ee6ac26cbe5a4f4ddef44d690b76">rte_lcore_is_enabled</a></div><div class="ttdeci">int rte_lcore_is_enabled(unsigned int lcore_id)</div></div>
<div class="ttc" id="arte__memory_8h_html"><div class="ttname"><a href="rte__memory_8h.html">rte_memory.h</a></div></div>
<div class="ttc" id="arte__branch__prediction_8h_html_ac6c45889010c1bd68631771b64f18101"><div class="ttname"><a href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a></div><div class="ttdeci">#define unlikely(x)</div><div class="ttdef"><b>Definition:</b> <a href="rte__branch__prediction_8h_source.html#l00038">rte_branch_prediction.h:38</a></div></div>
<div class="ttc" id="arte__launch_8h_html_acc0b1cfdc31fa73329acd51dcea31210"><div class="ttname"><a href="rte__launch_8h.html#acc0b1cfdc31fa73329acd51dcea31210">rte_eal_mp_remote_launch</a></div><div class="ttdeci">int rte_eal_mp_remote_launch(lcore_function_t *f, void *arg, enum rte_rmt_call_main_t call_main)</div></div>
<div class="ttc" id="arte__lcore_8h_html"><div class="ttname"><a href="rte__lcore_8h.html">rte_lcore.h</a></div></div>
<div class="ttc" id="arte__lcore_8h_html_a7c8da4664df26a64cf05dc508a4f26df"><div class="ttname"><a href="rte__lcore_8h.html#a7c8da4664df26a64cf05dc508a4f26df">rte_socket_id</a></div><div class="ttdeci">unsigned int rte_socket_id(void)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a4834f572f4dd4e46d81ad09b7d5fffd5aada568551470d5f419cd2f3d6b6bfedc"><div class="ttname"><a href="rte__ethdev_8h.html#a4834f572f4dd4e46d81ad09b7d5fffd5aada568551470d5f419cd2f3d6b6bfedc">ETH_MQ_TX_NONE</a></div><div class="ttdeci">@ ETH_MQ_TX_NONE</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00384">rte_ethdev.h:384</a></div></div>
<div class="ttc" id="astructrte__eth__vmdq__rx__conf_html_a1576f028debf3f0a3d4a09ee5285895c"><div class="ttname"><a href="structrte__eth__vmdq__rx__conf.html#a1576f028debf3f0a3d4a09ee5285895c">rte_eth_vmdq_rx_conf::nb_queue_pools</a></div><div class="ttdeci">enum rte_eth_nb_pools nb_queue_pools</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00912">rte_ethdev.h:937</a></div></div>
<div class="ttc" id="arte__log_8h_html"><div class="ttname"><a href="rte__log_8h.html">rte_log.h</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a796c2f20778984c6f41b271e36bae50e"><div class="ttname"><a href="rte__ethdev_8h.html#a796c2f20778984c6f41b271e36bae50e">rte_eth_tx_queue_setup</a></div><div class="ttdeci">int rte_eth_tx_queue_setup(uint16_t port_id, uint16_t tx_queue_id, uint16_t nb_tx_desc, unsigned int socket_id, const struct rte_eth_txconf *tx_conf)</div></div>
<div class="ttc" id="astructrte__eth__txconf_html"><div class="ttname"><a href="structrte__eth__txconf.html">rte_eth_txconf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01060">rte_ethdev.h:1060</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a1a7d3a20b102fee222541fda50fd87bd"><div class="ttname"><a href="rte__ethdev_8h.html#a1a7d3a20b102fee222541fda50fd87bd">rte_eth_dev_configure</a></div><div class="ttdeci">int rte_eth_dev_configure(uint16_t port_id, uint16_t nb_rx_queue, uint16_t nb_tx_queue, const struct rte_eth_conf *eth_conf)</div></div>
<div class="ttc" id="arte__errno_8h_html_a129a7eb4cfa1f5bdac5783bf49137d06"><div class="ttname"><a href="rte__errno_8h.html#a129a7eb4cfa1f5bdac5783bf49137d06">rte_strerror</a></div><div class="ttdeci">const char * rte_strerror(int errnum)</div></div>
<div class="ttc" id="arte__interrupts_8h_html"><div class="ttname"><a href="rte__interrupts_8h.html">rte_interrupts.h</a></div></div>
<div class="ttc" id="astructrte__eth__conf_html_a346eef99c24f617b74c440c1aa565d01"><div class="ttname"><a href="structrte__eth__conf.html#a346eef99c24f617b74c440c1aa565d01">rte_eth_conf::rxmode</a></div><div class="ttdeci">struct rte_eth_rxmode rxmode</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01294">rte_ethdev.h:1301</a></div></div>
<div class="ttc" id="arte__branch__prediction_8h_html"><div class="ttname"><a href="rte__branch__prediction_8h.html">rte_branch_prediction.h</a></div></div>
<div class="ttc" id="arte__eal_8h_html"><div class="ttname"><a href="rte__eal_8h.html">rte_eal.h</a></div></div>
<div class="ttc" id="astructrte__eth__rxmode_html_aa0562513c4569f1aa53050f1beac6b5d"><div class="ttname"><a href="structrte__eth__rxmode.html#aa0562513c4569f1aa53050f1beac6b5d">rte_eth_rxmode::mq_mode</a></div><div class="ttdeci">enum rte_eth_rx_mq_mode mq_mode</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00336">rte_ethdev.h:402</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a3e7d76a451b46348686ea97d6367f102"><div class="ttname"><a href="rte__ethdev_8h.html#a3e7d76a451b46348686ea97d6367f102">rte_eth_rx_burst</a></div><div class="ttdeci">static uint16_t rte_eth_rx_burst(uint16_t port_id, uint16_t queue_id, struct rte_mbuf **rx_pkts, const uint16_t nb_pkts)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l04834">rte_ethdev.h:4834</a></div></div>
<div class="ttc" id="arte__memcpy_8h_html_a09f4d8cdb1a7c25398a363906e1db8cd"><div class="ttname"><a href="rte__memcpy_8h.html#a09f4d8cdb1a7c25398a363906e1db8cd">rte_memcpy</a></div><div class="ttdeci">static void * rte_memcpy(void *dst, const void *src, size_t n)</div></div>
<div class="ttc" id="arte__ether_8h_html_ad6f7cb65b39d12b5250ecf82c8ffaa45"><div class="ttname"><a href="rte__ether_8h.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a></div><div class="ttdeci">uint8_t addr_bytes[RTE_ETHER_ADDR_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00000">rte_ether.h:0</a></div></div>
<div class="ttc" id="arte__ether_8h_html"><div class="ttname"><a href="rte__ether_8h.html">rte_ether.h</a></div></div>
<div class="ttc" id="astructrte__mbuf_html"><div class="ttname"><a href="structrte__mbuf.html">rte_mbuf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00473">rte_mbuf_core.h:473</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a7593f4fff04f4ae1b1d718db7ca7dc8c"><div class="ttname"><a href="rte__ethdev_8h.html#a7593f4fff04f4ae1b1d718db7ca7dc8c">rte_eth_dev_info_get</a></div><div class="ttdeci">int rte_eth_dev_info_get(uint16_t port_id, struct rte_eth_dev_info *dev_info)</div></div>
<div class="ttc" id="arte__atomic_8h_html"><div class="ttname"><a href="rte__atomic_8h.html">rte_atomic.h</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a22dcfd3f5f2b34f657131d66132e23a7"><div class="ttname"><a href="rte__ethdev_8h.html#a22dcfd3f5f2b34f657131d66132e23a7">rte_eth_dev_is_valid_port</a></div><div class="ttdeci">int rte_eth_dev_is_valid_port(uint16_t port_id)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a8a28375b279ded9125c99a46bf3956ef"><div class="ttname"><a href="rte__ethdev_8h.html#a8a28375b279ded9125c99a46bf3956ef">rte_eth_macaddr_get</a></div><div class="ttdeci">int rte_eth_macaddr_get(uint16_t port_id, struct rte_ether_addr *mac_addr)</div></div>
<div class="ttc" id="arte__common_8h_html_ac5169870c983b3463cb226bdb8a94880"><div class="ttname"><a href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a></div><div class="ttdeci">__rte_noreturn void rte_exit(int exit_code, const char *format,...) __rte_format_printf(2</div></div>
<div class="ttc" id="arte__lcore_8h_html_a1728dc7f14571ba778d3b5b41aa09283"><div class="ttname"><a href="rte__lcore_8h.html#a1728dc7f14571ba778d3b5b41aa09283">rte_lcore_count</a></div><div class="ttdeci">unsigned int rte_lcore_count(void)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a83e56cabbd31637efd648e3fc010392b"><div class="ttname"><a href="rte__ethdev_8h.html#a83e56cabbd31637efd648e3fc010392b">rte_eth_tx_burst</a></div><div class="ttdeci">static uint16_t rte_eth_tx_burst(uint16_t port_id, uint16_t queue_id, struct rte_mbuf **tx_pkts, uint16_t nb_pkts)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l05112">rte_ethdev.h:5112</a></div></div>
<div class="ttc" id="arte__lcore_8h_html_adfb2b334e7e73f534f25e8888a8a775f"><div class="ttname"><a href="rte__lcore_8h.html#adfb2b334e7e73f534f25e8888a8a775f">rte_lcore_id</a></div><div class="ttdeci">static unsigned rte_lcore_id(void)</div><div class="ttdef"><b>Definition:</b> <a href="rte__lcore_8h_source.html#l00075">rte_lcore.h:75</a></div></div>
<div class="ttc" id="arte__cycles_8h_html"><div class="ttname"><a href="rte__cycles_8h.html">rte_cycles.h</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_ae7110b5d5dced8f42505bff5d9e3f0ea"><div class="ttname"><a href="rte__ethdev_8h.html#ae7110b5d5dced8f42505bff5d9e3f0ea">DEV_TX_OFFLOAD_MBUF_FAST_FREE</a></div><div class="ttdeci">#define DEV_TX_OFFLOAD_MBUF_FAST_FREE</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01401">rte_ethdev.h:1397</a></div></div>
<div class="ttc" id="arte__common_8h_html_ac963da91b35efa4700b73a1f4eb1d8a6"><div class="ttname"><a href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a></div><div class="ttdeci">#define RTE_DIM(a)</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00809">rte_common.h:809</a></div></div>
<div class="ttc" id="astructrte__eth__txconf_html_a6cfe3b3ee46e9a8b8c62a64294b0b564"><div class="ttname"><a href="structrte__eth__txconf.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">rte_eth_txconf::offloads</a></div><div class="ttdeci">uint64_t offloads</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01072">rte_ethdev.h:1072</a></div></div>
<div class="ttc" id="astructrte__eth__rss__conf_html_ad70f17882a835e5d4e38c64a9f872fdc"><div class="ttname"><a href="structrte__eth__rss__conf.html#ad70f17882a835e5d4e38c64a9f872fdc">rte_eth_rss_conf::rss_hf</a></div><div class="ttdeci">uint64_t rss_hf</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00457">rte_ethdev.h:457</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_a2a8b10263496c7b580e9d0c7f2a1f073"><div class="ttname"><a href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a></div><div class="ttdeci">#define rte_pktmbuf_mtod(m, t)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00726">rte_mbuf_core.h:726</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_afdc834c1c52e9fb512301990468ca7c2"><div class="ttname"><a href="rte__ethdev_8h.html#afdc834c1c52e9fb512301990468ca7c2">rte_eth_dev_start</a></div><div class="ttdeci">int rte_eth_dev_start(uint16_t port_id)</div></div>
<div class="ttc" id="arte__ether_8h_html_af5e7040b36584eacec1c5b9eee086eac"><div class="ttname"><a href="rte__ether_8h.html#af5e7040b36584eacec1c5b9eee086eac">rte_ether_addr_copy</a></div><div class="ttdeci">static void rte_ether_addr_copy(const struct rte_ether_addr *__restrict ea_from, struct rte_ether_addr *__restrict ea_to)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00222">rte_ether.h:222</a></div></div>
<div class="ttc" id="arte__random_8h_html"><div class="ttname"><a href="rte__random_8h.html">rte_random.h</a></div></div>
<div class="ttc" id="astructrte__ether__hdr_html"><div class="ttname"><a href="structrte__ether__hdr.html">rte_ether_hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00264">rte_ether.h:264</a></div></div>
<div class="ttc" id="arte__common_8h_html"><div class="ttname"><a href="rte__common_8h.html">rte_common.h</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a9ab708089665bebcd65cefe5383b24f2"><div class="ttname"><a href="rte__ethdev_8h.html#a9ab708089665bebcd65cefe5383b24f2">rte_eth_dev_count_avail</a></div><div class="ttdeci">uint16_t rte_eth_dev_count_avail(void)</div></div>
<div class="ttc" id="astructrte__eth__vmdq__rx__conf_html"><div class="ttname"><a href="structrte__eth__vmdq__rx__conf.html">rte_eth_vmdq_rx_conf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00936">rte_ethdev.h:936</a></div></div>
<div class="ttc" id="arte__debug_8h_html"><div class="ttname"><a href="rte__debug_8h.html">rte_debug.h</a></div></div>
<div class="ttc" id="arte__common_8h_html_ae1a7c8799cb57669ae2ddf367b21533f"><div class="ttname"><a href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a></div><div class="ttdeci">#define __rte_unused</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00116">rte_common.h:116</a></div></div>
<div class="ttc" id="arte__memcpy_8h_html"><div class="ttname"><a href="rte__memcpy_8h.html">rte_memcpy.h</a></div></div>
<div class="ttc" id="arte__eal_8h_html_a5c3f4dddc25e38c5a186ecd8a69260e3"><div class="ttname"><a href="rte__eal_8h.html#a5c3f4dddc25e38c5a186ecd8a69260e3">rte_eal_init</a></div><div class="ttdeci">int rte_eal_init(int argc, char **argv)</div></div>
<div class="ttc" id="astructrte__mempool_html"><div class="ttname"><a href="structrte__mempool.html">rte_mempool</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__mempool_8h_source.html#l00207">rte_mempool.h:207</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a012a874434677984af1f026ad585dd0da308323e3152afc591f57f613d2418eae"><div class="ttname"><a href="rte__ethdev_8h.html#a012a874434677984af1f026ad585dd0da308323e3152afc591f57f613d2418eae">ETH_8_POOLS</a></div><div class="ttdeci">@ ETH_8_POOLS</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00865">rte_ethdev.h:865</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a586b8e86131b4ec0ccaf464e847ccf3ea66316d2ff53011a3209207734c124f3c"><div class="ttname"><a href="rte__ethdev_8h.html#a586b8e86131b4ec0ccaf464e847ccf3ea66316d2ff53011a3209207734c124f3c">ETH_MQ_RX_VMDQ_ONLY</a></div><div class="ttdeci">@ ETH_MQ_RX_VMDQ_ONLY</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00362">rte_ethdev.h:362</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_a593921f13307803b94bbb4e0932db962"><div class="ttname"><a href="rte__mbuf_8h.html#a593921f13307803b94bbb4e0932db962">rte_pktmbuf_pool_create</a></div><div class="ttdeci">struct rte_mempool * rte_pktmbuf_pool_create(const char *name, unsigned n, unsigned cache_size, uint16_t priv_size, uint16_t data_room_size, int socket_id)</div></div>
<div class="ttc" id="arte__mbuf_8h_html_a1215458932900b7cd5192326fa4a6902"><div class="ttname"><a href="rte__mbuf_8h.html#a1215458932900b7cd5192326fa4a6902">rte_pktmbuf_free</a></div><div class="ttdeci">static void rte_pktmbuf_free(struct rte_mbuf *m)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01397">rte_mbuf.h:1397</a></div></div>
<div class="ttc" id="arte__lcore_8h_html_ac779e61584eb9d087c3e20bf2d1150c8"><div class="ttname"><a href="rte__lcore_8h.html#ac779e61584eb9d087c3e20bf2d1150c8">RTE_LCORE_FOREACH_WORKER</a></div><div class="ttdeci">#define RTE_LCORE_FOREACH_WORKER(i)</div><div class="ttdef"><b>Definition:</b> <a href="rte__lcore_8h_source.html#l00239">rte_lcore.h:239</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a36ba70a5a6fce2c2c1f774828ba78f8d"><div class="ttname"><a href="rte__ethdev_8h.html#a36ba70a5a6fce2c2c1f774828ba78f8d">rte_eth_rx_queue_setup</a></div><div class="ttdeci">int rte_eth_rx_queue_setup(uint16_t port_id, uint16_t rx_queue_id, uint16_t nb_rx_desc, unsigned int socket_id, const struct rte_eth_rxconf *rx_conf, struct rte_mempool *mb_pool)</div></div>
<div class="ttc" id="astructrte__eth__conf_html_addc9c7bb19ed12f1171c543493553806"><div class="ttname"><a href="structrte__eth__conf.html#addc9c7bb19ed12f1171c543493553806">rte_eth_conf::rss_conf</a></div><div class="ttdeci">struct rte_eth_rss_conf rss_conf</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01327">rte_ethdev.h:1309</a></div></div>
<div class="ttc" id="arte__mempool_8h_html"><div class="ttname"><a href="rte__mempool_8h.html">rte_mempool.h</a></div></div>
<div class="ttc" id="astructrte__eth__conf_html_a084e132696e8d0f59f643d822c8cedb7"><div class="ttname"><a href="structrte__eth__conf.html#a084e132696e8d0f59f643d822c8cedb7">rte_eth_conf::rx_adv_conf</a></div><div class="ttdeci">struct rte_eth_conf::@153 rx_adv_conf</div></div>
<div class="ttc" id="arte__ethdev_8h_html"><div class="ttname"><a href="rte__ethdev_8h.html">rte_ethdev.h</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html"><div class="ttname"><a href="rte__mbuf_8h.html">rte_mbuf.h</a></div></div>
<div class="ttc" id="arte__launch_8h_html"><div class="ttname"><a href="rte__launch_8h.html">rte_launch.h</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a012a874434677984af1f026ad585dd0d"><div class="ttname"><a href="rte__ethdev_8h.html#a012a874434677984af1f026ad585dd0d">rte_eth_nb_pools</a></div><div class="ttdeci">rte_eth_nb_pools</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00864">rte_ethdev.h:864</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_aae1a98a4ba67296647a29abb8cce1031"><div class="ttname"><a href="rte__ethdev_8h.html#aae1a98a4ba67296647a29abb8cce1031">rte_eth_dev_mac_addr_add</a></div><div class="ttdeci">int rte_eth_dev_mac_addr_add(uint16_t port_id, struct rte_ether_addr *mac_addr, uint32_t pool)</div></div>
<div class="ttc" id="arte__launch_8h_html_a7fe96b0e5d3a6a8cf9b8d1a27cf3f159ad00c59bb386320b2ba3198d3149a0c35"><div class="ttname"><a href="rte__launch_8h.html#a7fe96b0e5d3a6a8cf9b8d1a27cf3f159ad00c59bb386320b2ba3198d3149a0c35">CALL_MAIN</a></div><div class="ttdeci">@ CALL_MAIN</div><div class="ttdef"><b>Definition:</b> <a href="rte__launch_8h_source.html#l00073">rte_launch.h:73</a></div></div>
<div class="ttc" id="astructrte__eth__dev__info_html"><div class="ttname"><a href="structrte__eth__dev__info.html">rte_eth_dev_info</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01504">rte_ethdev.h:1504</a></div></div>
<div class="ttc" id="astructrte__ether__addr_html"><div class="ttname"><a href="structrte__ether__addr.html">rte_ether_addr</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00064">rte_ether.h:64</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_ad7b46c67203d37fe3a34f11076d970d6"><div class="ttname"><a href="rte__ethdev_8h.html#ad7b46c67203d37fe3a34f11076d970d6">RTE_ETH_FOREACH_DEV</a></div><div class="ttdeci">#define RTE_ETH_FOREACH_DEV(p)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01858">rte_ethdev.h:1858</a></div></div>
<div class="ttc" id="astructrte__eth__conf_html"><div class="ttname"><a href="structrte__eth__conf.html">rte_eth_conf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01293">rte_ethdev.h:1293</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_ad032e25f712e6ffeb0c19eab1ec1fd2e"><div class="ttname"><a href="rte__ethdev_8h.html#ad032e25f712e6ffeb0c19eab1ec1fd2e">rte_eth_dev_socket_id</a></div><div class="ttdeci">int rte_eth_dev_socket_id(uint16_t port_id)</div></div>
<div class="ttc" id="arte__per__lcore_8h_html"><div class="ttname"><a href="rte__per__lcore_8h.html">rte_per_lcore.h</a></div></div>
<div class="ttc" id="astructrte__ether__hdr_html_a1d579e2782d36729c1f73608d8663124"><div class="ttname"><a href="structrte__ether__hdr.html#a1d579e2782d36729c1f73608d8663124">rte_ether_hdr::d_addr</a></div><div class="ttdeci">struct rte_ether_addr d_addr</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00000">rte_ether.h:265</a></div></div>
<div class="ttc" id="astructrte__ether__addr_html_ad6f7cb65b39d12b5250ecf82c8ffaa45"><div class="ttname"><a href="structrte__ether__addr.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">rte_ether_addr::addr_bytes</a></div><div class="ttdeci">uint8_t addr_bytes[RTE_ETHER_ADDR_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00065">rte_ether.h:65</a></div></div>
<div class="ttc" id="arte__launch_8h_html_ae9500e1d35bd4cfb95d18c0be863cb1e"><div class="ttname"><a href="rte__launch_8h.html#ae9500e1d35bd4cfb95d18c0be863cb1e">rte_eal_wait_lcore</a></div><div class="ttdeci">int rte_eal_wait_lcore(unsigned worker_id)</div></div>
<div class="ttc" id="astructrte__eth__rxconf_html_aaccf5b8238b9207f8102d69959ac3391"><div class="ttname"><a href="structrte__eth__rxconf.html#aaccf5b8238b9207f8102d69959ac3391">rte_eth_rxconf::rx_drop_en</a></div><div class="ttdeci">uint8_t rx_drop_en</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01035">rte_ethdev.h:1035</a></div></div>
<div class="ttc" id="arte__prefetch_8h_html"><div class="ttname"><a href="rte__prefetch_8h.html">rte_prefetch.h</a></div></div>
<div class="ttc" id="astructrte__eth__conf_html_a17845d02c4ddfdc09982bd899b6df06e"><div class="ttname"><a href="structrte__eth__conf.html#a17845d02c4ddfdc09982bd899b6df06e">rte_eth_conf::vmdq_rx_conf</a></div><div class="ttdeci">struct rte_eth_vmdq_rx_conf vmdq_rx_conf</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01327">rte_ethdev.h:1314</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
