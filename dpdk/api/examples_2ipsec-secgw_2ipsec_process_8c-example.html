<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DPDK: examples/ipsec-secgw/ipsec_process.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DPDK
   &#160;<span id="projectnumber">20.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">examples/ipsec-secgw/ipsec_process.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/* SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment"> * Copyright(c) 2016-2020 Intel Corporation</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/types.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;netinet/in.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;netinet/ip.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__branch__prediction_8h.html">rte_branch_prediction.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__log_8h.html">rte_log.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__cryptodev_8h.html">rte_cryptodev.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ethdev_8h.html">rte_ethdev.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__mbuf_8h.html">rte_mbuf.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;ipsec.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;ipsec-secgw.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SATP_OUT_IPV4(t)    \</span></div>
<div class="line"><span class="preprocessor">    ((((t) &amp; RTE_IPSEC_SATP_MODE_MASK) == RTE_IPSEC_SATP_MODE_TRANS &amp;&amp; \</span></div>
<div class="line"><span class="preprocessor">    (((t) &amp; RTE_IPSEC_SATP_IPV_MASK) == RTE_IPSEC_SATP_IPV4)) || \</span></div>
<div class="line"><span class="preprocessor">    ((t) &amp; RTE_IPSEC_SATP_MODE_MASK) == RTE_IPSEC_SATP_MODE_TUNLV4)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* helper routine to free bulk of crypto-ops and related packets */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">free_cops(<span class="keyword">struct</span> <a name="_a0"></a><a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> *cop[], uint32_t n)</div>
<div class="line">{</div>
<div class="line">    uint32_t i;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i != n; i++)</div>
<div class="line">        <a name="a1"></a><a class="code" href="rte__mbuf_8h.html#a1215458932900b7cd5192326fa4a6902">rte_pktmbuf_free</a>(cop[i]-&gt;sym-&gt;m_src);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* helper routine to enqueue bulk of crypto ops */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">enqueue_cop_bulk(<span class="keyword">struct</span> cdev_qp *cqp, <span class="keyword">struct</span> <a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> *cop[], uint32_t num)</div>
<div class="line">{</div>
<div class="line">    uint32_t i, k, len, n;</div>
<div class="line"> </div>
<div class="line">    len = cqp-&gt;len;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * if cqp is empty and we have enough ops,</span></div>
<div class="line"><span class="comment">     * then queue them to the PMD straightway.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordflow">if</span> (num &gt;= <a name="a2"></a><a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(cqp-&gt;buf) * 3 / 4 &amp;&amp; len == 0) {</div>
<div class="line">        n = <a name="a3"></a><a class="code" href="rte__cryptodev_8h.html#a1e1336b0a8fe381ea03a52bad85e5734">rte_cryptodev_enqueue_burst</a>(cqp-&gt;id, cqp-&gt;qp, cop, num);</div>
<div class="line">        cqp-&gt;in_flight += n;</div>
<div class="line">        free_cops(cop + n, num - n);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    k = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        n = <a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(cqp-&gt;buf) - len;</div>
<div class="line">        n = <a name="a4"></a><a class="code" href="rte__common_8h.html#a4c7571cbcdbfe9b63431036af811bee9">RTE_MIN</a>(num - k, n);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* put packets into cqp */</span></div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i != n; i++)</div>
<div class="line">            cqp-&gt;buf[len + i] = cop[k + i];</div>
<div class="line"> </div>
<div class="line">        len += n;</div>
<div class="line">        k += n;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* if cqp is full then, enqueue crypto-ops to PMD */</span></div>
<div class="line">        if (len == <a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(cqp-&gt;buf)) {</div>
<div class="line">            n = <a class="code" href="rte__cryptodev_8h.html#a1e1336b0a8fe381ea03a52bad85e5734">rte_cryptodev_enqueue_burst</a>(cqp-&gt;id, cqp-&gt;qp,</div>
<div class="line">                    cqp-&gt;buf, len);</div>
<div class="line">            cqp-&gt;in_flight += n;</div>
<div class="line">            free_cops(cqp-&gt;buf + n, len - n);</div>
<div class="line">            len = 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">while</span> (k != num);</div>
<div class="line"> </div>
<div class="line">    cqp-&gt;len = len;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span></div>
<div class="line">fill_ipsec_session(<span class="keyword">struct</span> <a name="_a5"></a><a class="code" href="structrte__ipsec__session.html">rte_ipsec_session</a> *ss, <span class="keyword">struct</span> ipsec_ctx *ctx,</div>
<div class="line">    <span class="keyword">struct</span> ipsec_sa *sa)</div>
<div class="line">{</div>
<div class="line">    int32_t rc;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* setup crypto section */</span></div>
<div class="line">    <span class="keywordflow">if</span> (ss-&gt;<a name="a6"></a><a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> == <a name="a7"></a><a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a79eb9b51e068301f8839e759e08d2b52">RTE_SECURITY_ACTION_TYPE_NONE</a> ||</div>
<div class="line">            ss-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> == <a name="a8"></a><a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a32e56f07add678e64f24fb06d7e8b93c">RTE_SECURITY_ACTION_TYPE_CPU_CRYPTO</a>) {</div>
<div class="line">        RTE_ASSERT(ss-&gt;<a name="a9"></a>crypto.ses == NULL);</div>
<div class="line">        rc = create_lookaside_session(ctx, sa, ss);</div>
<div class="line">        <span class="keywordflow">if</span> (rc != 0)</div>
<div class="line">            <span class="keywordflow">return</span> rc;</div>
<div class="line">    <span class="comment">/* setup session action type */</span></div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ss-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> == <a name="a10"></a><a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a770b2f7ec6c90bba88ba546acaa2c17f">RTE_SECURITY_ACTION_TYPE_LOOKASIDE_PROTOCOL</a>) {</div>
<div class="line">        RTE_ASSERT(ss-&gt;<a name="a11"></a>security.ses == NULL);</div>
<div class="line">        rc = create_lookaside_session(ctx, sa, ss);</div>
<div class="line">        <span class="keywordflow">if</span> (rc != 0)</div>
<div class="line">            <span class="keywordflow">return</span> rc;</div>
<div class="line">    } <span class="keywordflow">else</span></div>
<div class="line">        RTE_ASSERT(0);</div>
<div class="line"> </div>
<div class="line">    rc = <a name="a12"></a><a class="code" href="rte__ipsec_8h.html#a476dd6c023ba22a7b659e1d927f299a1">rte_ipsec_session_prepare</a>(ss);</div>
<div class="line">    <span class="keywordflow">if</span> (rc != 0)</div>
<div class="line">        memset(ss, 0, <span class="keyword">sizeof</span>(*ss));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rc;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * group input packets byt the SA they belong to.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">sa_group(<span class="keywordtype">void</span> *sa_ptr[], <span class="keyword">struct</span> <a name="_a13"></a><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkts[],</div>
<div class="line">    <span class="keyword">struct</span> <a name="_a14"></a><a class="code" href="structrte__ipsec__group.html">rte_ipsec_group</a> grp[], uint32_t num)</div>
<div class="line">{</div>
<div class="line">    uint32_t i, n, spi;</div>
<div class="line">    <span class="keywordtype">void</span> *sa;</div>
<div class="line">    <span class="keywordtype">void</span> * <span class="keyword">const</span> nosa = &amp;spi;</div>
<div class="line"> </div>
<div class="line">    sa = nosa;</div>
<div class="line">    grp[0].<a name="a15"></a><a class="code" href="structrte__ipsec__group.html#a6110c629c8d6771ee4a38a33cae2f3af">m</a> = pkts;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0, n = 0; i != num; i++) {</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (sa != sa_ptr[i]) {</div>
<div class="line">            grp[n].<a name="a16"></a><a class="code" href="structrte__ipsec__group.html#a884497f3269a8ae82bcd0a4814997702">cnt</a> = pkts + i - grp[n].<a class="code" href="structrte__ipsec__group.html#a6110c629c8d6771ee4a38a33cae2f3af">m</a>;</div>
<div class="line">            n += (sa != nosa);</div>
<div class="line">            grp[n].<a name="a17"></a><a class="code" href="structrte__ipsec__group.html#a4e8acaa20cdd9c263fc8f69d0130c75f">id</a>.<a name="a18"></a>ptr = sa_ptr[i];</div>
<div class="line">            grp[n].<a class="code" href="structrte__ipsec__group.html#a6110c629c8d6771ee4a38a33cae2f3af">m</a> = pkts + i;</div>
<div class="line">            sa = sa_ptr[i];</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* terminate last group */</span></div>
<div class="line">    <span class="keywordflow">if</span> (sa != nosa) {</div>
<div class="line">        grp[n].<a class="code" href="structrte__ipsec__group.html#a884497f3269a8ae82bcd0a4814997702">cnt</a> = pkts + i - grp[n].<a class="code" href="structrte__ipsec__group.html#a6110c629c8d6771ee4a38a33cae2f3af">m</a>;</div>
<div class="line">        n++;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> n;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * helper function, splits processed packets into ipv4/ipv6 traffic.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">copy_to_trf(<span class="keyword">struct</span> ipsec_traffic *trf, uint64_t satp, <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *mb[],</div>
<div class="line">    uint32_t num)</div>
<div class="line">{</div>
<div class="line">    uint32_t j, ofs, s;</div>
<div class="line">    <span class="keyword">struct </span>traffic_type *out;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * determine traffic type(ipv4/ipv6) and offset for ACL classify</span></div>
<div class="line"><span class="comment">     * based on SA type</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((satp &amp; RTE_IPSEC_SATP_DIR_MASK) == RTE_IPSEC_SATP_DIR_IB) {</div>
<div class="line">        <span class="keywordflow">if</span> ((satp &amp; RTE_IPSEC_SATP_IPV_MASK) == RTE_IPSEC_SATP_IPV4) {</div>
<div class="line">            out = &amp;trf-&gt;ip4;</div>
<div class="line">            ofs = <a name="a19"></a><a class="code" href="rte__common_8h.html#a276e8a32e0bbf024aadd9420b8f2d3b3">offsetof</a>(<span class="keyword">struct</span> ip, ip_p);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            out = &amp;trf-&gt;ip6;</div>
<div class="line">            ofs = <a class="code" href="rte__common_8h.html#a276e8a32e0bbf024aadd9420b8f2d3b3">offsetof</a>(<span class="keyword">struct</span> ip6_hdr, ip6_nxt);</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SATP_OUT_IPV4(satp)) {</div>
<div class="line">        out = &amp;trf-&gt;ip4;</div>
<div class="line">        ofs = <a class="code" href="rte__common_8h.html#a276e8a32e0bbf024aadd9420b8f2d3b3">offsetof</a>(<span class="keyword">struct</span> ip, ip_p);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        out = &amp;trf-&gt;ip6;</div>
<div class="line">        ofs = <a class="code" href="rte__common_8h.html#a276e8a32e0bbf024aadd9420b8f2d3b3">offsetof</a>(<span class="keyword">struct</span> ip6_hdr, ip6_nxt);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (j = 0, s = out-&gt;num; j != num; j++) {</div>
<div class="line">        out-&gt;data[s + j] = <a name="a20"></a><a class="code" href="rte__mbuf__core_8h.html#ad63e1de0ec54d7c7603ea984c76ca956">rte_pktmbuf_mtod_offset</a>(mb[j],</div>
<div class="line">                <span class="keywordtype">void</span> *, ofs);</div>
<div class="line">        out-&gt;pkts[s + j] = mb[j];</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    out-&gt;num += num;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">ipsec_prepare_crypto_group(<span class="keyword">struct</span> ipsec_ctx *ctx, <span class="keyword">struct</span> ipsec_sa *sa,</div>
<div class="line">        <span class="keyword">struct</span> <a class="code" href="structrte__ipsec__session.html">rte_ipsec_session</a> *ips, <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> **m,</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cnt)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>cdev_qp *cqp;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> *cop[cnt];</div>
<div class="line">    uint32_t j, k;</div>
<div class="line">    <span class="keyword">struct </span>ipsec_mbuf_metadata *priv;</div>
<div class="line"> </div>
<div class="line">    cqp = &amp;ctx-&gt;tbl[sa-&gt;cdev_id_qp];</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* for that app each mbuf has it&#39;s own crypto op */</span></div>
<div class="line">    <span class="keywordflow">for</span> (j = 0; j != cnt; j++) {</div>
<div class="line">        priv = get_priv(m[j]);</div>
<div class="line">        cop[j] = &amp;priv-&gt;cop;</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * this is just to satisfy inbound_sa_check()</span></div>
<div class="line"><span class="comment">         * should be removed in future.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        priv-&gt;sa = sa;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* prepare and enqueue crypto ops */</span></div>
<div class="line">    k = <a name="a21"></a><a class="code" href="rte__ipsec_8h.html#a8527e954c71570b959731a2de5ed95cf">rte_ipsec_pkt_crypto_prepare</a>(ips, m, cop, cnt);</div>
<div class="line">    <span class="keywordflow">if</span> (k != 0)</div>
<div class="line">        enqueue_cop_bulk(cqp, cop, k);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> k;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * helper routine for inline and cpu(synchronous) processing</span></div>
<div class="line"><span class="comment"> * this is just to satisfy inbound_sa_check() and get_hop_for_offload_pkt().</span></div>
<div class="line"><span class="comment"> * Should be removed in future.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">prep_process_group(<span class="keywordtype">void</span> *sa, <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *mb[], uint32_t cnt)</div>
<div class="line">{</div>
<div class="line">    uint32_t j;</div>
<div class="line">    <span class="keyword">struct </span>ipsec_mbuf_metadata *priv;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (j = 0; j != cnt; j++) {</div>
<div class="line">        priv = get_priv(mb[j]);</div>
<div class="line">        priv-&gt;sa = sa;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * finish processing of packets successfully decrypted by an inline processor</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">ipsec_process_inline_group(<span class="keyword">struct</span> <a class="code" href="structrte__ipsec__session.html">rte_ipsec_session</a> *ips, <span class="keywordtype">void</span> *sa,</div>
<div class="line">    <span class="keyword">struct</span> ipsec_traffic *trf, <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *mb[], uint32_t cnt)</div>
<div class="line">{</div>
<div class="line">    uint64_t satp;</div>
<div class="line">    uint32_t k;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* get SA type */</span></div>
<div class="line">    satp = <a name="a22"></a><a class="code" href="rte__ipsec__sa_8h.html#a0ba6bd3f9745dba2eff3d735f5b6613c">rte_ipsec_sa_type</a>(ips-&gt;<a name="a23"></a><a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>);</div>
<div class="line">    prep_process_group(sa, mb, cnt);</div>
<div class="line"> </div>
<div class="line">    k = <a name="a24"></a><a class="code" href="rte__ipsec_8h.html#ad4ace3986b35bde27597e3821d565122">rte_ipsec_pkt_process</a>(ips, mb, cnt);</div>
<div class="line">    copy_to_trf(trf, satp, mb, k);</div>
<div class="line">    <span class="keywordflow">return</span> k;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * process packets synchronously</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">ipsec_process_cpu_group(<span class="keyword">struct</span> <a class="code" href="structrte__ipsec__session.html">rte_ipsec_session</a> *ips, <span class="keywordtype">void</span> *sa,</div>
<div class="line">    <span class="keyword">struct</span> ipsec_traffic *trf, <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *mb[], uint32_t cnt)</div>
<div class="line">{</div>
<div class="line">    uint64_t satp;</div>
<div class="line">    uint32_t k;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* get SA type */</span></div>
<div class="line">    satp = <a class="code" href="rte__ipsec__sa_8h.html#a0ba6bd3f9745dba2eff3d735f5b6613c">rte_ipsec_sa_type</a>(ips-&gt;<a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>);</div>
<div class="line">    prep_process_group(sa, mb, cnt);</div>
<div class="line"> </div>
<div class="line">    k = rte_ipsec_pkt_cpu_prepare(ips, mb, cnt);</div>
<div class="line">    k = <a class="code" href="rte__ipsec_8h.html#ad4ace3986b35bde27597e3821d565122">rte_ipsec_pkt_process</a>(ips, mb, k);</div>
<div class="line">    copy_to_trf(trf, satp, mb, k);</div>
<div class="line">    <span class="keywordflow">return</span> k;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Process ipsec packets.</span></div>
<div class="line"><span class="comment"> * If packet belong to SA that is subject of inline-crypto,</span></div>
<div class="line"><span class="comment"> * then process it immediately.</span></div>
<div class="line"><span class="comment"> * Otherwise do necessary preparations and queue it to related</span></div>
<div class="line"><span class="comment"> * crypto-dev queue.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">ipsec_process(<span class="keyword">struct</span> ipsec_ctx *ctx, <span class="keyword">struct</span> ipsec_traffic *trf)</div>
<div class="line">{</div>
<div class="line">    uint32_t i, k, n;</div>
<div class="line">    <span class="keyword">struct </span>ipsec_sa *sa;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ipsec__group.html">rte_ipsec_group</a> *pg;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ipsec__session.html">rte_ipsec_session</a> *ips;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ipsec__group.html">rte_ipsec_group</a> grp[<a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(trf-&gt;ipsec.pkts)];</div>
<div class="line"> </div>
<div class="line">    n = sa_group(trf-&gt;ipsec.saptr, trf-&gt;ipsec.pkts, grp, trf-&gt;ipsec.num);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i != n; i++) {</div>
<div class="line"> </div>
<div class="line">        pg = grp + i;</div>
<div class="line">        sa = ipsec_mask_saptr(pg-&gt;<a class="code" href="structrte__ipsec__group.html#a4e8acaa20cdd9c263fc8f69d0130c75f">id</a>.ptr);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* fallback to cryptodev with RX packets which inline</span></div>
<div class="line"><span class="comment">         * processor was unable to process</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> (sa != NULL)</div>
<div class="line">            ips = (pg-&gt;<a class="code" href="structrte__ipsec__group.html#a4e8acaa20cdd9c263fc8f69d0130c75f">id</a>.<a name="a25"></a>val &amp; IPSEC_SA_OFFLOAD_FALLBACK_FLAG) ?</div>
<div class="line">                ipsec_get_fallback_session(sa) :</div>
<div class="line">                ipsec_get_primary_session(sa);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* no valid HW session for that SA, try to create one */</span></div>
<div class="line">        <span class="keywordflow">if</span> (sa == NULL || (ips-&gt;crypto.ses == NULL &amp;&amp;</div>
<div class="line">                fill_ipsec_session(ips, ctx, sa) != 0))</div>
<div class="line">            k = 0;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* process packets inline */</span></div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">switch</span> (ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a>) {</div>
<div class="line">            <span class="comment">/* enqueue packets to crypto dev */</span></div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a79eb9b51e068301f8839e759e08d2b52">RTE_SECURITY_ACTION_TYPE_NONE</a>:</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a770b2f7ec6c90bba88ba546acaa2c17f">RTE_SECURITY_ACTION_TYPE_LOOKASIDE_PROTOCOL</a>:</div>
<div class="line">                k = ipsec_prepare_crypto_group(ctx, sa, ips,</div>
<div class="line">                    pg-&gt;<a class="code" href="structrte__ipsec__group.html#a6110c629c8d6771ee4a38a33cae2f3af">m</a>, pg-&gt;<a class="code" href="structrte__ipsec__group.html#a884497f3269a8ae82bcd0a4814997702">cnt</a>);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a name="a26"></a><a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116">RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</a>:</div>
<div class="line">            <span class="keywordflow">case</span> <a name="a27"></a><a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f">RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</a>:</div>
<div class="line">                k = ipsec_process_inline_group(ips, sa,</div>
<div class="line">                    trf, pg-&gt;<a class="code" href="structrte__ipsec__group.html#a6110c629c8d6771ee4a38a33cae2f3af">m</a>, pg-&gt;<a class="code" href="structrte__ipsec__group.html#a884497f3269a8ae82bcd0a4814997702">cnt</a>);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a32e56f07add678e64f24fb06d7e8b93c">RTE_SECURITY_ACTION_TYPE_CPU_CRYPTO</a>:</div>
<div class="line">                k = ipsec_process_cpu_group(ips, sa,</div>
<div class="line">                    trf, pg-&gt;<a class="code" href="structrte__ipsec__group.html#a6110c629c8d6771ee4a38a33cae2f3af">m</a>, pg-&gt;<a class="code" href="structrte__ipsec__group.html#a884497f3269a8ae82bcd0a4814997702">cnt</a>);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">default</span>:</div>
<div class="line">                k = 0;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* drop packets that cannot be enqueued/processed */</span></div>
<div class="line">        <span class="keywordflow">if</span> (k != pg-&gt;<a class="code" href="structrte__ipsec__group.html#a884497f3269a8ae82bcd0a4814997702">cnt</a>)</div>
<div class="line">            free_pkts(pg-&gt;<a class="code" href="structrte__ipsec__group.html#a6110c629c8d6771ee4a38a33cae2f3af">m</a> + k, pg-&gt;<a class="code" href="structrte__ipsec__group.html#a884497f3269a8ae82bcd0a4814997702">cnt</a> - k);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> uint32_t</div>
<div class="line">cqp_dequeue(<span class="keyword">struct</span> cdev_qp *cqp, <span class="keyword">struct</span> <a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> *cop[], uint32_t num)</div>
<div class="line">{</div>
<div class="line">    uint32_t n;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cqp-&gt;in_flight == 0)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    n = <a name="a28"></a><a class="code" href="rte__cryptodev_8h.html#a0032857587ce7e217b8c10ba392bef56">rte_cryptodev_dequeue_burst</a>(cqp-&gt;id, cqp-&gt;qp, cop, num);</div>
<div class="line">    RTE_ASSERT(cqp-&gt;in_flight &gt;= n);</div>
<div class="line">    cqp-&gt;in_flight -= n;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> n;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> uint32_t</div>
<div class="line">ctx_dequeue(<span class="keyword">struct</span> ipsec_ctx *ctx, <span class="keyword">struct</span> <a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> *cop[], uint32_t num)</div>
<div class="line">{</div>
<div class="line">    uint32_t i, n;</div>
<div class="line"> </div>
<div class="line">    n = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = ctx-&gt;last_qp; n != num &amp;&amp; i != ctx-&gt;nb_qps; i++)</div>
<div class="line">        n += cqp_dequeue(ctx-&gt;tbl + i, cop + n, num - n);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; n != num &amp;&amp; i != ctx-&gt;last_qp; i++)</div>
<div class="line">        n += cqp_dequeue(ctx-&gt;tbl + i, cop + n, num - n);</div>
<div class="line"> </div>
<div class="line">    ctx-&gt;last_qp = i;</div>
<div class="line">    <span class="keywordflow">return</span> n;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * dequeue packets from crypto-queues and finalize processing.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">ipsec_cqp_process(<span class="keyword">struct</span> ipsec_ctx *ctx, <span class="keyword">struct</span> ipsec_traffic *trf)</div>
<div class="line">{</div>
<div class="line">    uint64_t satp;</div>
<div class="line">    uint32_t i, k, n, ng;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ipsec__session.html">rte_ipsec_session</a> *ss;</div>
<div class="line">    <span class="keyword">struct </span>traffic_type *out;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ipsec__group.html">rte_ipsec_group</a> *pg;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> *cop[<a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(trf-&gt;ipsec.pkts)];</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ipsec__group.html">rte_ipsec_group</a> grp[<a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(trf-&gt;ipsec.pkts)];</div>
<div class="line"> </div>
<div class="line">    trf-&gt;ip4.num = 0;</div>
<div class="line">    trf-&gt;ip6.num = 0;</div>
<div class="line"> </div>
<div class="line">    out = &amp;trf-&gt;ipsec;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* dequeue completed crypto-ops */</span></div>
<div class="line">    n = ctx_dequeue(ctx, cop, <a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(cop));</div>
<div class="line">    <span class="keywordflow">if</span> (n == 0)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* group them by ipsec session */</span></div>
<div class="line">    ng = <a name="a29"></a><a class="code" href="rte__ipsec__group_8h.html#a32aaeb7ea39895c86281f006cab8f908">rte_ipsec_pkt_crypto_group</a>((<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> **)</div>
<div class="line">        (uintptr_t)cop, out-&gt;pkts, grp, n);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* process each group of packets */</span></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i != ng; i++) {</div>
<div class="line"> </div>
<div class="line">        pg = grp + i;</div>
<div class="line">        ss = pg-&gt;<a class="code" href="structrte__ipsec__group.html#a4e8acaa20cdd9c263fc8f69d0130c75f">id</a>.ptr;</div>
<div class="line">        satp = <a class="code" href="rte__ipsec__sa_8h.html#a0ba6bd3f9745dba2eff3d735f5b6613c">rte_ipsec_sa_type</a>(ss-&gt;<a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>);</div>
<div class="line"> </div>
<div class="line">        k = <a class="code" href="rte__ipsec_8h.html#ad4ace3986b35bde27597e3821d565122">rte_ipsec_pkt_process</a>(ss, pg-&gt;<a class="code" href="structrte__ipsec__group.html#a6110c629c8d6771ee4a38a33cae2f3af">m</a>, pg-&gt;<a class="code" href="structrte__ipsec__group.html#a884497f3269a8ae82bcd0a4814997702">cnt</a>);</div>
<div class="line">        copy_to_trf(trf, satp, pg-&gt;<a class="code" href="structrte__ipsec__group.html#a6110c629c8d6771ee4a38a33cae2f3af">m</a>, k);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* free bad packets, if any */</span></div>
<div class="line">        free_pkts(pg-&gt;<a class="code" href="structrte__ipsec__group.html#a6110c629c8d6771ee4a38a33cae2f3af">m</a> + k, pg-&gt;<a class="code" href="structrte__ipsec__group.html#a884497f3269a8ae82bcd0a4814997702">cnt</a> - k);</div>
<div class="line"> </div>
<div class="line">        n -= pg-&gt;<a class="code" href="structrte__ipsec__group.html#a884497f3269a8ae82bcd0a4814997702">cnt</a>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* we should never have packet with unknown SA here */</span></div>
<div class="line">    RTE_VERIFY(n == 0);</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="arte__security_8h_html_a4ace8d873b2a4832039eb2f964b12165a32e56f07add678e64f24fb06d7e8b93c"><div class="ttname"><a href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a32e56f07add678e64f24fb06d7e8b93c">RTE_SECURITY_ACTION_TYPE_CPU_CRYPTO</a></div><div class="ttdeci">@ RTE_SECURITY_ACTION_TYPE_CPU_CRYPTO</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00349">rte_security.h:345</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a0032857587ce7e217b8c10ba392bef56"><div class="ttname"><a href="rte__cryptodev_8h.html#a0032857587ce7e217b8c10ba392bef56">rte_cryptodev_dequeue_burst</a></div><div class="ttdeci">static uint16_t rte_cryptodev_dequeue_burst(uint8_t dev_id, uint16_t qp_id, struct rte_crypto_op **ops, uint16_t nb_ops)</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00943">rte_cryptodev.h:943</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a1e1336b0a8fe381ea03a52bad85e5734"><div class="ttname"><a href="rte__cryptodev_8h.html#a1e1336b0a8fe381ea03a52bad85e5734">rte_cryptodev_enqueue_burst</a></div><div class="ttdeci">static uint16_t rte_cryptodev_enqueue_burst(uint8_t dev_id, uint16_t qp_id, struct rte_crypto_op **ops, uint16_t nb_ops)</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00987">rte_cryptodev.h:987</a></div></div>
<div class="ttc" id="arte__security_8h_html_a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f"><div class="ttname"><a href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f">RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</a></div><div class="ttdeci">@ RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00340">rte_security.h:337</a></div></div>
<div class="ttc" id="arte__log_8h_html"><div class="ttname"><a href="rte__log_8h.html">rte_log.h</a></div></div>
<div class="ttc" id="arte__ipsec__sa_8h_html_a0ba6bd3f9745dba2eff3d735f5b6613c"><div class="ttname"><a href="rte__ipsec__sa_8h.html#a0ba6bd3f9745dba2eff3d735f5b6613c">rte_ipsec_sa_type</a></div><div class="ttdeci">uint64_t rte_ipsec_sa_type(const struct rte_ipsec_sa *sa)</div></div>
<div class="ttc" id="arte__ipsec__group_8h_html_a32aaeb7ea39895c86281f006cab8f908"><div class="ttname"><a href="rte__ipsec__group_8h.html#a32aaeb7ea39895c86281f006cab8f908">rte_ipsec_pkt_crypto_group</a></div><div class="ttdeci">static uint16_t rte_ipsec_pkt_crypto_group(const struct rte_crypto_op *cop[], struct rte_mbuf *mb[], struct rte_ipsec_group grp[], uint16_t num)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec__group_8h_source.html#l00081">rte_ipsec_group.h:81</a></div></div>
<div class="ttc" id="arte__branch__prediction_8h_html"><div class="ttname"><a href="rte__branch__prediction_8h.html">rte_branch_prediction.h</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html"><div class="ttname"><a href="rte__cryptodev_8h.html">rte_cryptodev.h</a></div></div>
<div class="ttc" id="arte__ipsec_8h_html_a476dd6c023ba22a7b659e1d927f299a1"><div class="ttname"><a href="rte__ipsec_8h.html#a476dd6c023ba22a7b659e1d927f299a1">rte_ipsec_session_prepare</a></div><div class="ttdeci">int rte_ipsec_session_prepare(struct rte_ipsec_session *ss)</div></div>
<div class="ttc" id="astructrte__mbuf_html"><div class="ttname"><a href="structrte__mbuf.html">rte_mbuf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00473">rte_mbuf_core.h:473</a></div></div>
<div class="ttc" id="arte__security_8h_html_a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116"><div class="ttname"><a href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116">RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</a></div><div class="ttdeci">@ RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00336">rte_security.h:333</a></div></div>
<div class="ttc" id="astructrte__crypto__op_html"><div class="ttname"><a href="structrte__crypto__op.html">rte_crypto_op</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00078">rte_crypto.h:78</a></div></div>
<div class="ttc" id="astructrte__ipsec__group_html"><div class="ttname"><a href="structrte__ipsec__group.html">rte_ipsec_group</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec__group_8h_source.html#l00027">rte_ipsec_group.h:27</a></div></div>
<div class="ttc" id="arte__ipsec_8h_html_ad4ace3986b35bde27597e3821d565122"><div class="ttname"><a href="rte__ipsec_8h.html#ad4ace3986b35bde27597e3821d565122">rte_ipsec_pkt_process</a></div><div class="ttdeci">static uint16_t rte_ipsec_pkt_process(const struct rte_ipsec_session *ss, struct rte_mbuf *mb[], uint16_t num)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec_8h_source.html#l00155">rte_ipsec.h:155</a></div></div>
<div class="ttc" id="astructrte__ipsec__session_html_aa8f42f3a36d2c036ccb27f0b74b25160"><div class="ttname"><a href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">rte_ipsec_session::sa</a></div><div class="ttdeci">struct rte_ipsec_sa * sa</div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec_8h_source.html#l00063">rte_ipsec.h:63</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_ad63e1de0ec54d7c7603ea984c76ca956"><div class="ttname"><a href="rte__mbuf__core_8h.html#ad63e1de0ec54d7c7603ea984c76ca956">rte_pktmbuf_mtod_offset</a></div><div class="ttdeci">#define rte_pktmbuf_mtod_offset(m, t, o)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00711">rte_mbuf_core.h:711</a></div></div>
<div class="ttc" id="astructrte__ipsec__group_html_a6110c629c8d6771ee4a38a33cae2f3af"><div class="ttname"><a href="structrte__ipsec__group.html#a6110c629c8d6771ee4a38a33cae2f3af">rte_ipsec_group::m</a></div><div class="ttdeci">struct rte_mbuf ** m</div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec__group_8h_source.html#l00032">rte_ipsec_group.h:32</a></div></div>
<div class="ttc" id="arte__common_8h_html_ac963da91b35efa4700b73a1f4eb1d8a6"><div class="ttname"><a href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a></div><div class="ttdeci">#define RTE_DIM(a)</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00809">rte_common.h:809</a></div></div>
<div class="ttc" id="arte__common_8h_html_a4c7571cbcdbfe9b63431036af811bee9"><div class="ttname"><a href="rte__common_8h.html#a4c7571cbcdbfe9b63431036af811bee9">RTE_MIN</a></div><div class="ttdeci">#define RTE_MIN(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00573">rte_common.h:573</a></div></div>
<div class="ttc" id="astructrte__ipsec__group_html_a884497f3269a8ae82bcd0a4814997702"><div class="ttname"><a href="structrte__ipsec__group.html#a884497f3269a8ae82bcd0a4814997702">rte_ipsec_group::cnt</a></div><div class="ttdeci">uint32_t cnt</div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec__group_8h_source.html#l00033">rte_ipsec_group.h:33</a></div></div>
<div class="ttc" id="astructrte__ipsec__session_html_adb36704cd7fc83a9e5f8e10720974165"><div class="ttname"><a href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">rte_ipsec_session::type</a></div><div class="ttdeci">enum rte_security_session_action_type type</div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec_8h_source.html#l00063">rte_ipsec.h:65</a></div></div>
<div class="ttc" id="arte__common_8h_html_a276e8a32e0bbf024aadd9420b8f2d3b3"><div class="ttname"><a href="rte__common_8h.html#a276e8a32e0bbf024aadd9420b8f2d3b3">offsetof</a></div><div class="ttdeci">#define offsetof(TYPE, MEMBER)</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00753">rte_common.h:753</a></div></div>
<div class="ttc" id="astructrte__ipsec__session_html"><div class="ttname"><a href="structrte__ipsec__session.html">rte_ipsec_session</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec_8h_source.html#l00058">rte_ipsec.h:58</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_a1215458932900b7cd5192326fa4a6902"><div class="ttname"><a href="rte__mbuf_8h.html#a1215458932900b7cd5192326fa4a6902">rte_pktmbuf_free</a></div><div class="ttdeci">static void rte_pktmbuf_free(struct rte_mbuf *m)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01397">rte_mbuf.h:1397</a></div></div>
<div class="ttc" id="arte__ipsec_8h_html_a8527e954c71570b959731a2de5ed95cf"><div class="ttname"><a href="rte__ipsec_8h.html#a8527e954c71570b959731a2de5ed95cf">rte_ipsec_pkt_crypto_prepare</a></div><div class="ttdeci">static uint16_t rte_ipsec_pkt_crypto_prepare(const struct rte_ipsec_session *ss, struct rte_mbuf *mb[], struct rte_crypto_op *cop[], uint16_t num)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec_8h_source.html#l00118">rte_ipsec.h:118</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html"><div class="ttname"><a href="rte__ethdev_8h.html">rte_ethdev.h</a></div></div>
<div class="ttc" id="astructrte__ipsec__group_html_a4e8acaa20cdd9c263fc8f69d0130c75f"><div class="ttname"><a href="structrte__ipsec__group.html#a4e8acaa20cdd9c263fc8f69d0130c75f">rte_ipsec_group::id</a></div><div class="ttdeci">union rte_ipsec_group::@227 id</div></div>
<div class="ttc" id="arte__mbuf_8h_html"><div class="ttname"><a href="rte__mbuf_8h.html">rte_mbuf.h</a></div></div>
<div class="ttc" id="arte__security_8h_html_a4ace8d873b2a4832039eb2f964b12165a770b2f7ec6c90bba88ba546acaa2c17f"><div class="ttname"><a href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a770b2f7ec6c90bba88ba546acaa2c17f">RTE_SECURITY_ACTION_TYPE_LOOKASIDE_PROTOCOL</a></div><div class="ttdeci">@ RTE_SECURITY_ACTION_TYPE_LOOKASIDE_PROTOCOL</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00344">rte_security.h:341</a></div></div>
<div class="ttc" id="arte__security_8h_html_a4ace8d873b2a4832039eb2f964b12165a79eb9b51e068301f8839e759e08d2b52"><div class="ttname"><a href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a79eb9b51e068301f8839e759e08d2b52">RTE_SECURITY_ACTION_TYPE_NONE</a></div><div class="ttdeci">@ RTE_SECURITY_ACTION_TYPE_NONE</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00332">rte_security.h:331</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
