<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DPDK: examples/ipsec-secgw/esp.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DPDK
   &#160;<span id="projectnumber">20.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">examples/ipsec-secgw/esp.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/* SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment"> * Copyright(c) 2016-2017 Intel Corporation</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/types.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;netinet/in.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;netinet/ip.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;netinet/ip6.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fcntl.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__common_8h.html">rte_common.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__crypto_8h.html">rte_crypto.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__cryptodev_8h.html">rte_cryptodev.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__random_8h.html">rte_random.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;ipsec.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;esp.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;ipip.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">esp_inbound(<span class="keyword">struct</span> <a name="_a0"></a><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m, <span class="keyword">struct</span> ipsec_sa *sa,</div>
<div class="line">        <span class="keyword">struct</span> <a name="_a1"></a><a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> *cop)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>ip *ip4;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a2"></a><a class="code" href="structrte__crypto__sym__op.html">rte_crypto_sym_op</a> *sym_cop;</div>
<div class="line">    int32_t payload_len, ip_hdr_len;</div>
<div class="line"> </div>
<div class="line">    RTE_ASSERT(sa != NULL);</div>
<div class="line">    <span class="keywordflow">if</span> (ipsec_get_action_type(sa) ==</div>
<div class="line">            <a name="a3"></a><a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116">RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</a>)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    RTE_ASSERT(m != NULL);</div>
<div class="line">    RTE_ASSERT(cop != NULL);</div>
<div class="line"> </div>
<div class="line">    ip4 = <a name="a4"></a><a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(m, <span class="keyword">struct</span> ip *);</div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a5"></a><a class="code" href="rte__branch__prediction_8h.html#a217a0bd562b98ae8c2ffce44935351e1">likely</a>(ip4-&gt;ip_v == IPVERSION))</div>
<div class="line">        ip_hdr_len = ip4-&gt;ip_hl * 4;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ip4-&gt;ip_v == IP6_VERSION)</div>
<div class="line">        <span class="comment">/* XXX No option headers supported */</span></div>
<div class="line">        ip_hdr_len = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>ip6_hdr);</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">        <a name="a6"></a><a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC_ESP, <span class="stringliteral">&quot;invalid IP packet type %d\n&quot;</span>,</div>
<div class="line">                ip4-&gt;ip_v);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    payload_len = <a name="a7"></a><a class="code" href="rte__mbuf_8h.html#a7a7ea614c79d5b9ed790a56c1c79189d">rte_pktmbuf_pkt_len</a>(m) - ip_hdr_len -</div>
<div class="line">        <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a name="_a8"></a><a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a>) - sa-&gt;iv_len - sa-&gt;digest_len;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((payload_len &amp; (sa-&gt;block_size - 1)) || (payload_len &lt;= 0)) {</div>
<div class="line">        <a name="a9"></a><a class="code" href="rte__log_8h.html#aeed72aff1af9a59d2de85b96955e21f9">RTE_LOG_DP</a>(DEBUG, IPSEC_ESP, <span class="stringliteral">&quot;payload %d not multiple of %u\n&quot;</span>,</div>
<div class="line">                payload_len, sa-&gt;block_size);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    sym_cop = get_sym_cop(cop);</div>
<div class="line">    sym_cop-&gt;<a name="a10"></a><a class="code" href="structrte__crypto__sym__op.html#af021669494a2806b0569587e2096e88e">m_src</a> = m;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (sa-&gt;aead_algo == <a name="a11"></a><a class="code" href="rte__crypto__sym_8h.html#a648bc317af3ee238310fac9d87512508ab8b38d7173d30b7adf47116abb09c469">RTE_CRYPTO_AEAD_AES_GCM</a>) {</div>
<div class="line">        sym_cop-&gt;<a name="a12"></a>aead.data.offset =</div>
<div class="line">            ip_hdr_len + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a>) + sa-&gt;iv_len;</div>
<div class="line">        sym_cop-&gt;aead.data.length = payload_len;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">struct </span>cnt_blk *icb;</div>
<div class="line">        uint8_t *aad;</div>
<div class="line">        uint8_t *iv = <a name="a13"></a><a class="code" href="rte__common_8h.html#a96c6294ef6a307980f78899fe8a5813e">RTE_PTR_ADD</a>(ip4, ip_hdr_len +</div>
<div class="line">                    <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a>));</div>
<div class="line"> </div>
<div class="line">        icb = get_cnt_blk(m);</div>
<div class="line">        icb-&gt;salt = sa-&gt;salt;</div>
<div class="line">        memcpy(&amp;icb-&gt;iv, iv, 8);</div>
<div class="line">        icb-&gt;cnt = <a name="a14"></a><a class="code" href="rte__byteorder_8h.html#a6b1dd5d5a4c60c1d72ba48c523eba45c">rte_cpu_to_be_32</a>(1);</div>
<div class="line"> </div>
<div class="line">        aad = get_aad(m);</div>
<div class="line">        memcpy(aad, iv - <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a>), 8);</div>
<div class="line">        sym_cop-&gt;aead.aad.data = aad;</div>
<div class="line">        sym_cop-&gt;aead.aad.phys_addr = <a name="a15"></a><a class="code" href="rte__mbuf__core_8h.html#a0aba9fed77ad814d952958d448c71f38">rte_pktmbuf_iova_offset</a>(m,</div>
<div class="line">                aad - <a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(m, uint8_t *));</div>
<div class="line"> </div>
<div class="line">        sym_cop-&gt;aead.digest.data = <a name="a16"></a><a class="code" href="rte__mbuf__core_8h.html#ad63e1de0ec54d7c7603ea984c76ca956">rte_pktmbuf_mtod_offset</a>(m, <span class="keywordtype">void</span>*,</div>
<div class="line">                <a class="code" href="rte__mbuf_8h.html#a7a7ea614c79d5b9ed790a56c1c79189d">rte_pktmbuf_pkt_len</a>(m) - sa-&gt;digest_len);</div>
<div class="line">        sym_cop-&gt;aead.digest.phys_addr = <a class="code" href="rte__mbuf__core_8h.html#a0aba9fed77ad814d952958d448c71f38">rte_pktmbuf_iova_offset</a>(m,</div>
<div class="line">                <a class="code" href="rte__mbuf_8h.html#a7a7ea614c79d5b9ed790a56c1c79189d">rte_pktmbuf_pkt_len</a>(m) - sa-&gt;digest_len);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        sym_cop-&gt;<a name="a17"></a>cipher.data.offset =  ip_hdr_len +</div>
<div class="line">            <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a>) +</div>
<div class="line">            sa-&gt;iv_len;</div>
<div class="line">        sym_cop-&gt;cipher.data.length = payload_len;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">struct </span>cnt_blk *icb;</div>
<div class="line">        uint8_t *iv = <a class="code" href="rte__common_8h.html#a96c6294ef6a307980f78899fe8a5813e">RTE_PTR_ADD</a>(ip4, ip_hdr_len +</div>
<div class="line">                    <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a>));</div>
<div class="line">        uint8_t *iv_ptr = <a name="a18"></a><a class="code" href="rte__cryptodev_8h.html#aecf8ad2a113d395767f5b6cea89f3ee2">rte_crypto_op_ctod_offset</a>(cop,</div>
<div class="line">                    uint8_t *, IV_OFFSET);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">switch</span> (sa-&gt;cipher_algo) {</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a19"></a><a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eacc63a4618def739e08bb778de9f6e077">RTE_CRYPTO_CIPHER_NULL</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a20"></a><a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eaed8720577f149444ab479ee7415dbfb2">RTE_CRYPTO_CIPHER_3DES_CBC</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a21"></a><a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ead9f8e28815f3dd2b77e7ce93b7b8a7ca">RTE_CRYPTO_CIPHER_AES_CBC</a>:</div>
<div class="line">            <span class="comment">/* Copy IV at the end of crypto operation */</span></div>
<div class="line">            <a name="a22"></a><a class="code" href="rte__memcpy_8h.html#a09f4d8cdb1a7c25398a363906e1db8cd">rte_memcpy</a>(iv_ptr, iv, sa-&gt;iv_len);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a23"></a><a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ea5b5278dda15b9961d6f525dc0525ea95">RTE_CRYPTO_CIPHER_AES_CTR</a>:</div>
<div class="line">            icb = get_cnt_blk(m);</div>
<div class="line">            icb-&gt;salt = sa-&gt;salt;</div>
<div class="line">            memcpy(&amp;icb-&gt;iv, iv, 8);</div>
<div class="line">            icb-&gt;cnt = <a class="code" href="rte__byteorder_8h.html#a6b1dd5d5a4c60c1d72ba48c523eba45c">rte_cpu_to_be_32</a>(1);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC_ESP, <span class="stringliteral">&quot;unsupported cipher algorithm %u\n&quot;</span>,</div>
<div class="line">                    sa-&gt;cipher_algo);</div>
<div class="line">            <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">switch</span> (sa-&gt;auth_algo) {</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a24"></a><a class="code" href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793a9ea752ee9e74822da84cb75ef90cf583">RTE_CRYPTO_AUTH_NULL</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a25"></a><a class="code" href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793a98921a1d0174e6ec9f252b408dd39d20">RTE_CRYPTO_AUTH_SHA1_HMAC</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a26"></a><a class="code" href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793ad1b12ffc0e9202c46cff017c0bbcd6eb">RTE_CRYPTO_AUTH_SHA256_HMAC</a>:</div>
<div class="line">            sym_cop-&gt;<a name="a27"></a>auth.data.offset = ip_hdr_len;</div>
<div class="line">            sym_cop-&gt;auth.data.length = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a>) +</div>
<div class="line">                sa-&gt;iv_len + payload_len;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC_ESP, <span class="stringliteral">&quot;unsupported auth algorithm %u\n&quot;</span>,</div>
<div class="line">                    sa-&gt;auth_algo);</div>
<div class="line">            <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        sym_cop-&gt;auth.digest.data = <a class="code" href="rte__mbuf__core_8h.html#ad63e1de0ec54d7c7603ea984c76ca956">rte_pktmbuf_mtod_offset</a>(m, <span class="keywordtype">void</span>*,</div>
<div class="line">                <a class="code" href="rte__mbuf_8h.html#a7a7ea614c79d5b9ed790a56c1c79189d">rte_pktmbuf_pkt_len</a>(m) - sa-&gt;digest_len);</div>
<div class="line">        sym_cop-&gt;auth.digest.phys_addr = <a class="code" href="rte__mbuf__core_8h.html#a0aba9fed77ad814d952958d448c71f38">rte_pktmbuf_iova_offset</a>(m,</div>
<div class="line">                <a class="code" href="rte__mbuf_8h.html#a7a7ea614c79d5b9ed790a56c1c79189d">rte_pktmbuf_pkt_len</a>(m) - sa-&gt;digest_len);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">esp_inbound_post(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m, <span class="keyword">struct</span> ipsec_sa *sa,</div>
<div class="line">        <span class="keyword">struct</span> <a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> *cop)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>ip *ip4, *ip;</div>
<div class="line">    <span class="keyword">struct </span>ip6_hdr *ip6;</div>
<div class="line">    uint8_t *nexthdr, *pad_len;</div>
<div class="line">    uint8_t *padding;</div>
<div class="line">    uint16_t i;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a28"></a><a class="code" href="structrte__ipsec__session.html">rte_ipsec_session</a> *ips;</div>
<div class="line"> </div>
<div class="line">    RTE_ASSERT(m != NULL);</div>
<div class="line">    RTE_ASSERT(<a name="a29"></a><a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a> != NULL);</div>
<div class="line">    RTE_ASSERT(cop != NULL);</div>
<div class="line"> </div>
<div class="line">    ips = ipsec_get_primary_session(<a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((ips-&gt;<a name="a30"></a><a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> == <a name="a31"></a><a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f">RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</a>) ||</div>
<div class="line">            (ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> == <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116">RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</a>)) {</div>
<div class="line">        <span class="keywordflow">if</span> (m-&gt;<a name="a32"></a><a class="code" href="structrte__mbuf.html#a319d580a6e1ef13692631d7b0d6d5c98">ol_flags</a> &amp; <a name="a33"></a><a class="code" href="rte__mbuf__core_8h.html#a87d6352dee4dd78c55d943aa814b0491">PKT_RX_SEC_OFFLOAD</a>) {</div>
<div class="line">            <span class="keywordflow">if</span> (m-&gt;<a class="code" href="structrte__mbuf.html#a319d580a6e1ef13692631d7b0d6d5c98">ol_flags</a> &amp; <a name="a34"></a><a class="code" href="rte__mbuf__core_8h.html#a959f5d1aeb2487dcf748a6a41c5f0438">PKT_RX_SEC_OFFLOAD_FAILED</a>)</div>
<div class="line">                cop-&gt;<a name="a35"></a><a class="code" href="structrte__crypto__op.html#ade818037fd6c985038ff29656089758d">status</a> = <a name="a36"></a><a class="code" href="rte__crypto_8h.html#afe16508b77c2a8dc5caf74a4e9850171a8f28ff915b51b2a2b1ef351b3a66bdb6">RTE_CRYPTO_OP_STATUS_ERROR</a>;</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                cop-&gt;<a class="code" href="structrte__crypto__op.html#ade818037fd6c985038ff29656089758d">status</a> = <a name="a37"></a><a class="code" href="rte__crypto_8h.html#afe16508b77c2a8dc5caf74a4e9850171a845e1765bcab3b42614df5de2ef4fd74">RTE_CRYPTO_OP_STATUS_SUCCESS</a>;</div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line">            cop-&gt;<a class="code" href="structrte__crypto__op.html#ade818037fd6c985038ff29656089758d">status</a> = <a name="a38"></a><a class="code" href="rte__crypto_8h.html#afe16508b77c2a8dc5caf74a4e9850171abf99a223ed848ecec30ee7aa80743dc0">RTE_CRYPTO_OP_STATUS_NOT_PROCESSED</a>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cop-&gt;<a class="code" href="structrte__crypto__op.html#ade818037fd6c985038ff29656089758d">status</a> != <a class="code" href="rte__crypto_8h.html#afe16508b77c2a8dc5caf74a4e9850171a845e1765bcab3b42614df5de2ef4fd74">RTE_CRYPTO_OP_STATUS_SUCCESS</a>) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC_ESP, <span class="stringliteral">&quot;%s() failed crypto op\n&quot;</span>, __func__);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> == <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116">RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</a> &amp;&amp;</div>
<div class="line">        ips-&gt;<a name="a39"></a>security.ol_flags &amp; <a name="a40"></a><a class="code" href="rte__security_8h.html#a8c507948cec44ce3a96372b3ca4bd7a2">RTE_SECURITY_RX_HW_TRAILER_OFFLOAD</a>) {</div>
<div class="line">        nexthdr = &amp;m-&gt;<a name="a41"></a><a class="code" href="structrte__mbuf.html#ae0c78ca909c1082b27f5079e5ab9fd00">inner_esp_next_proto</a>;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        nexthdr = <a class="code" href="rte__mbuf__core_8h.html#ad63e1de0ec54d7c7603ea984c76ca956">rte_pktmbuf_mtod_offset</a>(m, uint8_t*,</div>
<div class="line">                <a class="code" href="rte__mbuf_8h.html#a7a7ea614c79d5b9ed790a56c1c79189d">rte_pktmbuf_pkt_len</a>(m) - <a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>-&gt;digest_len - 1);</div>
<div class="line">        pad_len = nexthdr - 1;</div>
<div class="line"> </div>
<div class="line">        padding = pad_len - *pad_len;</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; *pad_len; i++) {</div>
<div class="line">            <span class="keywordflow">if</span> (padding[i] != i + 1) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC_ESP, <span class="stringliteral">&quot;invalid padding\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a42"></a><a class="code" href="rte__mbuf_8h.html#abe1bed439015acec170d1342e8dabb3b">rte_pktmbuf_trim</a>(m, *pad_len + 2 + <a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>-&gt;digest_len)) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC_ESP,</div>
<div class="line">                    <span class="stringliteral">&quot;failed to remove pad_len + digest\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a43"></a><a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(IS_TRANSPORT(<a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>-&gt;flags))) {</div>
<div class="line">        ip = <a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(m, <span class="keyword">struct</span> ip *);</div>
<div class="line">        ip4 = (<span class="keyword">struct </span>ip *)<a name="a44"></a><a class="code" href="rte__mbuf_8h.html#a1bbd752194759ce7b419c4998f2e8651">rte_pktmbuf_adj</a>(m,</div>
<div class="line">                <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a>) + sa-&gt;iv_len);</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#a217a0bd562b98ae8c2ffce44935351e1">likely</a>(ip-&gt;ip_v == IPVERSION)) {</div>
<div class="line">            memmove(ip4, ip, ip-&gt;ip_hl * 4);</div>
<div class="line">            ip4-&gt;ip_p = *nexthdr;</div>
<div class="line">            ip4-&gt;ip_len = htons(<a name="a45"></a><a class="code" href="rte__mbuf_8h.html#a2a1e1b30162161ed11d3ba2faf7bbf13">rte_pktmbuf_data_len</a>(m));</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            ip6 = (<span class="keyword">struct </span>ip6_hdr *)ip4;</div>
<div class="line">            <span class="comment">/* XXX No option headers supported */</span></div>
<div class="line">            memmove(ip6, ip, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> ip6_hdr));</div>
<div class="line">            ip6-&gt;ip6_nxt = *nexthdr;</div>
<div class="line">            ip6-&gt;ip6_plen = htons(<a class="code" href="rte__mbuf_8h.html#a2a1e1b30162161ed11d3ba2faf7bbf13">rte_pktmbuf_data_len</a>(m) -</div>
<div class="line">                          <span class="keyword">sizeof</span>(<span class="keyword">struct</span> ip6_hdr));</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span></div>
<div class="line">        ipip_inbound(m, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a>) + sa-&gt;iv_len);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">esp_outbound(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m, <span class="keyword">struct</span> ipsec_sa *sa,</div>
<div class="line">        <span class="keyword">struct</span> <a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> *cop)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>ip *ip4;</div>
<div class="line">    <span class="keyword">struct </span>ip6_hdr *ip6;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a> *esp = NULL;</div>
<div class="line">    uint8_t *padding = NULL, *new_ip, nlp;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__sym__op.html">rte_crypto_sym_op</a> *sym_cop;</div>
<div class="line">    int32_t i;</div>
<div class="line">    uint16_t pad_payload_len, pad_len, ip_hdr_len;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ipsec__session.html">rte_ipsec_session</a> *ips;</div>
<div class="line"> </div>
<div class="line">    RTE_ASSERT(m != NULL);</div>
<div class="line">    RTE_ASSERT(<a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a> != NULL);</div>
<div class="line"> </div>
<div class="line">    ips = ipsec_get_primary_session(<a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>);</div>
<div class="line">    ip_hdr_len = 0;</div>
<div class="line"> </div>
<div class="line">    ip4 = <a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(m, <span class="keyword">struct</span> ip *);</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#a217a0bd562b98ae8c2ffce44935351e1">likely</a>(ip4-&gt;ip_v == IPVERSION)) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(IS_TRANSPORT(<a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>-&gt;flags))) {</div>
<div class="line">            ip_hdr_len = ip4-&gt;ip_hl * 4;</div>
<div class="line">            nlp = ip4-&gt;ip_p;</div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line">            nlp = IPPROTO_IPIP;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ip4-&gt;ip_v == IP6_VERSION) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(IS_TRANSPORT(<a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>-&gt;flags))) {</div>
<div class="line">            <span class="comment">/* XXX No option headers supported */</span></div>
<div class="line">            ip_hdr_len = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>ip6_hdr);</div>
<div class="line">            ip6 = (<span class="keyword">struct </span>ip6_hdr *)ip4;</div>
<div class="line">            nlp = ip6-&gt;ip6_nxt;</div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line">            nlp = IPPROTO_IPV6;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC_ESP, <span class="stringliteral">&quot;invalid IP packet type %d\n&quot;</span>,</div>
<div class="line">                ip4-&gt;ip_v);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Padded payload length */</span></div>
<div class="line">    pad_payload_len = <a name="a46"></a><a class="code" href="rte__common_8h.html#a856650153655096752b4c2a29690a15d">RTE_ALIGN_CEIL</a>(<a class="code" href="rte__mbuf_8h.html#a7a7ea614c79d5b9ed790a56c1c79189d">rte_pktmbuf_pkt_len</a>(m) -</div>
<div class="line">            ip_hdr_len + 2, sa-&gt;block_size);</div>
<div class="line">    pad_len = pad_payload_len + ip_hdr_len - <a class="code" href="rte__mbuf_8h.html#a7a7ea614c79d5b9ed790a56c1c79189d">rte_pktmbuf_pkt_len</a>(m);</div>
<div class="line"> </div>
<div class="line">    RTE_ASSERT(IS_TUNNEL(sa-&gt;flags) || IS_TRANSPORT(sa-&gt;flags));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#a217a0bd562b98ae8c2ffce44935351e1">likely</a>(IS_IP4_TUNNEL(sa-&gt;flags)))</div>
<div class="line">        ip_hdr_len = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>ip);</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IS_IP6_TUNNEL(sa-&gt;flags))</div>
<div class="line">        ip_hdr_len = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>ip6_hdr);</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!IS_TRANSPORT(sa-&gt;flags)) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC_ESP, <span class="stringliteral">&quot;Unsupported SA flags: 0x%x\n&quot;</span>,</div>
<div class="line">                sa-&gt;flags);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check maximum packet size */</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(ip_hdr_len + <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a>) + sa-&gt;iv_len +</div>
<div class="line">            pad_payload_len + sa-&gt;digest_len &gt; IP_MAXPACKET)) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC_ESP, <span class="stringliteral">&quot;ipsec packet is too big\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Add trailer padding if it is not constructed by HW */</span></div>
<div class="line">    <span class="keywordflow">if</span> (ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> != <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116">RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</a> ||</div>
<div class="line">        (ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> == <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116">RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</a> &amp;&amp;</div>
<div class="line">         !(ips-&gt;security.ol_flags &amp;</div>
<div class="line">             <a name="a47"></a><a class="code" href="rte__security_8h.html#ae7a4e7b862ba5ce383229caccc45eee2">RTE_SECURITY_TX_HW_TRAILER_OFFLOAD</a>))) {</div>
<div class="line">        padding = (uint8_t *)<a name="a48"></a><a class="code" href="rte__mbuf_8h.html#ad5b0cd686ad3bcbb83416ca8395a080b">rte_pktmbuf_append</a>(m, pad_len +</div>
<div class="line">                            sa-&gt;digest_len);</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(padding == NULL)) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC_ESP,</div>
<div class="line">                    <span class="stringliteral">&quot;not enough mbuf trailing space\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -ENOSPC;</div>
<div class="line">        }</div>
<div class="line">        <a name="a49"></a><a class="code" href="rte__prefetch_8h.html#a7f89cf66766e6bfd63feb370a7280de9">rte_prefetch0</a>(padding);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (WITHOUT_TRANSPORT_VERSION(sa-&gt;flags)) {</div>
<div class="line">    <span class="keywordflow">case</span> IP4_TUNNEL:</div>
<div class="line">        ip4 = ip4ip_outbound(m, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a>) + sa-&gt;iv_len,</div>
<div class="line">                &amp;sa-&gt;src, &amp;sa-&gt;dst);</div>
<div class="line">        esp = (<span class="keyword">struct </span><a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a> *)(ip4 + 1);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> IP6_TUNNEL:</div>
<div class="line">        ip6 = ip6ip_outbound(m, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a>) + sa-&gt;iv_len,</div>
<div class="line">                &amp;sa-&gt;src, &amp;sa-&gt;dst);</div>
<div class="line">        esp = (<span class="keyword">struct </span><a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a> *)(ip6 + 1);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> TRANSPORT:</div>
<div class="line">        new_ip = (uint8_t *)<a name="a50"></a><a class="code" href="rte__mbuf_8h.html#aadf5bef4ceb0b76dfafff0895f285ab0">rte_pktmbuf_prepend</a>(m,</div>
<div class="line">                <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a>) + sa-&gt;iv_len);</div>
<div class="line">        memmove(new_ip, ip4, ip_hdr_len);</div>
<div class="line">        esp = (<span class="keyword">struct </span><a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a> *)(new_ip + ip_hdr_len);</div>
<div class="line">        ip4 = (<span class="keyword">struct </span>ip *)new_ip;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#a217a0bd562b98ae8c2ffce44935351e1">likely</a>(ip4-&gt;ip_v == IPVERSION)) {</div>
<div class="line">            ip4-&gt;ip_p = IPPROTO_ESP;</div>
<div class="line">            ip4-&gt;ip_len = htons(<a class="code" href="rte__mbuf_8h.html#a2a1e1b30162161ed11d3ba2faf7bbf13">rte_pktmbuf_data_len</a>(m));</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            ip6 = (<span class="keyword">struct </span>ip6_hdr *)new_ip;</div>
<div class="line">            ip6-&gt;ip6_nxt = IPPROTO_ESP;</div>
<div class="line">            ip6-&gt;ip6_plen = htons(<a class="code" href="rte__mbuf_8h.html#a2a1e1b30162161ed11d3ba2faf7bbf13">rte_pktmbuf_data_len</a>(m) -</div>
<div class="line">                          <span class="keyword">sizeof</span>(<span class="keyword">struct</span> ip6_hdr));</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    sa-&gt;seq++;</div>
<div class="line">    esp-&gt;<a name="a51"></a><a class="code" href="structrte__esp__hdr.html#ade83e664f1375a837252e7bbb6d53a67">spi</a> = <a class="code" href="rte__byteorder_8h.html#a6b1dd5d5a4c60c1d72ba48c523eba45c">rte_cpu_to_be_32</a>(sa-&gt;spi);</div>
<div class="line">    esp-&gt;<a name="a52"></a><a class="code" href="structrte__esp__hdr.html#a141c580194b9c4325f73832c281f1d3d">seq</a> = <a class="code" href="rte__byteorder_8h.html#a6b1dd5d5a4c60c1d72ba48c523eba45c">rte_cpu_to_be_32</a>((uint32_t)sa-&gt;seq);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* set iv */</span></div>
<div class="line">    uint64_t *iv = (uint64_t *)(esp + 1);</div>
<div class="line">    <span class="keywordflow">if</span> (sa-&gt;aead_algo == <a class="code" href="rte__crypto__sym_8h.html#a648bc317af3ee238310fac9d87512508ab8b38d7173d30b7adf47116abb09c469">RTE_CRYPTO_AEAD_AES_GCM</a>) {</div>
<div class="line">        *iv = <a name="a53"></a><a class="code" href="rte__byteorder_8h.html#aac3cd87649f12ee04e12e116ff455336">rte_cpu_to_be_64</a>(sa-&gt;seq);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">switch</span> (sa-&gt;cipher_algo) {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eacc63a4618def739e08bb778de9f6e077">RTE_CRYPTO_CIPHER_NULL</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eaed8720577f149444ab479ee7415dbfb2">RTE_CRYPTO_CIPHER_3DES_CBC</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ead9f8e28815f3dd2b77e7ce93b7b8a7ca">RTE_CRYPTO_CIPHER_AES_CBC</a>:</div>
<div class="line">            memset(iv, 0, sa-&gt;iv_len);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ea5b5278dda15b9961d6f525dc0525ea95">RTE_CRYPTO_CIPHER_AES_CTR</a>:</div>
<div class="line">            *iv = <a class="code" href="rte__byteorder_8h.html#aac3cd87649f12ee04e12e116ff455336">rte_cpu_to_be_64</a>(sa-&gt;seq);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC_ESP,</div>
<div class="line">                <span class="stringliteral">&quot;unsupported cipher algorithm %u\n&quot;</span>,</div>
<div class="line">                sa-&gt;cipher_algo);</div>
<div class="line">            <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> == <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116">RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</a>) {</div>
<div class="line">        <span class="keywordflow">if</span> (ips-&gt;security.ol_flags &amp;</div>
<div class="line">                <a class="code" href="rte__security_8h.html#ae7a4e7b862ba5ce383229caccc45eee2">RTE_SECURITY_TX_HW_TRAILER_OFFLOAD</a>) {</div>
<div class="line">            <span class="comment">/* Set the inner esp next protocol for HW trailer */</span></div>
<div class="line">            m-&gt;<a class="code" href="structrte__mbuf.html#ae0c78ca909c1082b27f5079e5ab9fd00">inner_esp_next_proto</a> = nlp;</div>
<div class="line">            m-&gt;<a name="a54"></a><a class="code" href="structrte__mbuf.html#a8d0990e39ae8f91a4937083eead6b65f">packet_type</a> |= <a name="a55"></a><a class="code" href="rte__mbuf__ptype_8h.html#a5b86ec0495f9813868aff8ed5be2fe8a">RTE_PTYPE_TUNNEL_ESP</a>;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            padding[pad_len - 2] = pad_len - 2;</div>
<div class="line">            padding[pad_len - 1] = nlp;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">goto</span> done;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    RTE_ASSERT(cop != NULL);</div>
<div class="line">    sym_cop = get_sym_cop(cop);</div>
<div class="line">    sym_cop-&gt;<a class="code" href="structrte__crypto__sym__op.html#af021669494a2806b0569587e2096e88e">m_src</a> = m;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (sa-&gt;aead_algo == <a class="code" href="rte__crypto__sym_8h.html#a648bc317af3ee238310fac9d87512508ab8b38d7173d30b7adf47116abb09c469">RTE_CRYPTO_AEAD_AES_GCM</a>) {</div>
<div class="line">        uint8_t *aad;</div>
<div class="line"> </div>
<div class="line">        sym_cop-&gt;aead.data.offset = ip_hdr_len +</div>
<div class="line">            <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a>) + sa-&gt;iv_len;</div>
<div class="line">        sym_cop-&gt;aead.data.length = pad_payload_len;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Fill pad_len using default sequential scheme */</span></div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; pad_len - 2; i++)</div>
<div class="line">            padding[i] = i + 1;</div>
<div class="line">        padding[pad_len - 2] = pad_len - 2;</div>
<div class="line">        padding[pad_len - 1] = nlp;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">struct </span>cnt_blk *icb = get_cnt_blk(m);</div>
<div class="line">        icb-&gt;salt = sa-&gt;salt;</div>
<div class="line">        icb-&gt;iv = <a class="code" href="rte__byteorder_8h.html#aac3cd87649f12ee04e12e116ff455336">rte_cpu_to_be_64</a>(sa-&gt;seq);</div>
<div class="line">        icb-&gt;cnt = <a class="code" href="rte__byteorder_8h.html#a6b1dd5d5a4c60c1d72ba48c523eba45c">rte_cpu_to_be_32</a>(1);</div>
<div class="line"> </div>
<div class="line">        aad = get_aad(m);</div>
<div class="line">        memcpy(aad, esp, 8);</div>
<div class="line">        sym_cop-&gt;aead.aad.data = aad;</div>
<div class="line">        sym_cop-&gt;aead.aad.phys_addr = <a class="code" href="rte__mbuf__core_8h.html#a0aba9fed77ad814d952958d448c71f38">rte_pktmbuf_iova_offset</a>(m,</div>
<div class="line">                aad - <a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(m, uint8_t *));</div>
<div class="line"> </div>
<div class="line">        sym_cop-&gt;aead.digest.data = <a class="code" href="rte__mbuf__core_8h.html#ad63e1de0ec54d7c7603ea984c76ca956">rte_pktmbuf_mtod_offset</a>(m, uint8_t *,</div>
<div class="line">            <a class="code" href="rte__mbuf_8h.html#a7a7ea614c79d5b9ed790a56c1c79189d">rte_pktmbuf_pkt_len</a>(m) - sa-&gt;digest_len);</div>
<div class="line">        sym_cop-&gt;aead.digest.phys_addr = <a class="code" href="rte__mbuf__core_8h.html#a0aba9fed77ad814d952958d448c71f38">rte_pktmbuf_iova_offset</a>(m,</div>
<div class="line">            <a class="code" href="rte__mbuf_8h.html#a7a7ea614c79d5b9ed790a56c1c79189d">rte_pktmbuf_pkt_len</a>(m) - sa-&gt;digest_len);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">switch</span> (sa-&gt;cipher_algo) {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eacc63a4618def739e08bb778de9f6e077">RTE_CRYPTO_CIPHER_NULL</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eaed8720577f149444ab479ee7415dbfb2">RTE_CRYPTO_CIPHER_3DES_CBC</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ead9f8e28815f3dd2b77e7ce93b7b8a7ca">RTE_CRYPTO_CIPHER_AES_CBC</a>:</div>
<div class="line">            sym_cop-&gt;cipher.data.offset = ip_hdr_len +</div>
<div class="line">                <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a>);</div>
<div class="line">            sym_cop-&gt;cipher.data.length = pad_payload_len + sa-&gt;iv_len;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ea5b5278dda15b9961d6f525dc0525ea95">RTE_CRYPTO_CIPHER_AES_CTR</a>:</div>
<div class="line">            sym_cop-&gt;cipher.data.offset = ip_hdr_len +</div>
<div class="line">                <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a>) + sa-&gt;iv_len;</div>
<div class="line">            sym_cop-&gt;cipher.data.length = pad_payload_len;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC_ESP, <span class="stringliteral">&quot;unsupported cipher algorithm %u\n&quot;</span>,</div>
<div class="line">                    sa-&gt;cipher_algo);</div>
<div class="line">            <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Fill pad_len using default sequential scheme */</span></div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; pad_len - 2; i++)</div>
<div class="line">            padding[i] = i + 1;</div>
<div class="line">        padding[pad_len - 2] = pad_len - 2;</div>
<div class="line">        padding[pad_len - 1] = nlp;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">struct </span>cnt_blk *icb = get_cnt_blk(m);</div>
<div class="line">        icb-&gt;salt = sa-&gt;salt;</div>
<div class="line">        icb-&gt;iv = <a class="code" href="rte__byteorder_8h.html#aac3cd87649f12ee04e12e116ff455336">rte_cpu_to_be_64</a>(sa-&gt;seq);</div>
<div class="line">        icb-&gt;cnt = <a class="code" href="rte__byteorder_8h.html#a6b1dd5d5a4c60c1d72ba48c523eba45c">rte_cpu_to_be_32</a>(1);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">switch</span> (sa-&gt;auth_algo) {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793a9ea752ee9e74822da84cb75ef90cf583">RTE_CRYPTO_AUTH_NULL</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793a98921a1d0174e6ec9f252b408dd39d20">RTE_CRYPTO_AUTH_SHA1_HMAC</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793ad1b12ffc0e9202c46cff017c0bbcd6eb">RTE_CRYPTO_AUTH_SHA256_HMAC</a>:</div>
<div class="line">            sym_cop-&gt;auth.data.offset = ip_hdr_len;</div>
<div class="line">            sym_cop-&gt;auth.data.length = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrte__esp__hdr.html">rte_esp_hdr</a>) +</div>
<div class="line">                sa-&gt;iv_len + pad_payload_len;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC_ESP, <span class="stringliteral">&quot;unsupported auth algorithm %u\n&quot;</span>,</div>
<div class="line">                    sa-&gt;auth_algo);</div>
<div class="line">            <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        sym_cop-&gt;auth.digest.data = <a class="code" href="rte__mbuf__core_8h.html#ad63e1de0ec54d7c7603ea984c76ca956">rte_pktmbuf_mtod_offset</a>(m, uint8_t *,</div>
<div class="line">                <a class="code" href="rte__mbuf_8h.html#a7a7ea614c79d5b9ed790a56c1c79189d">rte_pktmbuf_pkt_len</a>(m) - sa-&gt;digest_len);</div>
<div class="line">        sym_cop-&gt;auth.digest.phys_addr = <a class="code" href="rte__mbuf__core_8h.html#a0aba9fed77ad814d952958d448c71f38">rte_pktmbuf_iova_offset</a>(m,</div>
<div class="line">                <a class="code" href="rte__mbuf_8h.html#a7a7ea614c79d5b9ed790a56c1c79189d">rte_pktmbuf_pkt_len</a>(m) - sa-&gt;digest_len);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">done:</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">esp_outbound_post(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m,</div>
<div class="line">          <span class="keyword">struct</span> ipsec_sa *sa,</div>
<div class="line">          <span class="keyword">struct</span> <a class="code" href="structrte__crypto__op.html">rte_crypto_op</a> *cop)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165">rte_security_session_action_type</a> type;</div>
<div class="line">    RTE_ASSERT(m != NULL);</div>
<div class="line">    RTE_ASSERT(sa != NULL);</div>
<div class="line"> </div>
<div class="line">    type = ipsec_get_action_type(sa);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((type == <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f">RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</a>) ||</div>
<div class="line">            (type == <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116">RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</a>)) {</div>
<div class="line">        m-&gt;<a class="code" href="structrte__mbuf.html#a319d580a6e1ef13692631d7b0d6d5c98">ol_flags</a> |= <a name="a56"></a><a class="code" href="rte__mbuf__core_8h.html#ac96de1a778092073c21e54e4ac07fc6c">PKT_TX_SEC_OFFLOAD</a>;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        RTE_ASSERT(cop != NULL);</div>
<div class="line">        <span class="keywordflow">if</span> (cop-&gt;<a class="code" href="structrte__crypto__op.html#ade818037fd6c985038ff29656089758d">status</a> != <a class="code" href="rte__crypto_8h.html#afe16508b77c2a8dc5caf74a4e9850171a845e1765bcab3b42614df5de2ef4fd74">RTE_CRYPTO_OP_STATUS_SUCCESS</a>) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC_ESP, <span class="stringliteral">&quot;%s() failed crypto op\n&quot;</span>,</div>
<div class="line">                __func__);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="astructrte__crypto__op_html_ade818037fd6c985038ff29656089758d"><div class="ttname"><a href="structrte__crypto__op.html#ade818037fd6c985038ff29656089758d">rte_crypto_op::status</a></div><div class="ttdeci">uint8_t status</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00086">rte_crypto.h:86</a></div></div>
<div class="ttc" id="arte__byteorder_8h_html_aac3cd87649f12ee04e12e116ff455336"><div class="ttname"><a href="rte__byteorder_8h.html#aac3cd87649f12ee04e12e116ff455336">rte_cpu_to_be_64</a></div><div class="ttdeci">static rte_be64_t rte_cpu_to_be_64(uint64_t x)</div></div>
<div class="ttc" id="arte__security_8h_html_ae7a4e7b862ba5ce383229caccc45eee2"><div class="ttname"><a href="rte__security_8h.html#ae7a4e7b862ba5ce383229caccc45eee2">RTE_SECURITY_TX_HW_TRAILER_OFFLOAD</a></div><div class="ttdeci">#define RTE_SECURITY_TX_HW_TRAILER_OFFLOAD</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00712">rte_security.h:707</a></div></div>
<div class="ttc" id="arte__crypto_8h_html_afe16508b77c2a8dc5caf74a4e9850171a845e1765bcab3b42614df5de2ef4fd74"><div class="ttname"><a href="rte__crypto_8h.html#afe16508b77c2a8dc5caf74a4e9850171a845e1765bcab3b42614df5de2ef4fd74">RTE_CRYPTO_OP_STATUS_SUCCESS</a></div><div class="ttdeci">@ RTE_CRYPTO_OP_STATUS_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00041">rte_crypto.h:40</a></div></div>
<div class="ttc" id="arte__common_8h_html_a856650153655096752b4c2a29690a15d"><div class="ttname"><a href="rte__common_8h.html#a856650153655096752b4c2a29690a15d">RTE_ALIGN_CEIL</a></div><div class="ttdeci">#define RTE_ALIGN_CEIL(val, align)</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00304">rte_common.h:304</a></div></div>
<div class="ttc" id="arte__prefetch_8h_html_a7f89cf66766e6bfd63feb370a7280de9"><div class="ttname"><a href="rte__prefetch_8h.html#a7f89cf66766e6bfd63feb370a7280de9">rte_prefetch0</a></div><div class="ttdeci">static void rte_prefetch0(const volatile void *p)</div></div>
<div class="ttc" id="arte__security_8h_html_a4ace8d873b2a4832039eb2f964b12165"><div class="ttname"><a href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165">rte_security_session_action_type</a></div><div class="ttdeci">rte_security_session_action_type</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00330">rte_security.h:330</a></div></div>
<div class="ttc" id="arte__branch__prediction_8h_html_ac6c45889010c1bd68631771b64f18101"><div class="ttname"><a href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a></div><div class="ttdeci">#define unlikely(x)</div><div class="ttdef"><b>Definition:</b> <a href="rte__branch__prediction_8h_source.html#l00038">rte_branch_prediction.h:38</a></div></div>
<div class="ttc" id="arte__security_8h_html_a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f"><div class="ttname"><a href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f">RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</a></div><div class="ttdeci">@ RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00340">rte_security.h:337</a></div></div>
<div class="ttc" id="arte__crypto_8h_html"><div class="ttname"><a href="rte__crypto_8h.html">rte_crypto.h</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a6e6d5d3329c585088678e9d52b50f75eacc63a4618def739e08bb778de9f6e077"><div class="ttname"><a href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eacc63a4618def739e08bb778de9f6e077">RTE_CRYPTO_CIPHER_NULL</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_NULL</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00117">rte_crypto_sym.h:116</a></div></div>
<div class="ttc" id="arte__common_8h_html_a96c6294ef6a307980f78899fe8a5813e"><div class="ttname"><a href="rte__common_8h.html#a96c6294ef6a307980f78899fe8a5813e">RTE_PTR_ADD</a></div><div class="ttdeci">#define RTE_PTR_ADD(ptr, x)</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00248">rte_common.h:248</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html"><div class="ttname"><a href="rte__cryptodev_8h.html">rte_cryptodev.h</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a275814f8c016f661c72b320295d91793a98921a1d0174e6ec9f252b408dd39d20"><div class="ttname"><a href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793a98921a1d0174e6ec9f252b408dd39d20">RTE_CRYPTO_AUTH_SHA1_HMAC</a></div><div class="ttdeci">@ RTE_CRYPTO_AUTH_SHA1_HMAC</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00304">rte_crypto_sym.h:300</a></div></div>
<div class="ttc" id="arte__memcpy_8h_html_a09f4d8cdb1a7c25398a363906e1db8cd"><div class="ttname"><a href="rte__memcpy_8h.html#a09f4d8cdb1a7c25398a363906e1db8cd">rte_memcpy</a></div><div class="ttdeci">static void * rte_memcpy(void *dst, const void *src, size_t n)</div></div>
<div class="ttc" id="astructrte__esp__hdr_html_ade83e664f1375a837252e7bbb6d53a67"><div class="ttname"><a href="structrte__esp__hdr.html#ade83e664f1375a837252e7bbb6d53a67">rte_esp_hdr::spi</a></div><div class="ttdeci">rte_be32_t spi</div><div class="ttdef"><b>Definition:</b> <a href="rte__esp_8h_source.html#l00024">rte_esp.h:24</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_ac96de1a778092073c21e54e4ac07fc6c"><div class="ttname"><a href="rte__mbuf__core_8h.html#ac96de1a778092073c21e54e4ac07fc6c">PKT_TX_SEC_OFFLOAD</a></div><div class="ttdeci">#define PKT_TX_SEC_OFFLOAD</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00221">rte_mbuf_core.h:221</a></div></div>
<div class="ttc" id="astructrte__mbuf_html"><div class="ttname"><a href="structrte__mbuf.html">rte_mbuf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00473">rte_mbuf_core.h:473</a></div></div>
<div class="ttc" id="arte__security_8h_html_a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116"><div class="ttname"><a href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116">RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</a></div><div class="ttdeci">@ RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00336">rte_security.h:333</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_a87d6352dee4dd78c55d943aa814b0491"><div class="ttname"><a href="rte__mbuf__core_8h.html#a87d6352dee4dd78c55d943aa814b0491">PKT_RX_SEC_OFFLOAD</a></div><div class="ttdeci">#define PKT_RX_SEC_OFFLOAD</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00157">rte_mbuf_core.h:157</a></div></div>
<div class="ttc" id="astructrte__crypto__op_html"><div class="ttname"><a href="structrte__crypto__op.html">rte_crypto_op</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00078">rte_crypto.h:78</a></div></div>
<div class="ttc" id="astructrte__crypto__sym__op_html_af021669494a2806b0569587e2096e88e"><div class="ttname"><a href="structrte__crypto__sym__op.html#af021669494a2806b0569587e2096e88e">rte_crypto_sym_op::m_src</a></div><div class="ttdeci">struct rte_mbuf * m_src</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00592">rte_crypto_sym.h:592</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_a7a7ea614c79d5b9ed790a56c1c79189d"><div class="ttname"><a href="rte__mbuf_8h.html#a7a7ea614c79d5b9ed790a56c1c79189d">rte_pktmbuf_pkt_len</a></div><div class="ttdeci">#define rte_pktmbuf_pkt_len(m)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01545">rte_mbuf.h:1545</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a6e6d5d3329c585088678e9d52b50f75ea5b5278dda15b9961d6f525dc0525ea95"><div class="ttname"><a href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ea5b5278dda15b9961d6f525dc0525ea95">RTE_CRYPTO_CIPHER_AES_CTR</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_AES_CTR</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00129">rte_crypto_sym.h:128</a></div></div>
<div class="ttc" id="astructrte__mbuf_html_a8d0990e39ae8f91a4937083eead6b65f"><div class="ttname"><a href="structrte__mbuf.html#a8d0990e39ae8f91a4937083eead6b65f">rte_mbuf::packet_type</a></div><div class="ttdeci">uint32_t packet_type</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00519">rte_mbuf_core.h:519</a></div></div>
<div class="ttc" id="astructrte__ipsec__session_html_aa8f42f3a36d2c036ccb27f0b74b25160"><div class="ttname"><a href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">rte_ipsec_session::sa</a></div><div class="ttdeci">struct rte_ipsec_sa * sa</div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec_8h_source.html#l00063">rte_ipsec.h:63</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_abe1bed439015acec170d1342e8dabb3b"><div class="ttname"><a href="rte__mbuf_8h.html#abe1bed439015acec170d1342e8dabb3b">rte_pktmbuf_trim</a></div><div class="ttdeci">static int rte_pktmbuf_trim(struct rte_mbuf *m, uint16_t len)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01666">rte_mbuf.h:1666</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_ad63e1de0ec54d7c7603ea984c76ca956"><div class="ttname"><a href="rte__mbuf__core_8h.html#ad63e1de0ec54d7c7603ea984c76ca956">rte_pktmbuf_mtod_offset</a></div><div class="ttdeci">#define rte_pktmbuf_mtod_offset(m, t, o)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00711">rte_mbuf_core.h:711</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a6e6d5d3329c585088678e9d52b50f75ead9f8e28815f3dd2b77e7ce93b7b8a7ca"><div class="ttname"><a href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75ead9f8e28815f3dd2b77e7ce93b7b8a7ca">RTE_CRYPTO_CIPHER_AES_CBC</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_AES_CBC</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00127">rte_crypto_sym.h:126</a></div></div>
<div class="ttc" id="arte__crypto_8h_html_afe16508b77c2a8dc5caf74a4e9850171abf99a223ed848ecec30ee7aa80743dc0"><div class="ttname"><a href="rte__crypto_8h.html#afe16508b77c2a8dc5caf74a4e9850171abf99a223ed848ecec30ee7aa80743dc0">RTE_CRYPTO_OP_STATUS_NOT_PROCESSED</a></div><div class="ttdeci">@ RTE_CRYPTO_OP_STATUS_NOT_PROCESSED</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00043">rte_crypto.h:42</a></div></div>
<div class="ttc" id="astructrte__mbuf_html_ae0c78ca909c1082b27f5079e5ab9fd00"><div class="ttname"><a href="structrte__mbuf.html#ae0c78ca909c1082b27f5079e5ab9fd00">rte_mbuf::inner_esp_next_proto</a></div><div class="ttdeci">uint8_t inner_esp_next_proto</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00528">rte_mbuf_core.h:528</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_a1bbd752194759ce7b419c4998f2e8651"><div class="ttname"><a href="rte__mbuf_8h.html#a1bbd752194759ce7b419c4998f2e8651">rte_pktmbuf_adj</a></div><div class="ttdeci">static char * rte_pktmbuf_adj(struct rte_mbuf *m, uint16_t len)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01636">rte_mbuf.h:1636</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_ad5b0cd686ad3bcbb83416ca8395a080b"><div class="ttname"><a href="rte__mbuf_8h.html#ad5b0cd686ad3bcbb83416ca8395a080b">rte_pktmbuf_append</a></div><div class="ttdeci">static char * rte_pktmbuf_append(struct rte_mbuf *m, uint16_t len)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01605">rte_mbuf.h:1605</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_a2a8b10263496c7b580e9d0c7f2a1f073"><div class="ttname"><a href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a></div><div class="ttdeci">#define rte_pktmbuf_mtod(m, t)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00726">rte_mbuf_core.h:726</a></div></div>
<div class="ttc" id="astructrte__esp__hdr_html_a141c580194b9c4325f73832c281f1d3d"><div class="ttname"><a href="structrte__esp__hdr.html#a141c580194b9c4325f73832c281f1d3d">rte_esp_hdr::seq</a></div><div class="ttdeci">rte_be32_t seq</div><div class="ttdef"><b>Definition:</b> <a href="rte__esp_8h_source.html#l00025">rte_esp.h:25</a></div></div>
<div class="ttc" id="arte__random_8h_html"><div class="ttname"><a href="rte__random_8h.html">rte_random.h</a></div></div>
<div class="ttc" id="arte__common_8h_html"><div class="ttname"><a href="rte__common_8h.html">rte_common.h</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_aadf5bef4ceb0b76dfafff0895f285ab0"><div class="ttname"><a href="rte__mbuf_8h.html#aadf5bef4ceb0b76dfafff0895f285ab0">rte_pktmbuf_prepend</a></div><div class="ttdeci">static char * rte_pktmbuf_prepend(struct rte_mbuf *m, uint16_t len)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01572">rte_mbuf.h:1572</a></div></div>
<div class="ttc" id="astructrte__ipsec__session_html_adb36704cd7fc83a9e5f8e10720974165"><div class="ttname"><a href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">rte_ipsec_session::type</a></div><div class="ttdeci">enum rte_security_session_action_type type</div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec_8h_source.html#l00063">rte_ipsec.h:65</a></div></div>
<div class="ttc" id="arte__crypto_8h_html_afe16508b77c2a8dc5caf74a4e9850171a8f28ff915b51b2a2b1ef351b3a66bdb6"><div class="ttname"><a href="rte__crypto_8h.html#afe16508b77c2a8dc5caf74a4e9850171a8f28ff915b51b2a2b1ef351b3a66bdb6">RTE_CRYPTO_OP_STATUS_ERROR</a></div><div class="ttdeci">@ RTE_CRYPTO_OP_STATUS_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00054">rte_crypto.h:53</a></div></div>
<div class="ttc" id="arte__security_8h_html_a8c507948cec44ce3a96372b3ca4bd7a2"><div class="ttname"><a href="rte__security_8h.html#a8c507948cec44ce3a96372b3ca4bd7a2">RTE_SECURITY_RX_HW_TRAILER_OFFLOAD</a></div><div class="ttdeci">#define RTE_SECURITY_RX_HW_TRAILER_OFFLOAD</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00718">rte_security.h:713</a></div></div>
<div class="ttc" id="astructrte__mbuf_html_a319d580a6e1ef13692631d7b0d6d5c98"><div class="ttname"><a href="structrte__mbuf.html#a319d580a6e1ef13692631d7b0d6d5c98">rte_mbuf::ol_flags</a></div><div class="ttdeci">uint64_t ol_flags</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00505">rte_mbuf_core.h:505</a></div></div>
<div class="ttc" id="astructrte__ipsec__session_html"><div class="ttname"><a href="structrte__ipsec__session.html">rte_ipsec_session</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec_8h_source.html#l00058">rte_ipsec.h:58</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a275814f8c016f661c72b320295d91793a9ea752ee9e74822da84cb75ef90cf583"><div class="ttname"><a href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793a9ea752ee9e74822da84cb75ef90cf583">RTE_CRYPTO_AUTH_NULL</a></div><div class="ttdeci">@ RTE_CRYPTO_AUTH_NULL</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00279">rte_crypto_sym.h:278</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a648bc317af3ee238310fac9d87512508ab8b38d7173d30b7adf47116abb09c469"><div class="ttname"><a href="rte__crypto__sym_8h.html#a648bc317af3ee238310fac9d87512508ab8b38d7173d30b7adf47116abb09c469">RTE_CRYPTO_AEAD_AES_GCM</a></div><div class="ttdeci">@ RTE_CRYPTO_AEAD_AES_GCM</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00445">rte_crypto_sym.h:444</a></div></div>
<div class="ttc" id="astructrte__esp__hdr_html"><div class="ttname"><a href="structrte__esp__hdr.html">rte_esp_hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__esp_8h_source.html#l00023">rte_esp.h:23</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_a959f5d1aeb2487dcf748a6a41c5f0438"><div class="ttname"><a href="rte__mbuf__core_8h.html#a959f5d1aeb2487dcf748a6a41c5f0438">PKT_RX_SEC_OFFLOAD_FAILED</a></div><div class="ttdeci">#define PKT_RX_SEC_OFFLOAD_FAILED</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00162">rte_mbuf_core.h:162</a></div></div>
<div class="ttc" id="arte__branch__prediction_8h_html_a217a0bd562b98ae8c2ffce44935351e1"><div class="ttname"><a href="rte__branch__prediction_8h.html#a217a0bd562b98ae8c2ffce44935351e1">likely</a></div><div class="ttdeci">#define likely(x)</div><div class="ttdef"><b>Definition:</b> <a href="rte__branch__prediction_8h_source.html#l00024">rte_branch_prediction.h:24</a></div></div>
<div class="ttc" id="arte__byteorder_8h_html_a6b1dd5d5a4c60c1d72ba48c523eba45c"><div class="ttname"><a href="rte__byteorder_8h.html#a6b1dd5d5a4c60c1d72ba48c523eba45c">rte_cpu_to_be_32</a></div><div class="ttdeci">static rte_be32_t rte_cpu_to_be_32(uint32_t x)</div></div>
<div class="ttc" id="arte__log_8h_html_ac23caeb9833fd0fd0665c6c05ec806fe"><div class="ttname"><a href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a></div><div class="ttdeci">#define RTE_LOG(l, t,...)</div><div class="ttdef"><b>Definition:</b> <a href="rte__log_8h_source.html#l00331">rte_log.h:331</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a6e6d5d3329c585088678e9d52b50f75eaed8720577f149444ab479ee7415dbfb2"><div class="ttname"><a href="rte__crypto__sym_8h.html#a6e6d5d3329c585088678e9d52b50f75eaed8720577f149444ab479ee7415dbfb2">RTE_CRYPTO_CIPHER_3DES_CBC</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_3DES_CBC</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00120">rte_crypto_sym.h:119</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_aecf8ad2a113d395767f5b6cea89f3ee2"><div class="ttname"><a href="rte__cryptodev_8h.html#aecf8ad2a113d395767f5b6cea89f3ee2">rte_crypto_op_ctod_offset</a></div><div class="ttdeci">#define rte_crypto_op_ctod_offset(c, t, o)</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00066">rte_cryptodev.h:66</a></div></div>
<div class="ttc" id="arte__log_8h_html_aeed72aff1af9a59d2de85b96955e21f9"><div class="ttname"><a href="rte__log_8h.html#aeed72aff1af9a59d2de85b96955e21f9">RTE_LOG_DP</a></div><div class="ttdeci">#define RTE_LOG_DP(l, t,...)</div><div class="ttdef"><b>Definition:</b> <a href="rte__log_8h_source.html#l00355">rte_log.h:355</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_a2a1e1b30162161ed11d3ba2faf7bbf13"><div class="ttname"><a href="rte__mbuf_8h.html#a2a1e1b30162161ed11d3ba2faf7bbf13">rte_pktmbuf_data_len</a></div><div class="ttdeci">#define rte_pktmbuf_data_len(m)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01555">rte_mbuf.h:1555</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_a0aba9fed77ad814d952958d448c71f38"><div class="ttname"><a href="rte__mbuf__core_8h.html#a0aba9fed77ad814d952958d448c71f38">rte_pktmbuf_iova_offset</a></div><div class="ttdeci">#define rte_pktmbuf_iova_offset(m, o)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00737">rte_mbuf_core.h:737</a></div></div>
<div class="ttc" id="arte__mbuf__ptype_8h_html_a5b86ec0495f9813868aff8ed5be2fe8a"><div class="ttname"><a href="rte__mbuf__ptype_8h.html#a5b86ec0495f9813868aff8ed5be2fe8a">RTE_PTYPE_TUNNEL_ESP</a></div><div class="ttdeci">#define RTE_PTYPE_TUNNEL_ESP</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__ptype_8h_source.html#l00427">rte_mbuf_ptype.h:427</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a275814f8c016f661c72b320295d91793ad1b12ffc0e9202c46cff017c0bbcd6eb"><div class="ttname"><a href="rte__crypto__sym_8h.html#a275814f8c016f661c72b320295d91793ad1b12ffc0e9202c46cff017c0bbcd6eb">RTE_CRYPTO_AUTH_SHA256_HMAC</a></div><div class="ttdeci">@ RTE_CRYPTO_AUTH_SHA256_HMAC</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00312">rte_crypto_sym.h:311</a></div></div>
<div class="ttc" id="astructrte__crypto__sym__op_html"><div class="ttname"><a href="structrte__crypto__sym__op.html">rte_crypto_sym_op</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00591">rte_crypto_sym.h:591</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
