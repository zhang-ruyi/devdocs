<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DPDK: examples/ipsec-secgw/ipsec_worker.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DPDK
   &#160;<span id="projectnumber">20.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">examples/ipsec-secgw/ipsec_worker.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/* SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment"> * Copyright(c) 2010-2016 Intel Corporation</span></div>
<div class="line"><span class="comment"> * Copyright (C) 2020 Marvell International Ltd.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__acl_8h.html">rte_acl.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__event__eth__tx__adapter_8h.html">rte_event_eth_tx_adapter.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__lpm_8h.html">rte_lpm.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__lpm6_8h.html">rte_lpm6.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;event_helper.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;ipsec.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;ipsec-secgw.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;ipsec_worker.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">enum</span> pkt_type</div>
<div class="line">process_ipsec_get_pkt_type(<span class="keyword">struct</span> <a name="_a0"></a><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkt, uint8_t **nlp)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a1"></a><a class="code" href="structrte__ether__hdr.html">rte_ether_hdr</a> *eth;</div>
<div class="line"> </div>
<div class="line">    eth = <a name="a2"></a><a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(pkt, <span class="keyword">struct</span> <a class="code" href="structrte__ether__hdr.html">rte_ether_hdr</a> *);</div>
<div class="line">    <span class="keywordflow">if</span> (eth-&gt;<a name="a3"></a><a class="code" href="structrte__ether__hdr.html#ad6312397ccc57d322b1a037c7080d340">ether_type</a> == <a name="a4"></a><a class="code" href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a>(<a name="a5"></a><a class="code" href="rte__ether_8h.html#a15583fc4e341572ad37c8beace664ea8">RTE_ETHER_TYPE_IPV4</a>)) {</div>
<div class="line">        *nlp = <a name="a6"></a><a class="code" href="rte__common_8h.html#a96c6294ef6a307980f78899fe8a5813e">RTE_PTR_ADD</a>(eth, <a name="a7"></a><a class="code" href="rte__ether_8h.html#a67dff5b18f52e97596f08ed2e76e4902">RTE_ETHER_HDR_LEN</a> +</div>
<div class="line">                <a name="a8"></a><a class="code" href="rte__common_8h.html#a276e8a32e0bbf024aadd9420b8f2d3b3">offsetof</a>(<span class="keyword">struct</span> ip, ip_p));</div>
<div class="line">        <span class="keywordflow">if</span> (**nlp == IPPROTO_ESP)</div>
<div class="line">            <span class="keywordflow">return</span> PKT_TYPE_IPSEC_IPV4;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">return</span> PKT_TYPE_PLAIN_IPV4;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (eth-&gt;<a class="code" href="structrte__ether__hdr.html#ad6312397ccc57d322b1a037c7080d340">ether_type</a> == <a class="code" href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a>(<a name="a9"></a><a class="code" href="rte__ether_8h.html#ac386d430206de37dca641eaa5c0c74ac">RTE_ETHER_TYPE_IPV6</a>)) {</div>
<div class="line">        *nlp = <a class="code" href="rte__common_8h.html#a96c6294ef6a307980f78899fe8a5813e">RTE_PTR_ADD</a>(eth, <a class="code" href="rte__ether_8h.html#a67dff5b18f52e97596f08ed2e76e4902">RTE_ETHER_HDR_LEN</a> +</div>
<div class="line">                <a class="code" href="rte__common_8h.html#a276e8a32e0bbf024aadd9420b8f2d3b3">offsetof</a>(<span class="keyword">struct</span> ip6_hdr, ip6_nxt));</div>
<div class="line">        <span class="keywordflow">if</span> (**nlp == IPPROTO_ESP)</div>
<div class="line">            <span class="keywordflow">return</span> PKT_TYPE_IPSEC_IPV6;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">return</span> PKT_TYPE_PLAIN_IPV6;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Unknown/Unsupported type */</span></div>
<div class="line">    <span class="keywordflow">return</span> PKT_TYPE_INVALID;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">update_mac_addrs(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkt, uint16_t portid)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ether__hdr.html">rte_ether_hdr</a> *ethhdr;</div>
<div class="line"> </div>
<div class="line">    ethhdr = <a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(pkt, <span class="keyword">struct</span> <a class="code" href="structrte__ether__hdr.html">rte_ether_hdr</a> *);</div>
<div class="line">    memcpy(&amp;ethhdr-&gt;<a name="a10"></a><a class="code" href="structrte__ether__hdr.html#acce632e0fded0f728a1ee1a1ffb5c9bf">s_addr</a>, &amp;ethaddr_tbl[portid].src, <a name="a11"></a><a class="code" href="rte__ether_8h.html#a22bf3d2d6b4e7be447b5e805674e0845">RTE_ETHER_ADDR_LEN</a>);</div>
<div class="line">    memcpy(&amp;ethhdr-&gt;<a name="a12"></a><a class="code" href="structrte__ether__hdr.html#a1d579e2782d36729c1f73608d8663124">d_addr</a>, &amp;ethaddr_tbl[portid].dst, <a class="code" href="rte__ether_8h.html#a22bf3d2d6b4e7be447b5e805674e0845">RTE_ETHER_ADDR_LEN</a>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">ipsec_event_pre_forward(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> port_id)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Save the destination port in the mbuf */</span></div>
<div class="line">    m-&gt;<a name="a13"></a><a class="code" href="structrte__mbuf.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a> = port_id;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Save eth queue for Tx */</span></div>
<div class="line">    <a name="a14"></a><a class="code" href="rte__event__eth__tx__adapter_8h.html#a4376e02a739b935fb0631402da4c0b73">rte_event_eth_tx_adapter_txq_set</a>(m, 0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">prepare_out_sessions_tbl(<span class="keyword">struct</span> sa_ctx *sa_out,</div>
<div class="line">        <span class="keyword">struct</span> rte_security_session **sess_tbl, uint16_t size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a15"></a><a class="code" href="structrte__ipsec__session.html">rte_ipsec_session</a> *pri_sess;</div>
<div class="line">    <span class="keyword">struct </span>ipsec_sa *sa;</div>
<div class="line">    uint32_t i;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!sa_out)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; sa_out-&gt;nb_sa; i++) {</div>
<div class="line"> </div>
<div class="line">        sa = &amp;sa_out-&gt;<a name="a16"></a><a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>[i];</div>
<div class="line">        <span class="keywordflow">if</span> (!sa)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        pri_sess = ipsec_get_primary_session(sa);</div>
<div class="line">        <span class="keywordflow">if</span> (!pri_sess)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (pri_sess-&gt;<a name="a17"></a><a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> !=</div>
<div class="line">            <a name="a18"></a><a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f">RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</a>) {</div>
<div class="line"> </div>
<div class="line">            <a name="a19"></a><a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC, <span class="stringliteral">&quot;Invalid session type %d\n&quot;</span>,</div>
<div class="line">                pri_sess-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a>);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (sa-&gt;portid &gt;= size) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">                <span class="stringliteral">&quot;Port id &gt;= than table size %d, %d\n&quot;</span>,</div>
<div class="line">                sa-&gt;portid, size);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Use only first inline session found for a given port */</span></div>
<div class="line">        <span class="keywordflow">if</span> (sess_tbl[sa-&gt;portid])</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        sess_tbl[sa-&gt;portid] = pri_sess-&gt;<a name="a20"></a>security.ses;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span></div>
<div class="line">check_sp(<span class="keyword">struct</span> sp_ctx *sp, <span class="keyword">const</span> uint8_t *nlp, uint32_t *sa_idx)</div>
<div class="line">{</div>
<div class="line">    uint32_t res;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a21"></a><a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(sp == NULL))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <a name="a22"></a><a class="code" href="rte__acl_8h.html#a97c75dcc2bddb3ce02c171f20d2f5854">rte_acl_classify</a>((<span class="keyword">struct</span> rte_acl_ctx *)sp, &amp;nlp, &amp;res, 1,</div>
<div class="line">            DEFAULT_MAX_CATEGORIES);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(res == DISCARD))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (res == BYPASS) {</div>
<div class="line">        *sa_idx = -1;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    *sa_idx = res - 1;</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> uint16_t</div>
<div class="line">route4_pkt(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkt, <span class="keyword">struct</span> rt_ctx *rt_ctx)</div>
<div class="line">{</div>
<div class="line">    uint32_t dst_ip;</div>
<div class="line">    uint16_t offset;</div>
<div class="line">    uint32_t hop;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    offset = <a class="code" href="rte__ether_8h.html#a67dff5b18f52e97596f08ed2e76e4902">RTE_ETHER_HDR_LEN</a> + <a class="code" href="rte__common_8h.html#a276e8a32e0bbf024aadd9420b8f2d3b3">offsetof</a>(<span class="keyword">struct</span> ip, ip_dst);</div>
<div class="line">    dst_ip = *<a name="a23"></a><a class="code" href="rte__mbuf__core_8h.html#ad63e1de0ec54d7c7603ea984c76ca956">rte_pktmbuf_mtod_offset</a>(pkt, uint32_t *, offset);</div>
<div class="line">    dst_ip = <a name="a24"></a><a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(dst_ip);</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a25"></a><a class="code" href="rte__lpm_8h.html#a1bab3e9f44549b0490a5e2f1e7e21ede">rte_lpm_lookup</a>((<span class="keyword">struct</span> rte_lpm *)rt_ctx, dst_ip, &amp;hop);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ret == 0) {</div>
<div class="line">        <span class="comment">/* We have a hit */</span></div>
<div class="line">        <span class="keywordflow">return</span> hop;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* else */</span></div>
<div class="line">    <span class="keywordflow">return</span> RTE_MAX_ETHPORTS;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* TODO: To be tested */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> uint16_t</div>
<div class="line">route6_pkt(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkt, <span class="keyword">struct</span> rt_ctx *rt_ctx)</div>
<div class="line">{</div>
<div class="line">    uint8_t dst_ip[16];</div>
<div class="line">    uint8_t *ip6_dst;</div>
<div class="line">    uint16_t offset;</div>
<div class="line">    uint32_t hop;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    offset = <a class="code" href="rte__ether_8h.html#a67dff5b18f52e97596f08ed2e76e4902">RTE_ETHER_HDR_LEN</a> + <a class="code" href="rte__common_8h.html#a276e8a32e0bbf024aadd9420b8f2d3b3">offsetof</a>(<span class="keyword">struct</span> ip6_hdr, ip6_dst);</div>
<div class="line">    ip6_dst = <a class="code" href="rte__mbuf__core_8h.html#ad63e1de0ec54d7c7603ea984c76ca956">rte_pktmbuf_mtod_offset</a>(pkt, uint8_t *, offset);</div>
<div class="line">    memcpy(&amp;dst_ip[0], ip6_dst, 16);</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a26"></a><a class="code" href="rte__lpm6_8h.html#a48ca2740af9d6654b976e72704928e66">rte_lpm6_lookup</a>((<span class="keyword">struct</span> rte_lpm6 *)rt_ctx, dst_ip, &amp;hop);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ret == 0) {</div>
<div class="line">        <span class="comment">/* We have a hit */</span></div>
<div class="line">        <span class="keywordflow">return</span> hop;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* else */</span></div>
<div class="line">    <span class="keywordflow">return</span> RTE_MAX_ETHPORTS;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> uint16_t</div>
<div class="line">get_route(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkt, <span class="keyword">struct</span> route_table *rt, <span class="keyword">enum</span> pkt_type type)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (type == PKT_TYPE_PLAIN_IPV4 || type == PKT_TYPE_IPSEC_IPV4)</div>
<div class="line">        <span class="keywordflow">return</span> route4_pkt(pkt, rt-&gt;rt4_ctx);</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == PKT_TYPE_PLAIN_IPV6 || type == PKT_TYPE_IPSEC_IPV6)</div>
<div class="line">        <span class="keywordflow">return</span> route6_pkt(pkt, rt-&gt;rt6_ctx);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> RTE_MAX_ETHPORTS;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span></div>
<div class="line">process_ipsec_ev_inbound(<span class="keyword">struct</span> ipsec_ctx *ctx, <span class="keyword">struct</span> route_table *rt,</div>
<div class="line">        <span class="keyword">struct</span> <a name="_a27"></a><a class="code" href="structrte__event.html">rte_event</a> *ev)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>ipsec_sa *sa = NULL;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkt;</div>
<div class="line">    uint16_t port_id = 0;</div>
<div class="line">    <span class="keyword">enum</span> pkt_type type;</div>
<div class="line">    uint32_t sa_idx;</div>
<div class="line">    uint8_t *nlp;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Get pkt from event */</span></div>
<div class="line">    pkt = ev-&gt;<a name="a28"></a><a class="code" href="structrte__event.html#a61d971d79c079636b0ede211cd7a2b26">mbuf</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check the packet type */</span></div>
<div class="line">    type = process_ipsec_get_pkt_type(pkt, &amp;nlp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (type) {</div>
<div class="line">    <span class="keywordflow">case</span> PKT_TYPE_PLAIN_IPV4:</div>
<div class="line">        <span class="keywordflow">if</span> (pkt-&gt;<a name="a29"></a><a class="code" href="structrte__mbuf.html#a319d580a6e1ef13692631d7b0d6d5c98">ol_flags</a> &amp; <a name="a30"></a><a class="code" href="rte__mbuf__core_8h.html#a87d6352dee4dd78c55d943aa814b0491">PKT_RX_SEC_OFFLOAD</a>) {</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(pkt-&gt;<a class="code" href="structrte__mbuf.html#a319d580a6e1ef13692631d7b0d6d5c98">ol_flags</a> &amp;</div>
<div class="line">                     <a name="a31"></a><a class="code" href="rte__mbuf__core_8h.html#a959f5d1aeb2487dcf748a6a41c5f0438">PKT_RX_SEC_OFFLOAD_FAILED</a>)) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">                    <span class="stringliteral">&quot;Inbound security offload failed\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">goto</span> drop_pkt_and_exit;</div>
<div class="line">            }</div>
<div class="line">            sa = *(<span class="keyword">struct </span>ipsec_sa **)<a name="a32"></a><a class="code" href="rte__security_8h.html#a6ab33d9ca2b9940e421f4f803b168eab">rte_security_dynfield</a>(pkt);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Check if we have a match */</span></div>
<div class="line">        <span class="keywordflow">if</span> (check_sp(ctx-&gt;sp4_ctx, nlp, &amp;sa_idx) == 0) {</div>
<div class="line">            <span class="comment">/* No valid match */</span></div>
<div class="line">            <span class="keywordflow">goto</span> drop_pkt_and_exit;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">case</span> PKT_TYPE_PLAIN_IPV6:</div>
<div class="line">        <span class="keywordflow">if</span> (pkt-&gt;<a class="code" href="structrte__mbuf.html#a319d580a6e1ef13692631d7b0d6d5c98">ol_flags</a> &amp; <a class="code" href="rte__mbuf__core_8h.html#a87d6352dee4dd78c55d943aa814b0491">PKT_RX_SEC_OFFLOAD</a>) {</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(pkt-&gt;<a class="code" href="structrte__mbuf.html#a319d580a6e1ef13692631d7b0d6d5c98">ol_flags</a> &amp;</div>
<div class="line">                     <a class="code" href="rte__mbuf__core_8h.html#a959f5d1aeb2487dcf748a6a41c5f0438">PKT_RX_SEC_OFFLOAD_FAILED</a>)) {</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">                    <span class="stringliteral">&quot;Inbound security offload failed\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">goto</span> drop_pkt_and_exit;</div>
<div class="line">            }</div>
<div class="line">            sa = *(<span class="keyword">struct </span>ipsec_sa **)<a class="code" href="rte__security_8h.html#a6ab33d9ca2b9940e421f4f803b168eab">rte_security_dynfield</a>(pkt);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Check if we have a match */</span></div>
<div class="line">        <span class="keywordflow">if</span> (check_sp(ctx-&gt;sp6_ctx, nlp, &amp;sa_idx) == 0) {</div>
<div class="line">            <span class="comment">/* No valid match */</span></div>
<div class="line">            <span class="keywordflow">goto</span> drop_pkt_and_exit;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC, <span class="stringliteral">&quot;Unsupported packet type = %d\n&quot;</span>, type);</div>
<div class="line">        <span class="keywordflow">goto</span> drop_pkt_and_exit;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check if the packet has to be bypassed */</span></div>
<div class="line">    <span class="keywordflow">if</span> (sa_idx == BYPASS)</div>
<div class="line">        <span class="keywordflow">goto</span> route_and_send_pkt;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Validate sa_idx */</span></div>
<div class="line">    <span class="keywordflow">if</span> (sa_idx &gt;= ctx-&gt;sa_ctx-&gt;nb_sa)</div>
<div class="line">        <span class="keywordflow">goto</span> drop_pkt_and_exit;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Else the packet has to be protected with SA */</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* If the packet was IPsec processed, then SA pointer should be set */</span></div>
<div class="line">    <span class="keywordflow">if</span> (sa == NULL)</div>
<div class="line">        <span class="keywordflow">goto</span> drop_pkt_and_exit;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* SPI on the packet should match with the one in SA */</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(sa-&gt;spi != ctx-&gt;sa_ctx-&gt;sa[sa_idx].spi))</div>
<div class="line">        <span class="keywordflow">goto</span> drop_pkt_and_exit;</div>
<div class="line"> </div>
<div class="line">route_and_send_pkt:</div>
<div class="line">    port_id = get_route(pkt, rt, type);</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(port_id == RTE_MAX_ETHPORTS)) {</div>
<div class="line">        <span class="comment">/* no match */</span></div>
<div class="line">        <span class="keywordflow">goto</span> drop_pkt_and_exit;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* else, we have a matching route */</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Update mac addresses */</span></div>
<div class="line">    update_mac_addrs(pkt, port_id);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Update the event with the dest port */</span></div>
<div class="line">    ipsec_event_pre_forward(pkt, port_id);</div>
<div class="line">    <span class="keywordflow">return</span> PKT_FORWARDED;</div>
<div class="line"> </div>
<div class="line">drop_pkt_and_exit:</div>
<div class="line">    <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC, <span class="stringliteral">&quot;Inbound packet dropped\n&quot;</span>);</div>
<div class="line">    <a name="a33"></a><a class="code" href="rte__mbuf_8h.html#a1215458932900b7cd5192326fa4a6902">rte_pktmbuf_free</a>(pkt);</div>
<div class="line">    ev-&gt;<a class="code" href="structrte__event.html#a61d971d79c079636b0ede211cd7a2b26">mbuf</a> = NULL;</div>
<div class="line">    <span class="keywordflow">return</span> PKT_DROPPED;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span></div>
<div class="line">process_ipsec_ev_outbound(<span class="keyword">struct</span> ipsec_ctx *ctx, <span class="keyword">struct</span> route_table *rt,</div>
<div class="line">        <span class="keyword">struct</span> <a class="code" href="structrte__event.html">rte_event</a> *ev)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ipsec__session.html">rte_ipsec_session</a> *sess;</div>
<div class="line">    <span class="keyword">struct </span>sa_ctx *sa_ctx;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkt;</div>
<div class="line">    uint16_t port_id = 0;</div>
<div class="line">    <span class="keyword">struct </span>ipsec_sa *sa;</div>
<div class="line">    <span class="keyword">enum</span> pkt_type type;</div>
<div class="line">    uint32_t sa_idx;</div>
<div class="line">    uint8_t *nlp;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Get pkt from event */</span></div>
<div class="line">    pkt = ev-&gt;<a class="code" href="structrte__event.html#a61d971d79c079636b0ede211cd7a2b26">mbuf</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check the packet type */</span></div>
<div class="line">    type = process_ipsec_get_pkt_type(pkt, &amp;nlp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (type) {</div>
<div class="line">    <span class="keywordflow">case</span> PKT_TYPE_PLAIN_IPV4:</div>
<div class="line">        <span class="comment">/* Check if we have a match */</span></div>
<div class="line">        <span class="keywordflow">if</span> (check_sp(ctx-&gt;sp4_ctx, nlp, &amp;sa_idx) == 0) {</div>
<div class="line">            <span class="comment">/* No valid match */</span></div>
<div class="line">            <span class="keywordflow">goto</span> drop_pkt_and_exit;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> PKT_TYPE_PLAIN_IPV6:</div>
<div class="line">        <span class="comment">/* Check if we have a match */</span></div>
<div class="line">        <span class="keywordflow">if</span> (check_sp(ctx-&gt;sp6_ctx, nlp, &amp;sa_idx) == 0) {</div>
<div class="line">            <span class="comment">/* No valid match */</span></div>
<div class="line">            <span class="keywordflow">goto</span> drop_pkt_and_exit;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Only plain IPv4 &amp; IPv6 packets are allowed</span></div>
<div class="line"><span class="comment">         * on protected port. Drop the rest.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC, <span class="stringliteral">&quot;Unsupported packet type = %d\n&quot;</span>, type);</div>
<div class="line">        <span class="keywordflow">goto</span> drop_pkt_and_exit;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check if the packet has to be bypassed */</span></div>
<div class="line">    <span class="keywordflow">if</span> (sa_idx == BYPASS) {</div>
<div class="line">        port_id = get_route(pkt, rt, type);</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(port_id == RTE_MAX_ETHPORTS)) {</div>
<div class="line">            <span class="comment">/* no match */</span></div>
<div class="line">            <span class="keywordflow">goto</span> drop_pkt_and_exit;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/* else, we have a matching route */</span></div>
<div class="line">        <span class="keywordflow">goto</span> send_pkt;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Validate sa_idx */</span></div>
<div class="line">    <span class="keywordflow">if</span> (sa_idx &gt;= ctx-&gt;sa_ctx-&gt;nb_sa)</div>
<div class="line">        <span class="keywordflow">goto</span> drop_pkt_and_exit;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Else the packet has to be protected */</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Get SA ctx*/</span></div>
<div class="line">    sa_ctx = ctx-&gt;sa_ctx;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Get SA */</span></div>
<div class="line">    sa = &amp;(sa_ctx-&gt;sa[sa_idx]);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Get IPsec session */</span></div>
<div class="line">    sess = ipsec_get_primary_session(sa);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Allow only inline protocol for now */</span></div>
<div class="line">    <span class="keywordflow">if</span> (sess-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> != <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f">RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</a>) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC, <span class="stringliteral">&quot;SA type not supported\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">goto</span> drop_pkt_and_exit;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (sess-&gt;security.ol_flags &amp; <a name="a34"></a><a class="code" href="rte__security_8h.html#aa37e473f2d863dedf92612e23e82d49c">RTE_SECURITY_TX_OLOAD_NEED_MDATA</a>)</div>
<div class="line">        *(<span class="keyword">struct </span>rte_security_session **)<a class="code" href="rte__security_8h.html#a6ab33d9ca2b9940e421f4f803b168eab">rte_security_dynfield</a>(pkt) =</div>
<div class="line">                sess-&gt;security.ses;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Mark the packet for Tx security offload */</span></div>
<div class="line">    pkt-&gt;<a class="code" href="structrte__mbuf.html#a319d580a6e1ef13692631d7b0d6d5c98">ol_flags</a> |= <a name="a35"></a><a class="code" href="rte__mbuf__core_8h.html#ac96de1a778092073c21e54e4ac07fc6c">PKT_TX_SEC_OFFLOAD</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Get the port to which this pkt need to be submitted */</span></div>
<div class="line">    port_id = sa-&gt;portid;</div>
<div class="line"> </div>
<div class="line">send_pkt:</div>
<div class="line">    <span class="comment">/* Update mac addresses */</span></div>
<div class="line">    update_mac_addrs(pkt, port_id);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Update the event with the dest port */</span></div>
<div class="line">    ipsec_event_pre_forward(pkt, port_id);</div>
<div class="line">    <span class="keywordflow">return</span> PKT_FORWARDED;</div>
<div class="line"> </div>
<div class="line">drop_pkt_and_exit:</div>
<div class="line">    <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC, <span class="stringliteral">&quot;Outbound packet dropped\n&quot;</span>);</div>
<div class="line">    <a class="code" href="rte__mbuf_8h.html#a1215458932900b7cd5192326fa4a6902">rte_pktmbuf_free</a>(pkt);</div>
<div class="line">    ev-&gt;<a class="code" href="structrte__event.html#a61d971d79c079636b0ede211cd7a2b26">mbuf</a> = NULL;</div>
<div class="line">    <span class="keywordflow">return</span> PKT_DROPPED;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Event mode exposes various operating modes depending on the</span></div>
<div class="line"><span class="comment"> * capabilities of the event device and the operating mode</span></div>
<div class="line"><span class="comment"> * selected.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Workers registered */</span></div>
<div class="line"><span class="preprocessor">#define IPSEC_EVENTMODE_WORKERS     2</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Event mode worker</span></div>
<div class="line"><span class="comment"> * Operating parameters : non-burst - Tx internal port - driver mode</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">ipsec_wrkr_non_burst_int_port_drv_mode(<span class="keyword">struct</span> eh_event_link_info *links,</div>
<div class="line">        uint8_t nb_links)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>rte_security_session *sess_tbl[RTE_MAX_ETHPORTS] = { NULL };</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nb_rx = 0;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkt;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__event.html">rte_event</a> ev;</div>
<div class="line">    uint32_t lcore_id;</div>
<div class="line">    int32_t socket_id;</div>
<div class="line">    int16_t port_id;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check if we have links registered for this lcore */</span></div>
<div class="line">    <span class="keywordflow">if</span> (nb_links == 0) {</div>
<div class="line">        <span class="comment">/* No links registered - exit */</span></div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Get core ID */</span></div>
<div class="line">    lcore_id = <a name="a36"></a><a class="code" href="rte__lcore_8h.html#adfb2b334e7e73f534f25e8888a8a775f">rte_lcore_id</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Get socket ID */</span></div>
<div class="line">    socket_id = <a name="a37"></a><a class="code" href="rte__lcore_8h.html#a023b4909f52c3cdf0351d71d2b5032bc">rte_lcore_to_socket_id</a>(lcore_id);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Prepare security sessions table. In outbound driver mode</span></div>
<div class="line"><span class="comment">     * we always use first session configured for a given port</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    prepare_out_sessions_tbl(socket_ctx[socket_id].sa_out, sess_tbl,</div>
<div class="line">            RTE_MAX_ETHPORTS);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(INFO, IPSEC,</div>
<div class="line">        <span class="stringliteral">&quot;Launching event mode worker (non-burst - Tx internal port - &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;driver mode) on lcore %d\n&quot;</span>, lcore_id);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* We have valid links */</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check if it&#39;s single link */</span></div>
<div class="line">    <span class="keywordflow">if</span> (nb_links != 1) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(INFO, IPSEC,</div>
<div class="line">            <span class="stringliteral">&quot;Multiple links not supported. Using first link\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(INFO, IPSEC, <span class="stringliteral">&quot; -- lcoreid=%u event_port_id=%u\n&quot;</span>, lcore_id,</div>
<div class="line">            links[0].event_port_id);</div>
<div class="line">    <span class="keywordflow">while</span> (!force_quit) {</div>
<div class="line">        <span class="comment">/* Read packet from event queues */</span></div>
<div class="line">        nb_rx = <a name="a38"></a><a class="code" href="rte__eventdev_8h.html#a2af1610d3ede24979267333cf2da1aab">rte_event_dequeue_burst</a>(links[0].eventdev_id,</div>
<div class="line">                links[0].event_port_id,</div>
<div class="line">                &amp;ev,    <span class="comment">/* events */</span></div>
<div class="line">                1,  <span class="comment">/* nb_events */</span></div>
<div class="line">                0   <span class="comment">/* timeout_ticks */</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (nb_rx == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        pkt = ev.<a class="code" href="structrte__event.html#a61d971d79c079636b0ede211cd7a2b26">mbuf</a>;</div>
<div class="line">        port_id = pkt-&gt;<a class="code" href="structrte__mbuf.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>;</div>
<div class="line"> </div>
<div class="line">        <a name="a39"></a><a class="code" href="rte__prefetch_8h.html#a7f89cf66766e6bfd63feb370a7280de9">rte_prefetch0</a>(<a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(pkt, <span class="keywordtype">void</span> *));</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Process packet */</span></div>
<div class="line">        ipsec_event_pre_forward(pkt, port_id);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (!is_unprotected_port(port_id)) {</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(!sess_tbl[port_id])) {</div>
<div class="line">                <a class="code" href="rte__mbuf_8h.html#a1215458932900b7cd5192326fa4a6902">rte_pktmbuf_free</a>(pkt);</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Save security session */</span></div>
<div class="line">            <span class="keywordflow">if</span> (<a name="a40"></a><a class="code" href="rte__security_8h.html#ac2cdd90e7fc7f9121c997cafe2f6a5e3">rte_security_dynfield_is_registered</a>())</div>
<div class="line">                *(<span class="keyword">struct </span>rte_security_session **)</div>
<div class="line">                    <a class="code" href="rte__security_8h.html#a6ab33d9ca2b9940e421f4f803b168eab">rte_security_dynfield</a>(pkt) =</div>
<div class="line">                        sess_tbl[port_id];</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Mark the packet for Tx security offload */</span></div>
<div class="line">            pkt-&gt;<a class="code" href="structrte__mbuf.html#a319d580a6e1ef13692631d7b0d6d5c98">ol_flags</a> |= <a class="code" href="rte__mbuf__core_8h.html#ac96de1a778092073c21e54e4ac07fc6c">PKT_TX_SEC_OFFLOAD</a>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Since tx internal port is available, events can be</span></div>
<div class="line"><span class="comment">         * directly enqueued to the adapter and it would be</span></div>
<div class="line"><span class="comment">         * internally submitted to the eth device.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <a name="a41"></a><a class="code" href="rte__event__eth__tx__adapter_8h.html#ab1e90b0812544c94b62b45bc49c24344">rte_event_eth_tx_adapter_enqueue</a>(links[0].eventdev_id,</div>
<div class="line">                links[0].event_port_id,</div>
<div class="line">                &amp;ev,    <span class="comment">/* events */</span></div>
<div class="line">                1,  <span class="comment">/* nb_events */</span></div>
<div class="line">                0   <span class="comment">/* flags */</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Event mode worker</span></div>
<div class="line"><span class="comment"> * Operating parameters : non-burst - Tx internal port - app mode</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">ipsec_wrkr_non_burst_int_port_app_mode(<span class="keyword">struct</span> eh_event_link_info *links,</div>
<div class="line">        uint8_t nb_links)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>lcore_conf_ev_tx_int_port_wrkr lconf;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nb_rx = 0;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__event.html">rte_event</a> ev;</div>
<div class="line">    uint32_t lcore_id;</div>
<div class="line">    int32_t socket_id;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check if we have links registered for this lcore */</span></div>
<div class="line">    <span class="keywordflow">if</span> (nb_links == 0) {</div>
<div class="line">        <span class="comment">/* No links registered - exit */</span></div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* We have valid links */</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Get core ID */</span></div>
<div class="line">    lcore_id = <a class="code" href="rte__lcore_8h.html#adfb2b334e7e73f534f25e8888a8a775f">rte_lcore_id</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Get socket ID */</span></div>
<div class="line">    socket_id = <a class="code" href="rte__lcore_8h.html#a023b4909f52c3cdf0351d71d2b5032bc">rte_lcore_to_socket_id</a>(lcore_id);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Save routing table */</span></div>
<div class="line">    lconf.rt.rt4_ctx = socket_ctx[socket_id].rt_ip4;</div>
<div class="line">    lconf.rt.rt6_ctx = socket_ctx[socket_id].rt_ip6;</div>
<div class="line">    lconf.inbound.sp4_ctx = socket_ctx[socket_id].sp_ip4_in;</div>
<div class="line">    lconf.inbound.sp6_ctx = socket_ctx[socket_id].sp_ip6_in;</div>
<div class="line">    lconf.inbound.sa_ctx = socket_ctx[socket_id].sa_in;</div>
<div class="line">    lconf.inbound.session_pool = socket_ctx[socket_id].session_pool;</div>
<div class="line">    lconf.inbound.session_priv_pool =</div>
<div class="line">            socket_ctx[socket_id].session_priv_pool;</div>
<div class="line">    lconf.outbound.sp4_ctx = socket_ctx[socket_id].sp_ip4_out;</div>
<div class="line">    lconf.outbound.sp6_ctx = socket_ctx[socket_id].sp_ip6_out;</div>
<div class="line">    lconf.outbound.sa_ctx = socket_ctx[socket_id].sa_out;</div>
<div class="line">    lconf.outbound.session_pool = socket_ctx[socket_id].session_pool;</div>
<div class="line">    lconf.outbound.session_priv_pool =</div>
<div class="line">            socket_ctx[socket_id].session_priv_pool;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(INFO, IPSEC,</div>
<div class="line">        <span class="stringliteral">&quot;Launching event mode worker (non-burst - Tx internal port - &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;app mode) on lcore %d\n&quot;</span>, lcore_id);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check if it&#39;s single link */</span></div>
<div class="line">    <span class="keywordflow">if</span> (nb_links != 1) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(INFO, IPSEC,</div>
<div class="line">            <span class="stringliteral">&quot;Multiple links not supported. Using first link\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(INFO, IPSEC, <span class="stringliteral">&quot; -- lcoreid=%u event_port_id=%u\n&quot;</span>, lcore_id,</div>
<div class="line">        links[0].event_port_id);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (!force_quit) {</div>
<div class="line">        <span class="comment">/* Read packet from event queues */</span></div>
<div class="line">        nb_rx = <a class="code" href="rte__eventdev_8h.html#a2af1610d3ede24979267333cf2da1aab">rte_event_dequeue_burst</a>(links[0].eventdev_id,</div>
<div class="line">                links[0].event_port_id,</div>
<div class="line">                &amp;ev,     <span class="comment">/* events */</span></div>
<div class="line">                1,       <span class="comment">/* nb_events */</span></div>
<div class="line">                0        <span class="comment">/* timeout_ticks */</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (nb_rx == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(ev.<a name="a42"></a><a class="code" href="structrte__event.html#a45def65890de0da17bc0d6e2ca2b3a9f">event_type</a> != <a name="a43"></a><a class="code" href="rte__eventdev_8h.html#ae5a711c45b3d3f125069b1a7cb731435">RTE_EVENT_TYPE_ETHDEV</a>)) {</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC, <span class="stringliteral">&quot;Invalid event type %u&quot;</span>,</div>
<div class="line">                ev.<a class="code" href="structrte__event.html#a45def65890de0da17bc0d6e2ca2b3a9f">event_type</a>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (is_unprotected_port(ev.<a class="code" href="structrte__event.html#a61d971d79c079636b0ede211cd7a2b26">mbuf</a>-&gt;<a class="code" href="structrte__mbuf.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>))</div>
<div class="line">            ret = process_ipsec_ev_inbound(&amp;lconf.inbound,</div>
<div class="line">                            &amp;lconf.rt, &amp;ev);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            ret = process_ipsec_ev_outbound(&amp;lconf.outbound,</div>
<div class="line">                            &amp;lconf.rt, &amp;ev);</div>
<div class="line">        <span class="keywordflow">if</span> (ret != 1)</div>
<div class="line">            <span class="comment">/* The pkt has been dropped */</span></div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Since tx internal port is available, events can be</span></div>
<div class="line"><span class="comment">         * directly enqueued to the adapter and it would be</span></div>
<div class="line"><span class="comment">         * internally submitted to the eth device.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <a class="code" href="rte__event__eth__tx__adapter_8h.html#ab1e90b0812544c94b62b45bc49c24344">rte_event_eth_tx_adapter_enqueue</a>(links[0].eventdev_id,</div>
<div class="line">                links[0].event_port_id,</div>
<div class="line">                &amp;ev,    <span class="comment">/* events */</span></div>
<div class="line">                1,  <span class="comment">/* nb_events */</span></div>
<div class="line">                0   <span class="comment">/* flags */</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint8_t</div>
<div class="line">ipsec_eventmode_populate_wrkr_params(<span class="keyword">struct</span> eh_app_worker_params *wrkrs)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>eh_app_worker_params *wrkr;</div>
<div class="line">    uint8_t nb_wrkr_param = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Save workers */</span></div>
<div class="line">    wrkr = wrkrs;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Non-burst - Tx internal port - driver mode */</span></div>
<div class="line">    wrkr-&gt;cap.burst = EH_RX_TYPE_NON_BURST;</div>
<div class="line">    wrkr-&gt;cap.tx_internal_port = EH_TX_TYPE_INTERNAL_PORT;</div>
<div class="line">    wrkr-&gt;cap.ipsec_mode = EH_IPSEC_MODE_TYPE_DRIVER;</div>
<div class="line">    wrkr-&gt;worker_thread = ipsec_wrkr_non_burst_int_port_drv_mode;</div>
<div class="line">    wrkr++;</div>
<div class="line">    nb_wrkr_param++;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Non-burst - Tx internal port - app mode */</span></div>
<div class="line">    wrkr-&gt;cap.burst = EH_RX_TYPE_NON_BURST;</div>
<div class="line">    wrkr-&gt;cap.tx_internal_port = EH_TX_TYPE_INTERNAL_PORT;</div>
<div class="line">    wrkr-&gt;cap.ipsec_mode = EH_IPSEC_MODE_TYPE_APP;</div>
<div class="line">    wrkr-&gt;worker_thread = ipsec_wrkr_non_burst_int_port_app_mode;</div>
<div class="line">    nb_wrkr_param++;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> nb_wrkr_param;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">ipsec_eventmode_worker(<span class="keyword">struct</span> eh_conf *conf)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>eh_app_worker_params ipsec_wrkr[IPSEC_EVENTMODE_WORKERS] = {</div>
<div class="line">                    {{{0} }, NULL } };</div>
<div class="line">    uint8_t nb_wrkr_param;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Populate l2fwd_wrkr params */</span></div>
<div class="line">    nb_wrkr_param = ipsec_eventmode_populate_wrkr_params(ipsec_wrkr);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Launch correct worker after checking</span></div>
<div class="line"><span class="comment">     * the event device&#39;s capabilities.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    eh_launch_worker(conf, ipsec_wrkr, nb_wrkr_param);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> ipsec_launch_one_lcore(<span class="keywordtype">void</span> *args)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>eh_conf *conf;</div>
<div class="line"> </div>
<div class="line">    conf = (<span class="keyword">struct </span>eh_conf *)args;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (conf-&gt;mode == EH_PKT_TRANSFER_MODE_POLL) {</div>
<div class="line">        <span class="comment">/* Run in poll mode */</span></div>
<div class="line">        ipsec_poll_mode_worker();</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (conf-&gt;mode == EH_PKT_TRANSFER_MODE_EVENT) {</div>
<div class="line">        <span class="comment">/* Run in event mode */</span></div>
<div class="line">        ipsec_eventmode_worker(conf);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="astructrte__ether__hdr_html_acce632e0fded0f728a1ee1a1ffb5c9bf"><div class="ttname"><a href="structrte__ether__hdr.html#acce632e0fded0f728a1ee1a1ffb5c9bf">rte_ether_hdr::s_addr</a></div><div class="ttdeci">struct rte_ether_addr s_addr</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00000">rte_ether.h:266</a></div></div>
<div class="ttc" id="arte__lpm_8h_html"><div class="ttname"><a href="rte__lpm_8h.html">rte_lpm.h</a></div></div>
<div class="ttc" id="arte__prefetch_8h_html_a7f89cf66766e6bfd63feb370a7280de9"><div class="ttname"><a href="rte__prefetch_8h.html#a7f89cf66766e6bfd63feb370a7280de9">rte_prefetch0</a></div><div class="ttdeci">static void rte_prefetch0(const volatile void *p)</div></div>
<div class="ttc" id="arte__byteorder_8h_html_a6ec4cb000fc67785792d18728cf45563"><div class="ttname"><a href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a></div><div class="ttdeci">static rte_be16_t rte_cpu_to_be_16(uint16_t x)</div></div>
<div class="ttc" id="arte__event__eth__tx__adapter_8h_html"><div class="ttname"><a href="rte__event__eth__tx__adapter_8h.html">rte_event_eth_tx_adapter.h</a></div></div>
<div class="ttc" id="arte__branch__prediction_8h_html_ac6c45889010c1bd68631771b64f18101"><div class="ttname"><a href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a></div><div class="ttdeci">#define unlikely(x)</div><div class="ttdef"><b>Definition:</b> <a href="rte__branch__prediction_8h_source.html#l00038">rte_branch_prediction.h:38</a></div></div>
<div class="ttc" id="arte__security_8h_html_a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f"><div class="ttname"><a href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f">RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</a></div><div class="ttdeci">@ RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00340">rte_security.h:337</a></div></div>
<div class="ttc" id="astructrte__ether__hdr_html_ad6312397ccc57d322b1a037c7080d340"><div class="ttname"><a href="structrte__ether__hdr.html#ad6312397ccc57d322b1a037c7080d340">rte_ether_hdr::ether_type</a></div><div class="ttdeci">uint16_t ether_type</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00267">rte_ether.h:267</a></div></div>
<div class="ttc" id="arte__lpm6_8h_html"><div class="ttname"><a href="rte__lpm6_8h.html">rte_lpm6.h</a></div></div>
<div class="ttc" id="arte__eventdev_8h_html_ae5a711c45b3d3f125069b1a7cb731435"><div class="ttname"><a href="rte__eventdev_8h.html#ae5a711c45b3d3f125069b1a7cb731435">RTE_EVENT_TYPE_ETHDEV</a></div><div class="ttdeci">#define RTE_EVENT_TYPE_ETHDEV</div><div class="ttdef"><b>Definition:</b> <a href="rte__eventdev_8h_source.html#l00978">rte_eventdev.h:977</a></div></div>
<div class="ttc" id="arte__acl_8h_html"><div class="ttname"><a href="rte__acl_8h.html">rte_acl.h</a></div></div>
<div class="ttc" id="arte__common_8h_html_a96c6294ef6a307980f78899fe8a5813e"><div class="ttname"><a href="rte__common_8h.html#a96c6294ef6a307980f78899fe8a5813e">RTE_PTR_ADD</a></div><div class="ttdeci">#define RTE_PTR_ADD(ptr, x)</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00248">rte_common.h:248</a></div></div>
<div class="ttc" id="arte__event__eth__tx__adapter_8h_html_a4376e02a739b935fb0631402da4c0b73"><div class="ttname"><a href="rte__event__eth__tx__adapter_8h.html#a4376e02a739b935fb0631402da4c0b73">rte_event_eth_tx_adapter_txq_set</a></div><div class="ttdeci">static __rte_always_inline void rte_event_eth_tx_adapter_txq_set(struct rte_mbuf *pkt, uint16_t queue)</div><div class="ttdef"><b>Definition:</b> <a href="rte__event__eth__tx__adapter_8h_source.html#l00266">rte_event_eth_tx_adapter.h:266</a></div></div>
<div class="ttc" id="astructrte__event_html_a45def65890de0da17bc0d6e2ca2b3a9f"><div class="ttname"><a href="structrte__event.html#a45def65890de0da17bc0d6e2ca2b3a9f">rte_event::event_type</a></div><div class="ttdeci">uint32_t event_type</div><div class="ttdef"><b>Definition:</b> <a href="rte__eventdev_8h_source.html#l01060">rte_eventdev.h:1060</a></div></div>
<div class="ttc" id="arte__lpm6_8h_html_a48ca2740af9d6654b976e72704928e66"><div class="ttname"><a href="rte__lpm6_8h.html#a48ca2740af9d6654b976e72704928e66">rte_lpm6_lookup</a></div><div class="ttdeci">int rte_lpm6_lookup(const struct rte_lpm6 *lpm, const uint8_t *ip, uint32_t *next_hop)</div></div>
<div class="ttc" id="arte__lcore_8h_html_a023b4909f52c3cdf0351d71d2b5032bc"><div class="ttname"><a href="rte__lcore_8h.html#a023b4909f52c3cdf0351d71d2b5032bc">rte_lcore_to_socket_id</a></div><div class="ttdeci">unsigned int rte_lcore_to_socket_id(unsigned int lcore_id)</div></div>
<div class="ttc" id="arte__security_8h_html_a6ab33d9ca2b9940e421f4f803b168eab"><div class="ttname"><a href="rte__security_8h.html#a6ab33d9ca2b9940e421f4f803b168eab">rte_security_dynfield</a></div><div class="ttdeci">static __rte_experimental rte_security_dynfield_t * rte_security_dynfield(struct rte_mbuf *mbuf)</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00475">rte_security.h:475</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_ac96de1a778092073c21e54e4ac07fc6c"><div class="ttname"><a href="rte__mbuf__core_8h.html#ac96de1a778092073c21e54e4ac07fc6c">PKT_TX_SEC_OFFLOAD</a></div><div class="ttdeci">#define PKT_TX_SEC_OFFLOAD</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00221">rte_mbuf_core.h:221</a></div></div>
<div class="ttc" id="astructrte__mbuf_html"><div class="ttname"><a href="structrte__mbuf.html">rte_mbuf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00473">rte_mbuf_core.h:473</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_a87d6352dee4dd78c55d943aa814b0491"><div class="ttname"><a href="rte__mbuf__core_8h.html#a87d6352dee4dd78c55d943aa814b0491">PKT_RX_SEC_OFFLOAD</a></div><div class="ttdeci">#define PKT_RX_SEC_OFFLOAD</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00157">rte_mbuf_core.h:157</a></div></div>
<div class="ttc" id="arte__lpm_8h_html_a1bab3e9f44549b0490a5e2f1e7e21ede"><div class="ttname"><a href="rte__lpm_8h.html#a1bab3e9f44549b0490a5e2f1e7e21ede">rte_lpm_lookup</a></div><div class="ttdeci">static int rte_lpm_lookup(struct rte_lpm *lpm, uint32_t ip, uint32_t *next_hop)</div><div class="ttdef"><b>Definition:</b> <a href="rte__lpm_8h_source.html#l00286">rte_lpm.h:286</a></div></div>
<div class="ttc" id="arte__event__eth__tx__adapter_8h_html_ab1e90b0812544c94b62b45bc49c24344"><div class="ttname"><a href="rte__event__eth__tx__adapter_8h.html#ab1e90b0812544c94b62b45bc49c24344">rte_event_eth_tx_adapter_enqueue</a></div><div class="ttdeci">static uint16_t rte_event_eth_tx_adapter_enqueue(uint8_t dev_id, uint8_t port_id, struct rte_event ev[], uint16_t nb_events, const uint8_t flags)</div><div class="ttdef"><b>Definition:</b> <a href="rte__event__eth__tx__adapter_8h_source.html#l00352">rte_event_eth_tx_adapter.h:352</a></div></div>
<div class="ttc" id="arte__byteorder_8h_html_a1d6fa9e3f0a9b2de0836177fa02eb403"><div class="ttname"><a href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a></div><div class="ttdeci">static uint32_t rte_be_to_cpu_32(rte_be32_t x)</div></div>
<div class="ttc" id="astructrte__ipsec__session_html_aa8f42f3a36d2c036ccb27f0b74b25160"><div class="ttname"><a href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">rte_ipsec_session::sa</a></div><div class="ttdeci">struct rte_ipsec_sa * sa</div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec_8h_source.html#l00063">rte_ipsec.h:63</a></div></div>
<div class="ttc" id="arte__ether_8h_html_a67dff5b18f52e97596f08ed2e76e4902"><div class="ttname"><a href="rte__ether_8h.html#a67dff5b18f52e97596f08ed2e76e4902">RTE_ETHER_HDR_LEN</a></div><div class="ttdeci">#define RTE_ETHER_HDR_LEN</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00035">rte_ether.h:33</a></div></div>
<div class="ttc" id="arte__acl_8h_html_a97c75dcc2bddb3ce02c171f20d2f5854"><div class="ttname"><a href="rte__acl_8h.html#a97c75dcc2bddb3ce02c171f20d2f5854">rte_acl_classify</a></div><div class="ttdeci">int rte_acl_classify(const struct rte_acl_ctx *ctx, const uint8_t **data, uint32_t *results, uint32_t num, uint32_t categories)</div></div>
<div class="ttc" id="arte__security_8h_html_aa37e473f2d863dedf92612e23e82d49c"><div class="ttname"><a href="rte__security_8h.html#aa37e473f2d863dedf92612e23e82d49c">RTE_SECURITY_TX_OLOAD_NEED_MDATA</a></div><div class="ttdeci">#define RTE_SECURITY_TX_OLOAD_NEED_MDATA</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00705">rte_security.h:703</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_ad63e1de0ec54d7c7603ea984c76ca956"><div class="ttname"><a href="rte__mbuf__core_8h.html#ad63e1de0ec54d7c7603ea984c76ca956">rte_pktmbuf_mtod_offset</a></div><div class="ttdeci">#define rte_pktmbuf_mtod_offset(m, t, o)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00711">rte_mbuf_core.h:711</a></div></div>
<div class="ttc" id="arte__ether_8h_html_ac386d430206de37dca641eaa5c0c74ac"><div class="ttname"><a href="rte__ether_8h.html#ac386d430206de37dca641eaa5c0c74ac">RTE_ETHER_TYPE_IPV6</a></div><div class="ttdeci">#define RTE_ETHER_TYPE_IPV6</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00284">rte_ether.h:284</a></div></div>
<div class="ttc" id="arte__lcore_8h_html_adfb2b334e7e73f534f25e8888a8a775f"><div class="ttname"><a href="rte__lcore_8h.html#adfb2b334e7e73f534f25e8888a8a775f">rte_lcore_id</a></div><div class="ttdeci">static unsigned rte_lcore_id(void)</div><div class="ttdef"><b>Definition:</b> <a href="rte__lcore_8h_source.html#l00075">rte_lcore.h:75</a></div></div>
<div class="ttc" id="astructrte__mbuf_html_a8e0798404bf2cf5dabb84c5ba9a4f236"><div class="ttname"><a href="structrte__mbuf.html#a8e0798404bf2cf5dabb84c5ba9a4f236">rte_mbuf::port</a></div><div class="ttdeci">uint16_t port</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00503">rte_mbuf_core.h:503</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_a2a8b10263496c7b580e9d0c7f2a1f073"><div class="ttname"><a href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a></div><div class="ttdeci">#define rte_pktmbuf_mtod(m, t)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00726">rte_mbuf_core.h:726</a></div></div>
<div class="ttc" id="astructrte__ether__hdr_html"><div class="ttname"><a href="structrte__ether__hdr.html">rte_ether_hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00264">rte_ether.h:264</a></div></div>
<div class="ttc" id="astructrte__ipsec__session_html_adb36704cd7fc83a9e5f8e10720974165"><div class="ttname"><a href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">rte_ipsec_session::type</a></div><div class="ttdeci">enum rte_security_session_action_type type</div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec_8h_source.html#l00063">rte_ipsec.h:65</a></div></div>
<div class="ttc" id="astructrte__event_html"><div class="ttname"><a href="structrte__event.html">rte_event</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__eventdev_8h_source.html#l01043">rte_eventdev.h:1043</a></div></div>
<div class="ttc" id="arte__security_8h_html_ac2cdd90e7fc7f9121c997cafe2f6a5e3"><div class="ttname"><a href="rte__security_8h.html#ac2cdd90e7fc7f9121c997cafe2f6a5e3">rte_security_dynfield_is_registered</a></div><div class="ttdeci">static __rte_experimental bool rte_security_dynfield_is_registered(void)</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00491">rte_security.h:491</a></div></div>
<div class="ttc" id="astructrte__mbuf_html_a319d580a6e1ef13692631d7b0d6d5c98"><div class="ttname"><a href="structrte__mbuf.html#a319d580a6e1ef13692631d7b0d6d5c98">rte_mbuf::ol_flags</a></div><div class="ttdeci">uint64_t ol_flags</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00505">rte_mbuf_core.h:505</a></div></div>
<div class="ttc" id="arte__common_8h_html_a276e8a32e0bbf024aadd9420b8f2d3b3"><div class="ttname"><a href="rte__common_8h.html#a276e8a32e0bbf024aadd9420b8f2d3b3">offsetof</a></div><div class="ttdeci">#define offsetof(TYPE, MEMBER)</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00753">rte_common.h:753</a></div></div>
<div class="ttc" id="astructrte__ipsec__session_html"><div class="ttname"><a href="structrte__ipsec__session.html">rte_ipsec_session</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec_8h_source.html#l00058">rte_ipsec.h:58</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_a1215458932900b7cd5192326fa4a6902"><div class="ttname"><a href="rte__mbuf_8h.html#a1215458932900b7cd5192326fa4a6902">rte_pktmbuf_free</a></div><div class="ttdeci">static void rte_pktmbuf_free(struct rte_mbuf *m)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01397">rte_mbuf.h:1397</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_a959f5d1aeb2487dcf748a6a41c5f0438"><div class="ttname"><a href="rte__mbuf__core_8h.html#a959f5d1aeb2487dcf748a6a41c5f0438">PKT_RX_SEC_OFFLOAD_FAILED</a></div><div class="ttdeci">#define PKT_RX_SEC_OFFLOAD_FAILED</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00162">rte_mbuf_core.h:162</a></div></div>
<div class="ttc" id="astructrte__event_html_a61d971d79c079636b0ede211cd7a2b26"><div class="ttname"><a href="structrte__event.html#a61d971d79c079636b0ede211cd7a2b26">rte_event::mbuf</a></div><div class="ttdeci">struct rte_mbuf * mbuf</div><div class="ttdef"><b>Definition:</b> <a href="rte__eventdev_8h_source.html#l01109">rte_eventdev.h:1109</a></div></div>
<div class="ttc" id="arte__log_8h_html_ac23caeb9833fd0fd0665c6c05ec806fe"><div class="ttname"><a href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a></div><div class="ttdeci">#define RTE_LOG(l, t,...)</div><div class="ttdef"><b>Definition:</b> <a href="rte__log_8h_source.html#l00331">rte_log.h:331</a></div></div>
<div class="ttc" id="arte__eventdev_8h_html_a2af1610d3ede24979267333cf2da1aab"><div class="ttname"><a href="rte__eventdev_8h.html#a2af1610d3ede24979267333cf2da1aab">rte_event_dequeue_burst</a></div><div class="ttdeci">static uint16_t rte_event_dequeue_burst(uint8_t dev_id, uint8_t port_id, struct rte_event ev[], uint16_t nb_events, uint64_t timeout_ticks)</div><div class="ttdef"><b>Definition:</b> <a href="rte__eventdev_8h_source.html#l01645">rte_eventdev.h:1645</a></div></div>
<div class="ttc" id="arte__ether_8h_html_a22bf3d2d6b4e7be447b5e805674e0845"><div class="ttname"><a href="rte__ether_8h.html#a22bf3d2d6b4e7be447b5e805674e0845">RTE_ETHER_ADDR_LEN</a></div><div class="ttdeci">#define RTE_ETHER_ADDR_LEN</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00030">rte_ether.h:30</a></div></div>
<div class="ttc" id="arte__ether_8h_html_a15583fc4e341572ad37c8beace664ea8"><div class="ttname"><a href="rte__ether_8h.html#a15583fc4e341572ad37c8beace664ea8">RTE_ETHER_TYPE_IPV4</a></div><div class="ttdeci">#define RTE_ETHER_TYPE_IPV4</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00283">rte_ether.h:283</a></div></div>
<div class="ttc" id="astructrte__ether__hdr_html_a1d579e2782d36729c1f73608d8663124"><div class="ttname"><a href="structrte__ether__hdr.html#a1d579e2782d36729c1f73608d8663124">rte_ether_hdr::d_addr</a></div><div class="ttdeci">struct rte_ether_addr d_addr</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00000">rte_ether.h:265</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
