<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DPDK: examples/ipsec-secgw/ipsec-secgw.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DPDK
   &#160;<span id="projectnumber">20.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">examples/ipsec-secgw/ipsec-secgw.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/* SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment"> * Copyright(c) 2016 Intel Corporation</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stdbool.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;inttypes.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/types.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;netinet/in.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;netinet/ip.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;netinet/ip6.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/queue.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdarg.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;errno.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;signal.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;getopt.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__common_8h.html">rte_common.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__bitmap_8h.html">rte_bitmap.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__byteorder_8h.html">rte_byteorder.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__log_8h.html">rte_log.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__eal_8h.html">rte_eal.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__launch_8h.html">rte_launch.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__atomic_8h.html">rte_atomic.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__cycles_8h.html">rte_cycles.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__prefetch_8h.html">rte_prefetch.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__lcore_8h.html">rte_lcore.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__per__lcore_8h.html">rte_per_lcore.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__branch__prediction_8h.html">rte_branch_prediction.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__interrupts_8h.html">rte_interrupts.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__random_8h.html">rte_random.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__debug_8h.html">rte_debug.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ether_8h.html">rte_ether.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ethdev_8h.html">rte_ethdev.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__mempool_8h.html">rte_mempool.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__mbuf_8h.html">rte_mbuf.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__acl_8h.html">rte_acl.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__lpm_8h.html">rte_lpm.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__lpm6_8h.html">rte_lpm6.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__hash_8h.html">rte_hash.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__jhash_8h.html">rte_jhash.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__cryptodev_8h.html">rte_cryptodev.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__security_8h.html">rte_security.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__eventdev_8h.html">rte_eventdev.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ip_8h.html">rte_ip.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ip__frag_8h.html">rte_ip_frag.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__alarm_8h.html">rte_alarm.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;event_helper.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;flow.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;ipsec.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;ipsec_worker.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;parser.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;sad.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">volatile</span> <span class="keywordtype">bool</span> force_quit;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MAX_JUMBO_PKT_LEN  9600</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MEMPOOL_CACHE_SIZE 256</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CDEV_QUEUE_DESC 2048</span></div>
<div class="line"><span class="preprocessor">#define CDEV_MAP_ENTRIES 16384</span></div>
<div class="line"><span class="preprocessor">#define CDEV_MP_CACHE_SZ 64</span></div>
<div class="line"><span class="preprocessor">#define CDEV_MP_CACHE_MULTIPLIER 1.5 </span><span class="comment">/* from rte_mempool.c */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define MAX_QUEUE_PAIRS 1</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define BURST_TX_DRAIN_US 100 </span><span class="comment">/* TX drain every ~100us */</span><span class="preprocessor"></span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Configure how many packets ahead to prefetch, when reading packets */</span></div>
<div class="line"><span class="preprocessor">#define PREFETCH_OFFSET 3</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MAX_RX_QUEUE_PER_LCORE 16</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MAX_LCORE_PARAMS 1024</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Configurable number of RX/TX ring descriptors</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="preprocessor">#define IPSEC_SECGW_RX_DESC_DEFAULT 1024</span></div>
<div class="line"><span class="preprocessor">#define IPSEC_SECGW_TX_DESC_DEFAULT 1024</span></div>
<div class="line"><span class="keyword">static</span> uint16_t nb_rxd = IPSEC_SECGW_RX_DESC_DEFAULT;</div>
<div class="line"><span class="keyword">static</span> uint16_t nb_txd = IPSEC_SECGW_TX_DESC_DEFAULT;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define ETHADDR_TO_UINT64(addr) __BYTES_TO_UINT64( \</span></div>
<div class="line"><span class="preprocessor">        (addr)-&gt;addr_bytes[0], (addr)-&gt;addr_bytes[1], \</span></div>
<div class="line"><span class="preprocessor">        (addr)-&gt;addr_bytes[2], (addr)-&gt;addr_bytes[3], \</span></div>
<div class="line"><span class="preprocessor">        (addr)-&gt;addr_bytes[4], (addr)-&gt;addr_bytes[5], \</span></div>
<div class="line"><span class="preprocessor">        0, 0)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define FRAG_TBL_BUCKET_ENTRIES 4</span></div>
<div class="line"><span class="preprocessor">#define MAX_FRAG_TTL_NS     (10LL * NS_PER_S)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MTU_TO_FRAMELEN(x)  ((x) + RTE_ETHER_HDR_LEN + RTE_ETHER_CRC_LEN)</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>ethaddr_info ethaddr_tbl[RTE_MAX_ETHPORTS] = {</div>
<div class="line">    { 0, ETHADDR(0x00, 0x16, 0x3e, 0x7e, 0x94, 0x9a) },</div>
<div class="line">    { 0, ETHADDR(0x00, 0x16, 0x3e, 0x22, 0xa1, 0xd9) },</div>
<div class="line">    { 0, ETHADDR(0x00, 0x16, 0x3e, 0x08, 0x69, 0x26) },</div>
<div class="line">    { 0, ETHADDR(0x00, 0x16, 0x3e, 0x49, 0x9e, 0xdd) }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>flow_info flow_info_tbl[RTE_MAX_ETHPORTS];</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CMD_LINE_OPT_CONFIG     &quot;config&quot;</span></div>
<div class="line"><span class="preprocessor">#define CMD_LINE_OPT_SINGLE_SA      &quot;single-sa&quot;</span></div>
<div class="line"><span class="preprocessor">#define CMD_LINE_OPT_CRYPTODEV_MASK &quot;cryptodev_mask&quot;</span></div>
<div class="line"><span class="preprocessor">#define CMD_LINE_OPT_TRANSFER_MODE  &quot;transfer-mode&quot;</span></div>
<div class="line"><span class="preprocessor">#define CMD_LINE_OPT_SCHEDULE_TYPE  &quot;event-schedule-type&quot;</span></div>
<div class="line"><span class="preprocessor">#define CMD_LINE_OPT_RX_OFFLOAD     &quot;rxoffload&quot;</span></div>
<div class="line"><span class="preprocessor">#define CMD_LINE_OPT_TX_OFFLOAD     &quot;txoffload&quot;</span></div>
<div class="line"><span class="preprocessor">#define CMD_LINE_OPT_REASSEMBLE     &quot;reassemble&quot;</span></div>
<div class="line"><span class="preprocessor">#define CMD_LINE_OPT_MTU        &quot;mtu&quot;</span></div>
<div class="line"><span class="preprocessor">#define CMD_LINE_OPT_FRAG_TTL       &quot;frag-ttl&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CMD_LINE_ARG_EVENT  &quot;event&quot;</span></div>
<div class="line"><span class="preprocessor">#define CMD_LINE_ARG_POLL   &quot;poll&quot;</span></div>
<div class="line"><span class="preprocessor">#define CMD_LINE_ARG_ORDERED    &quot;ordered&quot;</span></div>
<div class="line"><span class="preprocessor">#define CMD_LINE_ARG_ATOMIC &quot;atomic&quot;</span></div>
<div class="line"><span class="preprocessor">#define CMD_LINE_ARG_PARALLEL   &quot;parallel&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum</span> {</div>
<div class="line">    <span class="comment">/* long options mapped to a short option */</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* first long only option value must be &gt;= 256, so that we won&#39;t</span></div>
<div class="line"><span class="comment">     * conflict with short options</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    CMD_LINE_OPT_MIN_NUM = 256,</div>
<div class="line">    CMD_LINE_OPT_CONFIG_NUM,</div>
<div class="line">    CMD_LINE_OPT_SINGLE_SA_NUM,</div>
<div class="line">    CMD_LINE_OPT_CRYPTODEV_MASK_NUM,</div>
<div class="line">    CMD_LINE_OPT_TRANSFER_MODE_NUM,</div>
<div class="line">    CMD_LINE_OPT_SCHEDULE_TYPE_NUM,</div>
<div class="line">    CMD_LINE_OPT_RX_OFFLOAD_NUM,</div>
<div class="line">    CMD_LINE_OPT_TX_OFFLOAD_NUM,</div>
<div class="line">    CMD_LINE_OPT_REASSEMBLE_NUM,</div>
<div class="line">    CMD_LINE_OPT_MTU_NUM,</div>
<div class="line">    CMD_LINE_OPT_FRAG_TTL_NUM,</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span>option lgopts[] = {</div>
<div class="line">    {CMD_LINE_OPT_CONFIG, 1, 0, CMD_LINE_OPT_CONFIG_NUM},</div>
<div class="line">    {CMD_LINE_OPT_SINGLE_SA, 1, 0, CMD_LINE_OPT_SINGLE_SA_NUM},</div>
<div class="line">    {CMD_LINE_OPT_CRYPTODEV_MASK, 1, 0, CMD_LINE_OPT_CRYPTODEV_MASK_NUM},</div>
<div class="line">    {CMD_LINE_OPT_TRANSFER_MODE, 1, 0, CMD_LINE_OPT_TRANSFER_MODE_NUM},</div>
<div class="line">    {CMD_LINE_OPT_SCHEDULE_TYPE, 1, 0, CMD_LINE_OPT_SCHEDULE_TYPE_NUM},</div>
<div class="line">    {CMD_LINE_OPT_RX_OFFLOAD, 1, 0, CMD_LINE_OPT_RX_OFFLOAD_NUM},</div>
<div class="line">    {CMD_LINE_OPT_TX_OFFLOAD, 1, 0, CMD_LINE_OPT_TX_OFFLOAD_NUM},</div>
<div class="line">    {CMD_LINE_OPT_REASSEMBLE, 1, 0, CMD_LINE_OPT_REASSEMBLE_NUM},</div>
<div class="line">    {CMD_LINE_OPT_MTU, 1, 0, CMD_LINE_OPT_MTU_NUM},</div>
<div class="line">    {CMD_LINE_OPT_FRAG_TTL, 1, 0, CMD_LINE_OPT_FRAG_TTL_NUM},</div>
<div class="line">    {NULL, 0, 0, 0}</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">uint32_t unprotected_port_mask;</div>
<div class="line">uint32_t single_sa_idx;</div>
<div class="line"><span class="comment">/* mask of enabled ports */</span></div>
<div class="line"><span class="keyword">static</span> uint32_t enabled_port_mask;</div>
<div class="line"><span class="keyword">static</span> uint64_t enabled_cryptodev_mask = UINT64_MAX;</div>
<div class="line"><span class="keyword">static</span> int32_t promiscuous_on = 1;</div>
<div class="line"><span class="keyword">static</span> int32_t numa_on = 1; </div>
<div class="line"><span class="keyword">static</span> uint32_t nb_lcores;</div>
<div class="line"><span class="keyword">static</span> uint32_t single_sa;</div>
<div class="line"><span class="keyword">static</span> uint32_t nb_bufs_in_pool;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * RX/TX HW offload capabilities to enable/use on ethernet ports.</span></div>
<div class="line"><span class="comment"> * By default all capabilities are enabled.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> uint64_t dev_rx_offload = UINT64_MAX;</div>
<div class="line"><span class="keyword">static</span> uint64_t dev_tx_offload = UINT64_MAX;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * global values that determine multi-seg policy</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> uint32_t frag_tbl_sz;</div>
<div class="line"><span class="keyword">static</span> uint32_t frame_buf_size = RTE_MBUF_DEFAULT_BUF_SIZE;</div>
<div class="line"><span class="keyword">static</span> uint32_t mtu_size = <a name="a0"></a><a class="code" href="rte__ether_8h.html#a4eaf2c62fef067d38a3e1f7c34c36005">RTE_ETHER_MTU</a>;</div>
<div class="line"><span class="keyword">static</span> uint64_t frag_ttl_ns = MAX_FRAG_TTL_NS;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* application wide librte_ipsec/SA parameters */</span></div>
<div class="line"><span class="keyword">struct </span>app_sa_prm app_sa_prm = {</div>
<div class="line">            .enable = 0,</div>
<div class="line">            .cache_sz = SA_CACHE_SZ</div>
<div class="line">        };</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *cfgfile;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>lcore_rx_queue {</div>
<div class="line">    uint16_t port_id;</div>
<div class="line">    uint8_t queue_id;</div>
<div class="line">} <a name="a1"></a><a class="code" href="rte__common_8h.html#a38e32f822bc941e90fdcbe5a9c69b178">__rte_cache_aligned</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>lcore_params {</div>
<div class="line">    uint16_t port_id;</div>
<div class="line">    uint8_t queue_id;</div>
<div class="line">    uint8_t lcore_id;</div>
<div class="line">} <a class="code" href="rte__common_8h.html#a38e32f822bc941e90fdcbe5a9c69b178">__rte_cache_aligned</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>lcore_params lcore_params_array[MAX_LCORE_PARAMS];</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>lcore_params *lcore_params;</div>
<div class="line"><span class="keyword">static</span> uint16_t nb_lcore_params;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a name="_a2"></a><a class="code" href="structrte__hash.html">rte_hash</a> *cdev_map_in;</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structrte__hash.html">rte_hash</a> *cdev_map_out;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>buffer {</div>
<div class="line">    uint16_t len;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a3"></a><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m_table[MAX_PKT_BURST] <a name="a4"></a><a class="code" href="rte__ethdev_8h.html#ad9c80e6e25ce9d6e8acd4e720cc64c36">__rte_aligned</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">void</span> *));</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>lcore_conf {</div>
<div class="line">    uint16_t nb_rx_queue;</div>
<div class="line">    <span class="keyword">struct </span>lcore_rx_queue rx_queue_list[MAX_RX_QUEUE_PER_LCORE];</div>
<div class="line">    uint16_t tx_queue_id[RTE_MAX_ETHPORTS];</div>
<div class="line">    <span class="keyword">struct </span>buffer tx_mbufs[RTE_MAX_ETHPORTS];</div>
<div class="line">    <span class="keyword">struct </span>ipsec_ctx inbound;</div>
<div class="line">    <span class="keyword">struct </span>ipsec_ctx outbound;</div>
<div class="line">    <span class="keyword">struct </span>rt_ctx *rt4_ctx;</div>
<div class="line">    <span class="keyword">struct </span>rt_ctx *rt6_ctx;</div>
<div class="line">    <span class="keyword">struct </span>{</div>
<div class="line">        <span class="keyword">struct </span><a name="_a5"></a><a class="code" href="structrte__ip__frag__tbl.html">rte_ip_frag_tbl</a> *tbl;</div>
<div class="line">        <span class="keyword">struct </span><a name="_a6"></a><a class="code" href="structrte__mempool.html">rte_mempool</a> *pool_dir;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structrte__mempool.html">rte_mempool</a> *pool_indir;</div>
<div class="line">        <span class="keyword">struct </span><a name="_a7"></a><a class="code" href="structrte__ip__frag__death__row.html">rte_ip_frag_death_row</a> dr;</div>
<div class="line">    } frag;</div>
<div class="line">} <a class="code" href="rte__common_8h.html#a38e32f822bc941e90fdcbe5a9c69b178">__rte_cache_aligned</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>lcore_conf lcore_conf[RTE_MAX_LCORE];</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a name="_a8"></a><a class="code" href="structrte__eth__conf.html">rte_eth_conf</a> port_conf = {</div>
<div class="line">    .<a name="a9"></a><a class="code" href="structrte__eth__conf.html#a346eef99c24f617b74c440c1aa565d01">rxmode</a> = {</div>
<div class="line">        .<a name="a10"></a><a class="code" href="structrte__eth__rxmode.html#aa0562513c4569f1aa53050f1beac6b5d">mq_mode</a>    = <a name="a11"></a><a class="code" href="rte__ethdev_8h.html#a586b8e86131b4ec0ccaf464e847ccf3eaa06694239b7ecf1efa3c9243b9e7b4c0">ETH_MQ_RX_RSS</a>,</div>
<div class="line">        .max_rx_pkt_len = <a name="a12"></a><a class="code" href="rte__ether_8h.html#af1fb088707ce5b2ebb7825cb69b5cb58">RTE_ETHER_MAX_LEN</a>,</div>
<div class="line">        .split_hdr_size = 0,</div>
<div class="line">        .offloads = DEV_RX_OFFLOAD_CHECKSUM,</div>
<div class="line">    },</div>
<div class="line">    .rx_adv_conf = {</div>
<div class="line">        .rss_conf = {</div>
<div class="line">            .rss_key = NULL,</div>
<div class="line">            .rss_hf = ETH_RSS_IP | ETH_RSS_UDP |</div>
<div class="line">                ETH_RSS_TCP | ETH_RSS_SCTP,</div>
<div class="line">        },</div>
<div class="line">    },</div>
<div class="line">    .txmode = {</div>
<div class="line">        .mq_mode = <a name="a13"></a><a class="code" href="rte__ethdev_8h.html#a4834f572f4dd4e46d81ad09b7d5fffd5aada568551470d5f419cd2f3d6b6bfedc">ETH_MQ_TX_NONE</a>,</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>socket_ctx socket_ctx[NB_SOCKETS];</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Determine is multi-segment support required:</span></div>
<div class="line"><span class="comment"> *  - either frame buffer size is smaller then mtu</span></div>
<div class="line"><span class="comment"> *  - or reassmeble support is requested</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">multi_seg_required(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> (MTU_TO_FRAMELEN(mtu_size) + RTE_PKTMBUF_HEADROOM &gt;</div>
<div class="line">        frame_buf_size || frag_tbl_sz != 0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">adjust_ipv4_pktlen(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m, <span class="keyword">const</span> <span class="keyword">struct</span> <a name="_a14"></a><a class="code" href="structrte__ipv4__hdr.html">rte_ipv4_hdr</a> *iph,</div>
<div class="line">    uint32_t l2_len)</div>
<div class="line">{</div>
<div class="line">    uint32_t plen, trim;</div>
<div class="line"> </div>
<div class="line">    plen = <a name="a15"></a><a class="code" href="rte__byteorder_8h.html#a06f1729594bf45215195660a86c9b2c4">rte_be_to_cpu_16</a>(iph-&gt;<a name="a16"></a><a class="code" href="structrte__ipv4__hdr.html#ae5759afc2c39ee0ff1cf77f61173260e">total_length</a>) + l2_len;</div>
<div class="line">    <span class="keywordflow">if</span> (plen &lt; m-&gt;pkt_len) {</div>
<div class="line">        trim = m-&gt;<a name="a17"></a><a class="code" href="structrte__mbuf.html#a5046af233a45d6d79ce1a5aae535b23c">pkt_len</a> - plen;</div>
<div class="line">        <a name="a18"></a><a class="code" href="rte__mbuf_8h.html#abe1bed439015acec170d1342e8dabb3b">rte_pktmbuf_trim</a>(m, trim);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">adjust_ipv6_pktlen(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m, <span class="keyword">const</span> <span class="keyword">struct</span> <a name="_a19"></a><a class="code" href="structrte__ipv6__hdr.html">rte_ipv6_hdr</a> *iph,</div>
<div class="line">    uint32_t l2_len)</div>
<div class="line">{</div>
<div class="line">    uint32_t plen, trim;</div>
<div class="line"> </div>
<div class="line">    plen = <a class="code" href="rte__byteorder_8h.html#a06f1729594bf45215195660a86c9b2c4">rte_be_to_cpu_16</a>(iph-&gt;<a name="a20"></a><a class="code" href="structrte__ipv6__hdr.html#a7c49a9ddd6ae97a291bc48251c74da19">payload_len</a>) + <span class="keyword">sizeof</span>(*iph) + l2_len;</div>
<div class="line">    <span class="keywordflow">if</span> (plen &lt; m-&gt;pkt_len) {</div>
<div class="line">        trim = m-&gt;<a class="code" href="structrte__mbuf.html#a5046af233a45d6d79ce1a5aae535b23c">pkt_len</a> - plen;</div>
<div class="line">        <a class="code" href="rte__mbuf_8h.html#abe1bed439015acec170d1342e8dabb3b">rte_pktmbuf_trim</a>(m, trim);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#if (STATS_INTERVAL &gt; 0)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Print out statistics on packet distribution */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">print_stats_cb(<a name="a21"></a><a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *param)</div>
<div class="line">{</div>
<div class="line">    uint64_t total_packets_dropped, total_packets_tx, total_packets_rx;</div>
<div class="line">    <span class="keywordtype">float</span> burst_percent, rx_per_call, tx_per_call;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> coreid;</div>
<div class="line"> </div>
<div class="line">    total_packets_dropped = 0;</div>
<div class="line">    total_packets_tx = 0;</div>
<div class="line">    total_packets_rx = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> clr[] = { 27, <span class="charliteral">&#39;[&#39;</span>, <span class="charliteral">&#39;2&#39;</span>, <span class="charliteral">&#39;J&#39;</span>, <span class="charliteral">&#39;\0&#39;</span> };</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> topLeft[] = { 27, <span class="charliteral">&#39;[&#39;</span>, <span class="charliteral">&#39;1&#39;</span>, <span class="charliteral">&#39;;&#39;</span>, <span class="charliteral">&#39;1&#39;</span>, <span class="charliteral">&#39;H&#39;</span>, <span class="charliteral">&#39;\0&#39;</span> };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Clear screen and move to top left */</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;%s%s&quot;</span>, clr, topLeft);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;\nCore statistics ====================================&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (coreid = 0; coreid &lt; RTE_MAX_LCORE; coreid++) {</div>
<div class="line">        <span class="comment">/* skip disabled cores */</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a22"></a><a class="code" href="rte__lcore_8h.html#a5404ee6ac26cbe5a4f4ddef44d690b76">rte_lcore_is_enabled</a>(coreid) == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        burst_percent = (float)(core_statistics[coreid].burst_rx * 100)/</div>
<div class="line">                    core_statistics[coreid].rx;</div>
<div class="line">        rx_per_call =  (float)(core_statistics[coreid].rx)/</div>
<div class="line">                       core_statistics[coreid].rx_call;</div>
<div class="line">        tx_per_call =  (float)(core_statistics[coreid].tx)/</div>
<div class="line">                       core_statistics[coreid].tx_call;</div>
<div class="line">        printf(<span class="stringliteral">&quot;\nStatistics for core %u ------------------------------&quot;</span></div>
<div class="line">               <span class="stringliteral">&quot;\nPackets received: %20&quot;</span>PRIu64</div>
<div class="line">               <span class="stringliteral">&quot;\nPackets sent: %24&quot;</span>PRIu64</div>
<div class="line">               <span class="stringliteral">&quot;\nPackets dropped: %21&quot;</span>PRIu64</div>
<div class="line">               <span class="stringliteral">&quot;\nBurst percent: %23.2f&quot;</span></div>
<div class="line">               <span class="stringliteral">&quot;\nPackets per Rx call: %17.2f&quot;</span></div>
<div class="line">               <span class="stringliteral">&quot;\nPackets per Tx call: %17.2f&quot;</span>,</div>
<div class="line">               coreid,</div>
<div class="line">               core_statistics[coreid].rx,</div>
<div class="line">               core_statistics[coreid].tx,</div>
<div class="line">               core_statistics[coreid].dropped,</div>
<div class="line">               burst_percent,</div>
<div class="line">               rx_per_call,</div>
<div class="line">               tx_per_call);</div>
<div class="line"> </div>
<div class="line">        total_packets_dropped += core_statistics[coreid].dropped;</div>
<div class="line">        total_packets_tx += core_statistics[coreid].tx;</div>
<div class="line">        total_packets_rx += core_statistics[coreid].rx;</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;\nAggregate statistics ===============================&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;\nTotal packets received: %14&quot;</span>PRIu64</div>
<div class="line">           <span class="stringliteral">&quot;\nTotal packets sent: %18&quot;</span>PRIu64</div>
<div class="line">           <span class="stringliteral">&quot;\nTotal packets dropped: %15&quot;</span>PRIu64,</div>
<div class="line">           total_packets_rx,</div>
<div class="line">           total_packets_tx,</div>
<div class="line">           total_packets_dropped);</div>
<div class="line">    printf(<span class="stringliteral">&quot;\n====================================================\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a name="a23"></a><a class="code" href="rte__alarm_8h.html#a2dcad28ea9331067662351b36d5877e5">rte_eal_alarm_set</a>(STATS_INTERVAL * US_PER_S, print_stats_cb, NULL);</div>
<div class="line">}</div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">/* STATS_INTERVAL */</span><span class="preprocessor"></span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">prepare_one_packet(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkt, <span class="keyword">struct</span> ipsec_traffic *t)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a name="_a24"></a><a class="code" href="structrte__ether__hdr.html">rte_ether_hdr</a> *eth;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__ipv4__hdr.html">rte_ipv4_hdr</a> *iph4;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__ipv6__hdr.html">rte_ipv6_hdr</a> *iph6;</div>
<div class="line"> </div>
<div class="line">    eth = <a name="a25"></a><a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(pkt, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structrte__ether__hdr.html">rte_ether_hdr</a> *);</div>
<div class="line">    <span class="keywordflow">if</span> (eth-&gt;<a name="a26"></a><a class="code" href="structrte__ether__hdr.html#ad6312397ccc57d322b1a037c7080d340">ether_type</a> == <a name="a27"></a><a class="code" href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a>(<a name="a28"></a><a class="code" href="rte__ether_8h.html#a15583fc4e341572ad37c8beace664ea8">RTE_ETHER_TYPE_IPV4</a>)) {</div>
<div class="line"> </div>
<div class="line">        iph4 = (<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__ipv4__hdr.html">rte_ipv4_hdr</a> *)<a name="a29"></a><a class="code" href="rte__mbuf_8h.html#a1bbd752194759ce7b419c4998f2e8651">rte_pktmbuf_adj</a>(pkt,</div>
<div class="line">            <a name="a30"></a><a class="code" href="rte__ether_8h.html#a67dff5b18f52e97596f08ed2e76e4902">RTE_ETHER_HDR_LEN</a>);</div>
<div class="line">        adjust_ipv4_pktlen(pkt, iph4, 0);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (iph4-&gt;<a name="a31"></a><a class="code" href="structrte__ipv4__hdr.html#a513eb1be3a24fe8df91530edd4517ade">next_proto_id</a> == IPPROTO_ESP)</div>
<div class="line">            t-&gt;ipsec.pkts[(t-&gt;ipsec.num)++] = pkt;</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            t-&gt;ip4.data[t-&gt;ip4.num] = &amp;iph4-&gt;<a class="code" href="structrte__ipv4__hdr.html#a513eb1be3a24fe8df91530edd4517ade">next_proto_id</a>;</div>
<div class="line">            t-&gt;ip4.pkts[(t-&gt;ip4.num)++] = pkt;</div>
<div class="line">        }</div>
<div class="line">        pkt-&gt;<a name="a32"></a><a class="code" href="structrte__mbuf.html#aa25a7c259438b9eba28bcedc33846620">l2_len</a> = 0;</div>
<div class="line">        pkt-&gt;<a name="a33"></a><a class="code" href="structrte__mbuf.html#a82a34cb6d5935a8c0f043f2783d6b42d">l3_len</a> = <span class="keyword">sizeof</span>(*iph4);</div>
<div class="line">        pkt-&gt;<a name="a34"></a><a class="code" href="structrte__mbuf.html#a8d0990e39ae8f91a4937083eead6b65f">packet_type</a> |= <a name="a35"></a><a class="code" href="rte__mbuf__ptype_8h.html#ae381ac5f3d455fe13de25aa809399a60">RTE_PTYPE_L3_IPV4</a>;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (eth-&gt;<a class="code" href="structrte__ether__hdr.html#ad6312397ccc57d322b1a037c7080d340">ether_type</a> == <a class="code" href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a>(<a name="a36"></a><a class="code" href="rte__ether_8h.html#ac386d430206de37dca641eaa5c0c74ac">RTE_ETHER_TYPE_IPV6</a>)) {</div>
<div class="line">        <span class="keywordtype">int</span> next_proto;</div>
<div class="line">        <span class="keywordtype">size_t</span> l3len, ext_len;</div>
<div class="line">        uint8_t *p;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* get protocol type */</span></div>
<div class="line">        iph6 = (<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__ipv6__hdr.html">rte_ipv6_hdr</a> *)<a class="code" href="rte__mbuf_8h.html#a1bbd752194759ce7b419c4998f2e8651">rte_pktmbuf_adj</a>(pkt,</div>
<div class="line">            <a class="code" href="rte__ether_8h.html#a67dff5b18f52e97596f08ed2e76e4902">RTE_ETHER_HDR_LEN</a>);</div>
<div class="line">        adjust_ipv6_pktlen(pkt, iph6, 0);</div>
<div class="line"> </div>
<div class="line">        next_proto = iph6-&gt;<a name="a37"></a><a class="code" href="structrte__ipv6__hdr.html#adaae928b69788f774db092e75f1c4fb7">proto</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* determine l3 header size up to ESP extension */</span></div>
<div class="line">        l3len = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>ip6_hdr);</div>
<div class="line">        p = <a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(pkt, uint8_t *);</div>
<div class="line">        <span class="keywordflow">while</span> (next_proto != IPPROTO_ESP &amp;&amp; l3len &lt; pkt-&gt;data_len &amp;&amp;</div>
<div class="line">            (next_proto = <a name="a38"></a><a class="code" href="rte__ip_8h.html#a152c7479c3bb1c664f89ad315b1a453d">rte_ipv6_get_next_ext</a>(p + l3len,</div>
<div class="line">                        next_proto, &amp;ext_len)) &gt;= 0)</div>
<div class="line">            l3len += ext_len;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* drop packet when IPv6 header exceeds first segment length */</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a39"></a><a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(l3len &gt; pkt-&gt;<a name="a40"></a><a class="code" href="structrte__mbuf.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a>)) {</div>
<div class="line">            free_pkts(&amp;pkt, 1);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (next_proto == IPPROTO_ESP)</div>
<div class="line">            t-&gt;ipsec.pkts[(t-&gt;ipsec.num)++] = pkt;</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            t-&gt;ip6.data[t-&gt;ip6.num] = &amp;iph6-&gt;<a class="code" href="structrte__ipv6__hdr.html#adaae928b69788f774db092e75f1c4fb7">proto</a>;</div>
<div class="line">            t-&gt;ip6.pkts[(t-&gt;ip6.num)++] = pkt;</div>
<div class="line">        }</div>
<div class="line">        pkt-&gt;<a class="code" href="structrte__mbuf.html#aa25a7c259438b9eba28bcedc33846620">l2_len</a> = 0;</div>
<div class="line">        pkt-&gt;<a class="code" href="structrte__mbuf.html#a82a34cb6d5935a8c0f043f2783d6b42d">l3_len</a> = l3len;</div>
<div class="line">        pkt-&gt;<a class="code" href="structrte__mbuf.html#a8d0990e39ae8f91a4937083eead6b65f">packet_type</a> |= <a name="a41"></a><a class="code" href="rte__mbuf__ptype_8h.html#a44e077cfdb3846a3ca63c5039586b9e5">RTE_PTYPE_L3_IPV6</a>;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="comment">/* Unknown/Unsupported type, drop the packet */</span></div>
<div class="line">        <a name="a42"></a><a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC, <span class="stringliteral">&quot;Unsupported packet type 0x%x\n&quot;</span>,</div>
<div class="line">            <a class="code" href="rte__byteorder_8h.html#a06f1729594bf45215195660a86c9b2c4">rte_be_to_cpu_16</a>(eth-&gt;<a class="code" href="structrte__ether__hdr.html#ad6312397ccc57d322b1a037c7080d340">ether_type</a>));</div>
<div class="line">        free_pkts(&amp;pkt, 1);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check if the packet has been processed inline. For inline protocol</span></div>
<div class="line"><span class="comment">     * processed packets, the metadata in the mbuf can be used to identify</span></div>
<div class="line"><span class="comment">     * the security processing done on the packet. The metadata will be</span></div>
<div class="line"><span class="comment">     * used to retrieve the application registered userdata associated</span></div>
<div class="line"><span class="comment">     * with the security session.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (pkt-&gt;<a name="a43"></a><a class="code" href="structrte__mbuf.html#a319d580a6e1ef13692631d7b0d6d5c98">ol_flags</a> &amp; <a name="a44"></a><a class="code" href="rte__mbuf__core_8h.html#a87d6352dee4dd78c55d943aa814b0491">PKT_RX_SEC_OFFLOAD</a> &amp;&amp;</div>
<div class="line">            <a name="a45"></a><a class="code" href="rte__security_8h.html#ac2cdd90e7fc7f9121c997cafe2f6a5e3">rte_security_dynfield_is_registered</a>()) {</div>
<div class="line">        <span class="keyword">struct </span>ipsec_sa *sa;</div>
<div class="line">        <span class="keyword">struct </span>ipsec_mbuf_metadata *priv;</div>
<div class="line">        <span class="keyword">struct </span><a name="_a46"></a><a class="code" href="structrte__security__ctx.html">rte_security_ctx</a> *ctx = (<span class="keyword">struct </span><a class="code" href="structrte__security__ctx.html">rte_security_ctx</a> *)</div>
<div class="line">                        <a name="a47"></a><a class="code" href="rte__ethdev_8h.html#a539fa8ee80c94d538a42d951e4bcb00e">rte_eth_dev_get_sec_ctx</a>(</div>
<div class="line">                        pkt-&gt;<a name="a48"></a><a class="code" href="structrte__mbuf.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Retrieve the userdata registered. Here, the userdata</span></div>
<div class="line"><span class="comment">         * registered is the SA pointer.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        sa = (<span class="keyword">struct </span>ipsec_sa *)<a name="a49"></a><a class="code" href="rte__security_8h.html#a8a5c2bea95a2ec95ce525d1a366d7133">rte_security_get_userdata</a>(ctx,</div>
<div class="line">                *<a name="a50"></a><a class="code" href="rte__security_8h.html#a6ab33d9ca2b9940e421f4f803b168eab">rte_security_dynfield</a>(pkt));</div>
<div class="line">        <span class="keywordflow">if</span> (sa == NULL) {</div>
<div class="line">            <span class="comment">/* userdata could not be retrieved */</span></div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Save SA as priv member in mbuf. This will be used in the</span></div>
<div class="line"><span class="comment">         * IPsec selector(SP-SA) check.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line"> </div>
<div class="line">        priv = get_priv(pkt);</div>
<div class="line">        priv-&gt;sa = sa;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">prepare_traffic(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> **pkts, <span class="keyword">struct</span> ipsec_traffic *t,</div>
<div class="line">        uint16_t nb_pkts)</div>
<div class="line">{</div>
<div class="line">    int32_t i;</div>
<div class="line"> </div>
<div class="line">    t-&gt;ipsec.num = 0;</div>
<div class="line">    t-&gt;ip4.num = 0;</div>
<div class="line">    t-&gt;ip6.num = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; (nb_pkts - PREFETCH_OFFSET); i++) {</div>
<div class="line">        <a name="a51"></a><a class="code" href="rte__prefetch_8h.html#a7f89cf66766e6bfd63feb370a7280de9">rte_prefetch0</a>(<a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(pkts[i + PREFETCH_OFFSET],</div>
<div class="line">                    <span class="keywordtype">void</span> *));</div>
<div class="line">        prepare_one_packet(pkts[i], t);</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Process left packets */</span></div>
<div class="line">    <span class="keywordflow">for</span> (; i &lt; nb_pkts; i++)</div>
<div class="line">        prepare_one_packet(pkts[i], t);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">prepare_tx_pkt(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkt, uint16_t port,</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">struct</span> lcore_conf *qconf)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>ip *ip;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ether__hdr.html">rte_ether_hdr</a> *ethhdr;</div>
<div class="line"> </div>
<div class="line">    ip = <a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(pkt, <span class="keyword">struct</span> ip *);</div>
<div class="line"> </div>
<div class="line">    ethhdr = (<span class="keyword">struct </span><a class="code" href="structrte__ether__hdr.html">rte_ether_hdr</a> *)</div>
<div class="line">        <a name="a52"></a><a class="code" href="rte__mbuf_8h.html#aadf5bef4ceb0b76dfafff0895f285ab0">rte_pktmbuf_prepend</a>(pkt, <a class="code" href="rte__ether_8h.html#a67dff5b18f52e97596f08ed2e76e4902">RTE_ETHER_HDR_LEN</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ip-&gt;ip_v == IPVERSION) {</div>
<div class="line">        pkt-&gt;<a class="code" href="structrte__mbuf.html#a319d580a6e1ef13692631d7b0d6d5c98">ol_flags</a> |= qconf-&gt;outbound.ipv4_offloads;</div>
<div class="line">        pkt-&gt;<a class="code" href="structrte__mbuf.html#a82a34cb6d5935a8c0f043f2783d6b42d">l3_len</a> = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>ip);</div>
<div class="line">        pkt-&gt;<a class="code" href="structrte__mbuf.html#aa25a7c259438b9eba28bcedc33846620">l2_len</a> = <a class="code" href="rte__ether_8h.html#a67dff5b18f52e97596f08ed2e76e4902">RTE_ETHER_HDR_LEN</a>;</div>
<div class="line"> </div>
<div class="line">        ip-&gt;ip_sum = 0;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* calculate IPv4 cksum in SW */</span></div>
<div class="line">        <span class="keywordflow">if</span> ((pkt-&gt;<a class="code" href="structrte__mbuf.html#a319d580a6e1ef13692631d7b0d6d5c98">ol_flags</a> &amp; <a name="a53"></a><a class="code" href="rte__mbuf__core_8h.html#a51280725dafdf282a80b2d964418798c">PKT_TX_IP_CKSUM</a>) == 0)</div>
<div class="line">            ip-&gt;ip_sum = <a name="a54"></a><a class="code" href="rte__ip_8h.html#a8be1ccea98d6afa79fe0c8531eb266f7">rte_ipv4_cksum</a>((<span class="keyword">struct</span> <a class="code" href="structrte__ipv4__hdr.html">rte_ipv4_hdr</a> *)ip);</div>
<div class="line"> </div>
<div class="line">        ethhdr-&gt;<a class="code" href="structrte__ether__hdr.html#ad6312397ccc57d322b1a037c7080d340">ether_type</a> = <a class="code" href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a>(<a class="code" href="rte__ether_8h.html#a15583fc4e341572ad37c8beace664ea8">RTE_ETHER_TYPE_IPV4</a>);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        pkt-&gt;<a class="code" href="structrte__mbuf.html#a319d580a6e1ef13692631d7b0d6d5c98">ol_flags</a> |= qconf-&gt;outbound.ipv6_offloads;</div>
<div class="line">        pkt-&gt;<a class="code" href="structrte__mbuf.html#a82a34cb6d5935a8c0f043f2783d6b42d">l3_len</a> = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>ip6_hdr);</div>
<div class="line">        pkt-&gt;<a class="code" href="structrte__mbuf.html#aa25a7c259438b9eba28bcedc33846620">l2_len</a> = <a class="code" href="rte__ether_8h.html#a67dff5b18f52e97596f08ed2e76e4902">RTE_ETHER_HDR_LEN</a>;</div>
<div class="line"> </div>
<div class="line">        ethhdr-&gt;<a class="code" href="structrte__ether__hdr.html#ad6312397ccc57d322b1a037c7080d340">ether_type</a> = <a class="code" href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a>(<a class="code" href="rte__ether_8h.html#ac386d430206de37dca641eaa5c0c74ac">RTE_ETHER_TYPE_IPV6</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    memcpy(&amp;ethhdr-&gt;<a name="a55"></a><a class="code" href="structrte__ether__hdr.html#acce632e0fded0f728a1ee1a1ffb5c9bf">s_addr</a>, &amp;ethaddr_tbl[port].src,</div>
<div class="line">            <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a name="_a56"></a><a class="code" href="structrte__ether__addr.html">rte_ether_addr</a>));</div>
<div class="line">    memcpy(&amp;ethhdr-&gt;<a name="a57"></a><a class="code" href="structrte__ether__hdr.html#a1d579e2782d36729c1f73608d8663124">d_addr</a>, &amp;ethaddr_tbl[port].dst,</div>
<div class="line">            <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrte__ether__addr.html">rte_ether_addr</a>));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">prepare_tx_burst(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkts[], uint16_t nb_pkts, uint16_t port,</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">struct</span> lcore_conf *qconf)</div>
<div class="line">{</div>
<div class="line">    int32_t i;</div>
<div class="line">    <span class="keyword">const</span> int32_t prefetch_offset = 2;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; (nb_pkts - prefetch_offset); i++) {</div>
<div class="line">        <a name="a58"></a><a class="code" href="rte__mbuf_8h.html#a0e75f18703d94db97f61db2e1fce51e8">rte_mbuf_prefetch_part2</a>(pkts[i + prefetch_offset]);</div>
<div class="line">        prepare_tx_pkt(pkts[i], port, qconf);</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Process left packets */</span></div>
<div class="line">    <span class="keywordflow">for</span> (; i &lt; nb_pkts; i++)</div>
<div class="line">        prepare_tx_pkt(pkts[i], port, qconf);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Send burst of packets on an output interface */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> int32_t</div>
<div class="line">send_burst(<span class="keyword">struct</span> lcore_conf *qconf, uint16_t n, uint16_t port)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> **m_table;</div>
<div class="line">    int32_t ret;</div>
<div class="line">    uint16_t queueid;</div>
<div class="line"> </div>
<div class="line">    queueid = qconf-&gt;tx_queue_id[<a class="code" href="structrte__mbuf.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>];</div>
<div class="line">    m_table = (<span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> **)qconf-&gt;tx_mbufs[<a class="code" href="structrte__mbuf.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>].m_table;</div>
<div class="line"> </div>
<div class="line">    prepare_tx_burst(m_table, n, <a class="code" href="structrte__mbuf.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>, qconf);</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a59"></a><a class="code" href="rte__ethdev_8h.html#a83e56cabbd31637efd648e3fc010392b">rte_eth_tx_burst</a>(<a class="code" href="structrte__mbuf.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>, queueid, m_table, n);</div>
<div class="line"> </div>
<div class="line">    core_stats_update_tx(ret);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(ret &lt; n)) {</div>
<div class="line">        <span class="keywordflow">do</span> {</div>
<div class="line">            free_pkts(&amp;m_table[ret], 1);</div>
<div class="line">        } <span class="keywordflow">while</span> (++ret &lt; n);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Helper function to fragment and queue for TX one packet.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> uint32_t</div>
<div class="line">send_fragment_packet(<span class="keyword">struct</span> lcore_conf *qconf, <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m,</div>
<div class="line">    uint16_t <a class="code" href="structrte__mbuf.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>, uint8_t proto)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>buffer *tbl;</div>
<div class="line">    uint32_t len, n;</div>
<div class="line">    int32_t rc;</div>
<div class="line"> </div>
<div class="line">    tbl =  qconf-&gt;tx_mbufs + port;</div>
<div class="line">    len = tbl-&gt;len;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* free space for new fragments */</span></div>
<div class="line">    <span class="keywordflow">if</span> (len + RTE_LIBRTE_IP_FRAG_MAX_FRAG &gt;=  <a name="a60"></a><a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(tbl-&gt;m_table)) {</div>
<div class="line">        send_burst(qconf, len, port);</div>
<div class="line">        len = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    n = <a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(tbl-&gt;m_table) - len;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (proto == IPPROTO_IP)</div>
<div class="line">        rc = <a name="a61"></a><a class="code" href="rte__ip__frag_8h.html#a0ec59118790a4babb24bd5636b1e60d9">rte_ipv4_fragment_packet</a>(m, tbl-&gt;m_table + len,</div>
<div class="line">            n, mtu_size, qconf-&gt;frag.pool_dir,</div>
<div class="line">            qconf-&gt;frag.pool_indir);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        rc = <a name="a62"></a><a class="code" href="rte__ip__frag_8h.html#ae3e47fcd41f6ee74b920eabc0bc86565">rte_ipv6_fragment_packet</a>(m, tbl-&gt;m_table + len,</div>
<div class="line">            n, mtu_size, qconf-&gt;frag.pool_dir,</div>
<div class="line">            qconf-&gt;frag.pool_indir);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (rc &gt;= 0)</div>
<div class="line">        len += rc;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">            <span class="stringliteral">&quot;%s: failed to fragment packet with size %u, &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;error code: %d\n&quot;</span>,</div>
<div class="line">            __func__, m-&gt;<a class="code" href="structrte__mbuf.html#a5046af233a45d6d79ce1a5aae535b23c">pkt_len</a>, <a name="a63"></a><a class="code" href="rte__errno_8h.html#a66171a00ea02084317df4dc9c2adaccb">rte_errno</a>);</div>
<div class="line"> </div>
<div class="line">    free_pkts(&amp;m, 1);</div>
<div class="line">    <span class="keywordflow">return</span> len;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Enqueue a single packet, and send burst if queue is filled */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> int32_t</div>
<div class="line">send_single_packet(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m, uint16_t port, uint8_t proto)</div>
<div class="line">{</div>
<div class="line">    uint32_t lcore_id;</div>
<div class="line">    uint16_t len;</div>
<div class="line">    <span class="keyword">struct </span>lcore_conf *qconf;</div>
<div class="line"> </div>
<div class="line">    lcore_id = <a name="a64"></a><a class="code" href="rte__lcore_8h.html#adfb2b334e7e73f534f25e8888a8a775f">rte_lcore_id</a>();</div>
<div class="line"> </div>
<div class="line">    qconf = &amp;lcore_conf[lcore_id];</div>
<div class="line">    len = qconf-&gt;tx_mbufs[port].len;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m-&gt;<a class="code" href="structrte__mbuf.html#a5046af233a45d6d79ce1a5aae535b23c">pkt_len</a> &lt;= mtu_size) {</div>
<div class="line">        qconf-&gt;tx_mbufs[port].m_table[len] = m;</div>
<div class="line">        len++;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* need to fragment the packet */</span></div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (frag_tbl_sz &gt; 0)</div>
<div class="line">        len = send_fragment_packet(qconf, m, port, proto);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        free_pkts(&amp;m, 1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* enough pkts to be sent */</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(len == MAX_PKT_BURST)) {</div>
<div class="line">        send_burst(qconf, MAX_PKT_BURST, port);</div>
<div class="line">        len = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    qconf-&gt;tx_mbufs[port].len = len;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">inbound_sp_sa(<span class="keyword">struct</span> sp_ctx *sp, <span class="keyword">struct</span> sa_ctx *sa, <span class="keyword">struct</span> traffic_type *ip,</div>
<div class="line">        uint16_t lim)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m;</div>
<div class="line">    uint32_t i, j, res, sa_idx;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ip-&gt;num == 0 || sp == NULL)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <a name="a65"></a><a class="code" href="rte__acl_8h.html#a97c75dcc2bddb3ce02c171f20d2f5854">rte_acl_classify</a>((<span class="keyword">struct</span> rte_acl_ctx *)sp, ip-&gt;data, ip-&gt;res,</div>
<div class="line">            ip-&gt;num, DEFAULT_MAX_CATEGORIES);</div>
<div class="line"> </div>
<div class="line">    j = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; ip-&gt;num; i++) {</div>
<div class="line">        m = ip-&gt;pkts[i];</div>
<div class="line">        res = ip-&gt;res[i];</div>
<div class="line">        <span class="keywordflow">if</span> (res == BYPASS) {</div>
<div class="line">            ip-&gt;pkts[j++] = m;</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (res == DISCARD) {</div>
<div class="line">            free_pkts(&amp;m, 1);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Only check SPI match for processed IPSec packets */</span></div>
<div class="line">        <span class="keywordflow">if</span> (i &lt; lim &amp;&amp; ((m-&gt;<a class="code" href="structrte__mbuf.html#a319d580a6e1ef13692631d7b0d6d5c98">ol_flags</a> &amp; <a class="code" href="rte__mbuf__core_8h.html#a87d6352dee4dd78c55d943aa814b0491">PKT_RX_SEC_OFFLOAD</a>) == 0)) {</div>
<div class="line">            free_pkts(&amp;m, 1);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        sa_idx = res - 1;</div>
<div class="line">        <span class="keywordflow">if</span> (!inbound_sa_check(sa, m, sa_idx)) {</div>
<div class="line">            free_pkts(&amp;m, 1);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line">        ip-&gt;pkts[j++] = m;</div>
<div class="line">    }</div>
<div class="line">    ip-&gt;num = j;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">split46_traffic(<span class="keyword">struct</span> ipsec_traffic *trf, <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *mb[], uint32_t num)</div>
<div class="line">{</div>
<div class="line">    uint32_t i, n4, n6;</div>
<div class="line">    <span class="keyword">struct </span>ip *ip;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m;</div>
<div class="line"> </div>
<div class="line">    n4 = trf-&gt;ip4.num;</div>
<div class="line">    n6 = trf-&gt;ip6.num;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; num; i++) {</div>
<div class="line"> </div>
<div class="line">        m = mb[i];</div>
<div class="line">        ip = <a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(m, <span class="keyword">struct</span> ip *);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (ip-&gt;ip_v == IPVERSION) {</div>
<div class="line">            trf-&gt;ip4.pkts[n4] = m;</div>
<div class="line">            trf-&gt;ip4.data[n4] = <a name="a66"></a><a class="code" href="rte__mbuf__core_8h.html#ad63e1de0ec54d7c7603ea984c76ca956">rte_pktmbuf_mtod_offset</a>(m,</div>
<div class="line">                    uint8_t *, <a name="a67"></a><a class="code" href="rte__common_8h.html#a276e8a32e0bbf024aadd9420b8f2d3b3">offsetof</a>(<span class="keyword">struct</span> ip, ip_p));</div>
<div class="line">            n4++;</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ip-&gt;ip_v == IP6_VERSION) {</div>
<div class="line">            trf-&gt;ip6.pkts[n6] = m;</div>
<div class="line">            trf-&gt;ip6.data[n6] = <a class="code" href="rte__mbuf__core_8h.html#ad63e1de0ec54d7c7603ea984c76ca956">rte_pktmbuf_mtod_offset</a>(m,</div>
<div class="line">                    uint8_t *,</div>
<div class="line">                    <a class="code" href="rte__common_8h.html#a276e8a32e0bbf024aadd9420b8f2d3b3">offsetof</a>(<span class="keyword">struct</span> ip6_hdr, ip6_nxt));</div>
<div class="line">            n6++;</div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line">            free_pkts(&amp;m, 1);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    trf-&gt;ip4.num = n4;</div>
<div class="line">    trf-&gt;ip6.num = n6;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">process_pkts_inbound(<span class="keyword">struct</span> ipsec_ctx *ipsec_ctx,</div>
<div class="line">        <span class="keyword">struct</span> ipsec_traffic *traffic)</div>
<div class="line">{</div>
<div class="line">    uint16_t nb_pkts_in, n_ip4, n_ip6;</div>
<div class="line"> </div>
<div class="line">    n_ip4 = traffic-&gt;ip4.num;</div>
<div class="line">    n_ip6 = traffic-&gt;ip6.num;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (app_sa_prm.enable == 0) {</div>
<div class="line">        nb_pkts_in = ipsec_inbound(ipsec_ctx, traffic-&gt;ipsec.pkts,</div>
<div class="line">                traffic-&gt;ipsec.num, MAX_PKT_BURST);</div>
<div class="line">        split46_traffic(traffic, traffic-&gt;ipsec.pkts, nb_pkts_in);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        inbound_sa_lookup(ipsec_ctx-&gt;sa_ctx, traffic-&gt;ipsec.pkts,</div>
<div class="line">            traffic-&gt;ipsec.saptr, traffic-&gt;ipsec.num);</div>
<div class="line">        ipsec_process(ipsec_ctx, traffic);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    inbound_sp_sa(ipsec_ctx-&gt;sp4_ctx, ipsec_ctx-&gt;sa_ctx, &amp;traffic-&gt;ip4,</div>
<div class="line">            n_ip4);</div>
<div class="line"> </div>
<div class="line">    inbound_sp_sa(ipsec_ctx-&gt;sp6_ctx, ipsec_ctx-&gt;sa_ctx, &amp;traffic-&gt;ip6,</div>
<div class="line">            n_ip6);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">outbound_sp(<span class="keyword">struct</span> sp_ctx *sp, <span class="keyword">struct</span> traffic_type *ip,</div>
<div class="line">        <span class="keyword">struct</span> traffic_type *ipsec)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m;</div>
<div class="line">    uint32_t i, j, sa_idx;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ip-&gt;num == 0 || sp == NULL)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__acl_8h.html#a97c75dcc2bddb3ce02c171f20d2f5854">rte_acl_classify</a>((<span class="keyword">struct</span> rte_acl_ctx *)sp, ip-&gt;data, ip-&gt;res,</div>
<div class="line">            ip-&gt;num, DEFAULT_MAX_CATEGORIES);</div>
<div class="line"> </div>
<div class="line">    j = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; ip-&gt;num; i++) {</div>
<div class="line">        m = ip-&gt;pkts[i];</div>
<div class="line">        sa_idx = ip-&gt;res[i] - 1;</div>
<div class="line">        <span class="keywordflow">if</span> (ip-&gt;res[i] == DISCARD)</div>
<div class="line">            free_pkts(&amp;m, 1);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ip-&gt;res[i] == BYPASS)</div>
<div class="line">            ip-&gt;pkts[j++] = m;</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            ipsec-&gt;res[ipsec-&gt;num] = sa_idx;</div>
<div class="line">            ipsec-&gt;pkts[ipsec-&gt;num++] = m;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    ip-&gt;num = j;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">process_pkts_outbound(<span class="keyword">struct</span> ipsec_ctx *ipsec_ctx,</div>
<div class="line">        <span class="keyword">struct</span> ipsec_traffic *traffic)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m;</div>
<div class="line">    uint16_t idx, nb_pkts_out, i;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Drop any IPsec traffic from protected ports */</span></div>
<div class="line">    free_pkts(traffic-&gt;ipsec.pkts, traffic-&gt;ipsec.num);</div>
<div class="line"> </div>
<div class="line">    traffic-&gt;ipsec.num = 0;</div>
<div class="line"> </div>
<div class="line">    outbound_sp(ipsec_ctx-&gt;sp4_ctx, &amp;traffic-&gt;ip4, &amp;traffic-&gt;ipsec);</div>
<div class="line"> </div>
<div class="line">    outbound_sp(ipsec_ctx-&gt;sp6_ctx, &amp;traffic-&gt;ip6, &amp;traffic-&gt;ipsec);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (app_sa_prm.enable == 0) {</div>
<div class="line"> </div>
<div class="line">        nb_pkts_out = ipsec_outbound(ipsec_ctx, traffic-&gt;ipsec.pkts,</div>
<div class="line">                traffic-&gt;ipsec.res, traffic-&gt;ipsec.num,</div>
<div class="line">                MAX_PKT_BURST);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; nb_pkts_out; i++) {</div>
<div class="line">            m = traffic-&gt;ipsec.pkts[i];</div>
<div class="line">            <span class="keyword">struct </span>ip *ip = <a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(m, <span class="keyword">struct</span> ip *);</div>
<div class="line">            <span class="keywordflow">if</span> (ip-&gt;ip_v == IPVERSION) {</div>
<div class="line">                idx = traffic-&gt;ip4.num++;</div>
<div class="line">                traffic-&gt;ip4.pkts[idx] = m;</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                idx = traffic-&gt;ip6.num++;</div>
<div class="line">                traffic-&gt;ip6.pkts[idx] = m;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        outbound_sa_lookup(ipsec_ctx-&gt;sa_ctx, traffic-&gt;ipsec.res,</div>
<div class="line">            traffic-&gt;ipsec.saptr, traffic-&gt;ipsec.num);</div>
<div class="line">        ipsec_process(ipsec_ctx, traffic);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">process_pkts_inbound_nosp(<span class="keyword">struct</span> ipsec_ctx *ipsec_ctx,</div>
<div class="line">        <span class="keyword">struct</span> ipsec_traffic *traffic)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m;</div>
<div class="line">    uint32_t nb_pkts_in, i, idx;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Drop any IPv4 traffic from unprotected ports */</span></div>
<div class="line">    free_pkts(traffic-&gt;ip4.pkts, traffic-&gt;ip4.num);</div>
<div class="line"> </div>
<div class="line">    traffic-&gt;ip4.num = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Drop any IPv6 traffic from unprotected ports */</span></div>
<div class="line">    free_pkts(traffic-&gt;ip6.pkts, traffic-&gt;ip6.num);</div>
<div class="line"> </div>
<div class="line">    traffic-&gt;ip6.num = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (app_sa_prm.enable == 0) {</div>
<div class="line"> </div>
<div class="line">        nb_pkts_in = ipsec_inbound(ipsec_ctx, traffic-&gt;ipsec.pkts,</div>
<div class="line">                traffic-&gt;ipsec.num, MAX_PKT_BURST);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; nb_pkts_in; i++) {</div>
<div class="line">            m = traffic-&gt;ipsec.pkts[i];</div>
<div class="line">            <span class="keyword">struct </span>ip *ip = <a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(m, <span class="keyword">struct</span> ip *);</div>
<div class="line">            <span class="keywordflow">if</span> (ip-&gt;ip_v == IPVERSION) {</div>
<div class="line">                idx = traffic-&gt;ip4.num++;</div>
<div class="line">                traffic-&gt;ip4.pkts[idx] = m;</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                idx = traffic-&gt;ip6.num++;</div>
<div class="line">                traffic-&gt;ip6.pkts[idx] = m;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        inbound_sa_lookup(ipsec_ctx-&gt;sa_ctx, traffic-&gt;ipsec.pkts,</div>
<div class="line">            traffic-&gt;ipsec.saptr, traffic-&gt;ipsec.num);</div>
<div class="line">        ipsec_process(ipsec_ctx, traffic);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">process_pkts_outbound_nosp(<span class="keyword">struct</span> ipsec_ctx *ipsec_ctx,</div>
<div class="line">        <span class="keyword">struct</span> ipsec_traffic *traffic)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *m;</div>
<div class="line">    uint32_t nb_pkts_out, i, n;</div>
<div class="line">    <span class="keyword">struct </span>ip *ip;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Drop any IPsec traffic from protected ports */</span></div>
<div class="line">    free_pkts(traffic-&gt;ipsec.pkts, traffic-&gt;ipsec.num);</div>
<div class="line"> </div>
<div class="line">    n = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; traffic-&gt;ip4.num; i++) {</div>
<div class="line">        traffic-&gt;ipsec.pkts[n] = traffic-&gt;ip4.pkts[i];</div>
<div class="line">        traffic-&gt;ipsec.res[n++] = single_sa_idx;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; traffic-&gt;ip6.num; i++) {</div>
<div class="line">        traffic-&gt;ipsec.pkts[n] = traffic-&gt;ip6.pkts[i];</div>
<div class="line">        traffic-&gt;ipsec.res[n++] = single_sa_idx;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    traffic-&gt;ip4.num = 0;</div>
<div class="line">    traffic-&gt;ip6.num = 0;</div>
<div class="line">    traffic-&gt;ipsec.num = n;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (app_sa_prm.enable == 0) {</div>
<div class="line"> </div>
<div class="line">        nb_pkts_out = ipsec_outbound(ipsec_ctx, traffic-&gt;ipsec.pkts,</div>
<div class="line">                traffic-&gt;ipsec.res, traffic-&gt;ipsec.num,</div>
<div class="line">                MAX_PKT_BURST);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* They all sue the same SA (ip4 or ip6 tunnel) */</span></div>
<div class="line">        m = traffic-&gt;ipsec.pkts[0];</div>
<div class="line">        ip = <a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(m, <span class="keyword">struct</span> ip *);</div>
<div class="line">        <span class="keywordflow">if</span> (ip-&gt;ip_v == IPVERSION) {</div>
<div class="line">            traffic-&gt;ip4.num = nb_pkts_out;</div>
<div class="line">            <span class="keywordflow">for</span> (i = 0; i &lt; nb_pkts_out; i++)</div>
<div class="line">                traffic-&gt;ip4.pkts[i] = traffic-&gt;ipsec.pkts[i];</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            traffic-&gt;ip6.num = nb_pkts_out;</div>
<div class="line">            <span class="keywordflow">for</span> (i = 0; i &lt; nb_pkts_out; i++)</div>
<div class="line">                traffic-&gt;ip6.pkts[i] = traffic-&gt;ipsec.pkts[i];</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        outbound_sa_lookup(ipsec_ctx-&gt;sa_ctx, traffic-&gt;ipsec.res,</div>
<div class="line">            traffic-&gt;ipsec.saptr, traffic-&gt;ipsec.num);</div>
<div class="line">        ipsec_process(ipsec_ctx, traffic);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> int32_t</div>
<div class="line">get_hop_for_offload_pkt(<span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkt, <span class="keywordtype">int</span> is_ipv6)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>ipsec_mbuf_metadata *priv;</div>
<div class="line">    <span class="keyword">struct </span>ipsec_sa *sa;</div>
<div class="line"> </div>
<div class="line">    priv = get_priv(pkt);</div>
<div class="line"> </div>
<div class="line">    sa = priv-&gt;sa;</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(sa == NULL)) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC, <span class="stringliteral">&quot;SA not saved in private data\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">goto</span> fail;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (is_ipv6)</div>
<div class="line">        <span class="keywordflow">return</span> sa-&gt;portid;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* else */</span></div>
<div class="line">    <span class="keywordflow">return</span> (sa-&gt;portid | <a name="a68"></a><a class="code" href="rte__lpm_8h.html#a8ae31c18e8e385d52aa68cd2787d7e2a">RTE_LPM_LOOKUP_SUCCESS</a>);</div>
<div class="line"> </div>
<div class="line">fail:</div>
<div class="line">    <span class="keywordflow">if</span> (is_ipv6)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* else */</span></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">route4_pkts(<span class="keyword">struct</span> rt_ctx *rt_ctx, <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkts[], uint8_t nb_pkts)</div>
<div class="line">{</div>
<div class="line">    uint32_t hop[MAX_PKT_BURST * 2];</div>
<div class="line">    uint32_t dst_ip[MAX_PKT_BURST * 2];</div>
<div class="line">    int32_t pkt_hop = 0;</div>
<div class="line">    uint16_t i, offset;</div>
<div class="line">    uint16_t lpm_pkts = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (nb_pkts == 0)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Need to do an LPM lookup for non-inline packets. Inline packets will</span></div>
<div class="line"><span class="comment">     * have port ID in the SA</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; nb_pkts; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (!(pkts[i]-&gt;ol_flags &amp; <a name="a69"></a><a class="code" href="rte__mbuf__core_8h.html#ac96de1a778092073c21e54e4ac07fc6c">PKT_TX_SEC_OFFLOAD</a>)) {</div>
<div class="line">            <span class="comment">/* Security offload not enabled. So an LPM lookup is</span></div>
<div class="line"><span class="comment">             * required to get the hop</span></div>
<div class="line"><span class="comment">             */</span></div>
<div class="line">            offset = <a class="code" href="rte__common_8h.html#a276e8a32e0bbf024aadd9420b8f2d3b3">offsetof</a>(<span class="keyword">struct</span> ip, ip_dst);</div>
<div class="line">            dst_ip[lpm_pkts] = *<a class="code" href="rte__mbuf__core_8h.html#ad63e1de0ec54d7c7603ea984c76ca956">rte_pktmbuf_mtod_offset</a>(pkts[i],</div>
<div class="line">                    uint32_t *, offset);</div>
<div class="line">            dst_ip[lpm_pkts] = <a name="a70"></a><a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(dst_ip[lpm_pkts]);</div>
<div class="line">            lpm_pkts++;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a name="a71"></a><a class="code" href="rte__lpm_8h.html#a50015c45c3fde72568c8ba303ded2288">rte_lpm_lookup_bulk</a>((<span class="keyword">struct</span> rte_lpm *)rt_ctx, dst_ip, hop, lpm_pkts);</div>
<div class="line"> </div>
<div class="line">    lpm_pkts = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; nb_pkts; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (pkts[i]-&gt;ol_flags &amp; <a class="code" href="rte__mbuf__core_8h.html#ac96de1a778092073c21e54e4ac07fc6c">PKT_TX_SEC_OFFLOAD</a>) {</div>
<div class="line">            <span class="comment">/* Read hop from the SA */</span></div>
<div class="line">            pkt_hop = get_hop_for_offload_pkt(pkts[i], 0);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="comment">/* Need to use hop returned by lookup */</span></div>
<div class="line">            pkt_hop = hop[lpm_pkts++];</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((pkt_hop &amp; <a class="code" href="rte__lpm_8h.html#a8ae31c18e8e385d52aa68cd2787d7e2a">RTE_LPM_LOOKUP_SUCCESS</a>) == 0) {</div>
<div class="line">            free_pkts(&amp;pkts[i], 1);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line">        send_single_packet(pkts[i], pkt_hop &amp; 0xff, IPPROTO_IP);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">route6_pkts(<span class="keyword">struct</span> rt_ctx *rt_ctx, <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkts[], uint8_t nb_pkts)</div>
<div class="line">{</div>
<div class="line">    int32_t hop[MAX_PKT_BURST * 2];</div>
<div class="line">    uint8_t dst_ip[MAX_PKT_BURST * 2][16];</div>
<div class="line">    uint8_t *ip6_dst;</div>
<div class="line">    int32_t pkt_hop = 0;</div>
<div class="line">    uint16_t i, offset;</div>
<div class="line">    uint16_t lpm_pkts = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (nb_pkts == 0)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Need to do an LPM lookup for non-inline packets. Inline packets will</span></div>
<div class="line"><span class="comment">     * have port ID in the SA</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; nb_pkts; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (!(pkts[i]-&gt;ol_flags &amp; <a class="code" href="rte__mbuf__core_8h.html#ac96de1a778092073c21e54e4ac07fc6c">PKT_TX_SEC_OFFLOAD</a>)) {</div>
<div class="line">            <span class="comment">/* Security offload not enabled. So an LPM lookup is</span></div>
<div class="line"><span class="comment">             * required to get the hop</span></div>
<div class="line"><span class="comment">             */</span></div>
<div class="line">            offset = <a class="code" href="rte__common_8h.html#a276e8a32e0bbf024aadd9420b8f2d3b3">offsetof</a>(<span class="keyword">struct</span> ip6_hdr, ip6_dst);</div>
<div class="line">            ip6_dst = <a class="code" href="rte__mbuf__core_8h.html#ad63e1de0ec54d7c7603ea984c76ca956">rte_pktmbuf_mtod_offset</a>(pkts[i], uint8_t *,</div>
<div class="line">                    offset);</div>
<div class="line">            memcpy(&amp;dst_ip[lpm_pkts][0], ip6_dst, 16);</div>
<div class="line">            lpm_pkts++;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a name="a72"></a><a class="code" href="rte__lpm6_8h.html#aa9c2737e965c4ba60b2ded90e87b75ab">rte_lpm6_lookup_bulk_func</a>((<span class="keyword">struct</span> rte_lpm6 *)rt_ctx, dst_ip, hop,</div>
<div class="line">            lpm_pkts);</div>
<div class="line"> </div>
<div class="line">    lpm_pkts = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; nb_pkts; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (pkts[i]-&gt;ol_flags &amp; <a class="code" href="rte__mbuf__core_8h.html#ac96de1a778092073c21e54e4ac07fc6c">PKT_TX_SEC_OFFLOAD</a>) {</div>
<div class="line">            <span class="comment">/* Read hop from the SA */</span></div>
<div class="line">            pkt_hop = get_hop_for_offload_pkt(pkts[i], 1);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="comment">/* Need to use hop returned by lookup */</span></div>
<div class="line">            pkt_hop = hop[lpm_pkts++];</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (pkt_hop == -1) {</div>
<div class="line">            free_pkts(&amp;pkts[i], 1);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line">        send_single_packet(pkts[i], pkt_hop &amp; 0xff, IPPROTO_IPV6);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">process_pkts(<span class="keyword">struct</span> lcore_conf *qconf, <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> **pkts,</div>
<div class="line">        uint8_t nb_pkts, uint16_t portid)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>ipsec_traffic traffic;</div>
<div class="line"> </div>
<div class="line">    prepare_traffic(pkts, &amp;traffic, nb_pkts);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(single_sa)) {</div>
<div class="line">        <span class="keywordflow">if</span> (is_unprotected_port(portid))</div>
<div class="line">            process_pkts_inbound_nosp(&amp;qconf-&gt;inbound, &amp;traffic);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            process_pkts_outbound_nosp(&amp;qconf-&gt;outbound, &amp;traffic);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">if</span> (is_unprotected_port(portid))</div>
<div class="line">            process_pkts_inbound(&amp;qconf-&gt;inbound, &amp;traffic);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            process_pkts_outbound(&amp;qconf-&gt;outbound, &amp;traffic);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    route4_pkts(qconf-&gt;rt4_ctx, traffic.ip4.pkts, traffic.ip4.num);</div>
<div class="line">    route6_pkts(qconf-&gt;rt6_ctx, traffic.ip6.pkts, traffic.ip6.num);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">drain_tx_buffers(<span class="keyword">struct</span> lcore_conf *qconf)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>buffer *buf;</div>
<div class="line">    uint32_t portid;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (portid = 0; portid &lt; RTE_MAX_ETHPORTS; portid++) {</div>
<div class="line">        buf = &amp;qconf-&gt;tx_mbufs[portid];</div>
<div class="line">        <span class="keywordflow">if</span> (buf-&gt;len == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        send_burst(qconf, buf-&gt;len, portid);</div>
<div class="line">        buf-&gt;len = 0;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">drain_crypto_buffers(<span class="keyword">struct</span> lcore_conf *qconf)</div>
<div class="line">{</div>
<div class="line">    uint32_t i;</div>
<div class="line">    <span class="keyword">struct </span>ipsec_ctx *ctx;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* drain inbound buffers*/</span></div>
<div class="line">    ctx = &amp;qconf-&gt;inbound;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i != ctx-&gt;nb_qps; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;tbl[i].len != 0)</div>
<div class="line">            enqueue_cop_burst(ctx-&gt;tbl  + i);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* drain outbound buffers*/</span></div>
<div class="line">    ctx = &amp;qconf-&gt;outbound;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i != ctx-&gt;nb_qps; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (ctx-&gt;tbl[i].len != 0)</div>
<div class="line">            enqueue_cop_burst(ctx-&gt;tbl  + i);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">drain_inbound_crypto_queues(<span class="keyword">const</span> <span class="keyword">struct</span> lcore_conf *qconf,</div>
<div class="line">        <span class="keyword">struct</span> ipsec_ctx *ctx)</div>
<div class="line">{</div>
<div class="line">    uint32_t n;</div>
<div class="line">    <span class="keyword">struct </span>ipsec_traffic trf;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (app_sa_prm.enable == 0) {</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* dequeue packets from crypto-queue */</span></div>
<div class="line">        n = ipsec_inbound_cqp_dequeue(ctx, trf.ipsec.pkts,</div>
<div class="line">            <a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(trf.ipsec.pkts));</div>
<div class="line"> </div>
<div class="line">        trf.ip4.num = 0;</div>
<div class="line">        trf.ip6.num = 0;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* split traffic by ipv4-ipv6 */</span></div>
<div class="line">        split46_traffic(&amp;trf, trf.ipsec.pkts, n);</div>
<div class="line">    } <span class="keywordflow">else</span></div>
<div class="line">        ipsec_cqp_process(ctx, &amp;trf);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* process ipv4 packets */</span></div>
<div class="line">    <span class="keywordflow">if</span> (trf.ip4.num != 0) {</div>
<div class="line">        inbound_sp_sa(ctx-&gt;sp4_ctx, ctx-&gt;sa_ctx, &amp;trf.ip4, 0);</div>
<div class="line">        route4_pkts(qconf-&gt;rt4_ctx, trf.ip4.pkts, trf.ip4.num);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* process ipv6 packets */</span></div>
<div class="line">    <span class="keywordflow">if</span> (trf.ip6.num != 0) {</div>
<div class="line">        inbound_sp_sa(ctx-&gt;sp6_ctx, ctx-&gt;sa_ctx, &amp;trf.ip6, 0);</div>
<div class="line">        route6_pkts(qconf-&gt;rt6_ctx, trf.ip6.pkts, trf.ip6.num);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">drain_outbound_crypto_queues(<span class="keyword">const</span> <span class="keyword">struct</span> lcore_conf *qconf,</div>
<div class="line">        <span class="keyword">struct</span> ipsec_ctx *ctx)</div>
<div class="line">{</div>
<div class="line">    uint32_t n;</div>
<div class="line">    <span class="keyword">struct </span>ipsec_traffic trf;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (app_sa_prm.enable == 0) {</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* dequeue packets from crypto-queue */</span></div>
<div class="line">        n = ipsec_outbound_cqp_dequeue(ctx, trf.ipsec.pkts,</div>
<div class="line">            <a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(trf.ipsec.pkts));</div>
<div class="line"> </div>
<div class="line">        trf.ip4.num = 0;</div>
<div class="line">        trf.ip6.num = 0;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* split traffic by ipv4-ipv6 */</span></div>
<div class="line">        split46_traffic(&amp;trf, trf.ipsec.pkts, n);</div>
<div class="line">    } <span class="keywordflow">else</span></div>
<div class="line">        ipsec_cqp_process(ctx, &amp;trf);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* process ipv4 packets */</span></div>
<div class="line">    <span class="keywordflow">if</span> (trf.ip4.num != 0)</div>
<div class="line">        route4_pkts(qconf-&gt;rt4_ctx, trf.ip4.pkts, trf.ip4.num);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* process ipv6 packets */</span></div>
<div class="line">    <span class="keywordflow">if</span> (trf.ip6.num != 0)</div>
<div class="line">        route6_pkts(qconf-&gt;rt6_ctx, trf.ip6.pkts, trf.ip6.num);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* main processing loop */</span></div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">ipsec_poll_mode_worker(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkts[MAX_PKT_BURST];</div>
<div class="line">    uint32_t lcore_id;</div>
<div class="line">    uint64_t prev_tsc, diff_tsc, cur_tsc;</div>
<div class="line">    int32_t i, nb_rx;</div>
<div class="line">    uint16_t portid;</div>
<div class="line">    uint8_t queueid;</div>
<div class="line">    <span class="keyword">struct </span>lcore_conf *qconf;</div>
<div class="line">    int32_t rc, socket_id;</div>
<div class="line">    <span class="keyword">const</span> uint64_t drain_tsc = (<a name="a73"></a><a class="code" href="rte__cycles_8h.html#ae016e608f344823e677819d8f04264c5">rte_get_tsc_hz</a>() + US_PER_S - 1)</div>
<div class="line">            / US_PER_S * BURST_TX_DRAIN_US;</div>
<div class="line">    <span class="keyword">struct </span>lcore_rx_queue *rxql;</div>
<div class="line"> </div>
<div class="line">    prev_tsc = 0;</div>
<div class="line">    lcore_id = <a class="code" href="rte__lcore_8h.html#adfb2b334e7e73f534f25e8888a8a775f">rte_lcore_id</a>();</div>
<div class="line">    qconf = &amp;lcore_conf[lcore_id];</div>
<div class="line">    rxql = qconf-&gt;rx_queue_list;</div>
<div class="line">    socket_id = <a name="a74"></a><a class="code" href="rte__lcore_8h.html#a023b4909f52c3cdf0351d71d2b5032bc">rte_lcore_to_socket_id</a>(lcore_id);</div>
<div class="line"> </div>
<div class="line">    qconf-&gt;rt4_ctx = socket_ctx[socket_id].rt_ip4;</div>
<div class="line">    qconf-&gt;rt6_ctx = socket_ctx[socket_id].rt_ip6;</div>
<div class="line">    qconf-&gt;inbound.sp4_ctx = socket_ctx[socket_id].sp_ip4_in;</div>
<div class="line">    qconf-&gt;inbound.sp6_ctx = socket_ctx[socket_id].sp_ip6_in;</div>
<div class="line">    qconf-&gt;inbound.sa_ctx = socket_ctx[socket_id].sa_in;</div>
<div class="line">    qconf-&gt;inbound.cdev_map = cdev_map_in;</div>
<div class="line">    qconf-&gt;inbound.session_pool = socket_ctx[socket_id].session_pool;</div>
<div class="line">    qconf-&gt;inbound.session_priv_pool =</div>
<div class="line">            socket_ctx[socket_id].session_priv_pool;</div>
<div class="line">    qconf-&gt;outbound.sp4_ctx = socket_ctx[socket_id].sp_ip4_out;</div>
<div class="line">    qconf-&gt;outbound.sp6_ctx = socket_ctx[socket_id].sp_ip6_out;</div>
<div class="line">    qconf-&gt;outbound.sa_ctx = socket_ctx[socket_id].sa_out;</div>
<div class="line">    qconf-&gt;outbound.cdev_map = cdev_map_out;</div>
<div class="line">    qconf-&gt;outbound.session_pool = socket_ctx[socket_id].session_pool;</div>
<div class="line">    qconf-&gt;outbound.session_priv_pool =</div>
<div class="line">            socket_ctx[socket_id].session_priv_pool;</div>
<div class="line">    qconf-&gt;frag.pool_dir = socket_ctx[socket_id].mbuf_pool;</div>
<div class="line">    qconf-&gt;frag.pool_indir = socket_ctx[socket_id].mbuf_pool_indir;</div>
<div class="line"> </div>
<div class="line">    rc = ipsec_sad_lcore_cache_init(app_sa_prm.cache_sz);</div>
<div class="line">    <span class="keywordflow">if</span> (rc != 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">            <span class="stringliteral">&quot;SAD cache init on lcore %u, failed with code: %d\n&quot;</span>,</div>
<div class="line">            lcore_id, rc);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (qconf-&gt;nb_rx_queue == 0) {</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(DEBUG, IPSEC, <span class="stringliteral">&quot;lcore %u has nothing to do\n&quot;</span>,</div>
<div class="line">            lcore_id);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(INFO, IPSEC, <span class="stringliteral">&quot;entering main loop on lcore %u\n&quot;</span>, lcore_id);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; qconf-&gt;nb_rx_queue; i++) {</div>
<div class="line">        portid = rxql[i].port_id;</div>
<div class="line">        queueid = rxql[i].queue_id;</div>
<div class="line">        <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(INFO, IPSEC,</div>
<div class="line">            <span class="stringliteral">&quot; -- lcoreid=%u portid=%u rxqueueid=%hhu\n&quot;</span>,</div>
<div class="line">            lcore_id, portid, queueid);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (!force_quit) {</div>
<div class="line">        cur_tsc = rte_rdtsc();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* TX queue buffer drain */</span></div>
<div class="line">        diff_tsc = cur_tsc - prev_tsc;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(diff_tsc &gt; drain_tsc)) {</div>
<div class="line">            drain_tx_buffers(qconf);</div>
<div class="line">            drain_crypto_buffers(qconf);</div>
<div class="line">            prev_tsc = cur_tsc;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; qconf-&gt;nb_rx_queue; ++i) {</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Read packets from RX queues */</span></div>
<div class="line">            portid = rxql[i].port_id;</div>
<div class="line">            queueid = rxql[i].queue_id;</div>
<div class="line">            nb_rx = <a name="a75"></a><a class="code" href="rte__ethdev_8h.html#a3e7d76a451b46348686ea97d6367f102">rte_eth_rx_burst</a>(portid, queueid,</div>
<div class="line">                    pkts, MAX_PKT_BURST);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (nb_rx &gt; 0) {</div>
<div class="line">                core_stats_update_rx(nb_rx);</div>
<div class="line">                process_pkts(qconf, pkts, nb_rx, portid);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* dequeue and process completed crypto-ops */</span></div>
<div class="line">            <span class="keywordflow">if</span> (is_unprotected_port(portid))</div>
<div class="line">                drain_inbound_crypto_queues(qconf,</div>
<div class="line">                    &amp;qconf-&gt;inbound);</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                drain_outbound_crypto_queues(qconf,</div>
<div class="line">                    &amp;qconf-&gt;outbound);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">check_flow_params(uint16_t fdir_portid, uint8_t fdir_qid)</div>
<div class="line">{</div>
<div class="line">    uint16_t i;</div>
<div class="line">    uint16_t portid;</div>
<div class="line">    uint8_t queueid;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; nb_lcore_params; ++i) {</div>
<div class="line">        portid = lcore_params_array[i].port_id;</div>
<div class="line">        <span class="keywordflow">if</span> (portid == fdir_portid) {</div>
<div class="line">            queueid = lcore_params_array[i].queue_id;</div>
<div class="line">            <span class="keywordflow">if</span> (queueid == fdir_qid)</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (i == nb_lcore_params - 1)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> int32_t</div>
<div class="line">check_poll_mode_params(<span class="keyword">struct</span> eh_conf *eh_conf)</div>
<div class="line">{</div>
<div class="line">    uint8_t lcore;</div>
<div class="line">    uint16_t portid;</div>
<div class="line">    uint16_t i;</div>
<div class="line">    int32_t socket_id;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!eh_conf)</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (eh_conf-&gt;mode != EH_PKT_TRANSFER_MODE_POLL)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (lcore_params == NULL) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: No port/queue/core mappings\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; nb_lcore_params; ++i) {</div>
<div class="line">        lcore = lcore_params[i].lcore_id;</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="rte__lcore_8h.html#a5404ee6ac26cbe5a4f4ddef44d690b76">rte_lcore_is_enabled</a>(lcore)) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;error: lcore %hhu is not enabled in &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;lcore mask\n&quot;</span>, lcore);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">        socket_id = <a class="code" href="rte__lcore_8h.html#a023b4909f52c3cdf0351d71d2b5032bc">rte_lcore_to_socket_id</a>(lcore);</div>
<div class="line">        <span class="keywordflow">if</span> (socket_id != 0 &amp;&amp; numa_on == 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;warning: lcore %hhu is on socket %d &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;with numa off\n&quot;</span>,</div>
<div class="line">                lcore, socket_id);</div>
<div class="line">        }</div>
<div class="line">        portid = lcore_params[i].port_id;</div>
<div class="line">        <span class="keywordflow">if</span> ((enabled_port_mask &amp; (1 &lt;&lt; portid)) == 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;port %u is not enabled in port mask\n&quot;</span>, portid);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (!<a name="a76"></a><a class="code" href="rte__ethdev_8h.html#a22dcfd3f5f2b34f657131d66132e23a7">rte_eth_dev_is_valid_port</a>(portid)) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;port %u is not present on the board\n&quot;</span>, portid);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint8_t</div>
<div class="line">get_port_nb_rx_queues(<span class="keyword">const</span> uint16_t port)</div>
<div class="line">{</div>
<div class="line">    int32_t queue = -1;</div>
<div class="line">    uint16_t i;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; nb_lcore_params; ++i) {</div>
<div class="line">        <span class="keywordflow">if</span> (lcore_params[i].port_id == port &amp;&amp;</div>
<div class="line">                lcore_params[i].queue_id &gt; queue)</div>
<div class="line">            queue = lcore_params[i].queue_id;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> (uint8_t)(++queue);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> int32_t</div>
<div class="line">init_lcore_rx_queues(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    uint16_t i, nb_rx_queue;</div>
<div class="line">    uint8_t lcore;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; nb_lcore_params; ++i) {</div>
<div class="line">        lcore = lcore_params[i].lcore_id;</div>
<div class="line">        nb_rx_queue = lcore_conf[lcore].nb_rx_queue;</div>
<div class="line">        <span class="keywordflow">if</span> (nb_rx_queue &gt;= MAX_RX_QUEUE_PER_LCORE) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;error: too many queues (%u) for lcore: %u\n&quot;</span>,</div>
<div class="line">                    nb_rx_queue + 1, lcore);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">        lcore_conf[lcore].rx_queue_list[nb_rx_queue].port_id =</div>
<div class="line">            lcore_params[i].port_id;</div>
<div class="line">        lcore_conf[lcore].rx_queue_list[nb_rx_queue].queue_id =</div>
<div class="line">            lcore_params[i].queue_id;</div>
<div class="line">        lcore_conf[lcore].nb_rx_queue++;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* display usage */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">print_usage(<span class="keyword">const</span> <span class="keywordtype">char</span> *prgname)</div>
<div class="line">{</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;%s [EAL options] --&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; -p PORTMASK&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; [-P]&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; [-u PORTMASK]&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; [-j FRAMESIZE]&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; [-l]&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; [-w REPLAY_WINDOW_SIZE]&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; [-e]&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; [-a]&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; [-c]&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; [-s NUMBER_OF_MBUFS_IN_PKT_POOL]&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; -f CONFIG_FILE&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; --config (port,queue,lcore)[,(port,queue,lcore)]&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; [--single-sa SAIDX]&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; [--cryptodev_mask MASK]&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; [--transfer-mode MODE]&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; [--event-schedule-type TYPE]&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; [--&quot;</span> CMD_LINE_OPT_RX_OFFLOAD <span class="stringliteral">&quot; RX_OFFLOAD_MASK]&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; [--&quot;</span> CMD_LINE_OPT_TX_OFFLOAD <span class="stringliteral">&quot; TX_OFFLOAD_MASK]&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; [--&quot;</span> CMD_LINE_OPT_REASSEMBLE <span class="stringliteral">&quot; REASSEMBLE_TABLE_SIZE]&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot; [--&quot;</span> CMD_LINE_OPT_MTU <span class="stringliteral">&quot; MTU]&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\n\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  -p PORTMASK: Hexadecimal bitmask of ports to configure\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  -P : Enable promiscuous mode\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  -u PORTMASK: Hexadecimal bitmask of unprotected ports\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  -j FRAMESIZE: Data buffer size, minimum (and default)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;     value: RTE_MBUF_DEFAULT_BUF_SIZE\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  -l enables code-path that uses librte_ipsec\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  -w REPLAY_WINDOW_SIZE specifies IPsec SQN replay window\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;     size for each SA\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  -e enables ESN\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  -a enables SA SQN atomic behaviour\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  -c specifies inbound SAD cache size,\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;     zero value disables the cache (default value: 128)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  -s number of mbufs in packet pool, if not specified number\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;     of mbufs will be calculated based on number of cores,\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;     ports and crypto queues\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  -f CONFIG_FILE: Configuration file\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --config (port,queue,lcore): Rx queue configuration. In poll\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;                               mode determines which queues from\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;                               which ports are mapped to which cores.\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;                               In event mode this option is not used\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;                               as packets are dynamically scheduled\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;                               to cores by HW.\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --single-sa SAIDX: In poll mode use single SA index for\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;                     outbound traffic, bypassing the SP\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;                     In event mode selects driver submode,\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;                     SA index value is ignored\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --cryptodev_mask MASK: Hexadecimal bitmask of the crypto\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;                         devices to configure\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --transfer-mode MODE\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;               \&quot;poll\&quot;  : Packet transfer via polling (default)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;               \&quot;event\&quot; : Packet transfer via event device\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --event-schedule-type TYPE queue schedule type, used only when\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;                             transfer mode is set to event\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;               \&quot;ordered\&quot;  : Ordered (default)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;               \&quot;atomic\&quot;   : Atomic\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;               \&quot;parallel\&quot; : Parallel\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --&quot;</span> CMD_LINE_OPT_RX_OFFLOAD</div>
<div class="line">        <span class="stringliteral">&quot;: bitmask of the RX HW offload capabilities to enable/use\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;                         (DEV_RX_OFFLOAD_*)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --&quot;</span> CMD_LINE_OPT_TX_OFFLOAD</div>
<div class="line">        <span class="stringliteral">&quot;: bitmask of the TX HW offload capabilities to enable/use\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;                         (DEV_TX_OFFLOAD_*)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --&quot;</span> CMD_LINE_OPT_REASSEMBLE <span class="stringliteral">&quot; NUM&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;: max number of entries in reassemble(fragment) table\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;    (zero (default value) disables reassembly)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --&quot;</span> CMD_LINE_OPT_MTU <span class="stringliteral">&quot; MTU&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;: MTU value on all ports (default value: 1500)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;    outgoing packets with bigger size will be fragmented\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;    incoming packets with bigger size will be discarded\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;  --&quot;</span> CMD_LINE_OPT_FRAG_TTL <span class="stringliteral">&quot; FRAG_TTL_NS&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;: fragments lifetime in nanoseconds, default\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;    and maximum value is 10.000.000.000 ns (10 s)\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line">        prgname);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_mask(<span class="keyword">const</span> <span class="keywordtype">char</span> *str, uint64_t *val)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *end;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> t;</div>
<div class="line"> </div>
<div class="line">    errno = 0;</div>
<div class="line">    t = strtoul(str, &amp;end, 0);</div>
<div class="line">    <span class="keywordflow">if</span> (errno != 0 || end[0] != 0)</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">    *val = t;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> int32_t</div>
<div class="line">parse_portmask(<span class="keyword">const</span> <span class="keywordtype">char</span> *portmask)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *end = NULL;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> pm;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* parse hexadecimal string */</span></div>
<div class="line">    pm = strtoul(portmask, &amp;end, 16);</div>
<div class="line">    <span class="keywordflow">if</span> ((portmask[0] == <span class="charliteral">&#39;\0&#39;</span>) || (end == NULL) || (*end != <span class="charliteral">&#39;\0&#39;</span>))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((pm == 0) &amp;&amp; errno)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> pm;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> int64_t</div>
<div class="line">parse_decimal(<span class="keyword">const</span> <span class="keywordtype">char</span> *str)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *end = NULL;</div>
<div class="line">    uint64_t num;</div>
<div class="line"> </div>
<div class="line">    num = strtoull(str, &amp;end, 10);</div>
<div class="line">    <span class="keywordflow">if</span> ((str[0] == <span class="charliteral">&#39;\0&#39;</span>) || (end == NULL) || (*end != <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line">        || num &gt; INT64_MAX)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> num;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> int32_t</div>
<div class="line">parse_config(<span class="keyword">const</span> <span class="keywordtype">char</span> *q_arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> s[256];</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *p, *p0 = q_arg;</div>
<div class="line">    <span class="keywordtype">char</span> *end;</div>
<div class="line">    <span class="keyword">enum</span> fieldnames {</div>
<div class="line">        FLD_PORT = 0,</div>
<div class="line">        FLD_QUEUE,</div>
<div class="line">        FLD_LCORE,</div>
<div class="line">        _NUM_FLD</div>
<div class="line">    };</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> int_fld[_NUM_FLD];</div>
<div class="line">    <span class="keywordtype">char</span> *str_fld[_NUM_FLD];</div>
<div class="line">    int32_t i;</div>
<div class="line">    uint32_t size;</div>
<div class="line"> </div>
<div class="line">    nb_lcore_params = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> ((p = strchr(p0, <span class="charliteral">&#39;(&#39;</span>)) != NULL) {</div>
<div class="line">        ++p;</div>
<div class="line">        p0 = strchr(p, <span class="charliteral">&#39;)&#39;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (p0 == NULL)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">        size = p0 - p;</div>
<div class="line">        <span class="keywordflow">if</span> (size &gt;= <span class="keyword">sizeof</span>(s))</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">        snprintf(s, <span class="keyword">sizeof</span>(s), <span class="stringliteral">&quot;%.*s&quot;</span>, size, p);</div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a77"></a><a class="code" href="rte__string__fns_8h.html#af3ffc4e2ca821bc44f7fd08afbfe3638">rte_strsplit</a>(s, <span class="keyword">sizeof</span>(s), str_fld, _NUM_FLD, <span class="charliteral">&#39;,&#39;</span>) !=</div>
<div class="line">                _NUM_FLD)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; _NUM_FLD; i++) {</div>
<div class="line">            errno = 0;</div>
<div class="line">            int_fld[i] = strtoul(str_fld[i], &amp;end, 0);</div>
<div class="line">            <span class="keywordflow">if</span> (errno != 0 || end == str_fld[i] || int_fld[i] &gt; 255)</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (nb_lcore_params &gt;= MAX_LCORE_PARAMS) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;exceeded max number of lcore params: %hu\n&quot;</span>,</div>
<div class="line">                nb_lcore_params);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">        lcore_params_array[nb_lcore_params].port_id =</div>
<div class="line">            (uint8_t)int_fld[FLD_PORT];</div>
<div class="line">        lcore_params_array[nb_lcore_params].queue_id =</div>
<div class="line">            (uint8_t)int_fld[FLD_QUEUE];</div>
<div class="line">        lcore_params_array[nb_lcore_params].lcore_id =</div>
<div class="line">            (uint8_t)int_fld[FLD_LCORE];</div>
<div class="line">        ++nb_lcore_params;</div>
<div class="line">    }</div>
<div class="line">    lcore_params = lcore_params_array;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">print_app_sa_prm(<span class="keyword">const</span> <span class="keyword">struct</span> app_sa_prm *prm)</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;librte_ipsec usage: %s\n&quot;</span>,</div>
<div class="line">        (prm-&gt;enable == 0) ? <span class="stringliteral">&quot;disabled&quot;</span> : <span class="stringliteral">&quot;enabled&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;replay window size: %u\n&quot;</span>, prm-&gt;window_size);</div>
<div class="line">    printf(<span class="stringliteral">&quot;ESN: %s\n&quot;</span>, (prm-&gt;enable_esn == 0) ? <span class="stringliteral">&quot;disabled&quot;</span> : <span class="stringliteral">&quot;enabled&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;SA flags: %#&quot;</span> PRIx64 <span class="stringliteral">&quot;\n&quot;</span>, prm-&gt;flags);</div>
<div class="line">    printf(<span class="stringliteral">&quot;Frag TTL: %&quot;</span> PRIu64 <span class="stringliteral">&quot; ns\n&quot;</span>, frag_ttl_ns);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_transfer_mode(<span class="keyword">struct</span> eh_conf *conf, <span class="keyword">const</span> <span class="keywordtype">char</span> *optarg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!strcmp(CMD_LINE_ARG_POLL, optarg))</div>
<div class="line">        conf-&gt;mode = EH_PKT_TRANSFER_MODE_POLL;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(CMD_LINE_ARG_EVENT, optarg))</div>
<div class="line">        conf-&gt;mode = EH_PKT_TRANSFER_MODE_EVENT;</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Unsupported packet transfer mode\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_schedule_type(<span class="keyword">struct</span> eh_conf *conf, <span class="keyword">const</span> <span class="keywordtype">char</span> *optarg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>eventmode_conf *em_conf = NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Get eventmode conf */</span></div>
<div class="line">    em_conf = conf-&gt;mode_params;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!strcmp(CMD_LINE_ARG_ORDERED, optarg))</div>
<div class="line">        em_conf-&gt;ext_params.sched_type = <a name="a78"></a><a class="code" href="rte__eventdev_8h.html#a366ab13bc5be32cbc9ee15e294b4c9a2">RTE_SCHED_TYPE_ORDERED</a>;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(CMD_LINE_ARG_ATOMIC, optarg))</div>
<div class="line">        em_conf-&gt;ext_params.sched_type = <a name="a79"></a><a class="code" href="rte__eventdev_8h.html#a3c199a28e97411266a069bd07c9757fa">RTE_SCHED_TYPE_ATOMIC</a>;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(CMD_LINE_ARG_PARALLEL, optarg))</div>
<div class="line">        em_conf-&gt;ext_params.sched_type = <a name="a80"></a><a class="code" href="rte__eventdev_8h.html#ac88982845a12ff215c721fccb18ed4a7">RTE_SCHED_TYPE_PARALLEL</a>;</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Unsupported queue schedule type\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> int32_t</div>
<div class="line">parse_args(int32_t argc, <span class="keywordtype">char</span> **argv, <span class="keyword">struct</span> eh_conf *eh_conf)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> opt;</div>
<div class="line">    int64_t ret;</div>
<div class="line">    <span class="keywordtype">char</span> **argvopt;</div>
<div class="line">    int32_t option_index;</div>
<div class="line">    <span class="keywordtype">char</span> *prgname = argv[0];</div>
<div class="line">    int32_t f_present = 0;</div>
<div class="line"> </div>
<div class="line">    argvopt = argv;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> ((opt = getopt_long(argc, argvopt, <span class="stringliteral">&quot;aelp:Pu:f:j:w:c:s:&quot;</span>,</div>
<div class="line">                lgopts, &amp;option_index)) != EOF) {</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">switch</span> (opt) {</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>:</div>
<div class="line">            enabled_port_mask = parse_portmask(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (enabled_port_mask == 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;invalid portmask\n&quot;</span>);</div>
<div class="line">                print_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;P&#39;</span>:</div>
<div class="line">            printf(<span class="stringliteral">&quot;Promiscuous mode selected\n&quot;</span>);</div>
<div class="line">            promiscuous_on = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;u&#39;</span>:</div>
<div class="line">            unprotected_port_mask = parse_portmask(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (unprotected_port_mask == 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;invalid unprotected portmask\n&quot;</span>);</div>
<div class="line">                print_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>:</div>
<div class="line">            <span class="keywordflow">if</span> (f_present == 1) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;\&quot;-f\&quot; option present more than &quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;once!\n&quot;</span>);</div>
<div class="line">                print_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            cfgfile = optarg;</div>
<div class="line">            f_present = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:</div>
<div class="line">            ret = parse_decimal(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid number of buffers in a pool: &quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;%s\n&quot;</span>, optarg);</div>
<div class="line">                print_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            nb_bufs_in_pool = ret;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;j&#39;</span>:</div>
<div class="line">            ret = parse_decimal(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; RTE_MBUF_DEFAULT_BUF_SIZE ||</div>
<div class="line">                    ret &gt; UINT16_MAX) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid frame buffer size value: %s\n&quot;</span>,</div>
<div class="line">                    optarg);</div>
<div class="line">                print_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            frame_buf_size = ret;</div>
<div class="line">            printf(<span class="stringliteral">&quot;Custom frame buffer size %u\n&quot;</span>, frame_buf_size);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;l&#39;</span>:</div>
<div class="line">            app_sa_prm.enable = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;w&#39;</span>:</div>
<div class="line">            app_sa_prm.window_size = parse_decimal(optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;e&#39;</span>:</div>
<div class="line">            app_sa_prm.enable_esn = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:</div>
<div class="line">            app_sa_prm.enable = 1;</div>
<div class="line">            app_sa_prm.flags |= <a name="a81"></a><a class="code" href="rte__ipsec__sa_8h.html#adefe04d943154fbf1b98fba430006768">RTE_IPSEC_SAFLAG_SQN_ATOM</a>;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:</div>
<div class="line">            ret = parse_decimal(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid SA cache size: %s\n&quot;</span>, optarg);</div>
<div class="line">                print_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            app_sa_prm.cache_sz = ret;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> CMD_LINE_OPT_CONFIG_NUM:</div>
<div class="line">            ret = parse_config(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (ret) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid config\n&quot;</span>);</div>
<div class="line">                print_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> CMD_LINE_OPT_SINGLE_SA_NUM:</div>
<div class="line">            ret = parse_decimal(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (ret == -1 || ret &gt; UINT32_MAX) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid argument[sa_idx]\n&quot;</span>);</div>
<div class="line">                print_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* else */</span></div>
<div class="line">            single_sa = 1;</div>
<div class="line">            single_sa_idx = ret;</div>
<div class="line">            eh_conf-&gt;ipsec_mode = EH_IPSEC_MODE_TYPE_DRIVER;</div>
<div class="line">            printf(<span class="stringliteral">&quot;Configured with single SA index %u\n&quot;</span>,</div>
<div class="line">                    single_sa_idx);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> CMD_LINE_OPT_CRYPTODEV_MASK_NUM:</div>
<div class="line">            ret = parse_portmask(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (ret == -1) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid argument[portmask]\n&quot;</span>);</div>
<div class="line">                print_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* else */</span></div>
<div class="line">            enabled_cryptodev_mask = ret;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> CMD_LINE_OPT_TRANSFER_MODE_NUM:</div>
<div class="line">            ret = parse_transfer_mode(eh_conf, optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid packet transfer mode\n&quot;</span>);</div>
<div class="line">                print_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> CMD_LINE_OPT_SCHEDULE_TYPE_NUM:</div>
<div class="line">            ret = parse_schedule_type(eh_conf, optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid queue schedule type\n&quot;</span>);</div>
<div class="line">                print_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> CMD_LINE_OPT_RX_OFFLOAD_NUM:</div>
<div class="line">            ret = parse_mask(optarg, &amp;dev_rx_offload);</div>
<div class="line">            <span class="keywordflow">if</span> (ret != 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid argument for \&#39;%s\&#39;: %s\n&quot;</span>,</div>
<div class="line">                    CMD_LINE_OPT_RX_OFFLOAD, optarg);</div>
<div class="line">                print_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> CMD_LINE_OPT_TX_OFFLOAD_NUM:</div>
<div class="line">            ret = parse_mask(optarg, &amp;dev_tx_offload);</div>
<div class="line">            <span class="keywordflow">if</span> (ret != 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid argument for \&#39;%s\&#39;: %s\n&quot;</span>,</div>
<div class="line">                    CMD_LINE_OPT_TX_OFFLOAD, optarg);</div>
<div class="line">                print_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> CMD_LINE_OPT_REASSEMBLE_NUM:</div>
<div class="line">            ret = parse_decimal(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0 || ret &gt; UINT32_MAX) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid argument for \&#39;%s\&#39;: %s\n&quot;</span>,</div>
<div class="line">                    CMD_LINE_OPT_REASSEMBLE, optarg);</div>
<div class="line">                print_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            frag_tbl_sz = ret;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> CMD_LINE_OPT_MTU_NUM:</div>
<div class="line">            ret = parse_decimal(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0 || ret &gt; <a name="a82"></a><a class="code" href="rte__ip_8h.html#a419c49159f31d294b3854b86f9427a4e">RTE_IPV4_MAX_PKT_LEN</a>) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid argument for \&#39;%s\&#39;: %s\n&quot;</span>,</div>
<div class="line">                    CMD_LINE_OPT_MTU, optarg);</div>
<div class="line">                print_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            mtu_size = ret;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> CMD_LINE_OPT_FRAG_TTL_NUM:</div>
<div class="line">            ret = parse_decimal(optarg);</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0 || ret &gt; MAX_FRAG_TTL_NS) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Invalid argument for \&#39;%s\&#39;: %s\n&quot;</span>,</div>
<div class="line">                    CMD_LINE_OPT_MTU, optarg);</div>
<div class="line">                print_usage(prgname);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            frag_ttl_ns = ret;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            print_usage(prgname);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (f_present == 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Mandatory option \&quot;-f\&quot; not present\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* check do we need to enable multi-seg support */</span></div>
<div class="line">    <span class="keywordflow">if</span> (multi_seg_required()) {</div>
<div class="line">        <span class="comment">/* legacy mode doesn&#39;t support multi-seg */</span></div>
<div class="line">        app_sa_prm.enable = 1;</div>
<div class="line">        printf(<span class="stringliteral">&quot;frame buf size: %u, mtu: %u, &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;number of reassemble entries: %u\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;multi-segment support is required\n&quot;</span>,</div>
<div class="line">            frame_buf_size, mtu_size, frag_tbl_sz);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    print_app_sa_prm(&amp;app_sa_prm);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (optind &gt;= 0)</div>
<div class="line">        argv[optind-1] = prgname;</div>
<div class="line"> </div>
<div class="line">    ret = optind-1;</div>
<div class="line">    optind = 1; <span class="comment">/* reset getopt lib */</span></div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">print_ethaddr(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structrte__ether__addr.html">rte_ether_addr</a> *eth_addr)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> buf[RTE_ETHER_ADDR_FMT_SIZE];</div>
<div class="line">    <a name="a83"></a><a class="code" href="rte__ether_8h.html#af5cfe384bccf79d966ae861ccdf34923">rte_ether_format_addr</a>(buf, RTE_ETHER_ADDR_FMT_SIZE, eth_addr);</div>
<div class="line">    printf(<span class="stringliteral">&quot;%s%s&quot;</span>, name, buf);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Update destination ethaddr for the port.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">add_dst_ethaddr(uint16_t port, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structrte__ether__addr.html">rte_ether_addr</a> *addr)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (port &gt;= <a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(ethaddr_tbl))</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">    ethaddr_tbl[port].dst = ETHADDR_TO_UINT64(addr);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Check the link status of all ports in up to 9s, and print them finally */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">check_all_ports_link_status(uint32_t port_mask)</div>
<div class="line">{</div>
<div class="line"><span class="preprocessor">#define CHECK_INTERVAL 100 </span><span class="comment">/* 100ms */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define MAX_CHECK_TIME 90 </span><span class="comment">/* 9s (90 * 100ms) in total */</span><span class="preprocessor"></span></div>
<div class="line">    uint16_t portid;</div>
<div class="line">    uint8_t count, all_ports_up, print_flag = 0;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a84"></a><a class="code" href="structrte__eth__link.html">rte_eth_link</a> link;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line">    <span class="keywordtype">char</span> link_status_text[<a name="a85"></a><a class="code" href="rte__ethdev_8h.html#a7a31d6736244603b6a1d7efdd32a8834">RTE_ETH_LINK_MAX_STR_LEN</a>];</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;\nChecking link status&quot;</span>);</div>
<div class="line">    fflush(stdout);</div>
<div class="line">    <span class="keywordflow">for</span> (count = 0; count &lt;= MAX_CHECK_TIME; count++) {</div>
<div class="line">        all_ports_up = 1;</div>
<div class="line">        <a name="a86"></a><a class="code" href="rte__ethdev_8h.html#ad7b46c67203d37fe3a34f11076d970d6">RTE_ETH_FOREACH_DEV</a>(portid) {</div>
<div class="line">            <span class="keywordflow">if</span> ((port_mask &amp; (1 &lt;&lt; portid)) == 0)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            memset(&amp;link, 0, <span class="keyword">sizeof</span>(link));</div>
<div class="line">            ret = <a name="a87"></a><a class="code" href="rte__ethdev_8h.html#ad1263899f41301923c483c3b4ce0486f">rte_eth_link_get_nowait</a>(portid, &amp;link);</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">                all_ports_up = 0;</div>
<div class="line">                <span class="keywordflow">if</span> (print_flag == 1)</div>
<div class="line">                    printf(<span class="stringliteral">&quot;Port %u link get failed: %s\n&quot;</span>,</div>
<div class="line">                        portid, <a name="a88"></a><a class="code" href="rte__errno_8h.html#a129a7eb4cfa1f5bdac5783bf49137d06">rte_strerror</a>(-ret));</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">/* print link status if flag set */</span></div>
<div class="line">            <span class="keywordflow">if</span> (print_flag == 1) {</div>
<div class="line">                <a name="a89"></a><a class="code" href="rte__ethdev_8h.html#a5f51139368b8d1a2c22fdecd90bc4d98">rte_eth_link_to_str</a>(link_status_text,</div>
<div class="line">                    <span class="keyword">sizeof</span>(link_status_text), &amp;link);</div>
<div class="line">                printf(<span class="stringliteral">&quot;Port %d %s\n&quot;</span>, portid,</div>
<div class="line">                       link_status_text);</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">/* clear all_ports_up flag if any link down */</span></div>
<div class="line">            <span class="keywordflow">if</span> (link.link_status == <a name="a90"></a><a class="code" href="rte__ethdev_8h.html#a08c012f37e07726170ff67daf667d850">ETH_LINK_DOWN</a>) {</div>
<div class="line">                all_ports_up = 0;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/* after finally printing all link status, get out */</span></div>
<div class="line">        <span class="keywordflow">if</span> (print_flag == 1)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (all_ports_up == 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line">            fflush(stdout);</div>
<div class="line">            <a name="a91"></a><a class="code" href="rte__cycles_8h.html#af73b844d50b98de74b1a0e1730262f85">rte_delay_ms</a>(CHECK_INTERVAL);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* set the print_flag if all ports up or timeout */</span></div>
<div class="line">        <span class="keywordflow">if</span> (all_ports_up == 1 || count == (MAX_CHECK_TIME - 1)) {</div>
<div class="line">            print_flag = 1;</div>
<div class="line">            printf(<span class="stringliteral">&quot;done\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> int32_t</div>
<div class="line">add_mapping(<span class="keyword">struct</span> <a class="code" href="structrte__hash.html">rte_hash</a> *map, <span class="keyword">const</span> <span class="keywordtype">char</span> *str, uint16_t cdev_id,</div>
<div class="line">        uint16_t qp, <span class="keyword">struct</span> lcore_params *params,</div>
<div class="line">        <span class="keyword">struct</span> ipsec_ctx *ipsec_ctx,</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">struct</span> <a name="_a92"></a><a class="code" href="structrte__cryptodev__capabilities.html">rte_cryptodev_capabilities</a> *cipher,</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structrte__cryptodev__capabilities.html">rte_cryptodev_capabilities</a> *auth,</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structrte__cryptodev__capabilities.html">rte_cryptodev_capabilities</a> *aead)</div>
<div class="line">{</div>
<div class="line">    int32_t ret = 0;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i;</div>
<div class="line">    <span class="keyword">struct </span>cdev_key key = { 0 };</div>
<div class="line"> </div>
<div class="line">    key.lcore_id = params-&gt;lcore_id;</div>
<div class="line">    <span class="keywordflow">if</span> (cipher)</div>
<div class="line">        key.cipher_algo = cipher-&gt;<a name="a93"></a><a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a name="a94"></a><a class="code" href="structrte__cryptodev__symmetric__capability.html#a05863077b6b0802857a85984a19857c8">cipher</a>.algo;</div>
<div class="line">    <span class="keywordflow">if</span> (auth)</div>
<div class="line">        key.auth_algo = auth-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a name="a95"></a><a class="code" href="structrte__cryptodev__symmetric__capability.html#a690a3258912ca541695442ea102c55d8">auth</a>.algo;</div>
<div class="line">    <span class="keywordflow">if</span> (aead)</div>
<div class="line">        key.aead_algo = aead-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a name="a96"></a>aead.algo;</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a97"></a><a class="code" href="rte__hash_8h.html#a62ff0b837d39bbff00863feabf15e224">rte_hash_lookup</a>(map, &amp;key);</div>
<div class="line">    <span class="keywordflow">if</span> (ret != -ENOENT)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; ipsec_ctx-&gt;nb_qps; i++)</div>
<div class="line">        <span class="keywordflow">if</span> (ipsec_ctx-&gt;tbl[i].id == cdev_id)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (i == ipsec_ctx-&gt;nb_qps) {</div>
<div class="line">        <span class="keywordflow">if</span> (ipsec_ctx-&gt;nb_qps == MAX_QP_PER_LCORE) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Maximum number of crypto devices assigned to &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;a core, increase MAX_QP_PER_LCORE value\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line">        ipsec_ctx-&gt;tbl[i].id = cdev_id;</div>
<div class="line">        ipsec_ctx-&gt;tbl[i].qp = qp;</div>
<div class="line">        ipsec_ctx-&gt;nb_qps++;</div>
<div class="line">        printf(<span class="stringliteral">&quot;%s cdev mapping: lcore %u using cdev %u qp %u &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;(cdev_id_qp %lu)\n&quot;</span>, str, key.lcore_id,</div>
<div class="line">                cdev_id, qp, i);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a98"></a><a class="code" href="rte__hash_8h.html#a31fbd5835f9ed6ff92e052a79f905237">rte_hash_add_key_data</a>(map, &amp;key, (<span class="keywordtype">void</span> *)i);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Faled to insert cdev mapping for (lcore %u, &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;cdev %u, qp %u), errno %d\n&quot;</span>,</div>
<div class="line">                key.lcore_id, ipsec_ctx-&gt;tbl[i].id,</div>
<div class="line">                ipsec_ctx-&gt;tbl[i].qp, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> int32_t</div>
<div class="line">add_cdev_mapping(<span class="keyword">struct</span> <a name="_a99"></a><a class="code" href="structrte__cryptodev__info.html">rte_cryptodev_info</a> *dev_info, uint16_t cdev_id,</div>
<div class="line">        uint16_t qp, <span class="keyword">struct</span> lcore_params *params)</div>
<div class="line">{</div>
<div class="line">    int32_t ret = 0;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__capabilities.html">rte_cryptodev_capabilities</a> *i, *j;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__hash.html">rte_hash</a> *map;</div>
<div class="line">    <span class="keyword">struct </span>lcore_conf *qconf;</div>
<div class="line">    <span class="keyword">struct </span>ipsec_ctx *ipsec_ctx;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *str;</div>
<div class="line"> </div>
<div class="line">    qconf = &amp;lcore_conf[params-&gt;lcore_id];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((unprotected_port_mask &amp; (1 &lt;&lt; params-&gt;port_id)) == 0) {</div>
<div class="line">        map = cdev_map_out;</div>
<div class="line">        ipsec_ctx = &amp;qconf-&gt;outbound;</div>
<div class="line">        str = <span class="stringliteral">&quot;Outbound&quot;</span>;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        map = cdev_map_in;</div>
<div class="line">        ipsec_ctx = &amp;qconf-&gt;inbound;</div>
<div class="line">        str = <span class="stringliteral">&quot;Inbound&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Required cryptodevs with operation chainning */</span></div>
<div class="line">    <span class="keywordflow">if</span> (!(dev_info-&gt;<a name="a100"></a><a class="code" href="structrte__cryptodev__info.html#aaccbcc3ce862dbe5af189ee0c3e345b1">feature_flags</a> &amp;</div>
<div class="line">                <a name="a101"></a><a class="code" href="rte__cryptodev_8h.html#a2b576f436d279db944d0afee6c6c3aa3">RTE_CRYPTODEV_FF_SYM_OPERATION_CHAINING</a>))</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = dev_info-&gt;<a name="a102"></a><a class="code" href="structrte__cryptodev__info.html#a65b9cdbb3719f657c9d8e581ba2a904b">capabilities</a>;</div>
<div class="line">            i-&gt;<a name="a103"></a><a class="code" href="structrte__cryptodev__capabilities.html#a394c79d7e4c59bafe3bc7678dd69c03d">op</a> != <a name="a104"></a><a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739ad7a72984dd85b1c8b59cad6971b02248">RTE_CRYPTO_OP_TYPE_UNDEFINED</a>; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a394c79d7e4c59bafe3bc7678dd69c03d">op</a> != <a name="a105"></a><a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc">RTE_CRYPTO_OP_TYPE_SYMMETRIC</a>)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a name="a106"></a><a class="code" href="structrte__cryptodev__symmetric__capability.html#afe276edbba98b3f82f0826d7feaeb82f">xform_type</a> == <a name="a107"></a><a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a87d8d14b56f41d42ca643d33a279912a">RTE_CRYPTO_SYM_XFORM_AEAD</a>) {</div>
<div class="line">            ret |= add_mapping(map, str, cdev_id, qp, params,</div>
<div class="line">                    ipsec_ctx, NULL, NULL, i);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#afe276edbba98b3f82f0826d7feaeb82f">xform_type</a> != <a name="a108"></a><a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c">RTE_CRYPTO_SYM_XFORM_CIPHER</a>)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (j = dev_info-&gt;<a class="code" href="structrte__cryptodev__info.html#a65b9cdbb3719f657c9d8e581ba2a904b">capabilities</a>;</div>
<div class="line">                j-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a394c79d7e4c59bafe3bc7678dd69c03d">op</a> != <a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739ad7a72984dd85b1c8b59cad6971b02248">RTE_CRYPTO_OP_TYPE_UNDEFINED</a>; j++) {</div>
<div class="line">            <span class="keywordflow">if</span> (j-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a394c79d7e4c59bafe3bc7678dd69c03d">op</a> != <a class="code" href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc">RTE_CRYPTO_OP_TYPE_SYMMETRIC</a>)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (j-&gt;<a class="code" href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">sym</a>.<a class="code" href="structrte__cryptodev__symmetric__capability.html#afe276edbba98b3f82f0826d7feaeb82f">xform_type</a> != <a name="a109"></a><a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9">RTE_CRYPTO_SYM_XFORM_AUTH</a>)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            ret |= add_mapping(map, str, cdev_id, qp, params,</div>
<div class="line">                        ipsec_ctx, i, j, NULL);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Check if the device is enabled by cryptodev_mask */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">check_cryptodev_mask(uint8_t cdev_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (enabled_cryptodev_mask &amp; (1 &lt;&lt; cdev_id))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint16_t</div>
<div class="line">cryptodevs_init(uint16_t req_queue_num)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a110"></a><a class="code" href="structrte__cryptodev__config.html">rte_cryptodev_config</a> dev_conf;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a111"></a><a class="code" href="structrte__cryptodev__qp__conf.html">rte_cryptodev_qp_conf</a> qp_conf;</div>
<div class="line">    uint16_t idx, max_nb_qps, qp, total_nb_qps, i;</div>
<div class="line">    int16_t cdev_id;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a112"></a><a class="code" href="structrte__hash__parameters.html">rte_hash_parameters</a> params = { 0 };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> uint64_t mseg_flag = multi_seg_required() ?</div>
<div class="line">                <a name="a113"></a><a class="code" href="rte__cryptodev_8h.html#a4c4acd655062a7195c722948d93c22c4">RTE_CRYPTODEV_FF_IN_PLACE_SGL</a> : 0;</div>
<div class="line"> </div>
<div class="line">    params.<a name="a114"></a><a class="code" href="structrte__hash__parameters.html#a38bad35c844ffd72b0c1132715d5f3a1">entries</a> = CDEV_MAP_ENTRIES;</div>
<div class="line">    params.<a name="a115"></a><a class="code" href="structrte__hash__parameters.html#a7250588fe859c80e349c79c2b15ee421">key_len</a> = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>cdev_key);</div>
<div class="line">    params.<a name="a116"></a><a class="code" href="structrte__hash__parameters.html#aca908537bdd20d4ca4d4c7fd6c392903">hash_func</a> = <a name="a117"></a><a class="code" href="rte__jhash_8h.html#a5a6d3c6a6da332e3768fa41e879e0e10">rte_jhash</a>;</div>
<div class="line">    params.<a name="a118"></a><a class="code" href="structrte__hash__parameters.html#a01ac433d404852455c8fb211a4d43b2a">hash_func_init_val</a> = 0;</div>
<div class="line">    params.<a name="a119"></a><a class="code" href="structrte__hash__parameters.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a> = <a name="a120"></a><a class="code" href="rte__lcore_8h.html#a7c8da4664df26a64cf05dc508a4f26df">rte_socket_id</a>();</div>
<div class="line"> </div>
<div class="line">    params.<a name="a121"></a><a class="code" href="structrte__hash__parameters.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;cdev_map_in&quot;</span>;</div>
<div class="line">    cdev_map_in = <a name="a122"></a><a class="code" href="rte__hash_8h.html#a5afbd2564f738149a241bc22b2428612">rte_hash_create</a>(&amp;params);</div>
<div class="line">    <span class="keywordflow">if</span> (cdev_map_in == NULL)</div>
<div class="line">        <a name="a123"></a><a class="code" href="rte__debug_8h.html#a9fcab5683ce1c1164c52c17579cc2b5f">rte_panic</a>(<span class="stringliteral">&quot;Failed to create cdev_map hash table, errno = %d\n&quot;</span>,</div>
<div class="line">                <a class="code" href="rte__errno_8h.html#a66171a00ea02084317df4dc9c2adaccb">rte_errno</a>);</div>
<div class="line"> </div>
<div class="line">    params.<a class="code" href="structrte__hash__parameters.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;cdev_map_out&quot;</span>;</div>
<div class="line">    cdev_map_out = <a class="code" href="rte__hash_8h.html#a5afbd2564f738149a241bc22b2428612">rte_hash_create</a>(&amp;params);</div>
<div class="line">    <span class="keywordflow">if</span> (cdev_map_out == NULL)</div>
<div class="line">        <a class="code" href="rte__debug_8h.html#a9fcab5683ce1c1164c52c17579cc2b5f">rte_panic</a>(<span class="stringliteral">&quot;Failed to create cdev_map hash table, errno = %d\n&quot;</span>,</div>
<div class="line">                <a class="code" href="rte__errno_8h.html#a66171a00ea02084317df4dc9c2adaccb">rte_errno</a>);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;lcore/cryptodev/qp mappings:\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    idx = 0;</div>
<div class="line">    total_nb_qps = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (cdev_id = 0; cdev_id &lt; <a name="a124"></a><a class="code" href="rte__cryptodev_8h.html#a1a0c23adc25339b56bd19242194a002f">rte_cryptodev_count</a>(); cdev_id++) {</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structrte__cryptodev__info.html">rte_cryptodev_info</a> cdev_info;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (check_cryptodev_mask((uint8_t)cdev_id))</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <a name="a125"></a><a class="code" href="rte__cryptodev_8h.html#aeb677c03cea6fcc48a8caa533e3729f9">rte_cryptodev_info_get</a>(cdev_id, &amp;cdev_info);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((mseg_flag &amp; cdev_info.feature_flags) != mseg_flag)</div>
<div class="line">            <a name="a126"></a><a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE,</div>
<div class="line">                <span class="stringliteral">&quot;Device %hd does not support \&#39;%s\&#39; feature\n&quot;</span>,</div>
<div class="line">                cdev_id,</div>
<div class="line">                <a name="a127"></a><a class="code" href="rte__cryptodev_8h.html#a7cec5687e3123c44b0020b5c5c8c3d0b">rte_cryptodev_get_feature_name</a>(mseg_flag));</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (nb_lcore_params &gt; cdev_info.max_nb_queue_pairs)</div>
<div class="line">            max_nb_qps = cdev_info.max_nb_queue_pairs;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            max_nb_qps = nb_lcore_params;</div>
<div class="line"> </div>
<div class="line">        qp = 0;</div>
<div class="line">        i = 0;</div>
<div class="line">        <span class="keywordflow">while</span> (qp &lt; max_nb_qps &amp;&amp; i &lt; nb_lcore_params) {</div>
<div class="line">            <span class="keywordflow">if</span> (add_cdev_mapping(&amp;cdev_info, cdev_id, qp,</div>
<div class="line">                        &amp;lcore_params[idx]))</div>
<div class="line">                qp++;</div>
<div class="line">            idx++;</div>
<div class="line">            idx = idx % nb_lcore_params;</div>
<div class="line">            i++;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        qp = <a name="a128"></a><a class="code" href="rte__common_8h.html#a4c7571cbcdbfe9b63431036af811bee9">RTE_MIN</a>(max_nb_qps, <a name="a129"></a><a class="code" href="rte__common_8h.html#a8df8b303b8ea240cf6aebf937fd21eaf">RTE_MAX</a>(req_queue_num, qp));</div>
<div class="line">        <span class="keywordflow">if</span> (qp == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        total_nb_qps += qp;</div>
<div class="line">        dev_conf.socket_id = rte_cryptodev_socket_id(cdev_id);</div>
<div class="line">        dev_conf.nb_queue_pairs = qp;</div>
<div class="line">        dev_conf.ff_disable = <a name="a130"></a><a class="code" href="rte__cryptodev_8h.html#a616e039704be1e0c96a2822572c3839b">RTE_CRYPTODEV_FF_ASYMMETRIC_CRYPTO</a>;</div>
<div class="line"> </div>
<div class="line">        uint32_t dev_max_sess = cdev_info.sym.max_nb_sessions;</div>
<div class="line">        <span class="keywordflow">if</span> (dev_max_sess != 0 &amp;&amp;</div>
<div class="line">                dev_max_sess &lt; get_nb_crypto_sessions())</div>
<div class="line">            <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE,</div>
<div class="line">                <span class="stringliteral">&quot;Device does not support at least %u &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;sessions&quot;</span>, get_nb_crypto_sessions());</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a131"></a><a class="code" href="rte__cryptodev_8h.html#a58207367533ac9e65e4a611ba78090e5">rte_cryptodev_configure</a>(cdev_id, &amp;dev_conf))</div>
<div class="line">            <a class="code" href="rte__debug_8h.html#a9fcab5683ce1c1164c52c17579cc2b5f">rte_panic</a>(<span class="stringliteral">&quot;Failed to initialize cryptodev %u\n&quot;</span>,</div>
<div class="line">                    cdev_id);</div>
<div class="line"> </div>
<div class="line">        qp_conf.nb_descriptors = CDEV_QUEUE_DESC;</div>
<div class="line">        qp_conf.mp_session =</div>
<div class="line">            socket_ctx[dev_conf.socket_id].session_pool;</div>
<div class="line">        qp_conf.mp_session_private =</div>
<div class="line">            socket_ctx[dev_conf.socket_id].session_priv_pool;</div>
<div class="line">        <span class="keywordflow">for</span> (qp = 0; qp &lt; dev_conf.nb_queue_pairs; qp++)</div>
<div class="line">            <span class="keywordflow">if</span> (<a name="a132"></a><a class="code" href="rte__cryptodev_8h.html#ae4388e0326c8789ddf39e32044dc4187">rte_cryptodev_queue_pair_setup</a>(cdev_id, qp,</div>
<div class="line">                    &amp;qp_conf, dev_conf.socket_id))</div>
<div class="line">                <a class="code" href="rte__debug_8h.html#a9fcab5683ce1c1164c52c17579cc2b5f">rte_panic</a>(<span class="stringliteral">&quot;Failed to setup queue %u for &quot;</span></div>
<div class="line">                        <span class="stringliteral">&quot;cdev_id %u\n&quot;</span>, 0, cdev_id);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a133"></a><a class="code" href="rte__cryptodev_8h.html#a1fa401bd6c01129823669ac68deaa993">rte_cryptodev_start</a>(cdev_id))</div>
<div class="line">            <a class="code" href="rte__debug_8h.html#a9fcab5683ce1c1164c52c17579cc2b5f">rte_panic</a>(<span class="stringliteral">&quot;Failed to start cryptodev %u\n&quot;</span>,</div>
<div class="line">                    cdev_id);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> total_nb_qps;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">port_init(uint16_t portid, uint64_t req_rx_offloads, uint64_t req_tx_offloads)</div>
<div class="line">{</div>
<div class="line">    uint32_t frame_size;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a134"></a><a class="code" href="structrte__eth__dev__info.html">rte_eth_dev_info</a> dev_info;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a135"></a><a class="code" href="structrte__eth__txconf.html">rte_eth_txconf</a> *txconf;</div>
<div class="line">    uint16_t nb_tx_queue, nb_rx_queue;</div>
<div class="line">    uint16_t tx_queueid, rx_queueid, queue, lcore_id;</div>
<div class="line">    int32_t ret, socket_id;</div>
<div class="line">    <span class="keyword">struct </span>lcore_conf *qconf;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ether__addr.html">rte_ether_addr</a> ethaddr;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__eth__conf.html">rte_eth_conf</a> local_port_conf = port_conf;</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a136"></a><a class="code" href="rte__ethdev_8h.html#a7593f4fff04f4ae1b1d718db7ca7dc8c">rte_eth_dev_info_get</a>(portid, &amp;dev_info);</div>
<div class="line">    <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE,</div>
<div class="line">            <span class="stringliteral">&quot;Error during getting device (port %u) info: %s\n&quot;</span>,</div>
<div class="line">            portid, strerror(-ret));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* limit allowed HW offloafs, as user requested */</span></div>
<div class="line">    dev_info.rx_offload_capa &amp;= dev_rx_offload;</div>
<div class="line">    dev_info.tx_offload_capa &amp;= dev_tx_offload;</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Configuring device port %u:\n&quot;</span>, portid);</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a137"></a><a class="code" href="rte__ethdev_8h.html#a8a28375b279ded9125c99a46bf3956ef">rte_eth_macaddr_get</a>(portid, &amp;ethaddr);</div>
<div class="line">    <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE,</div>
<div class="line">            <span class="stringliteral">&quot;Error getting MAC address (port %u): %s\n&quot;</span>,</div>
<div class="line">            portid, <a class="code" href="rte__errno_8h.html#a129a7eb4cfa1f5bdac5783bf49137d06">rte_strerror</a>(-ret));</div>
<div class="line"> </div>
<div class="line">    ethaddr_tbl[portid].src = ETHADDR_TO_UINT64(&amp;ethaddr);</div>
<div class="line">    print_ethaddr(<span class="stringliteral">&quot;Address: &quot;</span>, &amp;ethaddr);</div>
<div class="line">    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    nb_rx_queue = get_port_nb_rx_queues(portid);</div>
<div class="line">    nb_tx_queue = nb_lcores;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (nb_rx_queue &gt; dev_info.max_rx_queues)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Error: queue %u not available &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;(max rx queue is %u)\n&quot;</span>,</div>
<div class="line">                nb_rx_queue, dev_info.max_rx_queues);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (nb_tx_queue &gt; dev_info.max_tx_queues)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Error: queue %u not available &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;(max tx queue is %u)\n&quot;</span>,</div>
<div class="line">                nb_tx_queue, dev_info.max_tx_queues);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Creating queues: nb_rx_queue=%d nb_tx_queue=%u...\n&quot;</span>,</div>
<div class="line">            nb_rx_queue, nb_tx_queue);</div>
<div class="line"> </div>
<div class="line">    frame_size = MTU_TO_FRAMELEN(mtu_size);</div>
<div class="line">    <span class="keywordflow">if</span> (frame_size &gt; local_port_conf.<a class="code" href="structrte__eth__conf.html#a346eef99c24f617b74c440c1aa565d01">rxmode</a>.<a name="a138"></a><a class="code" href="structrte__eth__rxmode.html#a84a5d32306b86a1df884144612c70726">max_rx_pkt_len</a>)</div>
<div class="line">        local_port_conf.<a class="code" href="structrte__eth__conf.html#a346eef99c24f617b74c440c1aa565d01">rxmode</a>.<a name="a139"></a><a class="code" href="structrte__eth__rxmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a> |= DEV_RX_OFFLOAD_JUMBO_FRAME;</div>
<div class="line">    local_port_conf.<a class="code" href="structrte__eth__conf.html#a346eef99c24f617b74c440c1aa565d01">rxmode</a>.<a class="code" href="structrte__eth__rxmode.html#a84a5d32306b86a1df884144612c70726">max_rx_pkt_len</a> = frame_size;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (multi_seg_required()) {</div>
<div class="line">        local_port_conf.<a class="code" href="structrte__eth__conf.html#a346eef99c24f617b74c440c1aa565d01">rxmode</a>.<a class="code" href="structrte__eth__rxmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a> |= DEV_RX_OFFLOAD_SCATTER;</div>
<div class="line">        local_port_conf.<a name="a140"></a><a class="code" href="structrte__eth__conf.html#a1c33c9d2e5cdb14b62ed386bf3159e07">txmode</a>.<a name="a141"></a><a class="code" href="structrte__eth__txmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a> |= <a name="a142"></a><a class="code" href="rte__ethdev_8h.html#a35b7466d51590b9c30fc40134b043ba7">DEV_TX_OFFLOAD_MULTI_SEGS</a>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    local_port_conf.<a class="code" href="structrte__eth__conf.html#a346eef99c24f617b74c440c1aa565d01">rxmode</a>.<a class="code" href="structrte__eth__rxmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a> |= req_rx_offloads;</div>
<div class="line">    local_port_conf.<a class="code" href="structrte__eth__conf.html#a1c33c9d2e5cdb14b62ed386bf3159e07">txmode</a>.<a class="code" href="structrte__eth__txmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a> |= req_tx_offloads;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check that all required capabilities are supported */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((local_port_conf.<a class="code" href="structrte__eth__conf.html#a346eef99c24f617b74c440c1aa565d01">rxmode</a>.<a class="code" href="structrte__eth__rxmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a> &amp; dev_info.rx_offload_capa) !=</div>
<div class="line">            local_port_conf.<a class="code" href="structrte__eth__conf.html#a346eef99c24f617b74c440c1aa565d01">rxmode</a>.<a class="code" href="structrte__eth__rxmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a>)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE,</div>
<div class="line">            <span class="stringliteral">&quot;Error: port %u required RX offloads: 0x%&quot;</span> PRIx64</div>
<div class="line">            <span class="stringliteral">&quot;, avaialbe RX offloads: 0x%&quot;</span> PRIx64 <span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line">            portid, local_port_conf.<a class="code" href="structrte__eth__conf.html#a346eef99c24f617b74c440c1aa565d01">rxmode</a>.<a class="code" href="structrte__eth__rxmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a>,</div>
<div class="line">            dev_info.rx_offload_capa);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((local_port_conf.<a class="code" href="structrte__eth__conf.html#a1c33c9d2e5cdb14b62ed386bf3159e07">txmode</a>.<a class="code" href="structrte__eth__txmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a> &amp; dev_info.tx_offload_capa) !=</div>
<div class="line">            local_port_conf.<a class="code" href="structrte__eth__conf.html#a1c33c9d2e5cdb14b62ed386bf3159e07">txmode</a>.<a class="code" href="structrte__eth__txmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a>)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE,</div>
<div class="line">            <span class="stringliteral">&quot;Error: port %u required TX offloads: 0x%&quot;</span> PRIx64</div>
<div class="line">            <span class="stringliteral">&quot;, avaialbe TX offloads: 0x%&quot;</span> PRIx64 <span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line">            portid, local_port_conf.<a class="code" href="structrte__eth__conf.html#a1c33c9d2e5cdb14b62ed386bf3159e07">txmode</a>.<a class="code" href="structrte__eth__txmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a>,</div>
<div class="line">            dev_info.tx_offload_capa);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (dev_info.tx_offload_capa &amp; <a name="a143"></a><a class="code" href="rte__ethdev_8h.html#ae7110b5d5dced8f42505bff5d9e3f0ea">DEV_TX_OFFLOAD_MBUF_FAST_FREE</a>)</div>
<div class="line">        local_port_conf.<a class="code" href="structrte__eth__conf.html#a1c33c9d2e5cdb14b62ed386bf3159e07">txmode</a>.<a class="code" href="structrte__eth__txmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a> |=</div>
<div class="line">            <a class="code" href="rte__ethdev_8h.html#ae7110b5d5dced8f42505bff5d9e3f0ea">DEV_TX_OFFLOAD_MBUF_FAST_FREE</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (dev_info.tx_offload_capa &amp; DEV_TX_OFFLOAD_IPV4_CKSUM)</div>
<div class="line">        local_port_conf.<a class="code" href="structrte__eth__conf.html#a1c33c9d2e5cdb14b62ed386bf3159e07">txmode</a>.<a class="code" href="structrte__eth__txmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a> |= DEV_TX_OFFLOAD_IPV4_CKSUM;</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;port %u configurng rx_offloads=0x%&quot;</span> PRIx64</div>
<div class="line">        <span class="stringliteral">&quot;, tx_offloads=0x%&quot;</span> PRIx64 <span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line">        portid, local_port_conf.<a class="code" href="structrte__eth__conf.html#a346eef99c24f617b74c440c1aa565d01">rxmode</a>.<a class="code" href="structrte__eth__rxmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a>,</div>
<div class="line">        local_port_conf.<a class="code" href="structrte__eth__conf.html#a1c33c9d2e5cdb14b62ed386bf3159e07">txmode</a>.<a class="code" href="structrte__eth__txmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a>);</div>
<div class="line"> </div>
<div class="line">    local_port_conf.<a name="a144"></a><a class="code" href="structrte__eth__conf.html#a084e132696e8d0f59f643d822c8cedb7">rx_adv_conf</a>.<a name="a145"></a><a class="code" href="structrte__eth__conf.html#addc9c7bb19ed12f1171c543493553806">rss_conf</a>.<a name="a146"></a><a class="code" href="structrte__eth__rss__conf.html#ad70f17882a835e5d4e38c64a9f872fdc">rss_hf</a> &amp;=</div>
<div class="line">        dev_info.flow_type_rss_offloads;</div>
<div class="line">    <span class="keywordflow">if</span> (local_port_conf.<a class="code" href="structrte__eth__conf.html#a084e132696e8d0f59f643d822c8cedb7">rx_adv_conf</a>.<a class="code" href="structrte__eth__conf.html#addc9c7bb19ed12f1171c543493553806">rss_conf</a>.<a class="code" href="structrte__eth__rss__conf.html#ad70f17882a835e5d4e38c64a9f872fdc">rss_hf</a> !=</div>
<div class="line">            port_conf.<a class="code" href="structrte__eth__conf.html#a084e132696e8d0f59f643d822c8cedb7">rx_adv_conf</a>.<a class="code" href="structrte__eth__conf.html#addc9c7bb19ed12f1171c543493553806">rss_conf</a>.<a class="code" href="structrte__eth__rss__conf.html#ad70f17882a835e5d4e38c64a9f872fdc">rss_hf</a>) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %u modified RSS hash function based on hardware support,&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;requested:%#&quot;</span>PRIx64<span class="stringliteral">&quot; configured:%#&quot;</span>PRIx64<span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line">            portid,</div>
<div class="line">            port_conf.<a class="code" href="structrte__eth__conf.html#a084e132696e8d0f59f643d822c8cedb7">rx_adv_conf</a>.<a class="code" href="structrte__eth__conf.html#addc9c7bb19ed12f1171c543493553806">rss_conf</a>.<a class="code" href="structrte__eth__rss__conf.html#ad70f17882a835e5d4e38c64a9f872fdc">rss_hf</a>,</div>
<div class="line">            local_port_conf.<a class="code" href="structrte__eth__conf.html#a084e132696e8d0f59f643d822c8cedb7">rx_adv_conf</a>.<a class="code" href="structrte__eth__conf.html#addc9c7bb19ed12f1171c543493553806">rss_conf</a>.<a class="code" href="structrte__eth__rss__conf.html#ad70f17882a835e5d4e38c64a9f872fdc">rss_hf</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a147"></a><a class="code" href="rte__ethdev_8h.html#a1a7d3a20b102fee222541fda50fd87bd">rte_eth_dev_configure</a>(portid, nb_rx_queue, nb_tx_queue,</div>
<div class="line">            &amp;local_port_conf);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Cannot configure device: &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;err=%d, port=%d\n&quot;</span>, ret, portid);</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a148"></a><a class="code" href="rte__ethdev_8h.html#ad31219b87a1733d5b367a7c04c7f7b48">rte_eth_dev_adjust_nb_rx_tx_desc</a>(portid, &amp;nb_rxd, &amp;nb_txd);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Cannot adjust number of descriptors: &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;err=%d, port=%d\n&quot;</span>, ret, portid);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* init one TX queue per lcore */</span></div>
<div class="line">    tx_queueid = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (lcore_id = 0; lcore_id &lt; RTE_MAX_LCORE; lcore_id++) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="rte__lcore_8h.html#a5404ee6ac26cbe5a4f4ddef44d690b76">rte_lcore_is_enabled</a>(lcore_id) == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (numa_on)</div>
<div class="line">            socket_id = (uint8_t)<a class="code" href="rte__lcore_8h.html#a023b4909f52c3cdf0351d71d2b5032bc">rte_lcore_to_socket_id</a>(lcore_id);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            socket_id = 0;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* init TX queue */</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Setup txq=%u,%d,%d\n&quot;</span>, lcore_id, tx_queueid, socket_id);</div>
<div class="line"> </div>
<div class="line">        txconf = &amp;dev_info.default_txconf;</div>
<div class="line">        txconf-&gt;<a name="a149"></a><a class="code" href="structrte__eth__txconf.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a> = local_port_conf.<a class="code" href="structrte__eth__conf.html#a1c33c9d2e5cdb14b62ed386bf3159e07">txmode</a>.<a class="code" href="structrte__eth__txmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a>;</div>
<div class="line"> </div>
<div class="line">        ret = <a name="a150"></a><a class="code" href="rte__ethdev_8h.html#a796c2f20778984c6f41b271e36bae50e">rte_eth_tx_queue_setup</a>(portid, tx_queueid, nb_txd,</div>
<div class="line">                socket_id, txconf);</div>
<div class="line">        <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">            <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;rte_eth_tx_queue_setup: &quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;err=%d, port=%d\n&quot;</span>, ret, portid);</div>
<div class="line"> </div>
<div class="line">        qconf = &amp;lcore_conf[lcore_id];</div>
<div class="line">        qconf-&gt;tx_queue_id[portid] = tx_queueid;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Pre-populate pkt offloads based on capabilities */</span></div>
<div class="line">        qconf-&gt;outbound.ipv4_offloads = <a name="a151"></a><a class="code" href="rte__mbuf__core_8h.html#a9d2d4eca2fab4ef35c8f8a7f3bbe9fe2">PKT_TX_IPV4</a>;</div>
<div class="line">        qconf-&gt;outbound.ipv6_offloads = <a name="a152"></a><a class="code" href="rte__mbuf__core_8h.html#a8478d650a7d2c49b1e1a173e52d52d35">PKT_TX_IPV6</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (local_port_conf.<a class="code" href="structrte__eth__conf.html#a1c33c9d2e5cdb14b62ed386bf3159e07">txmode</a>.<a class="code" href="structrte__eth__txmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a> &amp; DEV_TX_OFFLOAD_IPV4_CKSUM)</div>
<div class="line">            qconf-&gt;outbound.ipv4_offloads |= <a class="code" href="rte__mbuf__core_8h.html#a51280725dafdf282a80b2d964418798c">PKT_TX_IP_CKSUM</a>;</div>
<div class="line"> </div>
<div class="line">        tx_queueid++;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* init RX queues */</span></div>
<div class="line">        <span class="keywordflow">for</span> (queue = 0; queue &lt; qconf-&gt;nb_rx_queue; ++queue) {</div>
<div class="line">            <span class="keyword">struct </span><a name="_a153"></a><a class="code" href="structrte__eth__rxconf.html">rte_eth_rxconf</a> rxq_conf;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (portid != qconf-&gt;rx_queue_list[queue].port_id)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            rx_queueid = qconf-&gt;rx_queue_list[queue].queue_id;</div>
<div class="line"> </div>
<div class="line">            printf(<span class="stringliteral">&quot;Setup rxq=%d,%d,%d\n&quot;</span>, portid, rx_queueid,</div>
<div class="line">                    socket_id);</div>
<div class="line"> </div>
<div class="line">            rxq_conf = dev_info.default_rxconf;</div>
<div class="line">            rxq_conf.offloads = local_port_conf.<a class="code" href="structrte__eth__conf.html#a346eef99c24f617b74c440c1aa565d01">rxmode</a>.<a class="code" href="structrte__eth__rxmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">offloads</a>;</div>
<div class="line">            ret = <a name="a154"></a><a class="code" href="rte__ethdev_8h.html#a36ba70a5a6fce2c2c1f774828ba78f8d">rte_eth_rx_queue_setup</a>(portid, rx_queueid,</div>
<div class="line">                    nb_rxd, socket_id, &amp;rxq_conf,</div>
<div class="line">                    socket_ctx[socket_id].mbuf_pool);</div>
<div class="line">            <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">                <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE,</div>
<div class="line">                    <span class="stringliteral">&quot;rte_eth_rx_queue_setup: err=%d, &quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;port=%d\n&quot;</span>, ret, portid);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">size_t</span></div>
<div class="line">max_session_size(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">size_t</span> max_sz, sz;</div>
<div class="line">    <span class="keywordtype">void</span> *sec_ctx;</div>
<div class="line">    int16_t cdev_id, port_id, n;</div>
<div class="line"> </div>
<div class="line">    max_sz = 0;</div>
<div class="line">    n =  <a class="code" href="rte__cryptodev_8h.html#a1a0c23adc25339b56bd19242194a002f">rte_cryptodev_count</a>();</div>
<div class="line">    <span class="keywordflow">for</span> (cdev_id = 0; cdev_id != n; cdev_id++) {</div>
<div class="line">        sz = <a name="a155"></a><a class="code" href="rte__cryptodev_8h.html#a34a54ae38920d21d95aa6049640e8c0e">rte_cryptodev_sym_get_private_session_size</a>(cdev_id);</div>
<div class="line">        <span class="keywordflow">if</span> (sz &gt; max_sz)</div>
<div class="line">            max_sz = sz;</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * If crypto device is security capable, need to check the</span></div>
<div class="line"><span class="comment">         * size of security session as well.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Get security context of the crypto device */</span></div>
<div class="line">        sec_ctx = rte_cryptodev_get_sec_ctx(cdev_id);</div>
<div class="line">        <span class="keywordflow">if</span> (sec_ctx == NULL)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Get size of security session */</span></div>
<div class="line">        sz = <a name="a156"></a><a class="code" href="rte__security_8h.html#ab09ae03f5dd326c79671cc7147c0b73c">rte_security_session_get_size</a>(sec_ctx);</div>
<div class="line">        <span class="keywordflow">if</span> (sz &gt; max_sz)</div>
<div class="line">            max_sz = sz;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__ethdev_8h.html#ad7b46c67203d37fe3a34f11076d970d6">RTE_ETH_FOREACH_DEV</a>(port_id) {</div>
<div class="line">        <span class="keywordflow">if</span> ((enabled_port_mask &amp; (1 &lt;&lt; port_id)) == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        sec_ctx = <a class="code" href="rte__ethdev_8h.html#a539fa8ee80c94d538a42d951e4bcb00e">rte_eth_dev_get_sec_ctx</a>(port_id);</div>
<div class="line">        <span class="keywordflow">if</span> (sec_ctx == NULL)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        sz = <a class="code" href="rte__security_8h.html#ab09ae03f5dd326c79671cc7147c0b73c">rte_security_session_get_size</a>(sec_ctx);</div>
<div class="line">        <span class="keywordflow">if</span> (sz &gt; max_sz)</div>
<div class="line">            max_sz = sz;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> max_sz;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">session_pool_init(<span class="keyword">struct</span> socket_ctx *ctx, int32_t socket_id, <span class="keywordtype">size_t</span> sess_sz)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> mp_name[RTE_MEMPOOL_NAMESIZE];</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mempool.html">rte_mempool</a> *sess_mp;</div>
<div class="line">    uint32_t nb_sess;</div>
<div class="line"> </div>
<div class="line">    snprintf(mp_name, RTE_MEMPOOL_NAMESIZE,</div>
<div class="line">            <span class="stringliteral">&quot;sess_mp_%u&quot;</span>, <a name="a157"></a><a class="code" href="structrte__mempool.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line">    nb_sess = (get_nb_crypto_sessions() + CDEV_MP_CACHE_SZ *</div>
<div class="line">        <a name="a158"></a><a class="code" href="rte__lcore_8h.html#a1728dc7f14571ba778d3b5b41aa09283">rte_lcore_count</a>());</div>
<div class="line">    nb_sess = <a class="code" href="rte__common_8h.html#a8df8b303b8ea240cf6aebf937fd21eaf">RTE_MAX</a>(nb_sess, CDEV_MP_CACHE_SZ *</div>
<div class="line">            CDEV_MP_CACHE_MULTIPLIER);</div>
<div class="line">    sess_mp = <a name="a159"></a><a class="code" href="rte__cryptodev_8h.html#ac86bc0178d39db9734c594c35f9aee4e">rte_cryptodev_sym_session_pool_create</a>(</div>
<div class="line">            mp_name, nb_sess, sess_sz, CDEV_MP_CACHE_SZ, 0,</div>
<div class="line">            <a class="code" href="structrte__mempool.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line">    ctx-&gt;session_pool = sess_mp;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ctx-&gt;session_pool == NULL)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE,</div>
<div class="line">            <span class="stringliteral">&quot;Cannot init session pool on socket %d\n&quot;</span>, <a class="code" href="structrte__mempool.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Allocated session pool on socket %d\n&quot;</span>, <a class="code" href="structrte__mempool.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">session_priv_pool_init(<span class="keyword">struct</span> socket_ctx *ctx, int32_t <a class="code" href="structrte__mempool.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>,</div>
<div class="line">    <span class="keywordtype">size_t</span> sess_sz)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> mp_name[RTE_MEMPOOL_NAMESIZE];</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mempool.html">rte_mempool</a> *sess_mp;</div>
<div class="line">    uint32_t nb_sess;</div>
<div class="line"> </div>
<div class="line">    snprintf(mp_name, RTE_MEMPOOL_NAMESIZE,</div>
<div class="line">            <span class="stringliteral">&quot;sess_mp_priv_%u&quot;</span>, <a class="code" href="structrte__mempool.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line">    nb_sess = (get_nb_crypto_sessions() + CDEV_MP_CACHE_SZ *</div>
<div class="line">        <a class="code" href="rte__lcore_8h.html#a1728dc7f14571ba778d3b5b41aa09283">rte_lcore_count</a>());</div>
<div class="line">    nb_sess = <a class="code" href="rte__common_8h.html#a8df8b303b8ea240cf6aebf937fd21eaf">RTE_MAX</a>(nb_sess, CDEV_MP_CACHE_SZ *</div>
<div class="line">            CDEV_MP_CACHE_MULTIPLIER);</div>
<div class="line">    sess_mp = <a name="a160"></a><a class="code" href="rte__mempool_8h.html#a503f2f889043a48ca9995878846db2fd">rte_mempool_create</a>(mp_name,</div>
<div class="line">            nb_sess,</div>
<div class="line">            sess_sz,</div>
<div class="line">            CDEV_MP_CACHE_SZ,</div>
<div class="line">            0, NULL, NULL, NULL,</div>
<div class="line">            NULL, <a class="code" href="structrte__mempool.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>,</div>
<div class="line">            0);</div>
<div class="line">    ctx-&gt;session_priv_pool = sess_mp;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ctx-&gt;session_priv_pool == NULL)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE,</div>
<div class="line">            <span class="stringliteral">&quot;Cannot init session priv pool on socket %d\n&quot;</span>,</div>
<div class="line">            <a class="code" href="structrte__mempool.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Allocated session priv pool on socket %d\n&quot;</span>,</div>
<div class="line">            <a class="code" href="structrte__mempool.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">pool_init(<span class="keyword">struct</span> socket_ctx *ctx, int32_t <a class="code" href="structrte__mempool.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>, uint32_t nb_mbuf)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> s[64];</div>
<div class="line">    int32_t ms;</div>
<div class="line"> </div>
<div class="line">    snprintf(s, <span class="keyword">sizeof</span>(s), <span class="stringliteral">&quot;mbuf_pool_%d&quot;</span>, <a class="code" href="structrte__mempool.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line">    ctx-&gt;mbuf_pool = <a name="a161"></a><a class="code" href="rte__mbuf_8h.html#a593921f13307803b94bbb4e0932db962">rte_pktmbuf_pool_create</a>(s, nb_mbuf,</div>
<div class="line">            MEMPOOL_CACHE_SIZE, ipsec_metadata_size(),</div>
<div class="line">            frame_buf_size, <a class="code" href="structrte__mempool.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * if multi-segment support is enabled, then create a pool</span></div>
<div class="line"><span class="comment">     * for indirect mbufs.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    ms = multi_seg_required();</div>
<div class="line">    <span class="keywordflow">if</span> (ms != 0) {</div>
<div class="line">        snprintf(s, <span class="keyword">sizeof</span>(s), <span class="stringliteral">&quot;mbuf_pool_indir_%d&quot;</span>, <a class="code" href="structrte__mempool.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line">        ctx-&gt;mbuf_pool_indir = <a class="code" href="rte__mbuf_8h.html#a593921f13307803b94bbb4e0932db962">rte_pktmbuf_pool_create</a>(s, nb_mbuf,</div>
<div class="line">            MEMPOOL_CACHE_SIZE, 0, 0, <a class="code" href="structrte__mempool.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ctx-&gt;mbuf_pool == NULL || (ms != 0 &amp;&amp; ctx-&gt;mbuf_pool_indir == NULL))</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Cannot init mbuf pool on socket %d\n&quot;</span>,</div>
<div class="line">                <a class="code" href="structrte__mempool.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Allocated mbuf pool on socket %d\n&quot;</span>, <a class="code" href="structrte__mempool.html#a229cb0bd24215f0cb940e0724dbd4d55">socket_id</a>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span></div>
<div class="line">inline_ipsec_event_esn_overflow(<span class="keyword">struct</span> <a class="code" href="structrte__security__ctx.html">rte_security_ctx</a> *ctx, uint64_t md)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>ipsec_sa *sa;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* For inline protocol processing, the metadata in the event will</span></div>
<div class="line"><span class="comment">     * uniquely identify the security session which raised the event.</span></div>
<div class="line"><span class="comment">     * Application would then need the userdata it had registered with the</span></div>
<div class="line"><span class="comment">     * security session to process the event.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line"> </div>
<div class="line">    sa = (<span class="keyword">struct </span>ipsec_sa *)<a class="code" href="rte__security_8h.html#a8a5c2bea95a2ec95ce525d1a366d7133">rte_security_get_userdata</a>(ctx, md);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (sa == NULL) {</div>
<div class="line">        <span class="comment">/* userdata could not be retrieved */</span></div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Sequence number over flow. SA need to be re-established */</span></div>
<div class="line">    <a name="a162"></a><a class="code" href="rte__common_8h.html#aaedd6d14e7370916fee58e0f69d8c37a">RTE_SET_USED</a>(sa);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">inline_ipsec_event_callback(uint16_t port_id, <span class="keyword">enum</span> <a class="code" href="rte__ethdev_8h.html#a1e6788469a92700a583d06bf079d779d">rte_eth_event_type</a> type,</div>
<div class="line">         <span class="keywordtype">void</span> *param, <span class="keywordtype">void</span> *ret_param)</div>
<div class="line">{</div>
<div class="line">    uint64_t md;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a163"></a><a class="code" href="structrte__eth__event__ipsec__desc.html">rte_eth_event_ipsec_desc</a> *event_desc = NULL;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__security__ctx.html">rte_security_ctx</a> *ctx = (<span class="keyword">struct </span><a class="code" href="structrte__security__ctx.html">rte_security_ctx</a> *)</div>
<div class="line">                    <a class="code" href="rte__ethdev_8h.html#a539fa8ee80c94d538a42d951e4bcb00e">rte_eth_dev_get_sec_ctx</a>(port_id);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__common_8h.html#aaedd6d14e7370916fee58e0f69d8c37a">RTE_SET_USED</a>(param);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (type != <a name="a164"></a><a class="code" href="rte__ethdev_8h.html#a1e6788469a92700a583d06bf079d779da67808fda4e4561d661020bec76a67fdd">RTE_ETH_EVENT_IPSEC</a>)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    event_desc = ret_param;</div>
<div class="line">    <span class="keywordflow">if</span> (event_desc == NULL) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Event descriptor not set\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    md = event_desc-&gt;<a name="a165"></a><a class="code" href="structrte__eth__event__ipsec__desc.html#ab24d0e07dd55d2a2a380babfb08c0368">metadata</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (event_desc-&gt;<a name="a166"></a><a class="code" href="structrte__eth__event__ipsec__desc.html#a080a856c4deea914f22f617c714cef37">subtype</a> == <a name="a167"></a><a class="code" href="rte__ethdev_8h.html#a0449571f8fe2d8751f35999a5508f8beaa8bb18616ef0485c9fd7e493d6d909b2">RTE_ETH_EVENT_IPSEC_ESN_OVERFLOW</a>)</div>
<div class="line">        <span class="keywordflow">return</span> inline_ipsec_event_esn_overflow(ctx, md);</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event_desc-&gt;<a class="code" href="structrte__eth__event__ipsec__desc.html#a080a856c4deea914f22f617c714cef37">subtype</a> &gt;= <a name="a168"></a><a class="code" href="rte__ethdev_8h.html#a0449571f8fe2d8751f35999a5508f8bea66a7ea9e93381cdf133f6bd86fbd85df">RTE_ETH_EVENT_IPSEC_MAX</a>) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Invalid IPsec event reported\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint16_t</div>
<div class="line">rx_callback(<a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> uint16_t port, <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> uint16_t queue,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkt[], uint16_t nb_pkts,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> uint16_t max_pkts, <span class="keywordtype">void</span> *user_param)</div>
<div class="line">{</div>
<div class="line">    uint64_t tm;</div>
<div class="line">    uint32_t i, k;</div>
<div class="line">    <span class="keyword">struct </span>lcore_conf *lc;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *mb;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ether__hdr.html">rte_ether_hdr</a> *eth;</div>
<div class="line"> </div>
<div class="line">    lc = user_param;</div>
<div class="line">    k = 0;</div>
<div class="line">    tm = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i != nb_pkts; i++) {</div>
<div class="line"> </div>
<div class="line">        mb = pkt[i];</div>
<div class="line">        eth = <a class="code" href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a>(mb, <span class="keyword">struct</span> <a class="code" href="structrte__ether__hdr.html">rte_ether_hdr</a> *);</div>
<div class="line">        <span class="keywordflow">if</span> (eth-&gt;<a class="code" href="structrte__ether__hdr.html#ad6312397ccc57d322b1a037c7080d340">ether_type</a> == <a class="code" href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a>(<a class="code" href="rte__ether_8h.html#a15583fc4e341572ad37c8beace664ea8">RTE_ETHER_TYPE_IPV4</a>)) {</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">struct </span><a class="code" href="structrte__ipv4__hdr.html">rte_ipv4_hdr</a> *iph;</div>
<div class="line"> </div>
<div class="line">            iph = (<span class="keyword">struct </span><a class="code" href="structrte__ipv4__hdr.html">rte_ipv4_hdr</a> *)(eth + 1);</div>
<div class="line">            <span class="keywordflow">if</span> (<a name="a169"></a><a class="code" href="rte__ip__frag_8h.html#a20a18f3aadcc2f5bdd9ccdd306860ba5">rte_ipv4_frag_pkt_is_fragmented</a>(iph)) {</div>
<div class="line"> </div>
<div class="line">                mb-&gt;<a class="code" href="structrte__mbuf.html#aa25a7c259438b9eba28bcedc33846620">l2_len</a> = <span class="keyword">sizeof</span>(*eth);</div>
<div class="line">                mb-&gt;<a class="code" href="structrte__mbuf.html#a82a34cb6d5935a8c0f043f2783d6b42d">l3_len</a> = <span class="keyword">sizeof</span>(*iph);</div>
<div class="line">                tm = (tm != 0) ? tm : rte_rdtsc();</div>
<div class="line">                mb = <a name="a170"></a><a class="code" href="rte__ip__frag_8h.html#a2da601515eb520c7d11a9ca53d225003">rte_ipv4_frag_reassemble_packet</a>(</div>
<div class="line">                    lc-&gt;frag.tbl, &amp;lc-&gt;frag.dr,</div>
<div class="line">                    mb, tm, iph);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (mb != NULL) {</div>
<div class="line">                    <span class="comment">/* fix ip cksum after reassemble. */</span></div>
<div class="line">                    iph = <a class="code" href="rte__mbuf__core_8h.html#ad63e1de0ec54d7c7603ea984c76ca956">rte_pktmbuf_mtod_offset</a>(mb,</div>
<div class="line">                        <span class="keyword">struct</span> <a class="code" href="structrte__ipv4__hdr.html">rte_ipv4_hdr</a> *,</div>
<div class="line">                        mb-&gt;<a class="code" href="structrte__mbuf.html#aa25a7c259438b9eba28bcedc33846620">l2_len</a>);</div>
<div class="line">                    iph-&gt;<a name="a171"></a><a class="code" href="structrte__ipv4__hdr.html#a18eefe32b805f7416152441ec67533b9">hdr_checksum</a> = 0;</div>
<div class="line">                    iph-&gt;<a class="code" href="structrte__ipv4__hdr.html#a18eefe32b805f7416152441ec67533b9">hdr_checksum</a> = <a class="code" href="rte__ip_8h.html#a8be1ccea98d6afa79fe0c8531eb266f7">rte_ipv4_cksum</a>(iph);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (eth-&gt;<a class="code" href="structrte__ether__hdr.html#ad6312397ccc57d322b1a037c7080d340">ether_type</a> ==</div>
<div class="line">                <a class="code" href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a>(<a class="code" href="rte__ether_8h.html#ac386d430206de37dca641eaa5c0c74ac">RTE_ETHER_TYPE_IPV6</a>)) {</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">struct </span><a class="code" href="structrte__ipv6__hdr.html">rte_ipv6_hdr</a> *iph;</div>
<div class="line">            <span class="keyword">struct </span>ipv6_extension_fragment *fh;</div>
<div class="line"> </div>
<div class="line">            iph = (<span class="keyword">struct </span><a class="code" href="structrte__ipv6__hdr.html">rte_ipv6_hdr</a> *)(eth + 1);</div>
<div class="line">            fh = <a name="a172"></a><a class="code" href="rte__ip__frag_8h.html#a946fc05c631bedfaa390782a6bf89012">rte_ipv6_frag_get_ipv6_fragment_header</a>(iph);</div>
<div class="line">            <span class="keywordflow">if</span> (fh != NULL) {</div>
<div class="line">                mb-&gt;<a class="code" href="structrte__mbuf.html#aa25a7c259438b9eba28bcedc33846620">l2_len</a> = <span class="keyword">sizeof</span>(*eth);</div>
<div class="line">                mb-&gt;<a class="code" href="structrte__mbuf.html#a82a34cb6d5935a8c0f043f2783d6b42d">l3_len</a> = (uintptr_t)fh - (uintptr_t)iph +</div>
<div class="line">                    <span class="keyword">sizeof</span>(*fh);</div>
<div class="line">                tm = (tm != 0) ? tm : rte_rdtsc();</div>
<div class="line">                mb = <a name="a173"></a><a class="code" href="rte__ip__frag_8h.html#a3a5e68f12b9184d13950a7f685ec9aed">rte_ipv6_frag_reassemble_packet</a>(</div>
<div class="line">                    lc-&gt;frag.tbl, &amp;lc-&gt;frag.dr,</div>
<div class="line">                    mb, tm, iph, fh);</div>
<div class="line">                <span class="keywordflow">if</span> (mb != NULL)</div>
<div class="line">                    <span class="comment">/* fix l3_len after reassemble. */</span></div>
<div class="line">                    mb-&gt;<a class="code" href="structrte__mbuf.html#a82a34cb6d5935a8c0f043f2783d6b42d">l3_len</a> = mb-&gt;<a class="code" href="structrte__mbuf.html#a82a34cb6d5935a8c0f043f2783d6b42d">l3_len</a> - <span class="keyword">sizeof</span>(*fh);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        pkt[k] = mb;</div>
<div class="line">        k += (mb != NULL);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* some fragments were encountered, drain death row */</span></div>
<div class="line">    <span class="keywordflow">if</span> (tm != 0)</div>
<div class="line">        <a name="a174"></a><a class="code" href="rte__ip__frag_8h.html#af7d0a604738e3a8d5b7f3507c176510b">rte_ip_frag_free_death_row</a>(&amp;lc-&gt;frag.dr, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> k;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">reassemble_lcore_init(<span class="keyword">struct</span> lcore_conf *lc, uint32_t cid)</div>
<div class="line">{</div>
<div class="line">    int32_t sid;</div>
<div class="line">    uint32_t i;</div>
<div class="line">    uint64_t frag_cycles;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span>lcore_rx_queue *rxq;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span>rte_eth_rxtx_callback *cb;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* create fragment table */</span></div>
<div class="line">    sid = <a class="code" href="rte__lcore_8h.html#a023b4909f52c3cdf0351d71d2b5032bc">rte_lcore_to_socket_id</a>(cid);</div>
<div class="line">    frag_cycles = (<a class="code" href="rte__cycles_8h.html#ae016e608f344823e677819d8f04264c5">rte_get_tsc_hz</a>() + NS_PER_S - 1) /</div>
<div class="line">        NS_PER_S * frag_ttl_ns;</div>
<div class="line"> </div>
<div class="line">    lc-&gt;frag.tbl = <a name="a175"></a><a class="code" href="rte__ip__frag_8h.html#ad00c0949e82c8c4126d8565339b93350">rte_ip_frag_table_create</a>(frag_tbl_sz,</div>
<div class="line">        FRAG_TBL_BUCKET_ENTRIES, frag_tbl_sz, frag_cycles, sid);</div>
<div class="line">    <span class="keywordflow">if</span> (lc-&gt;frag.tbl == NULL) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;%s(%u): failed to create fragment table of size: %u, &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;error code: %d\n&quot;</span>,</div>
<div class="line">            __func__, cid, frag_tbl_sz, <a class="code" href="rte__errno_8h.html#a66171a00ea02084317df4dc9c2adaccb">rte_errno</a>);</div>
<div class="line">        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* setup reassemble RX callbacks for all queues */</span></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i != lc-&gt;nb_rx_queue; i++) {</div>
<div class="line"> </div>
<div class="line">        rxq = lc-&gt;rx_queue_list + i;</div>
<div class="line">        cb = <a name="a176"></a><a class="code" href="rte__ethdev_8h.html#adb70723c985c3ea177591b67cfc49178">rte_eth_add_rx_callback</a>(rxq-&gt;port_id, rxq-&gt;queue_id,</div>
<div class="line">            rx_callback, lc);</div>
<div class="line">        <span class="keywordflow">if</span> (cb == NULL) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;%s(%u): failed to install RX callback for &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;portid=%u, queueid=%u, error code: %d\n&quot;</span>,</div>
<div class="line">                __func__, cid,</div>
<div class="line">                rxq-&gt;port_id, rxq-&gt;queue_id, <a class="code" href="rte__errno_8h.html#a66171a00ea02084317df4dc9c2adaccb">rte_errno</a>);</div>
<div class="line">            <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">reassemble_init(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    int32_t rc;</div>
<div class="line">    uint32_t i, lc;</div>
<div class="line"> </div>
<div class="line">    rc = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i != nb_lcore_params; i++) {</div>
<div class="line">        lc = lcore_params[i].lcore_id;</div>
<div class="line">        rc = reassemble_lcore_init(lcore_conf + lc, lc);</div>
<div class="line">        <span class="keywordflow">if</span> (rc != 0)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> rc;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">create_default_ipsec_flow(uint16_t port_id, uint64_t rx_offloads)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>rte_flow_action action[2];</div>
<div class="line">    <span class="keyword">struct </span><a name="_a177"></a><a class="code" href="structrte__flow__item.html">rte_flow_item</a> pattern[2];</div>
<div class="line">    <span class="keyword">struct </span><a name="_a178"></a><a class="code" href="structrte__flow__attr.html">rte_flow_attr</a> attr = {0};</div>
<div class="line">    <span class="keyword">struct </span><a name="_a179"></a><a class="code" href="structrte__flow__error.html">rte_flow_error</a> err;</div>
<div class="line">    <span class="keyword">struct </span>rte_flow *flow;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!(rx_offloads &amp; DEV_RX_OFFLOAD_SECURITY))</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Add the default rte_flow to enable SECURITY for all ESP packets */</span></div>
<div class="line"> </div>
<div class="line">    pattern[0].<a name="a180"></a><a class="code" href="structrte__flow__error.html#a642435347234f209e6215370e3f90dd6">type</a> = <a name="a181"></a><a class="code" href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1a378d681349151b147a42ecfe0023f826">RTE_FLOW_ITEM_TYPE_ESP</a>;</div>
<div class="line">    pattern[0].spec = NULL;</div>
<div class="line">    pattern[0].mask = NULL;</div>
<div class="line">    pattern[0].last = NULL;</div>
<div class="line">    pattern[1].type = <a name="a182"></a><a class="code" href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1a51161f8ef75cba3968e32fc0472575d7">RTE_FLOW_ITEM_TYPE_END</a>;</div>
<div class="line"> </div>
<div class="line">    action[0].type = <a name="a183"></a><a class="code" href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aaac9738009ac5b299c3c4facdbdf66890">RTE_FLOW_ACTION_TYPE_SECURITY</a>;</div>
<div class="line">    action[0].conf = NULL;</div>
<div class="line">    action[1].type = <a name="a184"></a><a class="code" href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aa7bc270d4629785c13b81dccca71f67e3">RTE_FLOW_ACTION_TYPE_END</a>;</div>
<div class="line">    action[1].conf = NULL;</div>
<div class="line"> </div>
<div class="line">    attr.<a name="a185"></a><a class="code" href="structrte__flow__attr.html#ae4d19341d5298a2bc61f9eb941b1179c">ingress</a> = 1;</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a186"></a><a class="code" href="rte__flow_8h.html#a3fc6e9416462572d5a978e77d9ea2ec8">rte_flow_validate</a>(port_id, &amp;attr, pattern, action, &amp;err);</div>
<div class="line">    <span class="keywordflow">if</span> (ret)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    flow = <a name="a187"></a><a class="code" href="rte__flow_8h.html#a698ab49350e51414a31b9c511a7abe4e">rte_flow_create</a>(port_id, &amp;attr, pattern, action, &amp;err);</div>
<div class="line">    <span class="keywordflow">if</span> (flow == NULL)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    flow_info_tbl[port_id].rx_def_flow = flow;</div>
<div class="line">    <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(INFO, IPSEC,</div>
<div class="line">        <span class="stringliteral">&quot;Created default flow enabling SECURITY for all ESP traffic on port %d\n&quot;</span>,</div>
<div class="line">        port_id);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">signal_handler(<span class="keywordtype">int</span> signum)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (signum == SIGINT || signum == SIGTERM) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;\n\nSignal %d received, preparing to exit...\n&quot;</span>,</div>
<div class="line">                signum);</div>
<div class="line">        force_quit = <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">ev_mode_sess_verify(<span class="keyword">struct</span> ipsec_sa *sa, <span class="keywordtype">int</span> nb_sa)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a188"></a><a class="code" href="structrte__ipsec__session.html">rte_ipsec_session</a> *ips;</div>
<div class="line">    int32_t i;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!<a name="a189"></a><a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a> || !nb_sa)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; nb_sa; i++) {</div>
<div class="line">        ips = ipsec_get_primary_session(&amp;<a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>[i]);</div>
<div class="line">        <span class="keywordflow">if</span> (ips-&gt;<a name="a190"></a><a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> != <a name="a191"></a><a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f">RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</a>)</div>
<div class="line">            <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Event mode supports only &quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;inline protocol sessions\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> int32_t</div>
<div class="line">check_event_mode_params(<span class="keyword">struct</span> eh_conf *eh_conf)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>eventmode_conf *em_conf = NULL;</div>
<div class="line">    <span class="keyword">struct </span>lcore_params *params;</div>
<div class="line">    uint16_t portid;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!eh_conf || !eh_conf-&gt;mode_params)</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Get eventmode conf */</span></div>
<div class="line">    em_conf = eh_conf-&gt;mode_params;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (eh_conf-&gt;mode == EH_PKT_TRANSFER_MODE_POLL &amp;&amp;</div>
<div class="line">        em_conf-&gt;ext_params.sched_type != SCHED_TYPE_NOT_SET) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;error: option --event-schedule-type applies only to &quot;</span></div>
<div class="line">               <span class="stringliteral">&quot;event mode\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (eh_conf-&gt;mode != EH_PKT_TRANSFER_MODE_EVENT)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Set schedule type to ORDERED if it wasn&#39;t explicitly set by user */</span></div>
<div class="line">    <span class="keywordflow">if</span> (em_conf-&gt;ext_params.sched_type == SCHED_TYPE_NOT_SET)</div>
<div class="line">        em_conf-&gt;ext_params.sched_type = <a class="code" href="rte__eventdev_8h.html#a366ab13bc5be32cbc9ee15e294b4c9a2">RTE_SCHED_TYPE_ORDERED</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Event mode currently supports only inline protocol sessions.</span></div>
<div class="line"><span class="comment">     * If there are other types of sessions configured then exit with</span></div>
<div class="line"><span class="comment">     * error.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    ev_mode_sess_verify(sa_in, nb_sa_in);</div>
<div class="line">    ev_mode_sess_verify(sa_out, nb_sa_out);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Option --config does not apply to event mode */</span></div>
<div class="line">    <span class="keywordflow">if</span> (nb_lcore_params &gt; 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;error: option --config applies only to poll mode\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * In order to use the same port_init routine for both poll and event</span></div>
<div class="line"><span class="comment">     * modes initialize lcore_params with one queue for each eth port</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    lcore_params = lcore_params_array;</div>
<div class="line">    <a class="code" href="rte__ethdev_8h.html#ad7b46c67203d37fe3a34f11076d970d6">RTE_ETH_FOREACH_DEV</a>(portid) {</div>
<div class="line">        <span class="keywordflow">if</span> ((enabled_port_mask &amp; (1 &lt;&lt; portid)) == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        params = &amp;lcore_params[nb_lcore_params++];</div>
<div class="line">        params-&gt;port_id = portid;</div>
<div class="line">        params-&gt;queue_id = 0;</div>
<div class="line">        params-&gt;lcore_id = <a name="a192"></a><a class="code" href="rte__lcore_8h.html#acab656f5b00c29090db4500efabedd98">rte_get_next_lcore</a>(0, 0, 1);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">inline_sessions_free(<span class="keyword">struct</span> sa_ctx *sa_ctx)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__ipsec__session.html">rte_ipsec_session</a> *ips;</div>
<div class="line">    <span class="keyword">struct </span>ipsec_sa *sa;</div>
<div class="line">    int32_t ret;</div>
<div class="line">    uint32_t i;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!sa_ctx)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; sa_ctx-&gt;nb_sa; i++) {</div>
<div class="line"> </div>
<div class="line">        sa = &amp;sa_ctx-&gt;<a class="code" href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">sa</a>[i];</div>
<div class="line">        <span class="keywordflow">if</span> (!sa-&gt;spi)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        ips = ipsec_get_primary_session(sa);</div>
<div class="line">        <span class="keywordflow">if</span> (ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> != <a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f">RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</a> &amp;&amp;</div>
<div class="line">            ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a> != <a name="a193"></a><a class="code" href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116">RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</a>)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="rte__ethdev_8h.html#a22dcfd3f5f2b34f657131d66132e23a7">rte_eth_dev_is_valid_port</a>(sa-&gt;portid))</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        ret = <a name="a194"></a><a class="code" href="rte__security_8h.html#a7718e5b890596236eb5696a646373b24">rte_security_session_destroy</a>(</div>
<div class="line">                <a class="code" href="rte__ethdev_8h.html#a539fa8ee80c94d538a42d951e4bcb00e">rte_eth_dev_get_sec_ctx</a>(sa-&gt;portid),</div>
<div class="line">                ips-&gt;<a name="a195"></a>security.ses);</div>
<div class="line">        <span class="keywordflow">if</span> (ret)</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC, <span class="stringliteral">&quot;Failed to destroy security &quot;</span></div>
<div class="line">                        <span class="stringliteral">&quot;session type %d, spi %d\n&quot;</span>,</div>
<div class="line">                        ips-&gt;<a class="code" href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">type</a>, sa-&gt;spi);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">calculate_nb_mbufs(uint16_t nb_ports, uint16_t nb_crypto_qp, uint32_t nb_rxq,</div>
<div class="line">        uint32_t nb_txq)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="rte__common_8h.html#a8df8b303b8ea240cf6aebf937fd21eaf">RTE_MAX</a>((nb_rxq * nb_rxd +</div>
<div class="line">            nb_ports * nb_lcores * MAX_PKT_BURST +</div>
<div class="line">            nb_ports * nb_txq * nb_txd +</div>
<div class="line">            nb_lcores * MEMPOOL_CACHE_SIZE +</div>
<div class="line">            nb_crypto_qp * CDEV_QUEUE_DESC +</div>
<div class="line">            nb_lcores * frag_tbl_sz *</div>
<div class="line">            FRAG_TBL_BUCKET_ENTRIES),</div>
<div class="line">               8192U);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">int32_t</div>
<div class="line">main(int32_t argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">    int32_t ret;</div>
<div class="line">    uint32_t lcore_id, nb_txq, nb_rxq = 0;</div>
<div class="line">    uint32_t cdev_id;</div>
<div class="line">    uint32_t i;</div>
<div class="line">    uint8_t socket_id;</div>
<div class="line">    uint16_t portid, nb_crypto_qp, nb_ports = 0;</div>
<div class="line">    uint64_t req_rx_offloads[RTE_MAX_ETHPORTS];</div>
<div class="line">    uint64_t req_tx_offloads[RTE_MAX_ETHPORTS];</div>
<div class="line">    <span class="keyword">struct </span>eh_conf *eh_conf = NULL;</div>
<div class="line">    <span class="keywordtype">size_t</span> sess_sz;</div>
<div class="line"> </div>
<div class="line">    nb_bufs_in_pool = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* init EAL */</span></div>
<div class="line">    ret = <a name="a196"></a><a class="code" href="rte__eal_8h.html#a5c3f4dddc25e38c5a186ecd8a69260e3">rte_eal_init</a>(argc, argv);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Invalid EAL parameters\n&quot;</span>);</div>
<div class="line">    argc -= ret;</div>
<div class="line">    argv += ret;</div>
<div class="line"> </div>
<div class="line">    force_quit = <span class="keyword">false</span>;</div>
<div class="line">    signal(SIGINT, signal_handler);</div>
<div class="line">    signal(SIGTERM, signal_handler);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* initialize event helper configuration */</span></div>
<div class="line">    eh_conf = eh_conf_init();</div>
<div class="line">    <span class="keywordflow">if</span> (eh_conf == NULL)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Failed to init event helper config&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* parse application arguments (after the EAL ones) */</span></div>
<div class="line">    ret = parse_args(argc, argv, eh_conf);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Invalid parameters\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* parse configuration file */</span></div>
<div class="line">    <span class="keywordflow">if</span> (parse_cfg_file(cfgfile) &lt; 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;parsing file \&quot;%s\&quot; failed\n&quot;</span>,</div>
<div class="line">            optarg);</div>
<div class="line">        print_usage(argv[0]);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((unprotected_port_mask &amp; enabled_port_mask) !=</div>
<div class="line">            unprotected_port_mask)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;Invalid unprotected portmask 0x%x\n&quot;</span>,</div>
<div class="line">                unprotected_port_mask);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (check_poll_mode_params(eh_conf) &lt; 0)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;check_poll_mode_params failed\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (check_event_mode_params(eh_conf) &lt; 0)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;check_event_mode_params failed\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    ret = init_lcore_rx_queues();</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;init_lcore_rx_queues failed\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    nb_lcores = <a class="code" href="rte__lcore_8h.html#a1728dc7f14571ba778d3b5b41aa09283">rte_lcore_count</a>();</div>
<div class="line"> </div>
<div class="line">    sess_sz = max_session_size();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * In event mode request minimum number of crypto queues</span></div>
<div class="line"><span class="comment">     * to be reserved equal to number of ports.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordflow">if</span> (eh_conf-&gt;mode == EH_PKT_TRANSFER_MODE_EVENT)</div>
<div class="line">        nb_crypto_qp = <a name="a197"></a><a class="code" href="rte__ethdev_8h.html#a9ab708089665bebcd65cefe5383b24f2">rte_eth_dev_count_avail</a>();</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        nb_crypto_qp = 0;</div>
<div class="line"> </div>
<div class="line">    nb_crypto_qp = cryptodevs_init(nb_crypto_qp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (nb_bufs_in_pool == 0) {</div>
<div class="line">        <a class="code" href="rte__ethdev_8h.html#ad7b46c67203d37fe3a34f11076d970d6">RTE_ETH_FOREACH_DEV</a>(portid) {</div>
<div class="line">            <span class="keywordflow">if</span> ((enabled_port_mask &amp; (1 &lt;&lt; portid)) == 0)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            nb_ports++;</div>
<div class="line">            nb_rxq += get_port_nb_rx_queues(portid);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        nb_txq = nb_lcores;</div>
<div class="line"> </div>
<div class="line">        nb_bufs_in_pool = calculate_nb_mbufs(nb_ports, nb_crypto_qp,</div>
<div class="line">                        nb_rxq, nb_txq);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (lcore_id = 0; lcore_id &lt; RTE_MAX_LCORE; lcore_id++) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="rte__lcore_8h.html#a5404ee6ac26cbe5a4f4ddef44d690b76">rte_lcore_is_enabled</a>(lcore_id) == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (numa_on)</div>
<div class="line">            socket_id = (uint8_t)<a class="code" href="rte__lcore_8h.html#a023b4909f52c3cdf0351d71d2b5032bc">rte_lcore_to_socket_id</a>(lcore_id);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            socket_id = 0;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* mbuf_pool is initialised by the pool_init() function*/</span></div>
<div class="line">        <span class="keywordflow">if</span> (socket_ctx[socket_id].mbuf_pool)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        pool_init(&amp;socket_ctx[socket_id], socket_id, nb_bufs_in_pool);</div>
<div class="line">        session_pool_init(&amp;socket_ctx[socket_id], socket_id, sess_sz);</div>
<div class="line">        session_priv_pool_init(&amp;socket_ctx[socket_id], socket_id,</div>
<div class="line">            sess_sz);</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;Number of mbufs in packet pool %d\n&quot;</span>, nb_bufs_in_pool);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__ethdev_8h.html#ad7b46c67203d37fe3a34f11076d970d6">RTE_ETH_FOREACH_DEV</a>(portid) {</div>
<div class="line">        <span class="keywordflow">if</span> ((enabled_port_mask &amp; (1 &lt;&lt; portid)) == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        sa_check_offloads(portid, &amp;req_rx_offloads[portid],</div>
<div class="line">                &amp;req_tx_offloads[portid]);</div>
<div class="line">        port_init(portid, req_rx_offloads[portid],</div>
<div class="line">                req_tx_offloads[portid]);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Set the enabled port mask in helper config for use by helper</span></div>
<div class="line"><span class="comment">     * sub-system. This will be used while initializing devices using</span></div>
<div class="line"><span class="comment">     * helper sub-system.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    eh_conf-&gt;eth_portmask = enabled_port_mask;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Initialize eventmode components */</span></div>
<div class="line">    ret = eh_devs_init(eh_conf);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;eh_devs_init failed, err=%d\n&quot;</span>, ret);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* start ports */</span></div>
<div class="line">    <a class="code" href="rte__ethdev_8h.html#ad7b46c67203d37fe3a34f11076d970d6">RTE_ETH_FOREACH_DEV</a>(portid) {</div>
<div class="line">        <span class="keywordflow">if</span> ((enabled_port_mask &amp; (1 &lt;&lt; portid)) == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Create flow before starting the device */</span></div>
<div class="line">        create_default_ipsec_flow(portid, req_rx_offloads[portid]);</div>
<div class="line"> </div>
<div class="line">        ret = <a name="a198"></a><a class="code" href="rte__ethdev_8h.html#afdc834c1c52e9fb512301990468ca7c2">rte_eth_dev_start</a>(portid);</div>
<div class="line">        <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">            <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;rte_eth_dev_start: &quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;err=%d, port=%d\n&quot;</span>, ret, portid);</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * If enabled, put device in promiscuous mode.</span></div>
<div class="line"><span class="comment">         * This allows IO forwarding mode to forward packets</span></div>
<div class="line"><span class="comment">         * to itself through 2 cross-connected  ports of the</span></div>
<div class="line"><span class="comment">         * target machine.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> (promiscuous_on) {</div>
<div class="line">            ret = <a name="a199"></a><a class="code" href="rte__ethdev_8h.html#a5dd1dedaa45f05c72bcc35495e441e91">rte_eth_promiscuous_enable</a>(portid);</div>
<div class="line">            <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line">                <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE,</div>
<div class="line">                    <span class="stringliteral">&quot;rte_eth_promiscuous_enable: err=%s, port=%d\n&quot;</span>,</div>
<div class="line">                    <a class="code" href="rte__errno_8h.html#a129a7eb4cfa1f5bdac5783bf49137d06">rte_strerror</a>(-ret), portid);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a name="a200"></a><a class="code" href="rte__ethdev_8h.html#ac0bef2920a6ade4041cab5103f4700d9">rte_eth_dev_callback_register</a>(portid,</div>
<div class="line">            <a class="code" href="rte__ethdev_8h.html#a1e6788469a92700a583d06bf079d779da67808fda4e4561d661020bec76a67fdd">RTE_ETH_EVENT_IPSEC</a>, inline_ipsec_event_callback, NULL);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* fragment reassemble is enabled */</span></div>
<div class="line">    <span class="keywordflow">if</span> (frag_tbl_sz != 0) {</div>
<div class="line">        ret = reassemble_init();</div>
<div class="line">        <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line">            <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;failed at reassemble init&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Replicate each context per socket */</span></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; NB_SOCKETS &amp;&amp; i &lt; <a name="a201"></a><a class="code" href="rte__lcore_8h.html#ad6a4c3ec1b15d0658f4b3b755eb4fd40">rte_socket_count</a>(); i++) {</div>
<div class="line">        socket_id = <a name="a202"></a><a class="code" href="rte__lcore_8h.html#a688a671a9fb6c79203de98c684d6e7f2">rte_socket_id_by_idx</a>(i);</div>
<div class="line">        <span class="keywordflow">if</span> ((socket_ctx[socket_id].mbuf_pool != NULL) &amp;&amp;</div>
<div class="line">            (socket_ctx[socket_id].sa_in == NULL) &amp;&amp;</div>
<div class="line">            (socket_ctx[socket_id].sa_out == NULL)) {</div>
<div class="line">            sa_init(&amp;socket_ctx[socket_id], socket_id);</div>
<div class="line">            sp4_init(&amp;socket_ctx[socket_id], socket_id);</div>
<div class="line">            sp6_init(&amp;socket_ctx[socket_id], socket_id);</div>
<div class="line">            rt_init(&amp;socket_ctx[socket_id], socket_id);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    flow_init();</div>
<div class="line"> </div>
<div class="line">    check_all_ports_link_status(enabled_port_mask);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#if (STATS_INTERVAL &gt; 0)</span></div>
<div class="line">    <a class="code" href="rte__alarm_8h.html#a2dcad28ea9331067662351b36d5877e5">rte_eal_alarm_set</a>(STATS_INTERVAL * US_PER_S, print_stats_cb, NULL);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(INFO, IPSEC, <span class="stringliteral">&quot;Stats display disabled\n&quot;</span>);</div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">/* STATS_INTERVAL */</span><span class="preprocessor"></span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* launch per-lcore init on every lcore */</span></div>
<div class="line">    <a name="a203"></a><a class="code" href="rte__launch_8h.html#acc0b1cfdc31fa73329acd51dcea31210">rte_eal_mp_remote_launch</a>(ipsec_launch_one_lcore, eh_conf, <a name="a204"></a><a class="code" href="rte__launch_8h.html#a7fe96b0e5d3a6a8cf9b8d1a27cf3f159ad00c59bb386320b2ba3198d3149a0c35">CALL_MAIN</a>);</div>
<div class="line">    <a name="a205"></a><a class="code" href="rte__lcore_8h.html#ac779e61584eb9d087c3e20bf2d1150c8">RTE_LCORE_FOREACH_WORKER</a>(lcore_id) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a206"></a><a class="code" href="rte__launch_8h.html#ae9500e1d35bd4cfb95d18c0be863cb1e">rte_eal_wait_lcore</a>(lcore_id) &lt; 0)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Uninitialize eventmode components */</span></div>
<div class="line">    ret = eh_devs_uninit(eh_conf);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <a class="code" href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a>(EXIT_FAILURE, <span class="stringliteral">&quot;eh_devs_uninit failed, err=%d\n&quot;</span>, ret);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free eventmode configuration memory */</span></div>
<div class="line">    eh_conf_uninit(eh_conf);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Destroy inline inbound and outbound sessions */</span></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; NB_SOCKETS &amp;&amp; i &lt; <a class="code" href="rte__lcore_8h.html#ad6a4c3ec1b15d0658f4b3b755eb4fd40">rte_socket_count</a>(); i++) {</div>
<div class="line">        socket_id = <a class="code" href="rte__lcore_8h.html#a688a671a9fb6c79203de98c684d6e7f2">rte_socket_id_by_idx</a>(i);</div>
<div class="line">        inline_sessions_free(socket_ctx[socket_id].sa_in);</div>
<div class="line">        inline_sessions_free(socket_ctx[socket_id].sa_out);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (cdev_id = 0; cdev_id &lt; <a class="code" href="rte__cryptodev_8h.html#a1a0c23adc25339b56bd19242194a002f">rte_cryptodev_count</a>(); cdev_id++) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Closing cryptodev %d...&quot;</span>, cdev_id);</div>
<div class="line">        <a name="a207"></a><a class="code" href="rte__cryptodev_8h.html#a397b9f2873f0e82b1d3e18b49e03e1b4">rte_cryptodev_stop</a>(cdev_id);</div>
<div class="line">        <a name="a208"></a><a class="code" href="rte__cryptodev_8h.html#a05c7cc66ab3a89549b1c2a03eaa23568">rte_cryptodev_close</a>(cdev_id);</div>
<div class="line">        printf(<span class="stringliteral">&quot; Done\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="rte__ethdev_8h.html#ad7b46c67203d37fe3a34f11076d970d6">RTE_ETH_FOREACH_DEV</a>(portid) {</div>
<div class="line">        <span class="keywordflow">if</span> ((enabled_port_mask &amp; (1 &lt;&lt; portid)) == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        printf(<span class="stringliteral">&quot;Closing port %d...&quot;</span>, portid);</div>
<div class="line">        <span class="keywordflow">if</span> (flow_info_tbl[portid].rx_def_flow) {</div>
<div class="line">            <span class="keyword">struct </span><a class="code" href="structrte__flow__error.html">rte_flow_error</a> err;</div>
<div class="line"> </div>
<div class="line">            ret = <a name="a209"></a><a class="code" href="rte__flow_8h.html#a0446d6e5f60844b7729d0fafdf165403">rte_flow_destroy</a>(portid,</div>
<div class="line">                flow_info_tbl[portid].rx_def_flow, &amp;err);</div>
<div class="line">            <span class="keywordflow">if</span> (ret)</div>
<div class="line">                <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC, <span class="stringliteral">&quot;Failed to destroy flow &quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot; for port %u, err msg: %s\n&quot;</span>, portid,</div>
<div class="line">                    err.message);</div>
<div class="line">        }</div>
<div class="line">        ret = <a name="a210"></a><a class="code" href="rte__ethdev_8h.html#a6fc010cf6216331c50bc02d2fd4e614f">rte_eth_dev_stop</a>(portid);</div>
<div class="line">        <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line">            <a class="code" href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a>(ERR, IPSEC,</div>
<div class="line">                <span class="stringliteral">&quot;rte_eth_dev_stop: err=%s, port=%u\n&quot;</span>,</div>
<div class="line">                <a class="code" href="rte__errno_8h.html#a129a7eb4cfa1f5bdac5783bf49137d06">rte_strerror</a>(-ret), portid);</div>
<div class="line"> </div>
<div class="line">        <a name="a211"></a><a class="code" href="rte__ethdev_8h.html#ac2c7507787a5520e8049fff94432169e">rte_eth_dev_close</a>(portid);</div>
<div class="line">        printf(<span class="stringliteral">&quot; Done\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;Bye...\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="arte__common_8h_html_a8df8b303b8ea240cf6aebf937fd21eaf"><div class="ttname"><a href="rte__common_8h.html#a8df8b303b8ea240cf6aebf937fd21eaf">RTE_MAX</a></div><div class="ttdeci">#define RTE_MAX(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00583">rte_common.h:583</a></div></div>
<div class="ttc" id="arte__hash_8h_html"><div class="ttname"><a href="rte__hash_8h.html">rte_hash.h</a></div></div>
<div class="ttc" id="astructrte__cryptodev__info_html"><div class="ttname"><a href="structrte__cryptodev__info.html">rte_cryptodev_info</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00477">rte_cryptodev.h:477</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a5f51139368b8d1a2c22fdecd90bc4d98"><div class="ttname"><a href="rte__ethdev_8h.html#a5f51139368b8d1a2c22fdecd90bc4d98">rte_eth_link_to_str</a></div><div class="ttdeci">__rte_experimental int rte_eth_link_to_str(char *str, size_t len, const struct rte_eth_link *eth_link)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_ad31219b87a1733d5b367a7c04c7f7b48"><div class="ttname"><a href="rte__ethdev_8h.html#ad31219b87a1733d5b367a7c04c7f7b48">rte_eth_dev_adjust_nb_rx_tx_desc</a></div><div class="ttdeci">int rte_eth_dev_adjust_nb_rx_tx_desc(uint16_t port_id, uint16_t *nb_rx_desc, uint16_t *nb_tx_desc)</div></div>
<div class="ttc" id="astructrte__ether__hdr_html_acce632e0fded0f728a1ee1a1ffb5c9bf"><div class="ttname"><a href="structrte__ether__hdr.html#acce632e0fded0f728a1ee1a1ffb5c9bf">rte_ether_hdr::s_addr</a></div><div class="ttdeci">struct rte_ether_addr s_addr</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00000">rte_ether.h:266</a></div></div>
<div class="ttc" id="arte__lpm6_8h_html_aa9c2737e965c4ba60b2ded90e87b75ab"><div class="ttname"><a href="rte__lpm6_8h.html#aa9c2737e965c4ba60b2ded90e87b75ab">rte_lpm6_lookup_bulk_func</a></div><div class="ttdeci">int rte_lpm6_lookup_bulk_func(const struct rte_lpm6 *lpm, uint8_t ips[][RTE_LPM6_IPV6_ADDR_SIZE], int32_t *next_hops, unsigned int n)</div></div>
<div class="ttc" id="astructrte__eth__rxconf_html"><div class="ttname"><a href="structrte__eth__rxconf.html">rte_eth_rxconf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01032">rte_ethdev.h:1032</a></div></div>
<div class="ttc" id="arte__security_8h_html"><div class="ttname"><a href="rte__security_8h.html">rte_security.h</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a35b7466d51590b9c30fc40134b043ba7"><div class="ttname"><a href="rte__ethdev_8h.html#a35b7466d51590b9c30fc40134b043ba7">DEV_TX_OFFLOAD_MULTI_SEGS</a></div><div class="ttdeci">#define DEV_TX_OFFLOAD_MULTI_SEGS</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01396">rte_ethdev.h:1395</a></div></div>
<div class="ttc" id="arte__lpm_8h_html"><div class="ttname"><a href="rte__lpm_8h.html">rte_lpm.h</a></div></div>
<div class="ttc" id="arte__lcore_8h_html_a5404ee6ac26cbe5a4f4ddef44d690b76"><div class="ttname"><a href="rte__lcore_8h.html#a5404ee6ac26cbe5a4f4ddef44d690b76">rte_lcore_is_enabled</a></div><div class="ttdeci">int rte_lcore_is_enabled(unsigned int lcore_id)</div></div>
<div class="ttc" id="arte__prefetch_8h_html_a7f89cf66766e6bfd63feb370a7280de9"><div class="ttname"><a href="rte__prefetch_8h.html#a7f89cf66766e6bfd63feb370a7280de9">rte_prefetch0</a></div><div class="ttdeci">static void rte_prefetch0(const volatile void *p)</div></div>
<div class="ttc" id="astructrte__hash__parameters_html"><div class="ttname"><a href="structrte__hash__parameters.html">rte_hash_parameters</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__hash_8h_source.html#l00082">rte_hash.h:82</a></div></div>
<div class="ttc" id="arte__byteorder_8h_html_a6ec4cb000fc67785792d18728cf45563"><div class="ttname"><a href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a></div><div class="ttdeci">static rte_be16_t rte_cpu_to_be_16(uint16_t x)</div></div>
<div class="ttc" id="astructrte__cryptodev__capabilities_html"><div class="ttname"><a href="structrte__cryptodev__capabilities.html">rte_cryptodev_capabilities</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00178">rte_cryptodev.h:178</a></div></div>
<div class="ttc" id="arte__ip__frag_8h_html_a946fc05c631bedfaa390782a6bf89012"><div class="ttname"><a href="rte__ip__frag_8h.html#a946fc05c631bedfaa390782a6bf89012">rte_ipv6_frag_get_ipv6_fragment_header</a></div><div class="ttdeci">static struct ipv6_extension_fragment * rte_ipv6_frag_get_ipv6_fragment_header(struct rte_ipv6_hdr *hdr)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ip__frag_8h_source.html#l00215">rte_ip_frag.h:215</a></div></div>
<div class="ttc" id="arte__branch__prediction_8h_html_ac6c45889010c1bd68631771b64f18101"><div class="ttname"><a href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a></div><div class="ttdeci">#define unlikely(x)</div><div class="ttdef"><b>Definition:</b> <a href="rte__branch__prediction_8h_source.html#l00038">rte_branch_prediction.h:38</a></div></div>
<div class="ttc" id="arte__security_8h_html_a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f"><div class="ttname"><a href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a5d678422b0a6add180d391941b82bb9f">RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</a></div><div class="ttdeci">@ RTE_SECURITY_ACTION_TYPE_INLINE_PROTOCOL</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00340">rte_security.h:337</a></div></div>
<div class="ttc" id="arte__ether_8h_html_af5cfe384bccf79d966ae861ccdf34923"><div class="ttname"><a href="rte__ether_8h.html#af5cfe384bccf79d966ae861ccdf34923">rte_ether_format_addr</a></div><div class="ttdeci">void rte_ether_format_addr(char *buf, uint16_t size, const struct rte_ether_addr *eth_addr)</div></div>
<div class="ttc" id="arte__launch_8h_html_acc0b1cfdc31fa73329acd51dcea31210"><div class="ttname"><a href="rte__launch_8h.html#acc0b1cfdc31fa73329acd51dcea31210">rte_eal_mp_remote_launch</a></div><div class="ttdeci">int rte_eal_mp_remote_launch(lcore_function_t *f, void *arg, enum rte_rmt_call_main_t call_main)</div></div>
<div class="ttc" id="astructrte__ether__hdr_html_ad6312397ccc57d322b1a037c7080d340"><div class="ttname"><a href="structrte__ether__hdr.html#ad6312397ccc57d322b1a037c7080d340">rte_ether_hdr::ether_type</a></div><div class="ttdeci">uint16_t ether_type</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00267">rte_ether.h:267</a></div></div>
<div class="ttc" id="astructrte__flow__attr_html_ae4d19341d5298a2bc61f9eb941b1179c"><div class="ttname"><a href="structrte__flow__attr.html#ae4d19341d5298a2bc61f9eb941b1179c">rte_flow_attr::ingress</a></div><div class="ttdeci">uint32_t ingress</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l00079">rte_flow.h:79</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_a0e75f18703d94db97f61db2e1fce51e8"><div class="ttname"><a href="rte__mbuf_8h.html#a0e75f18703d94db97f61db2e1fce51e8">rte_mbuf_prefetch_part2</a></div><div class="ttdeci">static void rte_mbuf_prefetch_part2(struct rte_mbuf *m)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l00128">rte_mbuf.h:128</a></div></div>
<div class="ttc" id="arte__lcore_8h_html"><div class="ttname"><a href="rte__lcore_8h.html">rte_lcore.h</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a539fa8ee80c94d538a42d951e4bcb00e"><div class="ttname"><a href="rte__ethdev_8h.html#a539fa8ee80c94d538a42d951e4bcb00e">rte_eth_dev_get_sec_ctx</a></div><div class="ttdeci">void * rte_eth_dev_get_sec_ctx(uint16_t port_id)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a1e6788469a92700a583d06bf079d779da67808fda4e4561d661020bec76a67fdd"><div class="ttname"><a href="rte__ethdev_8h.html#a1e6788469a92700a583d06bf079d779da67808fda4e4561d661020bec76a67fdd">RTE_ETH_EVENT_IPSEC</a></div><div class="ttdeci">@ RTE_ETH_EVENT_IPSEC</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l03466">rte_ethdev.h:3466</a></div></div>
<div class="ttc" id="arte__mempool_8h_html_a503f2f889043a48ca9995878846db2fd"><div class="ttname"><a href="rte__mempool_8h.html#a503f2f889043a48ca9995878846db2fd">rte_mempool_create</a></div><div class="ttdeci">struct rte_mempool * rte_mempool_create(const char *name, unsigned n, unsigned elt_size, unsigned cache_size, unsigned private_data_size, rte_mempool_ctor_t *mp_init, void *mp_init_arg, rte_mempool_obj_cb_t *obj_init, void *obj_init_arg, int socket_id, unsigned flags)</div></div>
<div class="ttc" id="astructrte__ipv4__hdr_html_a18eefe32b805f7416152441ec67533b9"><div class="ttname"><a href="structrte__ipv4__hdr.html#a18eefe32b805f7416152441ec67533b9">rte_ipv4_hdr::hdr_checksum</a></div><div class="ttdeci">rte_be16_t hdr_checksum</div><div class="ttdef"><b>Definition:</b> <a href="rte__ip_8h_source.html#l00041">rte_ip.h:41</a></div></div>
<div class="ttc" id="arte__lcore_8h_html_a7c8da4664df26a64cf05dc508a4f26df"><div class="ttname"><a href="rte__lcore_8h.html#a7c8da4664df26a64cf05dc508a4f26df">rte_socket_id</a></div><div class="ttdeci">unsigned int rte_socket_id(void)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a4834f572f4dd4e46d81ad09b7d5fffd5aada568551470d5f419cd2f3d6b6bfedc"><div class="ttname"><a href="rte__ethdev_8h.html#a4834f572f4dd4e46d81ad09b7d5fffd5aada568551470d5f419cd2f3d6b6bfedc">ETH_MQ_TX_NONE</a></div><div class="ttdeci">@ ETH_MQ_TX_NONE</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00384">rte_ethdev.h:384</a></div></div>
<div class="ttc" id="astructrte__eth__event__ipsec__desc_html_a080a856c4deea914f22f617c714cef37"><div class="ttname"><a href="structrte__eth__event__ipsec__desc.html#a080a856c4deea914f22f617c714cef37">rte_eth_event_ipsec_desc::subtype</a></div><div class="ttdeci">enum rte_eth_event_ipsec_subtype subtype</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l03276">rte_ethdev.h:3433</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_aeb677c03cea6fcc48a8caa533e3729f9"><div class="ttname"><a href="rte__cryptodev_8h.html#aeb677c03cea6fcc48a8caa533e3729f9">rte_cryptodev_info_get</a></div><div class="ttdeci">void rte_cryptodev_info_get(uint8_t dev_id, struct rte_cryptodev_info *dev_info)</div></div>
<div class="ttc" id="arte__lpm6_8h_html"><div class="ttname"><a href="rte__lpm6_8h.html">rte_lpm6.h</a></div></div>
<div class="ttc" id="arte__mbuf__ptype_8h_html_a44e077cfdb3846a3ca63c5039586b9e5"><div class="ttname"><a href="rte__mbuf__ptype_8h.html#a44e077cfdb3846a3ca63c5039586b9e5">RTE_PTYPE_L3_IPV6</a></div><div class="ttdeci">#define RTE_PTYPE_L3_IPV6</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__ptype_8h_source.html#l00181">rte_mbuf_ptype.h:181</a></div></div>
<div class="ttc" id="arte__ip__frag_8h_html_a2da601515eb520c7d11a9ca53d225003"><div class="ttname"><a href="rte__ip__frag_8h.html#a2da601515eb520c7d11a9ca53d225003">rte_ipv4_frag_reassemble_packet</a></div><div class="ttdeci">struct rte_mbuf * rte_ipv4_frag_reassemble_packet(struct rte_ip_frag_tbl *tbl, struct rte_ip_frag_death_row *dr, struct rte_mbuf *mb, uint64_t tms, struct rte_ipv4_hdr *ip_hdr)</div></div>
<div class="ttc" id="arte__log_8h_html"><div class="ttname"><a href="rte__log_8h.html">rte_log.h</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a796c2f20778984c6f41b271e36bae50e"><div class="ttname"><a href="rte__ethdev_8h.html#a796c2f20778984c6f41b271e36bae50e">rte_eth_tx_queue_setup</a></div><div class="ttdeci">int rte_eth_tx_queue_setup(uint16_t port_id, uint16_t tx_queue_id, uint16_t nb_tx_desc, unsigned int socket_id, const struct rte_eth_txconf *tx_conf)</div></div>
<div class="ttc" id="astructrte__eth__txconf_html"><div class="ttname"><a href="structrte__eth__txconf.html">rte_eth_txconf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01060">rte_ethdev.h:1060</a></div></div>
<div class="ttc" id="arte__crypto_8h_html_ae6cf2c3fcd46c5ef3a43fbcb8b658739ad7a72984dd85b1c8b59cad6971b02248"><div class="ttname"><a href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739ad7a72984dd85b1c8b59cad6971b02248">RTE_CRYPTO_OP_TYPE_UNDEFINED</a></div><div class="ttdeci">@ RTE_CRYPTO_OP_TYPE_UNDEFINED</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00031">rte_crypto.h:30</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a1a7d3a20b102fee222541fda50fd87bd"><div class="ttname"><a href="rte__ethdev_8h.html#a1a7d3a20b102fee222541fda50fd87bd">rte_eth_dev_configure</a></div><div class="ttdeci">int rte_eth_dev_configure(uint16_t port_id, uint16_t nb_rx_queue, uint16_t nb_tx_queue, const struct rte_eth_conf *eth_conf)</div></div>
<div class="ttc" id="astructrte__ipv6__hdr_html_a7c49a9ddd6ae97a291bc48251c74da19"><div class="ttname"><a href="structrte__ipv6__hdr.html#a7c49a9ddd6ae97a291bc48251c74da19">rte_ipv6_hdr::payload_len</a></div><div class="ttdeci">rte_be16_t payload_len</div><div class="ttdef"><b>Definition:</b> <a href="rte__ip_8h_source.html#l00389">rte_ip.h:389</a></div></div>
<div class="ttc" id="astructrte__eth__rxmode_html_a84a5d32306b86a1df884144612c70726"><div class="ttname"><a href="structrte__eth__rxmode.html#a84a5d32306b86a1df884144612c70726">rte_eth_rxmode::max_rx_pkt_len</a></div><div class="ttdeci">uint32_t max_rx_pkt_len</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00403">rte_ethdev.h:403</a></div></div>
<div class="ttc" id="arte__errno_8h_html_a129a7eb4cfa1f5bdac5783bf49137d06"><div class="ttname"><a href="rte__errno_8h.html#a129a7eb4cfa1f5bdac5783bf49137d06">rte_strerror</a></div><div class="ttdeci">const char * rte_strerror(int errnum)</div></div>
<div class="ttc" id="arte__jhash_8h_html"><div class="ttname"><a href="rte__jhash_8h.html">rte_jhash.h</a></div></div>
<div class="ttc" id="arte__string__fns_8h_html_af3ffc4e2ca821bc44f7fd08afbfe3638"><div class="ttname"><a href="rte__string__fns_8h.html#af3ffc4e2ca821bc44f7fd08afbfe3638">rte_strsplit</a></div><div class="ttdeci">int rte_strsplit(char *string, int stringlen, char **tokens, int maxtokens, char delim)</div></div>
<div class="ttc" id="astructrte__security__ctx_html"><div class="ttname"><a href="structrte__security__ctx.html">rte_security_ctx</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00067">rte_security.h:67</a></div></div>
<div class="ttc" id="arte__acl_8h_html"><div class="ttname"><a href="rte__acl_8h.html">rte_acl.h</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_ac86bc0178d39db9734c594c35f9aee4e"><div class="ttname"><a href="rte__cryptodev_8h.html#ac86bc0178d39db9734c594c35f9aee4e">rte_cryptodev_sym_session_pool_create</a></div><div class="ttdeci">__rte_experimental struct rte_mempool * rte_cryptodev_sym_session_pool_create(const char *name, uint32_t nb_elts, uint32_t elt_size, uint32_t cache_size, uint16_t priv_size, int socket_id)</div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a397b9f2873f0e82b1d3e18b49e03e1b4"><div class="ttname"><a href="rte__cryptodev_8h.html#a397b9f2873f0e82b1d3e18b49e03e1b4">rte_cryptodev_stop</a></div><div class="ttdeci">void rte_cryptodev_stop(uint8_t dev_id)</div></div>
<div class="ttc" id="astructrte__ip__frag__death__row_html"><div class="ttname"><a href="structrte__ip__frag__death__row.html">rte_ip_frag_death_row</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ip__frag_8h_source.html#l00080">rte_ip_frag.h:80</a></div></div>
<div class="ttc" id="arte__flow_8h_html_a78f0386e683cfc491462a771df8b971aa7bc270d4629785c13b81dccca71f67e3"><div class="ttname"><a href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aa7bc270d4629785c13b81dccca71f67e3">RTE_FLOW_ACTION_TYPE_END</a></div><div class="ttdeci">@ RTE_FLOW_ACTION_TYPE_END</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l01703">rte_flow.h:1703</a></div></div>
<div class="ttc" id="arte__security_8h_html_a8a5c2bea95a2ec95ce525d1a366d7133"><div class="ttname"><a href="rte__security_8h.html#a8a5c2bea95a2ec95ce525d1a366d7133">rte_security_get_userdata</a></div><div class="ttdeci">__rte_experimental void * rte_security_get_userdata(struct rte_security_ctx *instance, uint64_t md)</div></div>
<div class="ttc" id="arte__security_8h_html_a7718e5b890596236eb5696a646373b24"><div class="ttname"><a href="rte__security_8h.html#a7718e5b890596236eb5696a646373b24">rte_security_session_destroy</a></div><div class="ttdeci">int rte_security_session_destroy(struct rte_security_ctx *instance, struct rte_security_session *sess)</div></div>
<div class="ttc" id="astructrte__eth__link_html"><div class="ttname"><a href="structrte__eth__link.html">rte_eth_link</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00313">rte_ethdev.h:313</a></div></div>
<div class="ttc" id="arte__flow_8h_html_a698ab49350e51414a31b9c511a7abe4e"><div class="ttname"><a href="rte__flow_8h.html#a698ab49350e51414a31b9c511a7abe4e">rte_flow_create</a></div><div class="ttdeci">struct rte_flow * rte_flow_create(uint16_t port_id, const struct rte_flow_attr *attr, const struct rte_flow_item pattern[], const struct rte_flow_action actions[], struct rte_flow_error *error)</div></div>
<div class="ttc" id="arte__interrupts_8h_html"><div class="ttname"><a href="rte__interrupts_8h.html">rte_interrupts.h</a></div></div>
<div class="ttc" id="astructrte__eth__conf_html_a346eef99c24f617b74c440c1aa565d01"><div class="ttname"><a href="structrte__eth__conf.html#a346eef99c24f617b74c440c1aa565d01">rte_eth_conf::rxmode</a></div><div class="ttdeci">struct rte_eth_rxmode rxmode</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01294">rte_ethdev.h:1301</a></div></div>
<div class="ttc" id="arte__common_8h_html_a38e32f822bc941e90fdcbe5a9c69b178"><div class="ttname"><a href="rte__common_8h.html#a38e32f822bc941e90fdcbe5a9c69b178">__rte_cache_aligned</a></div><div class="ttdeci">#define __rte_cache_aligned</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00400">rte_common.h:400</a></div></div>
<div class="ttc" id="astructrte__mbuf_html_ad1a572736a10ff6b282c5f43c4ea1ccf"><div class="ttname"><a href="structrte__mbuf.html#ad1a572736a10ff6b282c5f43c4ea1ccf">rte_mbuf::data_len</a></div><div class="ttdeci">uint16_t data_len</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00546">rte_mbuf_core.h:546</a></div></div>
<div class="ttc" id="astructrte__flow__item_html"><div class="ttname"><a href="structrte__flow__item.html">rte_flow_item</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l01663">rte_flow.h:1663</a></div></div>
<div class="ttc" id="arte__flow_8h_html_a78f0386e683cfc491462a771df8b971aaac9738009ac5b299c3c4facdbdf66890"><div class="ttname"><a href="rte__flow_8h.html#a78f0386e683cfc491462a771df8b971aaac9738009ac5b299c3c4facdbdf66890">RTE_FLOW_ACTION_TYPE_SECURITY</a></div><div class="ttdeci">@ RTE_FLOW_ACTION_TYPE_SECURITY</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l01827">rte_flow.h:1827</a></div></div>
<div class="ttc" id="arte__branch__prediction_8h_html"><div class="ttname"><a href="rte__branch__prediction_8h.html">rte_branch_prediction.h</a></div></div>
<div class="ttc" id="arte__eal_8h_html"><div class="ttname"><a href="rte__eal_8h.html">rte_eal.h</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html"><div class="ttname"><a href="rte__cryptodev_8h.html">rte_cryptodev.h</a></div></div>
<div class="ttc" id="astructrte__eth__event__ipsec__desc_html"><div class="ttname"><a href="structrte__eth__event__ipsec__desc.html">rte_eth_event_ipsec_desc</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l03432">rte_ethdev.h:3432</a></div></div>
<div class="ttc" id="astructrte__flow__error_html_a642435347234f209e6215370e3f90dd6"><div class="ttname"><a href="structrte__flow__error.html#a642435347234f209e6215370e3f90dd6">rte_flow_error::type</a></div><div class="ttdeci">enum rte_flow_error_type type</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l02860">rte_flow.h:2902</a></div></div>
<div class="ttc" id="arte__lcore_8h_html_a023b4909f52c3cdf0351d71d2b5032bc"><div class="ttname"><a href="rte__lcore_8h.html#a023b4909f52c3cdf0351d71d2b5032bc">rte_lcore_to_socket_id</a></div><div class="ttdeci">unsigned int rte_lcore_to_socket_id(unsigned int lcore_id)</div></div>
<div class="ttc" id="astructrte__eth__rxmode_html_aa0562513c4569f1aa53050f1beac6b5d"><div class="ttname"><a href="structrte__eth__rxmode.html#aa0562513c4569f1aa53050f1beac6b5d">rte_eth_rxmode::mq_mode</a></div><div class="ttdeci">enum rte_eth_rx_mq_mode mq_mode</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00336">rte_ethdev.h:402</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_ae4388e0326c8789ddf39e32044dc4187"><div class="ttname"><a href="rte__cryptodev_8h.html#ae4388e0326c8789ddf39e32044dc4187">rte_cryptodev_queue_pair_setup</a></div><div class="ttdeci">int rte_cryptodev_queue_pair_setup(uint8_t dev_id, uint16_t queue_pair_id, const struct rte_cryptodev_qp_conf *qp_conf, int socket_id)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a3e7d76a451b46348686ea97d6367f102"><div class="ttname"><a href="rte__ethdev_8h.html#a3e7d76a451b46348686ea97d6367f102">rte_eth_rx_burst</a></div><div class="ttdeci">static uint16_t rte_eth_rx_burst(uint16_t port_id, uint16_t queue_id, struct rte_mbuf **rx_pkts, const uint16_t nb_pkts)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l04834">rte_ethdev.h:4834</a></div></div>
<div class="ttc" id="arte__security_8h_html_a6ab33d9ca2b9940e421f4f803b168eab"><div class="ttname"><a href="rte__security_8h.html#a6ab33d9ca2b9940e421f4f803b168eab">rte_security_dynfield</a></div><div class="ttdeci">static __rte_experimental rte_security_dynfield_t * rte_security_dynfield(struct rte_mbuf *mbuf)</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00475">rte_security.h:475</a></div></div>
<div class="ttc" id="arte__mbuf__ptype_8h_html_ae381ac5f3d455fe13de25aa809399a60"><div class="ttname"><a href="rte__mbuf__ptype_8h.html#ae381ac5f3d455fe13de25aa809399a60">RTE_PTYPE_L3_IPV4</a></div><div class="ttdeci">#define RTE_PTYPE_L3_IPV4</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__ptype_8h_source.html#l00161">rte_mbuf_ptype.h:161</a></div></div>
<div class="ttc" id="arte__eventdev_8h_html_ac88982845a12ff215c721fccb18ed4a7"><div class="ttname"><a href="rte__eventdev_8h.html#ac88982845a12ff215c721fccb18ed4a7">RTE_SCHED_TYPE_PARALLEL</a></div><div class="ttdeci">#define RTE_SCHED_TYPE_PARALLEL</div><div class="ttdef"><b>Definition:</b> <a href="rte__eventdev_8h_source.html#l00974">rte_eventdev.h:963</a></div></div>
<div class="ttc" id="arte__lcore_8h_html_acab656f5b00c29090db4500efabedd98"><div class="ttname"><a href="rte__lcore_8h.html#acab656f5b00c29090db4500efabedd98">rte_get_next_lcore</a></div><div class="ttdeci">unsigned int rte_get_next_lcore(unsigned int i, int skip_main, int wrap)</div></div>
<div class="ttc" id="astructrte__cryptodev__qp__conf_html"><div class="ttname"><a href="structrte__cryptodev__qp__conf.html">rte_cryptodev_qp_conf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00517">rte_cryptodev.h:517</a></div></div>
<div class="ttc" id="arte__flow_8h_html_af10e2b0af33527be504e883406a84ca1a51161f8ef75cba3968e32fc0472575d7"><div class="ttname"><a href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1a51161f8ef75cba3968e32fc0472575d7">RTE_FLOW_ITEM_TYPE_END</a></div><div class="ttdeci">@ RTE_FLOW_ITEM_TYPE_END</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l00128">rte_flow.h:128</a></div></div>
<div class="ttc" id="arte__ether_8h_html"><div class="ttname"><a href="rte__ether_8h.html">rte_ether.h</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_ac96de1a778092073c21e54e4ac07fc6c"><div class="ttname"><a href="rte__mbuf__core_8h.html#ac96de1a778092073c21e54e4ac07fc6c">PKT_TX_SEC_OFFLOAD</a></div><div class="ttdeci">#define PKT_TX_SEC_OFFLOAD</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00221">rte_mbuf_core.h:221</a></div></div>
<div class="ttc" id="astructrte__mbuf_html"><div class="ttname"><a href="structrte__mbuf.html">rte_mbuf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00473">rte_mbuf_core.h:473</a></div></div>
<div class="ttc" id="arte__security_8h_html_a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116"><div class="ttname"><a href="rte__security_8h.html#a4ace8d873b2a4832039eb2f964b12165a9022bed6a693ce3fe43176bcaa779116">RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</a></div><div class="ttdeci">@ RTE_SECURITY_ACTION_TYPE_INLINE_CRYPTO</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00336">rte_security.h:333</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_ad1263899f41301923c483c3b4ce0486f"><div class="ttname"><a href="rte__ethdev_8h.html#ad1263899f41301923c483c3b4ce0486f">rte_eth_link_get_nowait</a></div><div class="ttdeci">int rte_eth_link_get_nowait(uint16_t port_id, struct rte_eth_link *link)</div></div>
<div class="ttc" id="arte__lcore_8h_html_ad6a4c3ec1b15d0658f4b3b755eb4fd40"><div class="ttname"><a href="rte__lcore_8h.html#ad6a4c3ec1b15d0658f4b3b755eb4fd40">rte_socket_count</a></div><div class="ttdeci">unsigned int rte_socket_count(void)</div></div>
<div class="ttc" id="arte__bitmap_8h_html"><div class="ttname"><a href="rte__bitmap_8h.html">rte_bitmap.h</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_a87d6352dee4dd78c55d943aa814b0491"><div class="ttname"><a href="rte__mbuf__core_8h.html#a87d6352dee4dd78c55d943aa814b0491">PKT_RX_SEC_OFFLOAD</a></div><div class="ttdeci">#define PKT_RX_SEC_OFFLOAD</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00157">rte_mbuf_core.h:157</a></div></div>
<div class="ttc" id="astructrte__cryptodev__symmetric__capability_html_a05863077b6b0802857a85984a19857c8"><div class="ttname"><a href="structrte__cryptodev__symmetric__capability.html#a05863077b6b0802857a85984a19857c8">rte_cryptodev_symmetric_capability::cipher</a></div><div class="ttdeci">struct rte_cryptodev_symmetric_capability::@135::@138 cipher</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a7593f4fff04f4ae1b1d718db7ca7dc8c"><div class="ttname"><a href="rte__ethdev_8h.html#a7593f4fff04f4ae1b1d718db7ca7dc8c">rte_eth_dev_info_get</a></div><div class="ttdeci">int rte_eth_dev_info_get(uint16_t port_id, struct rte_eth_dev_info *dev_info)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a5dd1dedaa45f05c72bcc35495e441e91"><div class="ttname"><a href="rte__ethdev_8h.html#a5dd1dedaa45f05c72bcc35495e441e91">rte_eth_promiscuous_enable</a></div><div class="ttdeci">int rte_eth_promiscuous_enable(uint16_t port_id)</div></div>
<div class="ttc" id="arte__lcore_8h_html_a688a671a9fb6c79203de98c684d6e7f2"><div class="ttname"><a href="rte__lcore_8h.html#a688a671a9fb6c79203de98c684d6e7f2">rte_socket_id_by_idx</a></div><div class="ttdeci">int rte_socket_id_by_idx(unsigned int idx)</div></div>
<div class="ttc" id="arte__atomic_8h_html"><div class="ttname"><a href="rte__atomic_8h.html">rte_atomic.h</a></div></div>
<div class="ttc" id="arte__ip_8h_html_a152c7479c3bb1c664f89ad315b1a453d"><div class="ttname"><a href="rte__ip_8h.html#a152c7479c3bb1c664f89ad315b1a453d">rte_ipv6_get_next_ext</a></div><div class="ttdeci">static __rte_experimental int rte_ipv6_get_next_ext(const uint8_t *p, int proto, size_t *ext_len)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ip_8h_source.html#l00526">rte_ip.h:526</a></div></div>
<div class="ttc" id="arte__byteorder_8h_html_a1d6fa9e3f0a9b2de0836177fa02eb403"><div class="ttname"><a href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a></div><div class="ttdeci">static uint32_t rte_be_to_cpu_32(rte_be32_t x)</div></div>
<div class="ttc" id="astructrte__mbuf_html_a8d0990e39ae8f91a4937083eead6b65f"><div class="ttname"><a href="structrte__mbuf.html#a8d0990e39ae8f91a4937083eead6b65f">rte_mbuf::packet_type</a></div><div class="ttdeci">uint32_t packet_type</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00519">rte_mbuf_core.h:519</a></div></div>
<div class="ttc" id="astructrte__ipsec__session_html_aa8f42f3a36d2c036ccb27f0b74b25160"><div class="ttname"><a href="structrte__ipsec__session.html#aa8f42f3a36d2c036ccb27f0b74b25160">rte_ipsec_session::sa</a></div><div class="ttdeci">struct rte_ipsec_sa * sa</div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec_8h_source.html#l00063">rte_ipsec.h:63</a></div></div>
<div class="ttc" id="arte__ether_8h_html_a67dff5b18f52e97596f08ed2e76e4902"><div class="ttname"><a href="rte__ether_8h.html#a67dff5b18f52e97596f08ed2e76e4902">RTE_ETHER_HDR_LEN</a></div><div class="ttdeci">#define RTE_ETHER_HDR_LEN</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00035">rte_ether.h:33</a></div></div>
<div class="ttc" id="arte__byteorder_8h_html_a06f1729594bf45215195660a86c9b2c4"><div class="ttname"><a href="rte__byteorder_8h.html#a06f1729594bf45215195660a86c9b2c4">rte_be_to_cpu_16</a></div><div class="ttdeci">static uint16_t rte_be_to_cpu_16(rte_be16_t x)</div></div>
<div class="ttc" id="arte__ip__frag_8h_html_a3a5e68f12b9184d13950a7f685ec9aed"><div class="ttname"><a href="rte__ip__frag_8h.html#a3a5e68f12b9184d13950a7f685ec9aed">rte_ipv6_frag_reassemble_packet</a></div><div class="ttdeci">struct rte_mbuf * rte_ipv6_frag_reassemble_packet(struct rte_ip_frag_tbl *tbl, struct rte_ip_frag_death_row *dr, struct rte_mbuf *mb, uint64_t tms, struct rte_ipv6_hdr *ip_hdr, struct ipv6_extension_fragment *frag_hdr)</div></div>
<div class="ttc" id="arte__acl_8h_html_a97c75dcc2bddb3ce02c171f20d2f5854"><div class="ttname"><a href="rte__acl_8h.html#a97c75dcc2bddb3ce02c171f20d2f5854">rte_acl_classify</a></div><div class="ttdeci">int rte_acl_classify(const struct rte_acl_ctx *ctx, const uint8_t **data, uint32_t *results, uint32_t num, uint32_t categories)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a22dcfd3f5f2b34f657131d66132e23a7"><div class="ttname"><a href="rte__ethdev_8h.html#a22dcfd3f5f2b34f657131d66132e23a7">rte_eth_dev_is_valid_port</a></div><div class="ttdeci">int rte_eth_dev_is_valid_port(uint16_t port_id)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a8a28375b279ded9125c99a46bf3956ef"><div class="ttname"><a href="rte__ethdev_8h.html#a8a28375b279ded9125c99a46bf3956ef">rte_eth_macaddr_get</a></div><div class="ttdeci">int rte_eth_macaddr_get(uint16_t port_id, struct rte_ether_addr *mac_addr)</div></div>
<div class="ttc" id="arte__hash_8h_html_a62ff0b837d39bbff00863feabf15e224"><div class="ttname"><a href="rte__hash_8h.html#a62ff0b837d39bbff00863feabf15e224">rte_hash_lookup</a></div><div class="ttdeci">int32_t rte_hash_lookup(const struct rte_hash *h, const void *key)</div></div>
<div class="ttc" id="arte__mbuf_8h_html_abe1bed439015acec170d1342e8dabb3b"><div class="ttname"><a href="rte__mbuf_8h.html#abe1bed439015acec170d1342e8dabb3b">rte_pktmbuf_trim</a></div><div class="ttdeci">static int rte_pktmbuf_trim(struct rte_mbuf *m, uint16_t len)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01666">rte_mbuf.h:1666</a></div></div>
<div class="ttc" id="arte__common_8h_html_ac5169870c983b3463cb226bdb8a94880"><div class="ttname"><a href="rte__common_8h.html#ac5169870c983b3463cb226bdb8a94880">rte_exit</a></div><div class="ttdeci">__rte_noreturn void rte_exit(int exit_code, const char *format,...) __rte_format_printf(2</div></div>
<div class="ttc" id="arte__lcore_8h_html_a1728dc7f14571ba778d3b5b41aa09283"><div class="ttname"><a href="rte__lcore_8h.html#a1728dc7f14571ba778d3b5b41aa09283">rte_lcore_count</a></div><div class="ttdeci">unsigned int rte_lcore_count(void)</div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_ad63e1de0ec54d7c7603ea984c76ca956"><div class="ttname"><a href="rte__mbuf__core_8h.html#ad63e1de0ec54d7c7603ea984c76ca956">rte_pktmbuf_mtod_offset</a></div><div class="ttdeci">#define rte_pktmbuf_mtod_offset(m, t, o)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00711">rte_mbuf_core.h:711</a></div></div>
<div class="ttc" id="astructrte__cryptodev__capabilities_html_a394c79d7e4c59bafe3bc7678dd69c03d"><div class="ttname"><a href="structrte__cryptodev__capabilities.html#a394c79d7e4c59bafe3bc7678dd69c03d">rte_cryptodev_capabilities::op</a></div><div class="ttdeci">enum rte_crypto_op_type op</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00159">rte_cryptodev.h:179</a></div></div>
<div class="ttc" id="arte__ip_8h_html"><div class="ttname"><a href="rte__ip_8h.html">rte_ip.h</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a83e56cabbd31637efd648e3fc010392b"><div class="ttname"><a href="rte__ethdev_8h.html#a83e56cabbd31637efd648e3fc010392b">rte_eth_tx_burst</a></div><div class="ttdeci">static uint16_t rte_eth_tx_burst(uint16_t port_id, uint16_t queue_id, struct rte_mbuf **tx_pkts, uint16_t nb_pkts)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l05112">rte_ethdev.h:5112</a></div></div>
<div class="ttc" id="arte__cycles_8h_html_ae016e608f344823e677819d8f04264c5"><div class="ttname"><a href="rte__cycles_8h.html#ae016e608f344823e677819d8f04264c5">rte_get_tsc_hz</a></div><div class="ttdeci">uint64_t rte_get_tsc_hz(void)</div></div>
<div class="ttc" id="arte__ether_8h_html_ac386d430206de37dca641eaa5c0c74ac"><div class="ttname"><a href="rte__ether_8h.html#ac386d430206de37dca641eaa5c0c74ac">RTE_ETHER_TYPE_IPV6</a></div><div class="ttdeci">#define RTE_ETHER_TYPE_IPV6</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00284">rte_ether.h:284</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a1e6788469a92700a583d06bf079d779d"><div class="ttname"><a href="rte__ethdev_8h.html#a1e6788469a92700a583d06bf079d779d">rte_eth_event_type</a></div><div class="ttdeci">rte_eth_event_type</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l03454">rte_ethdev.h:3454</a></div></div>
<div class="ttc" id="arte__lcore_8h_html_adfb2b334e7e73f534f25e8888a8a775f"><div class="ttname"><a href="rte__lcore_8h.html#adfb2b334e7e73f534f25e8888a8a775f">rte_lcore_id</a></div><div class="ttdeci">static unsigned rte_lcore_id(void)</div><div class="ttdef"><b>Definition:</b> <a href="rte__lcore_8h_source.html#l00075">rte_lcore.h:75</a></div></div>
<div class="ttc" id="arte__cycles_8h_html"><div class="ttname"><a href="rte__cycles_8h.html">rte_cycles.h</a></div></div>
<div class="ttc" id="arte__ip__frag_8h_html_af7d0a604738e3a8d5b7f3507c176510b"><div class="ttname"><a href="rte__ip__frag_8h.html#af7d0a604738e3a8d5b7f3507c176510b">rte_ip_frag_free_death_row</a></div><div class="ttdeci">void rte_ip_frag_free_death_row(struct rte_ip_frag_death_row *dr, uint32_t prefetch)</div></div>
<div class="ttc" id="astructrte__eth__event__ipsec__desc_html_ab24d0e07dd55d2a2a380babfb08c0368"><div class="ttname"><a href="structrte__eth__event__ipsec__desc.html#ab24d0e07dd55d2a2a380babfb08c0368">rte_eth_event_ipsec_desc::metadata</a></div><div class="ttdeci">uint64_t metadata</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l03435">rte_ethdev.h:3435</a></div></div>
<div class="ttc" id="astructrte__hash__parameters_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="structrte__hash__parameters.html#a8f8f80d37794cde9472343e4487ba3eb">rte_hash_parameters::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="rte__hash_8h_source.html#l00083">rte_hash.h:83</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_ae7110b5d5dced8f42505bff5d9e3f0ea"><div class="ttname"><a href="rte__ethdev_8h.html#ae7110b5d5dced8f42505bff5d9e3f0ea">DEV_TX_OFFLOAD_MBUF_FAST_FREE</a></div><div class="ttdeci">#define DEV_TX_OFFLOAD_MBUF_FAST_FREE</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01401">rte_ethdev.h:1397</a></div></div>
<div class="ttc" id="arte__common_8h_html_ac963da91b35efa4700b73a1f4eb1d8a6"><div class="ttname"><a href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a></div><div class="ttdeci">#define RTE_DIM(a)</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00809">rte_common.h:809</a></div></div>
<div class="ttc" id="astructrte__cryptodev__info_html_aaccbcc3ce862dbe5af189ee0c3e345b1"><div class="ttname"><a href="structrte__cryptodev__info.html#aaccbcc3ce862dbe5af189ee0c3e345b1">rte_cryptodev_info::feature_flags</a></div><div class="ttdeci">uint64_t feature_flags</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00482">rte_cryptodev.h:482</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_a1bbd752194759ce7b419c4998f2e8651"><div class="ttname"><a href="rte__mbuf_8h.html#a1bbd752194759ce7b419c4998f2e8651">rte_pktmbuf_adj</a></div><div class="ttdeci">static char * rte_pktmbuf_adj(struct rte_mbuf *m, uint16_t len)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01636">rte_mbuf.h:1636</a></div></div>
<div class="ttc" id="astructrte__eth__txconf_html_a6cfe3b3ee46e9a8b8c62a64294b0b564"><div class="ttname"><a href="structrte__eth__txconf.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">rte_eth_txconf::offloads</a></div><div class="ttdeci">uint64_t offloads</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01072">rte_ethdev.h:1072</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a58207367533ac9e65e4a611ba78090e5"><div class="ttname"><a href="rte__cryptodev_8h.html#a58207367533ac9e65e4a611ba78090e5">rte_cryptodev_configure</a></div><div class="ttdeci">int rte_cryptodev_configure(uint8_t dev_id, struct rte_cryptodev_config *config)</div></div>
<div class="ttc" id="astructrte__mbuf_html_aa25a7c259438b9eba28bcedc33846620"><div class="ttname"><a href="structrte__mbuf.html#aa25a7c259438b9eba28bcedc33846620">rte_mbuf::l2_len</a></div><div class="ttdeci">uint64_t l2_len</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00602">rte_mbuf_core.h:602</a></div></div>
<div class="ttc" id="arte__common_8h_html_a4c7571cbcdbfe9b63431036af811bee9"><div class="ttname"><a href="rte__common_8h.html#a4c7571cbcdbfe9b63431036af811bee9">RTE_MIN</a></div><div class="ttdeci">#define RTE_MIN(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00573">rte_common.h:573</a></div></div>
<div class="ttc" id="astructrte__eth__rss__conf_html_ad70f17882a835e5d4e38c64a9f872fdc"><div class="ttname"><a href="structrte__eth__rss__conf.html#ad70f17882a835e5d4e38c64a9f872fdc">rte_eth_rss_conf::rss_hf</a></div><div class="ttdeci">uint64_t rss_hf</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00457">rte_ethdev.h:457</a></div></div>
<div class="ttc" id="astructrte__mbuf_html_a8e0798404bf2cf5dabb84c5ba9a4f236"><div class="ttname"><a href="structrte__mbuf.html#a8e0798404bf2cf5dabb84c5ba9a4f236">rte_mbuf::port</a></div><div class="ttdeci">uint16_t port</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00503">rte_mbuf_core.h:503</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_a2a8b10263496c7b580e9d0c7f2a1f073"><div class="ttname"><a href="rte__mbuf__core_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073">rte_pktmbuf_mtod</a></div><div class="ttdeci">#define rte_pktmbuf_mtod(m, t)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00726">rte_mbuf_core.h:726</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_afdc834c1c52e9fb512301990468ca7c2"><div class="ttname"><a href="rte__ethdev_8h.html#afdc834c1c52e9fb512301990468ca7c2">rte_eth_dev_start</a></div><div class="ttdeci">int rte_eth_dev_start(uint16_t port_id)</div></div>
<div class="ttc" id="arte__random_8h_html"><div class="ttname"><a href="rte__random_8h.html">rte_random.h</a></div></div>
<div class="ttc" id="astructrte__cryptodev__symmetric__capability_html_a690a3258912ca541695442ea102c55d8"><div class="ttname"><a href="structrte__cryptodev__symmetric__capability.html#a690a3258912ca541695442ea102c55d8">rte_cryptodev_symmetric_capability::auth</a></div><div class="ttdeci">struct rte_cryptodev_symmetric_capability::@135::@137 auth</div></div>
<div class="ttc" id="arte__ethdev_8h_html_ad9c80e6e25ce9d6e8acd4e720cc64c36"><div class="ttname"><a href="rte__ethdev_8h.html#ad9c80e6e25ce9d6e8acd4e720cc64c36">__rte_aligned</a></div><div class="ttdeci">__extension__ struct rte_eth_link __rte_aligned(8)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a08c012f37e07726170ff67daf667d850"><div class="ttname"><a href="rte__ethdev_8h.html#a08c012f37e07726170ff67daf667d850">ETH_LINK_DOWN</a></div><div class="ttdeci">#define ETH_LINK_DOWN</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00323">rte_ethdev.h:323</a></div></div>
<div class="ttc" id="arte__ip__frag_8h_html_a0ec59118790a4babb24bd5636b1e60d9"><div class="ttname"><a href="rte__ip__frag_8h.html#a0ec59118790a4babb24bd5636b1e60d9">rte_ipv4_fragment_packet</a></div><div class="ttdeci">int32_t rte_ipv4_fragment_packet(struct rte_mbuf *pkt_in, struct rte_mbuf **pkts_out, uint16_t nb_pkts_out, uint16_t mtu_size, struct rte_mempool *pool_direct, struct rte_mempool *pool_indirect)</div></div>
<div class="ttc" id="astructrte__ether__hdr_html"><div class="ttname"><a href="structrte__ether__hdr.html">rte_ether_hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00264">rte_ether.h:264</a></div></div>
<div class="ttc" id="arte__jhash_8h_html_a5a6d3c6a6da332e3768fa41e879e0e10"><div class="ttname"><a href="rte__jhash_8h.html#a5a6d3c6a6da332e3768fa41e879e0e10">rte_jhash</a></div><div class="ttdeci">static uint32_t rte_jhash(const void *key, uint32_t length, uint32_t initval)</div><div class="ttdef"><b>Definition:</b> <a href="rte__jhash_8h_source.html#l00280">rte_jhash.h:280</a></div></div>
<div class="ttc" id="arte__common_8h_html"><div class="ttname"><a href="rte__common_8h.html">rte_common.h</a></div></div>
<div class="ttc" id="astructrte__hash__parameters_html_aca908537bdd20d4ca4d4c7fd6c392903"><div class="ttname"><a href="structrte__hash__parameters.html#aca908537bdd20d4ca4d4c7fd6c392903">rte_hash_parameters::hash_func</a></div><div class="ttdeci">rte_hash_function hash_func</div><div class="ttdef"><b>Definition:</b> <a href="rte__hash_8h_source.html#l00087">rte_hash.h:87</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a34a54ae38920d21d95aa6049640e8c0e"><div class="ttname"><a href="rte__cryptodev_8h.html#a34a54ae38920d21d95aa6049640e8c0e">rte_cryptodev_sym_get_private_session_size</a></div><div class="ttdeci">unsigned int rte_cryptodev_sym_get_private_session_size(uint8_t dev_id)</div></div>
<div class="ttc" id="astructrte__hash__parameters_html_a38bad35c844ffd72b0c1132715d5f3a1"><div class="ttname"><a href="structrte__hash__parameters.html#a38bad35c844ffd72b0c1132715d5f3a1">rte_hash_parameters::entries</a></div><div class="ttdeci">uint32_t entries</div><div class="ttdef"><b>Definition:</b> <a href="rte__hash_8h_source.html#l00084">rte_hash.h:84</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_ac0bef2920a6ade4041cab5103f4700d9"><div class="ttname"><a href="rte__ethdev_8h.html#ac0bef2920a6ade4041cab5103f4700d9">rte_eth_dev_callback_register</a></div><div class="ttdeci">int rte_eth_dev_callback_register(uint16_t port_id, enum rte_eth_event_type event, rte_eth_dev_cb_fn cb_fn, void *cb_arg)</div></div>
<div class="ttc" id="arte__mbuf_8h_html_aadf5bef4ceb0b76dfafff0895f285ab0"><div class="ttname"><a href="rte__mbuf_8h.html#aadf5bef4ceb0b76dfafff0895f285ab0">rte_pktmbuf_prepend</a></div><div class="ttdeci">static char * rte_pktmbuf_prepend(struct rte_mbuf *m, uint16_t len)</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf_8h_source.html#l01572">rte_mbuf.h:1572</a></div></div>
<div class="ttc" id="astructrte__eth__txmode_html_a6cfe3b3ee46e9a8b8c62a64294b0b564"><div class="ttname"><a href="structrte__eth__txmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">rte_eth_txmode::offloads</a></div><div class="ttdeci">uint64_t offloads</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00959">rte_ethdev.h:959</a></div></div>
<div class="ttc" id="arte__ether_8h_html_a4eaf2c62fef067d38a3e1f7c34c36005"><div class="ttname"><a href="rte__ether_8h.html#a4eaf2c62fef067d38a3e1f7c34c36005">RTE_ETHER_MTU</a></div><div class="ttdeci">#define RTE_ETHER_MTU</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00040">rte_ether.h:38</a></div></div>
<div class="ttc" id="arte__debug_8h_html_a9fcab5683ce1c1164c52c17579cc2b5f"><div class="ttname"><a href="rte__debug_8h.html#a9fcab5683ce1c1164c52c17579cc2b5f">rte_panic</a></div><div class="ttdeci">#define rte_panic(...)</div><div class="ttdef"><b>Definition:</b> <a href="rte__debug_8h_source.html#l00043">rte_debug.h:43</a></div></div>
<div class="ttc" id="astructrte__ipsec__session_html_adb36704cd7fc83a9e5f8e10720974165"><div class="ttname"><a href="structrte__ipsec__session.html#adb36704cd7fc83a9e5f8e10720974165">rte_ipsec_session::type</a></div><div class="ttdeci">enum rte_security_session_action_type type</div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec_8h_source.html#l00063">rte_ipsec.h:65</a></div></div>
<div class="ttc" id="arte__lpm_8h_html_a50015c45c3fde72568c8ba303ded2288"><div class="ttname"><a href="rte__lpm_8h.html#a50015c45c3fde72568c8ba303ded2288">rte_lpm_lookup_bulk</a></div><div class="ttdeci">#define rte_lpm_lookup_bulk(lpm, ips, next_hops, n)</div><div class="ttdef"><b>Definition:</b> <a href="rte__lpm_8h_source.html#l00339">rte_lpm.h:339</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a05c7cc66ab3a89549b1c2a03eaa23568"><div class="ttname"><a href="rte__cryptodev_8h.html#a05c7cc66ab3a89549b1c2a03eaa23568">rte_cryptodev_close</a></div><div class="ttdeci">int rte_cryptodev_close(uint8_t dev_id)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a9ab708089665bebcd65cefe5383b24f2"><div class="ttname"><a href="rte__ethdev_8h.html#a9ab708089665bebcd65cefe5383b24f2">rte_eth_dev_count_avail</a></div><div class="ttdeci">uint16_t rte_eth_dev_count_avail(void)</div></div>
<div class="ttc" id="arte__debug_8h_html"><div class="ttname"><a href="rte__debug_8h.html">rte_debug.h</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_a51280725dafdf282a80b2d964418798c"><div class="ttname"><a href="rte__mbuf__core_8h.html#a51280725dafdf282a80b2d964418798c">PKT_TX_IP_CKSUM</a></div><div class="ttdeci">#define PKT_TX_IP_CKSUM</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00324">rte_mbuf_core.h:324</a></div></div>
<div class="ttc" id="arte__ip__frag_8h_html_ad00c0949e82c8c4126d8565339b93350"><div class="ttname"><a href="rte__ip__frag_8h.html#ad00c0949e82c8c4126d8565339b93350">rte_ip_frag_table_create</a></div><div class="ttdeci">struct rte_ip_frag_tbl * rte_ip_frag_table_create(uint32_t bucket_num, uint32_t bucket_entries, uint32_t max_entries, uint64_t max_cycles, int socket_id)</div></div>
<div class="ttc" id="arte__alarm_8h_html"><div class="ttname"><a href="rte__alarm_8h.html">rte_alarm.h</a></div></div>
<div class="ttc" id="arte__alarm_8h_html_a2dcad28ea9331067662351b36d5877e5"><div class="ttname"><a href="rte__alarm_8h.html#a2dcad28ea9331067662351b36d5877e5">rte_eal_alarm_set</a></div><div class="ttdeci">int rte_eal_alarm_set(uint64_t us, rte_eal_alarm_callback cb, void *cb_arg)</div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a4c4acd655062a7195c722948d93c22c4"><div class="ttname"><a href="rte__cryptodev_8h.html#a4c4acd655062a7195c722948d93c22c4">RTE_CRYPTODEV_FF_IN_PLACE_SGL</a></div><div class="ttdeci">#define RTE_CRYPTODEV_FF_IN_PLACE_SGL</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00425">rte_cryptodev.h:422</a></div></div>
<div class="ttc" id="arte__common_8h_html_ae1a7c8799cb57669ae2ddf367b21533f"><div class="ttname"><a href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a></div><div class="ttdeci">#define __rte_unused</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00116">rte_common.h:116</a></div></div>
<div class="ttc" id="astructrte__eth__rxmode_html_a6cfe3b3ee46e9a8b8c62a64294b0b564"><div class="ttname"><a href="structrte__eth__rxmode.html#a6cfe3b3ee46e9a8b8c62a64294b0b564">rte_eth_rxmode::offloads</a></div><div class="ttdeci">uint64_t offloads</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00412">rte_ethdev.h:412</a></div></div>
<div class="ttc" id="astructrte__ipv6__hdr_html_adaae928b69788f774db092e75f1c4fb7"><div class="ttname"><a href="structrte__ipv6__hdr.html#adaae928b69788f774db092e75f1c4fb7">rte_ipv6_hdr::proto</a></div><div class="ttdeci">uint8_t proto</div><div class="ttdef"><b>Definition:</b> <a href="rte__ip_8h_source.html#l00390">rte_ip.h:390</a></div></div>
<div class="ttc" id="arte__flow_8h_html_a3fc6e9416462572d5a978e77d9ea2ec8"><div class="ttname"><a href="rte__flow_8h.html#a3fc6e9416462572d5a978e77d9ea2ec8">rte_flow_validate</a></div><div class="ttdeci">int rte_flow_validate(uint16_t port_id, const struct rte_flow_attr *attr, const struct rte_flow_item pattern[], const struct rte_flow_action actions[], struct rte_flow_error *error)</div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a1fa401bd6c01129823669ac68deaa993"><div class="ttname"><a href="rte__cryptodev_8h.html#a1fa401bd6c01129823669ac68deaa993">rte_cryptodev_start</a></div><div class="ttdeci">int rte_cryptodev_start(uint8_t dev_id)</div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a2b576f436d279db944d0afee6c6c3aa3"><div class="ttname"><a href="rte__cryptodev_8h.html#a2b576f436d279db944d0afee6c6c3aa3">RTE_CRYPTODEV_FF_SYM_OPERATION_CHAINING</a></div><div class="ttdeci">#define RTE_CRYPTODEV_FF_SYM_OPERATION_CHAINING</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00407">rte_cryptodev.h:406</a></div></div>
<div class="ttc" id="arte__security_8h_html_ac2cdd90e7fc7f9121c997cafe2f6a5e3"><div class="ttname"><a href="rte__security_8h.html#ac2cdd90e7fc7f9121c997cafe2f6a5e3">rte_security_dynfield_is_registered</a></div><div class="ttdeci">static __rte_experimental bool rte_security_dynfield_is_registered(void)</div><div class="ttdef"><b>Definition:</b> <a href="rte__security_8h_source.html#l00491">rte_security.h:491</a></div></div>
<div class="ttc" id="arte__eal_8h_html_a5c3f4dddc25e38c5a186ecd8a69260e3"><div class="ttname"><a href="rte__eal_8h.html#a5c3f4dddc25e38c5a186ecd8a69260e3">rte_eal_init</a></div><div class="ttdeci">int rte_eal_init(int argc, char **argv)</div></div>
<div class="ttc" id="arte__flow_8h_html_af10e2b0af33527be504e883406a84ca1a378d681349151b147a42ecfe0023f826"><div class="ttname"><a href="rte__flow_8h.html#af10e2b0af33527be504e883406a84ca1a378d681349151b147a42ecfe0023f826">RTE_FLOW_ITEM_TYPE_ESP</a></div><div class="ttdeci">@ RTE_FLOW_ITEM_TYPE_ESP</div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l00340">rte_flow.h:340</a></div></div>
<div class="ttc" id="astructrte__mempool_html"><div class="ttname"><a href="structrte__mempool.html">rte_mempool</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__mempool_8h_source.html#l00207">rte_mempool.h:207</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_adb70723c985c3ea177591b67cfc49178"><div class="ttname"><a href="rte__ethdev_8h.html#adb70723c985c3ea177591b67cfc49178">rte_eth_add_rx_callback</a></div><div class="ttdeci">const struct rte_eth_rxtx_callback * rte_eth_add_rx_callback(uint16_t port_id, uint16_t queue_id, rte_rx_callback_fn fn, void *user_param)</div></div>
<div class="ttc" id="astructrte__mbuf_html_a319d580a6e1ef13692631d7b0d6d5c98"><div class="ttname"><a href="structrte__mbuf.html#a319d580a6e1ef13692631d7b0d6d5c98">rte_mbuf::ol_flags</a></div><div class="ttdeci">uint64_t ol_flags</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00505">rte_mbuf_core.h:505</a></div></div>
<div class="ttc" id="arte__common_8h_html_a276e8a32e0bbf024aadd9420b8f2d3b3"><div class="ttname"><a href="rte__common_8h.html#a276e8a32e0bbf024aadd9420b8f2d3b3">offsetof</a></div><div class="ttdeci">#define offsetof(TYPE, MEMBER)</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00753">rte_common.h:753</a></div></div>
<div class="ttc" id="astructrte__ipsec__session_html"><div class="ttname"><a href="structrte__ipsec__session.html">rte_ipsec_session</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec_8h_source.html#l00058">rte_ipsec.h:58</a></div></div>
<div class="ttc" id="astructrte__flow__attr_html"><div class="ttname"><a href="structrte__flow__attr.html">rte_flow_attr</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l00076">rte_flow.h:76</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html_a593921f13307803b94bbb4e0932db962"><div class="ttname"><a href="rte__mbuf_8h.html#a593921f13307803b94bbb4e0932db962">rte_pktmbuf_pool_create</a></div><div class="ttdeci">struct rte_mempool * rte_pktmbuf_pool_create(const char *name, unsigned n, unsigned cache_size, uint16_t priv_size, uint16_t data_room_size, int socket_id)</div></div>
<div class="ttc" id="astructrte__ipv4__hdr_html"><div class="ttname"><a href="structrte__ipv4__hdr.html">rte_ipv4_hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ip_8h_source.html#l00033">rte_ip.h:33</a></div></div>
<div class="ttc" id="arte__crypto_8h_html_ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc"><div class="ttname"><a href="rte__crypto_8h.html#ae6cf2c3fcd46c5ef3a43fbcb8b658739a33144a5991d4b9aaa43adb9748a067fc">RTE_CRYPTO_OP_TYPE_SYMMETRIC</a></div><div class="ttdeci">@ RTE_CRYPTO_OP_TYPE_SYMMETRIC</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto_8h_source.html#l00033">rte_crypto.h:32</a></div></div>
<div class="ttc" id="arte__common_8h_html_aaedd6d14e7370916fee58e0f69d8c37a"><div class="ttname"><a href="rte__common_8h.html#aaedd6d14e7370916fee58e0f69d8c37a">RTE_SET_USED</a></div><div class="ttdeci">#define RTE_SET_USED(x)</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00131">rte_common.h:131</a></div></div>
<div class="ttc" id="astructrte__hash__parameters_html_a01ac433d404852455c8fb211a4d43b2a"><div class="ttname"><a href="structrte__hash__parameters.html#a01ac433d404852455c8fb211a4d43b2a">rte_hash_parameters::hash_func_init_val</a></div><div class="ttdeci">uint32_t hash_func_init_val</div><div class="ttdef"><b>Definition:</b> <a href="rte__hash_8h_source.html#l00088">rte_hash.h:88</a></div></div>
<div class="ttc" id="astructrte__mbuf_html_a5046af233a45d6d79ce1a5aae535b23c"><div class="ttname"><a href="structrte__mbuf.html#a5046af233a45d6d79ce1a5aae535b23c">rte_mbuf::pkt_len</a></div><div class="ttdeci">uint32_t pkt_len</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00545">rte_mbuf_core.h:545</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9"><div class="ttname"><a href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9">RTE_CRYPTO_SYM_XFORM_AUTH</a></div><div class="ttdeci">@ RTE_CRYPTO_SYM_XFORM_AUTH</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00529">rte_crypto_sym.h:529</a></div></div>
<div class="ttc" id="arte__ip_8h_html_a419c49159f31d294b3854b86f9427a4e"><div class="ttname"><a href="rte__ip_8h.html#a419c49159f31d294b3854b86f9427a4e">RTE_IPV4_MAX_PKT_LEN</a></div><div class="ttdeci">#define RTE_IPV4_MAX_PKT_LEN</div><div class="ttdef"><b>Definition:</b> <a href="rte__ip_8h_source.html#l00053">rte_ip.h:53</a></div></div>
<div class="ttc" id="astructrte__mbuf_html_a82a34cb6d5935a8c0f043f2783d6b42d"><div class="ttname"><a href="structrte__mbuf.html#a82a34cb6d5935a8c0f043f2783d6b42d">rte_mbuf::l3_len</a></div><div class="ttdeci">uint64_t l3_len</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00606">rte_mbuf_core.h:606</a></div></div>
<div class="ttc" id="arte__lcore_8h_html_ac779e61584eb9d087c3e20bf2d1150c8"><div class="ttname"><a href="rte__lcore_8h.html#ac779e61584eb9d087c3e20bf2d1150c8">RTE_LCORE_FOREACH_WORKER</a></div><div class="ttdeci">#define RTE_LCORE_FOREACH_WORKER(i)</div><div class="ttdef"><b>Definition:</b> <a href="rte__lcore_8h_source.html#l00239">rte_lcore.h:239</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a36ba70a5a6fce2c2c1f774828ba78f8d"><div class="ttname"><a href="rte__ethdev_8h.html#a36ba70a5a6fce2c2c1f774828ba78f8d">rte_eth_rx_queue_setup</a></div><div class="ttdeci">int rte_eth_rx_queue_setup(uint16_t port_id, uint16_t rx_queue_id, uint16_t nb_rx_desc, unsigned int socket_id, const struct rte_eth_rxconf *rx_conf, struct rte_mempool *mb_pool)</div></div>
<div class="ttc" id="astructrte__eth__conf_html_addc9c7bb19ed12f1171c543493553806"><div class="ttname"><a href="structrte__eth__conf.html#addc9c7bb19ed12f1171c543493553806">rte_eth_conf::rss_conf</a></div><div class="ttdeci">struct rte_eth_rss_conf rss_conf</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01327">rte_ethdev.h:1309</a></div></div>
<div class="ttc" id="arte__eventdev_8h_html_a3c199a28e97411266a069bd07c9757fa"><div class="ttname"><a href="rte__eventdev_8h.html#a3c199a28e97411266a069bd07c9757fa">RTE_SCHED_TYPE_ATOMIC</a></div><div class="ttdeci">#define RTE_SCHED_TYPE_ATOMIC</div><div class="ttdef"><b>Definition:</b> <a href="rte__eventdev_8h_source.html#l00961">rte_eventdev.h:944</a></div></div>
<div class="ttc" id="arte__mempool_8h_html"><div class="ttname"><a href="rte__mempool_8h.html">rte_mempool.h</a></div></div>
<div class="ttc" id="arte__lpm_8h_html_a8ae31c18e8e385d52aa68cd2787d7e2a"><div class="ttname"><a href="rte__lpm_8h.html#a8ae31c18e8e385d52aa68cd2787d7e2a">RTE_LPM_LOOKUP_SUCCESS</a></div><div class="ttdeci">#define RTE_LPM_LOOKUP_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="rte__lpm_8h_source.html#l00065">rte_lpm.h:65</a></div></div>
<div class="ttc" id="astructrte__ipv4__hdr_html_ae5759afc2c39ee0ff1cf77f61173260e"><div class="ttname"><a href="structrte__ipv4__hdr.html#ae5759afc2c39ee0ff1cf77f61173260e">rte_ipv4_hdr::total_length</a></div><div class="ttdeci">rte_be16_t total_length</div><div class="ttdef"><b>Definition:</b> <a href="rte__ip_8h_source.html#l00036">rte_ip.h:36</a></div></div>
<div class="ttc" id="astructrte__eth__conf_html_a084e132696e8d0f59f643d822c8cedb7"><div class="ttname"><a href="structrte__eth__conf.html#a084e132696e8d0f59f643d822c8cedb7">rte_eth_conf::rx_adv_conf</a></div><div class="ttdeci">struct rte_eth_conf::@153 rx_adv_conf</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a0449571f8fe2d8751f35999a5508f8beaa8bb18616ef0485c9fd7e493d6d909b2"><div class="ttname"><a href="rte__ethdev_8h.html#a0449571f8fe2d8751f35999a5508f8beaa8bb18616ef0485c9fd7e493d6d909b2">RTE_ETH_EVENT_IPSEC_ESN_OVERFLOW</a></div><div class="ttdeci">@ RTE_ETH_EVENT_IPSEC_ESN_OVERFLOW</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l03419">rte_ethdev.h:3418</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c"><div class="ttname"><a href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c">RTE_CRYPTO_SYM_XFORM_CIPHER</a></div><div class="ttdeci">@ RTE_CRYPTO_SYM_XFORM_CIPHER</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00530">rte_crypto_sym.h:530</a></div></div>
<div class="ttc" id="arte__flow_8h_html_a0446d6e5f60844b7729d0fafdf165403"><div class="ttname"><a href="rte__flow_8h.html#a0446d6e5f60844b7729d0fafdf165403">rte_flow_destroy</a></div><div class="ttdeci">int rte_flow_destroy(uint16_t port_id, struct rte_flow *flow, struct rte_flow_error *error)</div></div>
<div class="ttc" id="arte__ethdev_8h_html"><div class="ttname"><a href="rte__ethdev_8h.html">rte_ethdev.h</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a6fc010cf6216331c50bc02d2fd4e614f"><div class="ttname"><a href="rte__ethdev_8h.html#a6fc010cf6216331c50bc02d2fd4e614f">rte_eth_dev_stop</a></div><div class="ttdeci">int rte_eth_dev_stop(uint16_t port_id)</div></div>
<div class="ttc" id="arte__log_8h_html_ac23caeb9833fd0fd0665c6c05ec806fe"><div class="ttname"><a href="rte__log_8h.html#ac23caeb9833fd0fd0665c6c05ec806fe">RTE_LOG</a></div><div class="ttdeci">#define RTE_LOG(l, t,...)</div><div class="ttdef"><b>Definition:</b> <a href="rte__log_8h_source.html#l00331">rte_log.h:331</a></div></div>
<div class="ttc" id="arte__ip__frag_8h_html_a20a18f3aadcc2f5bdd9ccdd306860ba5"><div class="ttname"><a href="rte__ip__frag_8h.html#a20a18f3aadcc2f5bdd9ccdd306860ba5">rte_ipv4_frag_pkt_is_fragmented</a></div><div class="ttdeci">static int rte_ipv4_frag_pkt_is_fragmented(const struct rte_ipv4_hdr *hdr)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ip__frag_8h_source.html#l00285">rte_ip_frag.h:285</a></div></div>
<div class="ttc" id="astructrte__ipv6__hdr_html"><div class="ttname"><a href="structrte__ipv6__hdr.html">rte_ipv6_hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ip_8h_source.html#l00387">rte_ip.h:387</a></div></div>
<div class="ttc" id="arte__mbuf_8h_html"><div class="ttname"><a href="rte__mbuf_8h.html">rte_mbuf.h</a></div></div>
<div class="ttc" id="arte__launch_8h_html"><div class="ttname"><a href="rte__launch_8h.html">rte_launch.h</a></div></div>
<div class="ttc" id="arte__ip__frag_8h_html_ae3e47fcd41f6ee74b920eabc0bc86565"><div class="ttname"><a href="rte__ip__frag_8h.html#ae3e47fcd41f6ee74b920eabc0bc86565">rte_ipv6_fragment_packet</a></div><div class="ttdeci">int32_t rte_ipv6_fragment_packet(struct rte_mbuf *pkt_in, struct rte_mbuf **pkts_out, uint16_t nb_pkts_out, uint16_t mtu_size, struct rte_mempool *pool_direct, struct rte_mempool *pool_indirect)</div></div>
<div class="ttc" id="astructrte__eth__conf_html_a1c33c9d2e5cdb14b62ed386bf3159e07"><div class="ttname"><a href="structrte__eth__conf.html#a1c33c9d2e5cdb14b62ed386bf3159e07">rte_eth_conf::txmode</a></div><div class="ttdeci">struct rte_eth_txmode txmode</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01294">rte_ethdev.h:1302</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a46aecd6ebcceea1eba91d16a90e76782a87d8d14b56f41d42ca643d33a279912a"><div class="ttname"><a href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a87d8d14b56f41d42ca643d33a279912a">RTE_CRYPTO_SYM_XFORM_AEAD</a></div><div class="ttdeci">@ RTE_CRYPTO_SYM_XFORM_AEAD</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00532">rte_crypto_sym.h:531</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a0449571f8fe2d8751f35999a5508f8bea66a7ea9e93381cdf133f6bd86fbd85df"><div class="ttname"><a href="rte__ethdev_8h.html#a0449571f8fe2d8751f35999a5508f8bea66a7ea9e93381cdf133f6bd86fbd85df">RTE_ETH_EVENT_IPSEC_MAX</a></div><div class="ttdeci">@ RTE_ETH_EVENT_IPSEC_MAX</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l03426">rte_ethdev.h:3424</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a7a31d6736244603b6a1d7efdd32a8834"><div class="ttname"><a href="rte__ethdev_8h.html#a7a31d6736244603b6a1d7efdd32a8834">RTE_ETH_LINK_MAX_STR_LEN</a></div><div class="ttdeci">#define RTE_ETH_LINK_MAX_STR_LEN</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00327">rte_ethdev.h:327</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_a8478d650a7d2c49b1e1a173e52d52d35"><div class="ttname"><a href="rte__mbuf__core_8h.html#a8478d650a7d2c49b1e1a173e52d52d35">PKT_TX_IPV6</a></div><div class="ttdeci">#define PKT_TX_IPV6</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00340">rte_mbuf_core.h:340</a></div></div>
<div class="ttc" id="arte__launch_8h_html_a7fe96b0e5d3a6a8cf9b8d1a27cf3f159ad00c59bb386320b2ba3198d3149a0c35"><div class="ttname"><a href="rte__launch_8h.html#a7fe96b0e5d3a6a8cf9b8d1a27cf3f159ad00c59bb386320b2ba3198d3149a0c35">CALL_MAIN</a></div><div class="ttdeci">@ CALL_MAIN</div><div class="ttdef"><b>Definition:</b> <a href="rte__launch_8h_source.html#l00073">rte_launch.h:73</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a1a0c23adc25339b56bd19242194a002f"><div class="ttname"><a href="rte__cryptodev_8h.html#a1a0c23adc25339b56bd19242194a002f">rte_cryptodev_count</a></div><div class="ttdeci">uint8_t rte_cryptodev_count(void)</div></div>
<div class="ttc" id="arte__hash_8h_html_a5afbd2564f738149a241bc22b2428612"><div class="ttname"><a href="rte__hash_8h.html#a5afbd2564f738149a241bc22b2428612">rte_hash_create</a></div><div class="ttdeci">struct rte_hash * rte_hash_create(const struct rte_hash_parameters *params)</div></div>
<div class="ttc" id="arte__ether_8h_html_a15583fc4e341572ad37c8beace664ea8"><div class="ttname"><a href="rte__ether_8h.html#a15583fc4e341572ad37c8beace664ea8">RTE_ETHER_TYPE_IPV4</a></div><div class="ttdeci">#define RTE_ETHER_TYPE_IPV4</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00283">rte_ether.h:283</a></div></div>
<div class="ttc" id="astructrte__flow__error_html"><div class="ttname"><a href="structrte__flow__error.html">rte_flow_error</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__flow_8h_source.html#l02901">rte_flow.h:2901</a></div></div>
<div class="ttc" id="astructrte__eth__dev__info_html"><div class="ttname"><a href="structrte__eth__dev__info.html">rte_eth_dev_info</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01504">rte_ethdev.h:1504</a></div></div>
<div class="ttc" id="astructrte__hash_html"><div class="ttname"><a href="structrte__hash.html">rte_hash</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cuckoo__hash_8h_source.html#l00160">rte_cuckoo_hash.h:160</a></div></div>
<div class="ttc" id="astructrte__ether__addr_html"><div class="ttname"><a href="structrte__ether__addr.html">rte_ether_addr</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00064">rte_ether.h:64</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_ad7b46c67203d37fe3a34f11076d970d6"><div class="ttname"><a href="rte__ethdev_8h.html#ad7b46c67203d37fe3a34f11076d970d6">RTE_ETH_FOREACH_DEV</a></div><div class="ttdeci">#define RTE_ETH_FOREACH_DEV(p)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01858">rte_ethdev.h:1858</a></div></div>
<div class="ttc" id="astructrte__eth__conf_html"><div class="ttname"><a href="structrte__eth__conf.html">rte_eth_conf</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l01293">rte_ethdev.h:1293</a></div></div>
<div class="ttc" id="astructrte__hash__parameters_html_a229cb0bd24215f0cb940e0724dbd4d55"><div class="ttname"><a href="structrte__hash__parameters.html#a229cb0bd24215f0cb940e0724dbd4d55">rte_hash_parameters::socket_id</a></div><div class="ttdeci">int socket_id</div><div class="ttdef"><b>Definition:</b> <a href="rte__hash_8h_source.html#l00089">rte_hash.h:89</a></div></div>
<div class="ttc" id="astructrte__hash__parameters_html_a7250588fe859c80e349c79c2b15ee421"><div class="ttname"><a href="structrte__hash__parameters.html#a7250588fe859c80e349c79c2b15ee421">rte_hash_parameters::key_len</a></div><div class="ttdeci">uint32_t key_len</div><div class="ttdef"><b>Definition:</b> <a href="rte__hash_8h_source.html#l00086">rte_hash.h:86</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a7cec5687e3123c44b0020b5c5c8c3d0b"><div class="ttname"><a href="rte__cryptodev_8h.html#a7cec5687e3123c44b0020b5c5c8c3d0b">rte_cryptodev_get_feature_name</a></div><div class="ttdeci">const char * rte_cryptodev_get_feature_name(uint64_t flag)</div></div>
<div class="ttc" id="arte__ip__frag_8h_html"><div class="ttname"><a href="rte__ip__frag_8h.html">rte_ip_frag.h</a></div></div>
<div class="ttc" id="arte__per__lcore_8h_html"><div class="ttname"><a href="rte__per__lcore_8h.html">rte_per_lcore.h</a></div></div>
<div class="ttc" id="astructrte__cryptodev__capabilities_html_a632781b6c57a8ece1eb98dd4d06e1e8c"><div class="ttname"><a href="structrte__cryptodev__capabilities.html#a632781b6c57a8ece1eb98dd4d06e1e8c">rte_cryptodev_capabilities::sym</a></div><div class="ttdeci">struct rte_cryptodev_symmetric_capability sym</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00182">rte_cryptodev.h:184</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a616e039704be1e0c96a2822572c3839b"><div class="ttname"><a href="rte__cryptodev_8h.html#a616e039704be1e0c96a2822572c3839b">RTE_CRYPTODEV_FF_ASYMMETRIC_CRYPTO</a></div><div class="ttdeci">#define RTE_CRYPTODEV_FF_ASYMMETRIC_CRYPTO</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00405">rte_cryptodev.h:404</a></div></div>
<div class="ttc" id="arte__ipsec__sa_8h_html_adefe04d943154fbf1b98fba430006768"><div class="ttname"><a href="rte__ipsec__sa_8h.html#adefe04d943154fbf1b98fba430006768">RTE_IPSEC_SAFLAG_SQN_ATOM</a></div><div class="ttdeci">#define RTE_IPSEC_SAFLAG_SQN_ATOM</div><div class="ttdef"><b>Definition:</b> <a href="rte__ipsec__sa_8h_source.html#l00070">rte_ipsec_sa.h:70</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a586b8e86131b4ec0ccaf464e847ccf3eaa06694239b7ecf1efa3c9243b9e7b4c0"><div class="ttname"><a href="rte__ethdev_8h.html#a586b8e86131b4ec0ccaf464e847ccf3eaa06694239b7ecf1efa3c9243b9e7b4c0">ETH_MQ_RX_RSS</a></div><div class="ttdeci">@ ETH_MQ_RX_RSS</div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00355">rte_ethdev.h:355</a></div></div>
<div class="ttc" id="astructrte__cryptodev__config_html"><div class="ttname"><a href="structrte__cryptodev__config.html">rte_cryptodev_config</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00628">rte_cryptodev.h:628</a></div></div>
<div class="ttc" id="arte__byteorder_8h_html"><div class="ttname"><a href="rte__byteorder_8h.html">rte_byteorder.h</a></div></div>
<div class="ttc" id="astructrte__cryptodev__info_html_a65b9cdbb3719f657c9d8e581ba2a904b"><div class="ttname"><a href="structrte__cryptodev__info.html#a65b9cdbb3719f657c9d8e581ba2a904b">rte_cryptodev_info::capabilities</a></div><div class="ttdeci">const struct rte_cryptodev_capabilities * capabilities</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00485">rte_cryptodev.h:485</a></div></div>
<div class="ttc" id="astructrte__cryptodev__symmetric__capability_html_afe276edbba98b3f82f0826d7feaeb82f"><div class="ttname"><a href="structrte__cryptodev__symmetric__capability.html#afe276edbba98b3f82f0826d7feaeb82f">rte_cryptodev_symmetric_capability::xform_type</a></div><div class="ttdeci">enum rte_crypto_sym_xform_type xform_type</div><div class="ttdef"><b>Definition:</b> <a href="rte__cryptodev_8h_source.html#l00089">rte_cryptodev.h:101</a></div></div>
<div class="ttc" id="astructrte__ip__frag__tbl_html"><div class="ttname"><a href="structrte__ip__frag__tbl.html">rte_ip_frag_tbl</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ip__frag_8h_source.html#l00099">rte_ip_frag.h:99</a></div></div>
<div class="ttc" id="astructrte__mempool_html_a229cb0bd24215f0cb940e0724dbd4d55"><div class="ttname"><a href="structrte__mempool.html#a229cb0bd24215f0cb940e0724dbd4d55">rte_mempool::socket_id</a></div><div class="ttdeci">int socket_id</div><div class="ttdef"><b>Definition:</b> <a href="rte__mempool_8h_source.html#l00222">rte_mempool.h:222</a></div></div>
<div class="ttc" id="arte__cycles_8h_html_af73b844d50b98de74b1a0e1730262f85"><div class="ttname"><a href="rte__cycles_8h.html#af73b844d50b98de74b1a0e1730262f85">rte_delay_ms</a></div><div class="ttdeci">static void rte_delay_ms(unsigned ms)</div><div class="ttdef"><b>Definition:</b> <a href="rte__cycles_8h_source.html#l00148">rte_cycles.h:148</a></div></div>
<div class="ttc" id="arte__eventdev_8h_html_a366ab13bc5be32cbc9ee15e294b4c9a2"><div class="ttname"><a href="rte__eventdev_8h.html#a366ab13bc5be32cbc9ee15e294b4c9a2">RTE_SCHED_TYPE_ORDERED</a></div><div class="ttdeci">#define RTE_SCHED_TYPE_ORDERED</div><div class="ttdef"><b>Definition:</b> <a href="rte__eventdev_8h_source.html#l00942">rte_eventdev.h:917</a></div></div>
<div class="ttc" id="arte__ether_8h_html_af1fb088707ce5b2ebb7825cb69b5cb58"><div class="ttname"><a href="rte__ether_8h.html#af1fb088707ce5b2ebb7825cb69b5cb58">RTE_ETHER_MAX_LEN</a></div><div class="ttdeci">#define RTE_ETHER_MAX_LEN</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00037">rte_ether.h:37</a></div></div>
<div class="ttc" id="astructrte__ether__hdr_html_a1d579e2782d36729c1f73608d8663124"><div class="ttname"><a href="structrte__ether__hdr.html#a1d579e2782d36729c1f73608d8663124">rte_ether_hdr::d_addr</a></div><div class="ttdeci">struct rte_ether_addr d_addr</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00000">rte_ether.h:265</a></div></div>
<div class="ttc" id="arte__launch_8h_html_ae9500e1d35bd4cfb95d18c0be863cb1e"><div class="ttname"><a href="rte__launch_8h.html#ae9500e1d35bd4cfb95d18c0be863cb1e">rte_eal_wait_lcore</a></div><div class="ttdeci">int rte_eal_wait_lcore(unsigned worker_id)</div></div>
<div class="ttc" id="arte__errno_8h_html_a66171a00ea02084317df4dc9c2adaccb"><div class="ttname"><a href="rte__errno_8h.html#a66171a00ea02084317df4dc9c2adaccb">rte_errno</a></div><div class="ttdeci">#define rte_errno</div><div class="ttdef"><b>Definition:</b> <a href="rte__errno_8h_source.html#l00029">rte_errno.h:29</a></div></div>
<div class="ttc" id="arte__eventdev_8h_html"><div class="ttname"><a href="rte__eventdev_8h.html">rte_eventdev.h</a></div></div>
<div class="ttc" id="astructrte__ipv4__hdr_html_a513eb1be3a24fe8df91530edd4517ade"><div class="ttname"><a href="structrte__ipv4__hdr.html#a513eb1be3a24fe8df91530edd4517ade">rte_ipv4_hdr::next_proto_id</a></div><div class="ttdeci">uint8_t next_proto_id</div><div class="ttdef"><b>Definition:</b> <a href="rte__ip_8h_source.html#l00040">rte_ip.h:40</a></div></div>
<div class="ttc" id="arte__ip_8h_html_a8be1ccea98d6afa79fe0c8531eb266f7"><div class="ttname"><a href="rte__ip_8h.html#a8be1ccea98d6afa79fe0c8531eb266f7">rte_ipv4_cksum</a></div><div class="ttdeci">static uint16_t rte_ipv4_cksum(const struct rte_ipv4_hdr *ipv4_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="rte__ip_8h_source.html#l00289">rte_ip.h:289</a></div></div>
<div class="ttc" id="arte__security_8h_html_ab09ae03f5dd326c79671cc7147c0b73c"><div class="ttname"><a href="rte__security_8h.html#ab09ae03f5dd326c79671cc7147c0b73c">rte_security_session_get_size</a></div><div class="ttdeci">unsigned int rte_security_session_get_size(struct rte_security_ctx *instance)</div></div>
<div class="ttc" id="arte__prefetch_8h_html"><div class="ttname"><a href="rte__prefetch_8h.html">rte_prefetch.h</a></div></div>
<div class="ttc" id="arte__mbuf__core_8h_html_a9d2d4eca2fab4ef35c8f8a7f3bbe9fe2"><div class="ttname"><a href="rte__mbuf__core_8h.html#a9d2d4eca2fab4ef35c8f8a7f3bbe9fe2">PKT_TX_IPV4</a></div><div class="ttdeci">#define PKT_TX_IPV4</div><div class="ttdef"><b>Definition:</b> <a href="rte__mbuf__core_8h_source.html#l00332">rte_mbuf_core.h:332</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_ac2c7507787a5520e8049fff94432169e"><div class="ttname"><a href="rte__ethdev_8h.html#ac2c7507787a5520e8049fff94432169e">rte_eth_dev_close</a></div><div class="ttdeci">int rte_eth_dev_close(uint16_t port_id)</div></div>
<div class="ttc" id="arte__hash_8h_html_a31fbd5835f9ed6ff92e052a79f905237"><div class="ttname"><a href="rte__hash_8h.html#a31fbd5835f9ed6ff92e052a79f905237">rte_hash_add_key_data</a></div><div class="ttdeci">int rte_hash_add_key_data(const struct rte_hash *h, const void *key, void *data)</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
