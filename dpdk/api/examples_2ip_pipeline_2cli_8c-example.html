<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DPDK: examples/ip_pipeline/cli.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DPDK
   &#160;<span id="projectnumber">20.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">examples/ip_pipeline/cli.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/* SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment"> * Copyright(c) 2010-2018 Intel Corporation</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__common_8h.html">rte_common.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__cycles_8h.html">rte_cycles.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ethdev_8h.html">rte_ethdev.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;cli.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;cryptodev.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;kni.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;link.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;mempool.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;parser.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;pipeline.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;swq.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;tap.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;thread.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;tmgr.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef CMD_MAX_TOKENS</span></div>
<div class="line"><span class="preprocessor">#define CMD_MAX_TOKENS     256</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MSG_OUT_OF_MEMORY   &quot;Not enough memory.\n&quot;</span></div>
<div class="line"><span class="preprocessor">#define MSG_CMD_UNKNOWN     &quot;Unknown command \&quot;%s\&quot;.\n&quot;</span></div>
<div class="line"><span class="preprocessor">#define MSG_CMD_UNIMPLEM    &quot;Command \&quot;%s\&quot; not implemented.\n&quot;</span></div>
<div class="line"><span class="preprocessor">#define MSG_ARG_NOT_ENOUGH  &quot;Not enough arguments for command \&quot;%s\&quot;.\n&quot;</span></div>
<div class="line"><span class="preprocessor">#define MSG_ARG_TOO_MANY    &quot;Too many arguments for command \&quot;%s\&quot;.\n&quot;</span></div>
<div class="line"><span class="preprocessor">#define MSG_ARG_MISMATCH    &quot;Wrong number of arguments for command \&quot;%s\&quot;.\n&quot;</span></div>
<div class="line"><span class="preprocessor">#define MSG_ARG_NOT_FOUND   &quot;Argument \&quot;%s\&quot; not found.\n&quot;</span></div>
<div class="line"><span class="preprocessor">#define MSG_ARG_INVALID     &quot;Invalid value for argument \&quot;%s\&quot;.\n&quot;</span></div>
<div class="line"><span class="preprocessor">#define MSG_FILE_ERR        &quot;Error in file \&quot;%s\&quot; at line %u.\n&quot;</span></div>
<div class="line"><span class="preprocessor">#define MSG_FILE_NOT_ENOUGH &quot;Not enough rules in file \&quot;%s\&quot;.\n&quot;</span></div>
<div class="line"><span class="preprocessor">#define MSG_CMD_FAIL        &quot;Command \&quot;%s\&quot; failed.\n&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">is_comment(<span class="keywordtype">char</span> *in)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> ((strlen(in) &amp;&amp; index(<span class="stringliteral">&quot;!#%;&quot;</span>, in[0])) ||</div>
<div class="line">        (strncmp(in, <span class="stringliteral">&quot;//&quot;</span>, 2) == 0) ||</div>
<div class="line">        (strncmp(in, <span class="stringliteral">&quot;--&quot;</span>, 2) == 0))</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_mempool_help[] =</div>
<div class="line"><span class="stringliteral">&quot;mempool &lt;mempool_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   buffer &lt;buffer_size&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   pool &lt;pool_size&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   cache &lt;cache_size&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   cpu &lt;cpu_id&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_mempool(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>mempool_params p;</div>
<div class="line">    <span class="keywordtype">char</span> *name;</div>
<div class="line">    <span class="keyword">struct </span>mempool *mempool;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 10) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;buffer&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;buffer&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.buffer_size, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;buffer_size&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;pool&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;pool&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.pool_size, tokens[5]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;pool_size&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;cache&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;cache&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.cache_size, tokens[7]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;cache_size&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[8], <span class="stringliteral">&quot;cpu&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;cpu&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.cpu_id, tokens[9]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;cpu_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    mempool = mempool_create(name, &amp;p);</div>
<div class="line">    <span class="keywordflow">if</span> (mempool == NULL) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_link_help[] =</div>
<div class="line"><span class="stringliteral">&quot;link &lt;link_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   dev &lt;device_name&gt; | port &lt;port_id&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   rxq &lt;n_queues&gt; &lt;queue_size&gt; &lt;mempool_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   txq &lt;n_queues&gt; &lt;queue_size&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   promiscuous on | off\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   [rss &lt;qid_0&gt; ... &lt;qid_n&gt;]\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_link(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>link_params p;</div>
<div class="line">    <span class="keyword">struct </span>link_params_rss rss;</div>
<div class="line">    <span class="keyword">struct </span>link *link;</div>
<div class="line">    <span class="keywordtype">char</span> *name;</div>
<div class="line"> </div>
<div class="line">    memset(&amp;p, 0, <span class="keyword">sizeof</span>(p));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens &lt; 13) || (n_tokens &gt; 14 + LINK_RXQ_RSS_MAX)) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;dev&quot;</span>) == 0)</div>
<div class="line">        p.dev_name = tokens[3];</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;port&quot;</span>) == 0) {</div>
<div class="line">        p.dev_name = NULL;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint16(&amp;p.port_id, tokens[3]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;port_id&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;dev or port&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;rxq&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;rxq&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.rx.n_queues, tokens[5]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;n_queues&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.rx.queue_size, tokens[6]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;queue_size&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    p.rx.mempool_name = tokens[7];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[8], <span class="stringliteral">&quot;txq&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;txq&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.tx.n_queues, tokens[9]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;n_queues&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.tx.queue_size, tokens[10]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;queue_size&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[11], <span class="stringliteral">&quot;promiscuous&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;promiscuous&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[12], <span class="stringliteral">&quot;on&quot;</span>) == 0)</div>
<div class="line">        p.promiscuous = 1;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[12], <span class="stringliteral">&quot;off&quot;</span>) == 0)</div>
<div class="line">        p.promiscuous = 0;</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;on or off&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* RSS */</span></div>
<div class="line">    p.rx.rss = NULL;</div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &gt; 13) {</div>
<div class="line">        uint32_t queue_id, i;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[13], <span class="stringliteral">&quot;rss&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;rss&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.rx.rss = &amp;rss;</div>
<div class="line"> </div>
<div class="line">        rss.n_queues = 0;</div>
<div class="line">        <span class="keywordflow">for</span> (i = 14; i &lt; n_tokens; i++) {</div>
<div class="line">            <span class="keywordflow">if</span> (parser_read_uint32(&amp;queue_id, tokens[i]) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                    <span class="stringliteral">&quot;queue_id&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            rss.queue_id[rss.n_queues] = queue_id;</div>
<div class="line">            rss.n_queues++;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    link = link_create(name, &amp;p);</div>
<div class="line">    <span class="keywordflow">if</span> (link == NULL) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Print the link stats and info */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">print_link_info(<span class="keyword">struct</span> link *link, <span class="keywordtype">char</span> *out, <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a0"></a><a class="code" href="structrte__eth__stats.html">rte_eth_stats</a> stats;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a1"></a><a class="code" href="structrte__ether__addr.html">rte_ether_addr</a> mac_addr;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a2"></a><a class="code" href="structrte__eth__link.html">rte_eth_link</a> eth_link;</div>
<div class="line">    uint16_t mtu;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    memset(&amp;stats, 0, <span class="keyword">sizeof</span>(stats));</div>
<div class="line">    <a name="a3"></a><a class="code" href="rte__ethdev_8h.html#adec226574c53ae413252c9b15f6f4bab">rte_eth_stats_get</a>(link-&gt;port_id, &amp;stats);</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a4"></a><a class="code" href="rte__ethdev_8h.html#a8a28375b279ded9125c99a46bf3956ef">rte_eth_macaddr_get</a>(link-&gt;port_id, &amp;mac_addr);</div>
<div class="line">    <span class="keywordflow">if</span> (ret != 0) {</div>
<div class="line">        snprintf(out, out_size, <span class="stringliteral">&quot;\n%s: MAC address get failed: %s&quot;</span>,</div>
<div class="line">             link-&gt;name, <a name="a5"></a><a class="code" href="rte__errno_8h.html#a129a7eb4cfa1f5bdac5783bf49137d06">rte_strerror</a>(-ret));</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a6"></a><a class="code" href="rte__ethdev_8h.html#a56200b0c25f3ecab5abe9bd2b647c215">rte_eth_link_get</a>(link-&gt;port_id, &amp;eth_link);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">        snprintf(out, out_size, <span class="stringliteral">&quot;\n%s: link get failed: %s&quot;</span>,</div>
<div class="line">             link-&gt;name, <a class="code" href="rte__errno_8h.html#a129a7eb4cfa1f5bdac5783bf49137d06">rte_strerror</a>(-ret));</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a name="a7"></a><a class="code" href="rte__ethdev_8h.html#a386c83c7cc16ec9886ecf2925e7be4a3">rte_eth_dev_get_mtu</a>(link-&gt;port_id, &amp;mtu);</div>
<div class="line"> </div>
<div class="line">    snprintf(out, out_size,</div>
<div class="line">        <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;%s: flags=&lt;%s&gt; mtu %u\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\tether %02X:%02X:%02X:%02X:%02X:%02X rxqueues %u txqueues %u\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\tport# %u  speed %s\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\tRX packets %&quot;</span> PRIu64<span class="stringliteral">&quot;  bytes %&quot;</span> PRIu64<span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\tRX errors %&quot;</span> PRIu64<span class="stringliteral">&quot;  missed %&quot;</span> PRIu64<span class="stringliteral">&quot;  no-mbuf %&quot;</span> PRIu64<span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\tTX packets %&quot;</span> PRIu64<span class="stringliteral">&quot;  bytes %&quot;</span> PRIu64<span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\tTX errors %&quot;</span> PRIu64<span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line">        link-&gt;name,</div>
<div class="line">        eth_link.link_status == 0 ? <span class="stringliteral">&quot;DOWN&quot;</span> : <span class="stringliteral">&quot;UP&quot;</span>,</div>
<div class="line">        mtu,</div>
<div class="line">        mac_addr.addr_bytes[0], mac_addr.addr_bytes[1],</div>
<div class="line">        mac_addr.addr_bytes[2], mac_addr.addr_bytes[3],</div>
<div class="line">        mac_addr.addr_bytes[4], mac_addr.addr_bytes[5],</div>
<div class="line">        link-&gt;n_rxq,</div>
<div class="line">        link-&gt;n_txq,</div>
<div class="line">        link-&gt;port_id,</div>
<div class="line">        <a name="a8"></a><a class="code" href="rte__ethdev_8h.html#ade8a6c56c3b7c65fa4cabf1d1106fdc7">rte_eth_link_speed_to_str</a>(eth_link.link_speed),</div>
<div class="line">        stats.ipackets,</div>
<div class="line">        stats.ibytes,</div>
<div class="line">        stats.ierrors,</div>
<div class="line">        stats.imissed,</div>
<div class="line">        stats.rx_nombuf,</div>
<div class="line">        stats.opackets,</div>
<div class="line">        stats.obytes,</div>
<div class="line">        stats.oerrors);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * link show [&lt;link_name&gt;]</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_link_show(<span class="keywordtype">char</span> **tokens, uint32_t n_tokens, <span class="keywordtype">char</span> *out, <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>link *link;</div>
<div class="line">    <span class="keywordtype">char</span> *link_name;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 2 &amp;&amp; n_tokens != 3) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens == 2) {</div>
<div class="line">        link = link_next(NULL);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">while</span> (link != NULL) {</div>
<div class="line">            out_size = out_size - strlen(out);</div>
<div class="line">            out = &amp;out[strlen(out)];</div>
<div class="line"> </div>
<div class="line">            print_link_info(link, out, out_size);</div>
<div class="line">            link = link_next(link);</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        out_size = out_size - strlen(out);</div>
<div class="line">        out = &amp;out[strlen(out)];</div>
<div class="line"> </div>
<div class="line">        link_name = tokens[2];</div>
<div class="line">        link = link_find(link_name);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (link == NULL) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                    <span class="stringliteral">&quot;Link does not exist&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        print_link_info(link, out, out_size);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_swq_help[] =</div>
<div class="line"><span class="stringliteral">&quot;swq &lt;swq_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   size &lt;size&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   cpu &lt;cpu_id&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_swq(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>swq_params p;</div>
<div class="line">    <span class="keywordtype">char</span> *name;</div>
<div class="line">    <span class="keyword">struct </span>swq *swq;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 6) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;size&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;size&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.size, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;size&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;cpu&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;cpu&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.cpu_id, tokens[5]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;cpu_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    swq = swq_create(name, &amp;p);</div>
<div class="line">    <span class="keywordflow">if</span> (swq == NULL) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_tmgr_subport_profile_help[] =</div>
<div class="line"><span class="stringliteral">&quot;tmgr subport profile\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   &lt;tb_rate&gt; &lt;tb_size&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   &lt;tc0_rate&gt; &lt;tc1_rate&gt; &lt;tc2_rate&gt; &lt;tc3_rate&gt; &lt;tc4_rate&gt;&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;        &lt;tc5_rate&gt; &lt;tc6_rate&gt; &lt;tc7_rate&gt; &lt;tc8_rate&gt;&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;        &lt;tc9_rate&gt; &lt;tc10_rate&gt; &lt;tc11_rate&gt; &lt;tc12_rate&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   &lt;tc_period&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_tmgr_subport_profile(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>rte_sched_subport_profile_params subport_profile;</div>
<div class="line">    <span class="keywordtype">int</span> status, i;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 19) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint64(&amp;subport_profile.tb_rate, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;tb_rate&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint64(&amp;subport_profile.tb_size, tokens[4]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;tb_size&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; <a name="a9"></a><a class="code" href="rte__sched_8h.html#a987eaedb9cd05abdbdb1bf30ed446ac1">RTE_SCHED_TRAFFIC_CLASSES_PER_PIPE</a>; i++)</div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint64(&amp;subport_profile.tc_rate[i],</div>
<div class="line">                tokens[5 + i]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;tc_rate&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint64(&amp;subport_profile.tc_period, tokens[18]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;tc_period&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = tmgr_subport_profile_add(&amp;subport_profile);</div>
<div class="line">    <span class="keywordflow">if</span> (status != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_tmgr_pipe_profile_help[] =</div>
<div class="line"><span class="stringliteral">&quot;tmgr pipe profile\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   &lt;tb_rate&gt; &lt;tb_size&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   &lt;tc0_rate&gt; &lt;tc1_rate&gt; &lt;tc2_rate&gt; &lt;tc3_rate&gt; &lt;tc4_rate&gt;&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;     &lt;tc5_rate&gt; &lt;tc6_rate&gt; &lt;tc7_rate&gt; &lt;tc8_rate&gt;&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;     &lt;tc9_rate&gt; &lt;tc10_rate&gt; &lt;tc11_rate&gt; &lt;tc12_rate&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   &lt;tc_period&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   &lt;tc_ov_weight&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   &lt;wrr_weight0..3&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_tmgr_pipe_profile(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>rte_sched_pipe_params p;</div>
<div class="line">    <span class="keywordtype">int</span> status, i;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 24) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint64(&amp;p.tb_rate, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;tb_rate&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint64(&amp;p.tb_size, tokens[4]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;tb_size&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="rte__sched_8h.html#a987eaedb9cd05abdbdb1bf30ed446ac1">RTE_SCHED_TRAFFIC_CLASSES_PER_PIPE</a>; i++)</div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint64(&amp;p.tc_rate[i], tokens[5 + i]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;tc_rate&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint64(&amp;p.tc_period, tokens[18]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;tc_period&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint8(&amp;p.tc_ov_weight, tokens[19]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;tc_ov_weight&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; <a name="a10"></a><a class="code" href="rte__sched_8h.html#ad30bb3bc9bb7531556d7866882135642">RTE_SCHED_BE_QUEUES_PER_PIPE</a>; i++)</div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint8(&amp;p.wrr_weights[i], tokens[20 + i]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;wrr_weights&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    status = tmgr_pipe_profile_add(&amp;p);</div>
<div class="line">    <span class="keywordflow">if</span> (status != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_tmgr_help[] =</div>
<div class="line"><span class="stringliteral">&quot;tmgr &lt;tmgr_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   rate &lt;rate&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   spp &lt;n_subports_per_port&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   pps &lt;n_pipes_per_subport&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   fo &lt;frame_overhead&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   mtu &lt;mtu&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   cpu &lt;cpu_id&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_tmgr(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>tmgr_port_params p;</div>
<div class="line">    <span class="keywordtype">char</span> *name;</div>
<div class="line">    <span class="keyword">struct </span>tmgr_port *tmgr_port;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 14) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;rate&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;rate&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint64(&amp;p.rate, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;rate&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;spp&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;spp&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.n_subports_per_port, tokens[5]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;n_subports_per_port&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;pps&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;spp&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.n_pipes_per_subport, tokens[7]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;n_pipes_per_subport&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[8], <span class="stringliteral">&quot;fo&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;fo&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.frame_overhead, tokens[9]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;frame_overhead&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[10], <span class="stringliteral">&quot;mtu&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;mtu&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.mtu, tokens[11]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;mtu&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[12], <span class="stringliteral">&quot;cpu&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;cpu&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.cpu_id, tokens[13]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;cpu_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    tmgr_port = tmgr_port_create(name, &amp;p);</div>
<div class="line">    <span class="keywordflow">if</span> (tmgr_port == NULL) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_tmgr_subport_help[] =</div>
<div class="line"><span class="stringliteral">&quot;tmgr &lt;tmgr_name&gt; subport &lt;subport_id&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   profile &lt;subport_profile_id&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_tmgr_subport(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    uint32_t subport_id, subport_profile_id;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line">    <span class="keywordtype">char</span> *name;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 6) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;subport_id, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;subport_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;subport_profile_id, tokens[5]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;subport_profile_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = tmgr_subport_config(name, subport_id, subport_profile_id);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_tmgr_subport_pipe_help[] =</div>
<div class="line"><span class="stringliteral">&quot;tmgr &lt;tmgr_name&gt; subport &lt;subport_id&gt; pipe\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   from &lt;pipe_id_first&gt; to &lt;pipe_id_last&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   profile &lt;pipe_profile_id&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_tmgr_subport_pipe(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    uint32_t subport_id, pipe_id_first, pipe_id_last, pipe_profile_id;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line">    <span class="keywordtype">char</span> *name;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 11) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;subport_id, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;subport_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;pipe&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;pipe&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;from&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;from&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;pipe_id_first, tokens[6]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;pipe_id_first&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[7], <span class="stringliteral">&quot;to&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;to&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;pipe_id_last, tokens[8]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;pipe_id_last&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[9], <span class="stringliteral">&quot;profile&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;profile&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;pipe_profile_id, tokens[10]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;pipe_profile_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = tmgr_pipe_config(name, subport_id, pipe_id_first,</div>
<div class="line">            pipe_id_last, pipe_profile_id);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_tap_help[] =</div>
<div class="line"><span class="stringliteral">&quot;tap &lt;tap_name&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_tap(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *name;</div>
<div class="line">    <span class="keyword">struct </span>tap *tap;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 2) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    tap = tap_create(name);</div>
<div class="line">    <span class="keywordflow">if</span> (tap == NULL) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_kni_help[] =</div>
<div class="line"><span class="stringliteral">&quot;kni &lt;kni_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   link &lt;link_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   mempool &lt;mempool_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   [thread &lt;thread_id&gt;]\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_kni(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>kni_params p;</div>
<div class="line">    <span class="keywordtype">char</span> *name;</div>
<div class="line">    <span class="keyword">struct </span>kni *kni;</div>
<div class="line"> </div>
<div class="line">    memset(&amp;p, 0, <span class="keyword">sizeof</span>(p));</div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens != 6) &amp;&amp; (n_tokens != 8)) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;link&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;link&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    p.link_name = tokens[3];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;mempool&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;mempool&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    p.mempool_name = tokens[5];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens == 8) {</div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;thread&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;thread&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.thread_id, tokens[7]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;thread_id&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.force_bind = 1;</div>
<div class="line">    } <span class="keywordflow">else</span></div>
<div class="line">        p.force_bind = 0;</div>
<div class="line"> </div>
<div class="line">    kni = kni_create(name, &amp;p);</div>
<div class="line">    <span class="keywordflow">if</span> (kni == NULL) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_cryptodev_help[] =</div>
<div class="line"><span class="stringliteral">&quot;cryptodev &lt;cryptodev_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   dev &lt;device_name&gt; | dev_id &lt;device_id&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   queue &lt;n_queues&gt; &lt;queue_size&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   max_sessions &lt;n_sessions&gt;&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_cryptodev(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>cryptodev_params params;</div>
<div class="line">    <span class="keywordtype">char</span> *name;</div>
<div class="line"> </div>
<div class="line">    memset(&amp;params, 0, <span class="keyword">sizeof</span>(params));</div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 9) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;dev&quot;</span>) == 0)</div>
<div class="line">        params.dev_name = tokens[3];</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;dev_id&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;params.dev_id, tokens[3]) &lt; 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;dev_id&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">            <span class="stringliteral">&quot;cryptodev&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;queue&quot;</span>)) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">            <span class="stringliteral">&quot;queue&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;params.n_queues, tokens[5]) &lt; 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">            <span class="stringliteral">&quot;q&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;params.queue_size, tokens[6]) &lt; 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">            <span class="stringliteral">&quot;queue_size&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[7], <span class="stringliteral">&quot;max_sessions&quot;</span>)) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">            <span class="stringliteral">&quot;max_sessions&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;params.session_pool_size, tokens[8]) &lt; 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">            <span class="stringliteral">&quot;queue_size&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cryptodev_create(name, &amp;params) == NULL) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_port_in_action_profile_help[] =</div>
<div class="line"><span class="stringliteral">&quot;port in action profile &lt;profile_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   [filter match | mismatch offset &lt;key_offset&gt; mask &lt;key_mask&gt; key &lt;key_value&gt; port &lt;port_id&gt;]\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   [balance offset &lt;key_offset&gt; mask &lt;key_mask&gt; port &lt;port_id0&gt; ... &lt;port_id15&gt;]\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_port_in_action_profile(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>port_in_action_profile_params p;</div>
<div class="line">    <span class="keyword">struct </span>port_in_action_profile *ap;</div>
<div class="line">    <span class="keywordtype">char</span> *name;</div>
<div class="line">    uint32_t t0;</div>
<div class="line"> </div>
<div class="line">    memset(&amp;p, 0, <span class="keyword">sizeof</span>(p));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &lt; 5) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[1], <span class="stringliteral">&quot;in&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;in&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;action&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;action&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[3], <span class="stringliteral">&quot;profile&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;profile&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    name = tokens[4];</div>
<div class="line"> </div>
<div class="line">    t0 = 5;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((t0 &lt; n_tokens) &amp;&amp; (strcmp(tokens[t0], <span class="stringliteral">&quot;filter&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t size;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 10) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH, <span class="stringliteral">&quot;port in action profile filter&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;match&quot;</span>) == 0)</div>
<div class="line">            p.fltr.filter_on_match = 1;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;mismatch&quot;</span>) == 0)</div>
<div class="line">            p.fltr.filter_on_match = 0;</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;match or mismatch&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 2], <span class="stringliteral">&quot;offset&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;offset&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.fltr.key_offset, tokens[t0 + 3]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;key_offset&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 4], <span class="stringliteral">&quot;mask&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;mask&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        size = <a name="a11"></a><a class="code" href="rte__port__in__action_8h.html#aa8e04a1dab3e174379b73d5e57c8bb35">RTE_PORT_IN_ACTION_FLTR_KEY_SIZE</a>;</div>
<div class="line">        <span class="keywordflow">if</span> ((parse_hex_string(tokens[t0 + 5], p.fltr.key_mask, &amp;size) != 0) ||</div>
<div class="line">            (size != <a class="code" href="rte__port__in__action_8h.html#aa8e04a1dab3e174379b73d5e57c8bb35">RTE_PORT_IN_ACTION_FLTR_KEY_SIZE</a>)) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;key_mask&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 6], <span class="stringliteral">&quot;key&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;key&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        size = <a class="code" href="rte__port__in__action_8h.html#aa8e04a1dab3e174379b73d5e57c8bb35">RTE_PORT_IN_ACTION_FLTR_KEY_SIZE</a>;</div>
<div class="line">        <span class="keywordflow">if</span> ((parse_hex_string(tokens[t0 + 7], p.fltr.key, &amp;size) != 0) ||</div>
<div class="line">            (size != <a class="code" href="rte__port__in__action_8h.html#aa8e04a1dab3e174379b73d5e57c8bb35">RTE_PORT_IN_ACTION_FLTR_KEY_SIZE</a>)) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;key_value&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 8], <span class="stringliteral">&quot;port&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;port&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.fltr.port_id, tokens[t0 + 9]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;port_id&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.action_mask |= 1LLU &lt;&lt; <a name="a12"></a><a class="code" href="rte__port__in__action_8h.html#ac5d93af8e87d41bfefed6ed260fb380eae3e717e82386ce7c487c636c258b3900">RTE_PORT_IN_ACTION_FLTR</a>;</div>
<div class="line">        t0 += 10;</div>
<div class="line">    } <span class="comment">/* filter */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((t0 &lt; n_tokens) &amp;&amp; (strcmp(tokens[t0], <span class="stringliteral">&quot;balance&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t i;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 22) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;port in action profile balance&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;offset&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;offset&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.lb.key_offset, tokens[t0 + 2]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;key_offset&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 3], <span class="stringliteral">&quot;mask&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;mask&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.lb.key_size = <a name="a13"></a><a class="code" href="rte__port__in__action_8h.html#aee01bd1fd2e3c3a1e65c6493ff7038a0">RTE_PORT_IN_ACTION_LB_KEY_SIZE_MAX</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (parse_hex_string(tokens[t0 + 4], p.lb.key_mask, &amp;p.lb.key_size) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;key_mask&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 5], <span class="stringliteral">&quot;port&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;port&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; 16; i++)</div>
<div class="line">            <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.lb.port_id[i], tokens[t0 + 6 + i]) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;port_id&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">        p.action_mask |= 1LLU &lt;&lt; <a name="a14"></a><a class="code" href="rte__port__in__action_8h.html#ac5d93af8e87d41bfefed6ed260fb380ea0b6b2ba5a14252bfef2f1cf9c804b311">RTE_PORT_IN_ACTION_LB</a>;</div>
<div class="line">        t0 += 22;</div>
<div class="line">    } <span class="comment">/* balance */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (t0 &lt; n_tokens) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ap = port_in_action_profile_create(name, &amp;p);</div>
<div class="line">    <span class="keywordflow">if</span> (ap == NULL) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_table_action_profile_help[] =</div>
<div class="line"><span class="stringliteral">&quot;table action profile &lt;profile_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   ipv4 | ipv6\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   offset &lt;ip_offset&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   fwd\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   [balance offset &lt;key_offset&gt; mask &lt;key_mask&gt; outoffset &lt;out_offset&gt;]\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   [meter srtcm | trtcm\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;       tc &lt;n_tc&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;       stats none | pkts | bytes | both]\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   [tm spp &lt;n_subports_per_port&gt; pps &lt;n_pipes_per_subport&gt;]\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   [encap ether | vlan | qinq | mpls | pppoe | qinq_pppoe \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;       vxlan offset &lt;ether_offset&gt; ipv4 | ipv6 vlan on | off]\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   [nat src | dst\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;       proto udp | tcp]\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   [ttl drop | fwd\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;       stats none | pkts]\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   [stats pkts | bytes | both]\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   [time]\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   [sym_crypto dev &lt;CRYPTODEV_NAME&gt; offset &lt;op_offset&gt;]\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   [tag]\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   [decap]\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_table_action_profile(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>table_action_profile_params p;</div>
<div class="line">    <span class="keyword">struct </span>table_action_profile *ap;</div>
<div class="line">    <span class="keywordtype">char</span> *name;</div>
<div class="line">    uint32_t t0;</div>
<div class="line"> </div>
<div class="line">    memset(&amp;p, 0, <span class="keyword">sizeof</span>(p));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &lt; 8) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[1], <span class="stringliteral">&quot;action&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;action&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;profile&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;profile&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    name = tokens[3];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;ipv4&quot;</span>) == 0)</div>
<div class="line">        p.common.ip_version = 1;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;ipv6&quot;</span>) == 0)</div>
<div class="line">        p.common.ip_version = 0;</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;ipv4 or ipv6&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;offset&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;offset&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.common.ip_offset, tokens[6]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;ip_offset&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[7], <span class="stringliteral">&quot;fwd&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;fwd&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    p.action_mask |= 1LLU &lt;&lt; <a name="a15"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aa5194910932359cba3eeca7183922dbf">RTE_TABLE_ACTION_FWD</a>;</div>
<div class="line"> </div>
<div class="line">    t0 = 8;</div>
<div class="line">    <span class="keywordflow">if</span> ((t0 &lt; n_tokens) &amp;&amp; (strcmp(tokens[t0], <span class="stringliteral">&quot;balance&quot;</span>) == 0)) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 7) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH, <span class="stringliteral">&quot;table action profile balance&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;offset&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;offset&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.lb.key_offset, tokens[t0 + 2]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;key_offset&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 3], <span class="stringliteral">&quot;mask&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;mask&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.lb.key_size = <a class="code" href="rte__port__in__action_8h.html#aee01bd1fd2e3c3a1e65c6493ff7038a0">RTE_PORT_IN_ACTION_LB_KEY_SIZE_MAX</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (parse_hex_string(tokens[t0 + 4], p.lb.key_mask, &amp;p.lb.key_size) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;key_mask&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 5], <span class="stringliteral">&quot;outoffset&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;outoffset&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.lb.out_offset, tokens[t0 + 6]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;out_offset&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.action_mask |= 1LLU &lt;&lt; <a name="a16"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2af4f7ba5c7d7eefc2fde9341b8724c11b">RTE_TABLE_ACTION_LB</a>;</div>
<div class="line">        t0 += 7;</div>
<div class="line">    } <span class="comment">/* balance */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((t0 &lt; n_tokens) &amp;&amp; (strcmp(tokens[t0], <span class="stringliteral">&quot;meter&quot;</span>) == 0)) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 6) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;table action profile meter&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;srtcm&quot;</span>) == 0)</div>
<div class="line">            p.mtr.alg = <a name="a17"></a><a class="code" href="rte__table__action_8h.html#ae2962eacf079d46d74fc6e2e7ac4d666ab51bd4d8c02db27c18cc31b0e67fb6b7">RTE_TABLE_ACTION_METER_SRTCM</a>;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;trtcm&quot;</span>) == 0)</div>
<div class="line">            p.mtr.alg = <a name="a18"></a><a class="code" href="rte__table__action_8h.html#ae2962eacf079d46d74fc6e2e7ac4d666aad855c58b7ce34e2da8f1608c800778d">RTE_TABLE_ACTION_METER_TRTCM</a>;</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                <span class="stringliteral">&quot;srtcm or trtcm&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 2], <span class="stringliteral">&quot;tc&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;tc&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.mtr.n_tc, tokens[t0 + 3]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;n_tc&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 4], <span class="stringliteral">&quot;stats&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;stats&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 5], <span class="stringliteral">&quot;none&quot;</span>) == 0) {</div>
<div class="line">            p.mtr.n_packets_enabled = 0;</div>
<div class="line">            p.mtr.n_bytes_enabled = 0;</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 5], <span class="stringliteral">&quot;pkts&quot;</span>) == 0) {</div>
<div class="line">            p.mtr.n_packets_enabled = 1;</div>
<div class="line">            p.mtr.n_bytes_enabled = 0;</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 5], <span class="stringliteral">&quot;bytes&quot;</span>) == 0) {</div>
<div class="line">            p.mtr.n_packets_enabled = 0;</div>
<div class="line">            p.mtr.n_bytes_enabled = 1;</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 5], <span class="stringliteral">&quot;both&quot;</span>) == 0) {</div>
<div class="line">            p.mtr.n_packets_enabled = 1;</div>
<div class="line">            p.mtr.n_bytes_enabled = 1;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                <span class="stringliteral">&quot;none or pkts or bytes or both&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.action_mask |= 1LLU &lt;&lt; <a name="a19"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a7442253cfdff0aec945b0ad7ddf5ab2d">RTE_TABLE_ACTION_MTR</a>;</div>
<div class="line">        t0 += 6;</div>
<div class="line">    } <span class="comment">/* meter */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((t0 &lt; n_tokens) &amp;&amp; (strcmp(tokens[t0], <span class="stringliteral">&quot;tm&quot;</span>) == 0)) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 5) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;table action profile tm&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;spp&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;spp&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.tm.n_subports_per_port,</div>
<div class="line">            tokens[t0 + 2]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;n_subports_per_port&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 3], <span class="stringliteral">&quot;pps&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;pps&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.tm.n_pipes_per_subport,</div>
<div class="line">            tokens[t0 + 4]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;n_pipes_per_subport&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.action_mask |= 1LLU &lt;&lt; <a name="a20"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a9f9ca84acea19612c86d3da0898ed34e">RTE_TABLE_ACTION_TM</a>;</div>
<div class="line">        t0 += 5;</div>
<div class="line">    } <span class="comment">/* tm */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((t0 &lt; n_tokens) &amp;&amp; (strcmp(tokens[t0], <span class="stringliteral">&quot;encap&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t n_extra_tokens = 0;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 2) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;action profile encap&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;ether&quot;</span>) == 0)</div>
<div class="line">            p.encap.encap_mask = 1LLU &lt;&lt; <a name="a21"></a><a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629cade2089a818728f7245cb6a3aea427875">RTE_TABLE_ACTION_ENCAP_ETHER</a>;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;vlan&quot;</span>) == 0)</div>
<div class="line">            p.encap.encap_mask = 1LLU &lt;&lt; <a name="a22"></a><a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629ca0cc0e97e7d412911cbe6e98994d4c2e4">RTE_TABLE_ACTION_ENCAP_VLAN</a>;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;qinq&quot;</span>) == 0)</div>
<div class="line">            p.encap.encap_mask = 1LLU &lt;&lt; <a name="a23"></a><a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629caca0bdb5026849382b38c7ddc42a902da">RTE_TABLE_ACTION_ENCAP_QINQ</a>;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;mpls&quot;</span>) == 0)</div>
<div class="line">            p.encap.encap_mask = 1LLU &lt;&lt; <a name="a24"></a><a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629ca5ff940244e800cde375a6f7dbd743c80">RTE_TABLE_ACTION_ENCAP_MPLS</a>;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;pppoe&quot;</span>) == 0)</div>
<div class="line">            p.encap.encap_mask = 1LLU &lt;&lt; <a name="a25"></a><a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629cad02d848b8cb391c8e855f16b4fef1091">RTE_TABLE_ACTION_ENCAP_PPPOE</a>;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;vxlan&quot;</span>) == 0) {</div>
<div class="line">            <span class="keywordflow">if</span> (n_tokens &lt; t0 + 2 + 5) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                    <span class="stringliteral">&quot;action profile encap vxlan&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (strcmp(tokens[t0 + 2], <span class="stringliteral">&quot;offset&quot;</span>) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                    <span class="stringliteral">&quot;vxlan: offset&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.encap.vxlan.data_offset,</div>
<div class="line">                tokens[t0 + 2 + 1]) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                    <span class="stringliteral">&quot;vxlan: ether_offset&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (strcmp(tokens[t0 + 2 + 2], <span class="stringliteral">&quot;ipv4&quot;</span>) == 0)</div>
<div class="line">                p.encap.vxlan.ip_version = 1;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 2 + 2], <span class="stringliteral">&quot;ipv6&quot;</span>) == 0)</div>
<div class="line">                p.encap.vxlan.ip_version = 0;</div>
<div class="line">            <span class="keywordflow">else</span> {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                    <span class="stringliteral">&quot;vxlan: ipv4 or ipv6&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (strcmp(tokens[t0 + 2 + 3], <span class="stringliteral">&quot;vlan&quot;</span>) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                    <span class="stringliteral">&quot;vxlan: vlan&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (strcmp(tokens[t0 + 2 + 4], <span class="stringliteral">&quot;on&quot;</span>) == 0)</div>
<div class="line">                p.encap.vxlan.vlan = 1;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 2 + 4], <span class="stringliteral">&quot;off&quot;</span>) == 0)</div>
<div class="line">                p.encap.vxlan.vlan = 0;</div>
<div class="line">            <span class="keywordflow">else</span> {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                    <span class="stringliteral">&quot;vxlan: on or off&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            p.encap.encap_mask = 1LLU &lt;&lt; <a name="a26"></a><a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629caa4687757afebb0174bc1ab65a517dfbf">RTE_TABLE_ACTION_ENCAP_VXLAN</a>;</div>
<div class="line">            n_extra_tokens = 5;</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;qinq_pppoe&quot;</span>) == 0)</div>
<div class="line">            p.encap.encap_mask =</div>
<div class="line">                1LLU &lt;&lt; <a name="a27"></a><a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629ca0ce6e8832b5b48c705b9f0f77d018b7c">RTE_TABLE_ACTION_ENCAP_QINQ_PPPOE</a>;</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH, <span class="stringliteral">&quot;encap&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.action_mask |= 1LLU &lt;&lt; <a name="a28"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1">RTE_TABLE_ACTION_ENCAP</a>;</div>
<div class="line">        t0 += 2 + n_extra_tokens;</div>
<div class="line">    } <span class="comment">/* encap */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((t0 &lt; n_tokens) &amp;&amp; (strcmp(tokens[t0], <span class="stringliteral">&quot;nat&quot;</span>) == 0)) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 4) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;table action profile nat&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;src&quot;</span>) == 0)</div>
<div class="line">            p.nat.source_nat = 1;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;dst&quot;</span>) == 0)</div>
<div class="line">            p.nat.source_nat = 0;</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                <span class="stringliteral">&quot;src or dst&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 2], <span class="stringliteral">&quot;proto&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;proto&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 3], <span class="stringliteral">&quot;tcp&quot;</span>) == 0)</div>
<div class="line">            p.nat.proto = 0x06;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 3], <span class="stringliteral">&quot;udp&quot;</span>) == 0)</div>
<div class="line">            p.nat.proto = 0x11;</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                <span class="stringliteral">&quot;tcp or udp&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.action_mask |= 1LLU &lt;&lt; <a name="a29"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a6368c734fa9c1ac9cb591160eb6bf293">RTE_TABLE_ACTION_NAT</a>;</div>
<div class="line">        t0 += 4;</div>
<div class="line">    } <span class="comment">/* nat */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((t0 &lt; n_tokens) &amp;&amp; (strcmp(tokens[t0], <span class="stringliteral">&quot;ttl&quot;</span>) == 0)) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 4) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;table action profile ttl&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;drop&quot;</span>) == 0)</div>
<div class="line">            p.ttl.drop = 1;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;fwd&quot;</span>) == 0)</div>
<div class="line">            p.ttl.drop = 0;</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                <span class="stringliteral">&quot;drop or fwd&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 2], <span class="stringliteral">&quot;stats&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;stats&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 3], <span class="stringliteral">&quot;none&quot;</span>) == 0)</div>
<div class="line">            p.ttl.n_packets_enabled = 0;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 3], <span class="stringliteral">&quot;pkts&quot;</span>) == 0)</div>
<div class="line">            p.ttl.n_packets_enabled = 1;</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                <span class="stringliteral">&quot;none or pkts&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.action_mask |= 1LLU &lt;&lt; <a name="a30"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a64248fbadf2339ff36eee3c6c7c54ce6">RTE_TABLE_ACTION_TTL</a>;</div>
<div class="line">        t0 += 4;</div>
<div class="line">    } <span class="comment">/* ttl */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((t0 &lt; n_tokens) &amp;&amp; (strcmp(tokens[t0], <span class="stringliteral">&quot;stats&quot;</span>) == 0)) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 2) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;table action profile stats&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;pkts&quot;</span>) == 0) {</div>
<div class="line">            p.stats.n_packets_enabled = 1;</div>
<div class="line">            p.stats.n_bytes_enabled = 0;</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;bytes&quot;</span>) == 0) {</div>
<div class="line">            p.stats.n_packets_enabled = 0;</div>
<div class="line">            p.stats.n_bytes_enabled = 1;</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;both&quot;</span>) == 0) {</div>
<div class="line">            p.stats.n_packets_enabled = 1;</div>
<div class="line">            p.stats.n_bytes_enabled = 1;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                <span class="stringliteral">&quot;pkts or bytes or both&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.action_mask |= 1LLU &lt;&lt; <a name="a31"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a491ff78ac06bce973d261ed4dea04101">RTE_TABLE_ACTION_STATS</a>;</div>
<div class="line">        t0 += 2;</div>
<div class="line">    } <span class="comment">/* stats */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((t0 &lt; n_tokens) &amp;&amp; (strcmp(tokens[t0], <span class="stringliteral">&quot;time&quot;</span>) == 0)) {</div>
<div class="line">        p.action_mask |= 1LLU &lt;&lt; <a name="a32"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a5ff88316e4574c62086f9f978a89fe5a">RTE_TABLE_ACTION_TIME</a>;</div>
<div class="line">        t0 += 1;</div>
<div class="line">    } <span class="comment">/* time */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((t0 &lt; n_tokens) &amp;&amp; (strcmp(tokens[t0], <span class="stringliteral">&quot;sym_crypto&quot;</span>) == 0)) {</div>
<div class="line">        <span class="keyword">struct </span>cryptodev *cryptodev;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 5 ||</div>
<div class="line">                strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;dev&quot;</span>) ||</div>
<div class="line">                strcmp(tokens[t0 + 3], <span class="stringliteral">&quot;offset&quot;</span>)) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;table action profile sym_crypto&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        cryptodev = cryptodev_find(tokens[t0 + 2]);</div>
<div class="line">        <span class="keywordflow">if</span> (cryptodev == NULL) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;table action profile sym_crypto&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.sym_crypto.cryptodev_id = cryptodev-&gt;dev_id;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.sym_crypto.op_offset,</div>
<div class="line">                tokens[t0 + 4]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                    <span class="stringliteral">&quot;table action profile sym_crypto&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.sym_crypto.mp_create = cryptodev-&gt;mp_create;</div>
<div class="line">        p.sym_crypto.mp_init = cryptodev-&gt;mp_init;</div>
<div class="line"> </div>
<div class="line">        p.action_mask |= 1LLU &lt;&lt; <a name="a33"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a962e3a5154b7a1a3e8648bd129c4b561">RTE_TABLE_ACTION_SYM_CRYPTO</a>;</div>
<div class="line"> </div>
<div class="line">        t0 += 5;</div>
<div class="line">    } <span class="comment">/* sym_crypto */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((t0 &lt; n_tokens) &amp;&amp; (strcmp(tokens[t0], <span class="stringliteral">&quot;tag&quot;</span>) == 0)) {</div>
<div class="line">        p.action_mask |= 1LLU &lt;&lt; <a name="a34"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a3a25fcdcb69e9946dc6d9f6fc7f6ac72">RTE_TABLE_ACTION_TAG</a>;</div>
<div class="line">        t0 += 1;</div>
<div class="line">    } <span class="comment">/* tag */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((t0 &lt; n_tokens) &amp;&amp; (strcmp(tokens[t0], <span class="stringliteral">&quot;decap&quot;</span>) == 0)) {</div>
<div class="line">        p.action_mask |= 1LLU &lt;&lt; <a name="a35"></a><a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a73da4960f9f9b30236eeaaed592c855c">RTE_TABLE_ACTION_DECAP</a>;</div>
<div class="line">        t0 += 1;</div>
<div class="line">    } <span class="comment">/* decap */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (t0 &lt; n_tokens) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ap = table_action_profile_create(name, &amp;p);</div>
<div class="line">    <span class="keywordflow">if</span> (ap == NULL) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   period &lt;timer_period_ms&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   offset_port_id &lt;offset_port_id&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   cpu &lt;cpu_id&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a36"></a><a class="code" href="structpipeline__params.html">pipeline_params</a> p;</div>
<div class="line">    <span class="keywordtype">char</span> *name;</div>
<div class="line">    <span class="keyword">struct </span>pipeline *pipeline;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 8) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;period&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;period&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.timer_period_ms, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;timer_period_ms&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;offset_port_id&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;offset_port_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.offset_port_id, tokens[5]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;offset_port_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;cpu&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;cpu&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.cpu_id, tokens[7]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;cpu_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline = pipeline_create(name, &amp;p);</div>
<div class="line">    <span class="keywordflow">if</span> (pipeline == NULL) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_port_in_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; port in\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   bsz &lt;burst_size&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   link &lt;link_name&gt; rxq &lt;queue_id&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   | swq &lt;swq_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   | tmgr &lt;tmgr_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   | tap &lt;tap_name&gt; mempool &lt;mempool_name&gt; mtu &lt;mtu&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   | kni &lt;kni_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   | source mempool &lt;mempool_name&gt; file &lt;file_name&gt; bpp &lt;n_bytes_per_pkt&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   | cryptodev &lt;cryptodev_name&gt; rxq &lt;queue_id&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   [action &lt;port_in_action_profile_name&gt;]\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   [disabled]\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_port_in(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>port_in_params p;</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t t0;</div>
<div class="line">    <span class="keywordtype">int</span> enabled, status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &lt; 7) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;port&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;port&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[3], <span class="stringliteral">&quot;in&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;in&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;bsz&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;bsz&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.burst_size, tokens[5]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;burst_size&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    t0 = 6;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[t0], <span class="stringliteral">&quot;link&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 4) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline port in link&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.type = PORT_IN_RXQ;</div>
<div class="line"> </div>
<div class="line">        p.dev_name = tokens[t0 + 1];</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 2], <span class="stringliteral">&quot;rxq&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;rxq&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint16(&amp;p.rxq.queue_id, tokens[t0 + 3]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;queue_id&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        t0 += 4;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0], <span class="stringliteral">&quot;swq&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 2) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline port in swq&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.type = PORT_IN_SWQ;</div>
<div class="line"> </div>
<div class="line">        p.dev_name = tokens[t0 + 1];</div>
<div class="line"> </div>
<div class="line">        t0 += 2;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0], <span class="stringliteral">&quot;tmgr&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 2) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline port in tmgr&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.type = PORT_IN_TMGR;</div>
<div class="line"> </div>
<div class="line">        p.dev_name = tokens[t0 + 1];</div>
<div class="line"> </div>
<div class="line">        t0 += 2;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0], <span class="stringliteral">&quot;tap&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 6) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline port in tap&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.type = PORT_IN_TAP;</div>
<div class="line"> </div>
<div class="line">        p.dev_name = tokens[t0 + 1];</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 2], <span class="stringliteral">&quot;mempool&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                <span class="stringliteral">&quot;mempool&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.tap.mempool_name = tokens[t0 + 3];</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 4], <span class="stringliteral">&quot;mtu&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                <span class="stringliteral">&quot;mtu&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.tap.mtu, tokens[t0 + 5]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;mtu&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        t0 += 6;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0], <span class="stringliteral">&quot;kni&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 2) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline port in kni&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.type = PORT_IN_KNI;</div>
<div class="line"> </div>
<div class="line">        p.dev_name = tokens[t0 + 1];</div>
<div class="line"> </div>
<div class="line">        t0 += 2;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0], <span class="stringliteral">&quot;source&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 6) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline port in source&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.type = PORT_IN_SOURCE;</div>
<div class="line"> </div>
<div class="line">        p.dev_name = NULL;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;mempool&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                <span class="stringliteral">&quot;mempool&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.source.mempool_name = tokens[t0 + 2];</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 3], <span class="stringliteral">&quot;file&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                <span class="stringliteral">&quot;file&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.source.file_name = tokens[t0 + 4];</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 5], <span class="stringliteral">&quot;bpp&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                <span class="stringliteral">&quot;bpp&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.source.n_bytes_per_pkt, tokens[t0 + 6]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;n_bytes_per_pkt&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        t0 += 7;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0], <span class="stringliteral">&quot;cryptodev&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 3) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline port in cryptodev&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.type = PORT_IN_CRYPTODEV;</div>
<div class="line"> </div>
<div class="line">        p.dev_name = tokens[t0 + 1];</div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint16(&amp;p.rxq.queue_id, tokens[t0 + 3]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;rxq&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.cryptodev.arg_callback = NULL;</div>
<div class="line">        p.cryptodev.f_callback = NULL;</div>
<div class="line"> </div>
<div class="line">        t0 += 4;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    p.action_profile_name = NULL;</div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens &gt; t0) &amp;&amp; (strcmp(tokens[t0], <span class="stringliteral">&quot;action&quot;</span>) == 0)) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 2) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH, <span class="stringliteral">&quot;action&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.action_profile_name = tokens[t0 + 1];</div>
<div class="line"> </div>
<div class="line">        t0 += 2;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    enabled = 1;</div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens &gt; t0) &amp;&amp;</div>
<div class="line">        (strcmp(tokens[t0], <span class="stringliteral">&quot;disabled&quot;</span>) == 0)) {</div>
<div class="line">        enabled = 0;</div>
<div class="line"> </div>
<div class="line">        t0 += 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != t0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = pipeline_port_in_create(pipeline_name,</div>
<div class="line">        &amp;p, enabled);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_port_out_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; port out\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   bsz &lt;burst_size&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   link &lt;link_name&gt; txq &lt;txq_id&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   | swq &lt;swq_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   | tmgr &lt;tmgr_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   | tap &lt;tap_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   | kni &lt;kni_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   | sink [file &lt;file_name&gt; pkts &lt;max_n_pkts&gt;]\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   | cryptodev &lt;cryptodev_name&gt; txq &lt;txq_id&gt; offset &lt;crypto_op_offset&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_port_out(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>port_out_params p;</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    memset(&amp;p, 0, <span class="keyword">sizeof</span>(p));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &lt; 7) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;port&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;port&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[3], <span class="stringliteral">&quot;out&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;out&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;bsz&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;bsz&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.burst_size, tokens[5]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;burst_size&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;link&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens != 10) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline port out link&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.type = PORT_OUT_TXQ;</div>
<div class="line"> </div>
<div class="line">        p.dev_name = tokens[7];</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[8], <span class="stringliteral">&quot;txq&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;txq&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint16(&amp;p.txq.queue_id, tokens[9]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;queue_id&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;swq&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens != 8) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline port out swq&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.type = PORT_OUT_SWQ;</div>
<div class="line"> </div>
<div class="line">        p.dev_name = tokens[7];</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;tmgr&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens != 8) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline port out tmgr&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.type = PORT_OUT_TMGR;</div>
<div class="line"> </div>
<div class="line">        p.dev_name = tokens[7];</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;tap&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens != 8) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline port out tap&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.type = PORT_OUT_TAP;</div>
<div class="line"> </div>
<div class="line">        p.dev_name = tokens[7];</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;kni&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens != 8) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline port out kni&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.type = PORT_OUT_KNI;</div>
<div class="line"> </div>
<div class="line">        p.dev_name = tokens[7];</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;sink&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens != 7) &amp;&amp; (n_tokens != 11)) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline port out sink&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.type = PORT_OUT_SINK;</div>
<div class="line"> </div>
<div class="line">        p.dev_name = NULL;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens == 7) {</div>
<div class="line">            p.sink.file_name = NULL;</div>
<div class="line">            p.sink.max_n_pkts = 0;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">if</span> (strcmp(tokens[7], <span class="stringliteral">&quot;file&quot;</span>) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                    <span class="stringliteral">&quot;file&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            p.sink.file_name = tokens[8];</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (strcmp(tokens[9], <span class="stringliteral">&quot;pkts&quot;</span>) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;pkts&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.sink.max_n_pkts, tokens[10]) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;max_n_pkts&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;cryptodev&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens != 12) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline port out cryptodev&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.type = PORT_OUT_CRYPTODEV;</div>
<div class="line"> </div>
<div class="line">        p.dev_name = tokens[7];</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[8], <span class="stringliteral">&quot;txq&quot;</span>)) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline port out cryptodev&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint16(&amp;p.cryptodev.queue_id, tokens[9])</div>
<div class="line">                != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;queue_id&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[10], <span class="stringliteral">&quot;offset&quot;</span>)) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline port out cryptodev&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.cryptodev.op_offset, tokens[11])</div>
<div class="line">                != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;queue_id&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = pipeline_port_out_create(pipeline_name, &amp;p);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_table_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; table\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;       match\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;       acl\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           ipv4 | ipv6\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           offset &lt;ip_header_offset&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           size &lt;n_rules&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;       | array\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           offset &lt;key_offset&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           size &lt;n_keys&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;       | hash\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           ext | lru\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           key &lt;key_size&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           mask &lt;key_mask&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           offset &lt;key_offset&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           buckets &lt;n_buckets&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           size &lt;n_keys&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;       | lpm\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           ipv4 | ipv6\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           offset &lt;ip_header_offset&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           size &lt;n_rules&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;       | stub\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   [action &lt;table_action_profile_name&gt;]\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_table(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    uint8_t key_mask[TABLE_RULE_MATCH_SIZE_MAX];</div>
<div class="line">    <span class="keyword">struct </span>table_params p;</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t t0;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &lt; 5) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;table&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[3], <span class="stringliteral">&quot;match&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;match&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    t0 = 4;</div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[t0], <span class="stringliteral">&quot;acl&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 6) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline table acl&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.match_type = TABLE_ACL;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;ipv4&quot;</span>) == 0)</div>
<div class="line">            p.match.acl.ip_version = 1;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;ipv6&quot;</span>) == 0)</div>
<div class="line">            p.match.acl.ip_version = 0;</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                <span class="stringliteral">&quot;ipv4 or ipv6&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 2], <span class="stringliteral">&quot;offset&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;offset&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.match.acl.ip_header_offset,</div>
<div class="line">            tokens[t0 + 3]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;ip_header_offset&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 4], <span class="stringliteral">&quot;size&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;size&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.match.acl.n_rules,</div>
<div class="line">            tokens[t0 + 5]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;n_rules&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        t0 += 6;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0], <span class="stringliteral">&quot;array&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 5) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline table array&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.match_type = TABLE_ARRAY;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;offset&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;offset&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.match.array.key_offset,</div>
<div class="line">            tokens[t0 + 2]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;key_offset&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 3], <span class="stringliteral">&quot;size&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;size&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.match.array.n_keys,</div>
<div class="line">            tokens[t0 + 4]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;n_keys&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        t0 += 5;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0], <span class="stringliteral">&quot;hash&quot;</span>) == 0) {</div>
<div class="line">        uint32_t key_mask_size = TABLE_RULE_MATCH_SIZE_MAX;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 12) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline table hash&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.match_type = TABLE_HASH;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;ext&quot;</span>) == 0)</div>
<div class="line">            p.match.hash.extendable_bucket = 1;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;lru&quot;</span>) == 0)</div>
<div class="line">            p.match.hash.extendable_bucket = 0;</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                <span class="stringliteral">&quot;ext or lru&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 2], <span class="stringliteral">&quot;key&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;key&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((parser_read_uint32(&amp;p.match.hash.key_size,</div>
<div class="line">            tokens[t0 + 3]) != 0) ||</div>
<div class="line">            (p.match.hash.key_size == 0) ||</div>
<div class="line">            (p.match.hash.key_size &gt; TABLE_RULE_MATCH_SIZE_MAX)) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;key_size&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 4], <span class="stringliteral">&quot;mask&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;mask&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((parse_hex_string(tokens[t0 + 5],</div>
<div class="line">            key_mask, &amp;key_mask_size) != 0) ||</div>
<div class="line">            (key_mask_size != p.match.hash.key_size)) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;key_mask&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        p.match.hash.key_mask = key_mask;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 6], <span class="stringliteral">&quot;offset&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;offset&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.match.hash.key_offset,</div>
<div class="line">            tokens[t0 + 7]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;key_offset&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 8], <span class="stringliteral">&quot;buckets&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;buckets&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.match.hash.n_buckets,</div>
<div class="line">            tokens[t0 + 9]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;n_buckets&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 10], <span class="stringliteral">&quot;size&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;size&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.match.hash.n_keys,</div>
<div class="line">            tokens[t0 + 11]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;n_keys&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        t0 += 12;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0], <span class="stringliteral">&quot;lpm&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 6) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;pipeline table lpm&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.match_type = TABLE_LPM;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;ipv4&quot;</span>) == 0)</div>
<div class="line">            p.match.lpm.key_size = 4;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0 + 1], <span class="stringliteral">&quot;ipv6&quot;</span>) == 0)</div>
<div class="line">            p.match.lpm.key_size = 16;</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                <span class="stringliteral">&quot;ipv4 or ipv6&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 2], <span class="stringliteral">&quot;offset&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;offset&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.match.lpm.key_offset,</div>
<div class="line">            tokens[t0 + 3]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;key_offset&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[t0 + 4], <span class="stringliteral">&quot;size&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;size&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;p.match.lpm.n_rules,</div>
<div class="line">            tokens[t0 + 5]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;n_rules&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        t0 += 6;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[t0], <span class="stringliteral">&quot;stub&quot;</span>) == 0) {</div>
<div class="line">        p.match_type = TABLE_STUB;</div>
<div class="line"> </div>
<div class="line">        t0 += 1;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    p.action_profile_name = NULL;</div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens &gt; t0) &amp;&amp; (strcmp(tokens[t0], <span class="stringliteral">&quot;action&quot;</span>) == 0)) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; t0 + 2) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH, <span class="stringliteral">&quot;action&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.action_profile_name = tokens[t0 + 1];</div>
<div class="line"> </div>
<div class="line">        t0 += 2;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &gt; t0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = pipeline_table_create(pipeline_name, &amp;p);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_port_in_table_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; port in &lt;port_id&gt; table &lt;table_id&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_port_in_table(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t port_id, table_id;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 7) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;port&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;port&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[3], <span class="stringliteral">&quot;in&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;in&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;port_id, tokens[4]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;port_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;table&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;table&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;table_id, tokens[6]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;table_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = pipeline_port_in_connect_to_table(pipeline_name,</div>
<div class="line">        port_id,</div>
<div class="line">        table_id);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_port_in_stats_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; port in &lt;port_id&gt; stats read [clear]\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MSG_PIPELINE_PORT_IN_STATS                         \</span></div>
<div class="line"><span class="preprocessor">    &quot;Pkts in: %&quot; PRIu64 &quot;\n&quot;                           \</span></div>
<div class="line"><span class="preprocessor">    &quot;Pkts dropped by AH: %&quot; PRIu64 &quot;\n&quot;                \</span></div>
<div class="line"><span class="preprocessor">    &quot;Pkts dropped by other: %&quot; PRIu64 &quot;\n&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_port_in_stats(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a37"></a><a class="code" href="structrte__pipeline__port__in__stats.html">rte_pipeline_port_in_stats</a> <a name="a38"></a><a class="code" href="structrte__pipeline__port__in__stats.html#a48efd9560ccf56a1dedb5d25e323fa8a">stats</a>;</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t port_id;</div>
<div class="line">    <span class="keywordtype">int</span> clear, status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens != 7) &amp;&amp; (n_tokens != 8)) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;port&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;port&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[3], <span class="stringliteral">&quot;in&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;in&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;port_id, tokens[4]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;port_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;stats&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;stats&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;read&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;read&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    clear = 0;</div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens == 8) {</div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[7], <span class="stringliteral">&quot;clear&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;clear&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        clear = 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = pipeline_port_in_stats_read(pipeline_name,</div>
<div class="line">        port_id,</div>
<div class="line">        &amp;<a class="code" href="structrte__pipeline__port__in__stats.html#a48efd9560ccf56a1dedb5d25e323fa8a">stats</a>,</div>
<div class="line">        clear);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    snprintf(out, out_size, MSG_PIPELINE_PORT_IN_STATS,</div>
<div class="line">        <a class="code" href="structrte__pipeline__port__in__stats.html#a48efd9560ccf56a1dedb5d25e323fa8a">stats</a>.stats.<a name="a39"></a>n_pkts_in,</div>
<div class="line">        <a class="code" href="structrte__pipeline__port__in__stats.html#a48efd9560ccf56a1dedb5d25e323fa8a">stats</a>.n_pkts_dropped_by_ah,</div>
<div class="line">        <a class="code" href="structrte__pipeline__port__in__stats.html#a48efd9560ccf56a1dedb5d25e323fa8a">stats</a>.stats.<a name="a40"></a>n_pkts_drop);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_port_in_enable_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; port in &lt;port_id&gt; enable\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_port_in_enable(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t port_id;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 6) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;port&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;port&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[3], <span class="stringliteral">&quot;in&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;in&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;port_id, tokens[4]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;port_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;enable&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;enable&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = pipeline_port_in_enable(pipeline_name, port_id);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_port_in_disable_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; port in &lt;port_id&gt; disable\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_port_in_disable(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t port_id;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 6) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;port&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;port&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[3], <span class="stringliteral">&quot;in&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;in&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;port_id, tokens[4]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;port_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;disable&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;disable&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = pipeline_port_in_disable(pipeline_name, port_id);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_port_out_stats_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; port out &lt;port_id&gt; stats read [clear]\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MSG_PIPELINE_PORT_OUT_STATS                        \</span></div>
<div class="line"><span class="preprocessor">    &quot;Pkts in: %&quot; PRIu64 &quot;\n&quot;                           \</span></div>
<div class="line"><span class="preprocessor">    &quot;Pkts dropped by AH: %&quot; PRIu64 &quot;\n&quot;                \</span></div>
<div class="line"><span class="preprocessor">    &quot;Pkts dropped by other: %&quot; PRIu64 &quot;\n&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_port_out_stats(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a41"></a><a class="code" href="structrte__pipeline__port__out__stats.html">rte_pipeline_port_out_stats</a> <a name="a42"></a><a class="code" href="structrte__pipeline__port__out__stats.html#a7d127ce0e2d9594ebb38cc5441e60174">stats</a>;</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t port_id;</div>
<div class="line">    <span class="keywordtype">int</span> clear, status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens != 7) &amp;&amp; (n_tokens != 8)) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;port&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;port&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[3], <span class="stringliteral">&quot;out&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;out&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;port_id, tokens[4]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;port_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;stats&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;stats&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;read&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;read&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    clear = 0;</div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens == 8) {</div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[7], <span class="stringliteral">&quot;clear&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;clear&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        clear = 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = pipeline_port_out_stats_read(pipeline_name,</div>
<div class="line">        port_id,</div>
<div class="line">        &amp;<a class="code" href="structrte__pipeline__port__out__stats.html#a7d127ce0e2d9594ebb38cc5441e60174">stats</a>,</div>
<div class="line">        clear);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    snprintf(out, out_size, MSG_PIPELINE_PORT_OUT_STATS,</div>
<div class="line">        <a class="code" href="structrte__pipeline__port__out__stats.html#a7d127ce0e2d9594ebb38cc5441e60174">stats</a>.stats.<a name="a43"></a>n_pkts_in,</div>
<div class="line">        <a class="code" href="structrte__pipeline__port__out__stats.html#a7d127ce0e2d9594ebb38cc5441e60174">stats</a>.n_pkts_dropped_by_ah,</div>
<div class="line">        <a class="code" href="structrte__pipeline__port__out__stats.html#a7d127ce0e2d9594ebb38cc5441e60174">stats</a>.stats.<a name="a44"></a>n_pkts_drop);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_table_stats_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; table &lt;table_id&gt; stats read [clear]\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MSG_PIPELINE_TABLE_STATS                                     \</span></div>
<div class="line"><span class="preprocessor">    &quot;Pkts in: %&quot; PRIu64 &quot;\n&quot;                                     \</span></div>
<div class="line"><span class="preprocessor">    &quot;Pkts in with lookup miss: %&quot; PRIu64 &quot;\n&quot;                    \</span></div>
<div class="line"><span class="preprocessor">    &quot;Pkts in with lookup hit dropped by AH: %&quot; PRIu64 &quot;\n&quot;       \</span></div>
<div class="line"><span class="preprocessor">    &quot;Pkts in with lookup hit dropped by others: %&quot; PRIu64 &quot;\n&quot;   \</span></div>
<div class="line"><span class="preprocessor">    &quot;Pkts in with lookup miss dropped by AH: %&quot; PRIu64 &quot;\n&quot;      \</span></div>
<div class="line"><span class="preprocessor">    &quot;Pkts in with lookup miss dropped by others: %&quot; PRIu64 &quot;\n&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_table_stats(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a45"></a><a class="code" href="structrte__pipeline__table__stats.html">rte_pipeline_table_stats</a> <a name="a46"></a><a class="code" href="structrte__pipeline__table__stats.html#a324dbcea014c359561641979bb66c6f1">stats</a>;</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t table_id;</div>
<div class="line">    <span class="keywordtype">int</span> clear, status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens != 6) &amp;&amp; (n_tokens != 7)) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;port&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;table_id, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;table_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;stats&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;stats&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;read&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;read&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    clear = 0;</div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens == 7) {</div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;clear&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;clear&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        clear = 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = pipeline_table_stats_read(pipeline_name,</div>
<div class="line">        table_id,</div>
<div class="line">        &amp;<a class="code" href="structrte__pipeline__table__stats.html#a324dbcea014c359561641979bb66c6f1">stats</a>,</div>
<div class="line">        clear);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    snprintf(out, out_size, MSG_PIPELINE_TABLE_STATS,</div>
<div class="line">        <a class="code" href="structrte__pipeline__table__stats.html#a324dbcea014c359561641979bb66c6f1">stats</a>.stats.<a name="a47"></a>n_pkts_in,</div>
<div class="line">        <a class="code" href="structrte__pipeline__table__stats.html#a324dbcea014c359561641979bb66c6f1">stats</a>.stats.<a name="a48"></a>n_pkts_lookup_miss,</div>
<div class="line">        <a class="code" href="structrte__pipeline__table__stats.html#a324dbcea014c359561641979bb66c6f1">stats</a>.n_pkts_dropped_by_lkp_hit_ah,</div>
<div class="line">        <a class="code" href="structrte__pipeline__table__stats.html#a324dbcea014c359561641979bb66c6f1">stats</a>.n_pkts_dropped_lkp_hit,</div>
<div class="line">        <a class="code" href="structrte__pipeline__table__stats.html#a324dbcea014c359561641979bb66c6f1">stats</a>.n_pkts_dropped_by_lkp_miss_ah,</div>
<div class="line">        <a class="code" href="structrte__pipeline__table__stats.html#a324dbcea014c359561641979bb66c6f1">stats</a>.n_pkts_dropped_lkp_miss);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pkt_key_qinq {</div>
<div class="line">    uint16_t ethertype_svlan;</div>
<div class="line">    uint16_t svlan;</div>
<div class="line">    uint16_t ethertype_cvlan;</div>
<div class="line">    uint16_t cvlan;</div>
<div class="line">} <a name="a49"></a><a class="code" href="rte__common_8h.html#aa870761f77784e5b578d2ade3301d893">__rte_packed</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pkt_key_ipv4_5tuple {</div>
<div class="line">    uint8_t time_to_live;</div>
<div class="line">    uint8_t proto;</div>
<div class="line">    uint16_t hdr_checksum;</div>
<div class="line">    uint32_t sa;</div>
<div class="line">    uint32_t da;</div>
<div class="line">    uint16_t sp;</div>
<div class="line">    uint16_t dp;</div>
<div class="line">} <a class="code" href="rte__common_8h.html#aa870761f77784e5b578d2ade3301d893">__rte_packed</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pkt_key_ipv6_5tuple {</div>
<div class="line">    uint16_t payload_length;</div>
<div class="line">    uint8_t proto;</div>
<div class="line">    uint8_t hop_limit;</div>
<div class="line">    uint8_t sa[16];</div>
<div class="line">    uint8_t da[16];</div>
<div class="line">    uint16_t sp;</div>
<div class="line">    uint16_t dp;</div>
<div class="line">} <a class="code" href="rte__common_8h.html#aa870761f77784e5b578d2ade3301d893">__rte_packed</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pkt_key_ipv4_addr {</div>
<div class="line">    uint32_t addr;</div>
<div class="line">} <a class="code" href="rte__common_8h.html#aa870761f77784e5b578d2ade3301d893">__rte_packed</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>pkt_key_ipv6_addr {</div>
<div class="line">    uint8_t addr[16];</div>
<div class="line">} <a class="code" href="rte__common_8h.html#aa870761f77784e5b578d2ade3301d893">__rte_packed</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">parse_match(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_match *m)</div>
<div class="line">{</div>
<div class="line">    memset(m, 0, <span class="keyword">sizeof</span>(*m));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &lt; 2)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;match&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;match&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[1], <span class="stringliteral">&quot;acl&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; 14) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        m-&gt;match_type = TABLE_ACL;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;priority&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;priority&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;m-&gt;match.acl.priority,</div>
<div class="line">            tokens[3]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;priority&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;ipv4&quot;</span>) == 0) {</div>
<div class="line">            <span class="keyword">struct </span>in_addr saddr, daddr;</div>
<div class="line"> </div>
<div class="line">            m-&gt;match.acl.ip_version = 1;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parse_ipv4_addr(tokens[5], &amp;saddr) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;sa&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line">            m-&gt;match.acl.ipv4.sa = <a name="a50"></a><a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(saddr.s_addr);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parse_ipv4_addr(tokens[7], &amp;daddr) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;da&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line">            m-&gt;match.acl.ipv4.da = <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(daddr.s_addr);</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;ipv6&quot;</span>) == 0) {</div>
<div class="line">            <span class="keyword">struct </span>in6_addr saddr, daddr;</div>
<div class="line"> </div>
<div class="line">            m-&gt;match.acl.ip_version = 0;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parse_ipv6_addr(tokens[5], &amp;saddr) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;sa&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line">            memcpy(m-&gt;match.acl.ipv6.sa, saddr.s6_addr, 16);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parse_ipv6_addr(tokens[7], &amp;daddr) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;da&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line">            memcpy(m-&gt;match.acl.ipv6.da, daddr.s6_addr, 16);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND,</div>
<div class="line">                <span class="stringliteral">&quot;ipv4 or ipv6&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;m-&gt;match.acl.sa_depth,</div>
<div class="line">            tokens[6]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;sa_depth&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;m-&gt;match.acl.da_depth,</div>
<div class="line">            tokens[8]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;da_depth&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint16(&amp;m-&gt;match.acl.sp0, tokens[9]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;sp0&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint16(&amp;m-&gt;match.acl.sp1, tokens[10]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;sp1&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint16(&amp;m-&gt;match.acl.dp0, tokens[11]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;dp0&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint16(&amp;m-&gt;match.acl.dp1, tokens[12]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;dp1&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint8(&amp;m-&gt;match.acl.proto, tokens[13]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;proto&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        m-&gt;match.acl.proto_mask = 0xff;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> 14;</div>
<div class="line">    } <span class="comment">/* acl */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[1], <span class="stringliteral">&quot;array&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; 3) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        m-&gt;match_type = TABLE_ARRAY;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;m-&gt;match.array.pos, tokens[2]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;pos&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> 3;</div>
<div class="line">    } <span class="comment">/* array */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[1], <span class="stringliteral">&quot;hash&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; 3) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        m-&gt;match_type = TABLE_HASH;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;raw&quot;</span>) == 0) {</div>
<div class="line">            uint32_t key_size = TABLE_RULE_MATCH_SIZE_MAX;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (n_tokens &lt; 4) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                    tokens[0]);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parse_hex_string(tokens[3],</div>
<div class="line">                m-&gt;match.hash.key, &amp;key_size) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;key&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> 4;</div>
<div class="line">        } <span class="comment">/* hash raw */</span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;ipv4_5tuple&quot;</span>) == 0) {</div>
<div class="line">            <span class="keyword">struct </span>pkt_key_ipv4_5tuple *ipv4 =</div>
<div class="line">                (<span class="keyword">struct </span>pkt_key_ipv4_5tuple *) m-&gt;match.hash.key;</div>
<div class="line">            <span class="keyword">struct</span> in_addr saddr, daddr;</div>
<div class="line">            uint16_t sp, dp;</div>
<div class="line">            uint8_t proto;</div>
<div class="line"> </div>
<div class="line">            if (n_tokens &lt; 8) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                    tokens[0]);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parse_ipv4_addr(tokens[3], &amp;saddr) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;sa&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parse_ipv4_addr(tokens[4], &amp;daddr) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;da&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parser_read_uint16(&amp;sp, tokens[5]) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;sp&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parser_read_uint16(&amp;dp, tokens[6]) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;dp&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parser_read_uint8(&amp;proto, tokens[7]) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                    <span class="stringliteral">&quot;proto&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            ipv4-&gt;sa = saddr.s_addr;</div>
<div class="line">            ipv4-&gt;da = daddr.s_addr;</div>
<div class="line">            ipv4-&gt;sp = <a name="a51"></a><a class="code" href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a>(sp);</div>
<div class="line">            ipv4-&gt;dp = <a class="code" href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a>(dp);</div>
<div class="line">            ipv4-&gt;proto = proto;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> 8;</div>
<div class="line">        } <span class="comment">/* hash ipv4_5tuple */</span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;ipv6_5tuple&quot;</span>) == 0) {</div>
<div class="line">            <span class="keyword">struct </span>pkt_key_ipv6_5tuple *ipv6 =</div>
<div class="line">                (<span class="keyword">struct </span>pkt_key_ipv6_5tuple *) m-&gt;match.hash.key;</div>
<div class="line">            <span class="keyword">struct</span> in6_addr saddr, daddr;</div>
<div class="line">            uint16_t sp, dp;</div>
<div class="line">            uint8_t proto;</div>
<div class="line"> </div>
<div class="line">            if (n_tokens &lt; 8) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                    tokens[0]);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parse_ipv6_addr(tokens[3], &amp;saddr) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;sa&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parse_ipv6_addr(tokens[4], &amp;daddr) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;da&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parser_read_uint16(&amp;sp, tokens[5]) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;sp&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parser_read_uint16(&amp;dp, tokens[6]) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;dp&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parser_read_uint8(&amp;proto, tokens[7]) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                    <span class="stringliteral">&quot;proto&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            memcpy(ipv6-&gt;sa, saddr.s6_addr, 16);</div>
<div class="line">            memcpy(ipv6-&gt;da, daddr.s6_addr, 16);</div>
<div class="line">            ipv6-&gt;sp = <a class="code" href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a>(sp);</div>
<div class="line">            ipv6-&gt;dp = <a class="code" href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a>(dp);</div>
<div class="line">            ipv6-&gt;proto = proto;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> 8;</div>
<div class="line">        } <span class="comment">/* hash ipv6_5tuple */</span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;ipv4_addr&quot;</span>) == 0) {</div>
<div class="line">            <span class="keyword">struct </span>pkt_key_ipv4_addr *ipv4_addr =</div>
<div class="line">                (<span class="keyword">struct </span>pkt_key_ipv4_addr *) m-&gt;match.hash.key;</div>
<div class="line">            <span class="keyword">struct</span> in_addr addr;</div>
<div class="line"> </div>
<div class="line">            if (n_tokens &lt; 4) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                    tokens[0]);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parse_ipv4_addr(tokens[3], &amp;addr) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                    <span class="stringliteral">&quot;addr&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            ipv4_addr-&gt;addr = addr.s_addr;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> 4;</div>
<div class="line">        } <span class="comment">/* hash ipv4_addr */</span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;ipv6_addr&quot;</span>) == 0) {</div>
<div class="line">            <span class="keyword">struct </span>pkt_key_ipv6_addr *ipv6_addr =</div>
<div class="line">                (<span class="keyword">struct </span>pkt_key_ipv6_addr *) m-&gt;match.hash.key;</div>
<div class="line">            <span class="keyword">struct</span> in6_addr addr;</div>
<div class="line"> </div>
<div class="line">            if (n_tokens &lt; 4) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                    tokens[0]);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parse_ipv6_addr(tokens[3], &amp;addr) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                    <span class="stringliteral">&quot;addr&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            memcpy(ipv6_addr-&gt;addr, addr.s6_addr, 16);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> 4;</div>
<div class="line">        } <span class="comment">/* hash ipv6_5tuple */</span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;qinq&quot;</span>) == 0) {</div>
<div class="line">            <span class="keyword">struct </span>pkt_key_qinq *qinq =</div>
<div class="line">                (<span class="keyword">struct </span>pkt_key_qinq *) m-&gt;match.hash.key;</div>
<div class="line">            uint16_t svlan, cvlan;</div>
<div class="line"> </div>
<div class="line">            if (n_tokens &lt; 5) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                    tokens[0]);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> ((parser_read_uint16(&amp;svlan, tokens[3]) != 0) ||</div>
<div class="line">                (svlan &gt; 0xFFF)) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                    <span class="stringliteral">&quot;svlan&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> ((parser_read_uint16(&amp;cvlan, tokens[4]) != 0) ||</div>
<div class="line">                (cvlan &gt; 0xFFF)) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                    <span class="stringliteral">&quot;cvlan&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            qinq-&gt;svlan = <a class="code" href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a>(svlan);</div>
<div class="line">            qinq-&gt;cvlan = <a class="code" href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a>(cvlan);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> 5;</div>
<div class="line">        } <span class="comment">/* hash qinq */</span></div>
<div class="line"> </div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    } <span class="comment">/* hash */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[1], <span class="stringliteral">&quot;lpm&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; 5) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        m-&gt;match_type = TABLE_LPM;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;ipv4&quot;</span>) == 0) {</div>
<div class="line">            <span class="keyword">struct </span>in_addr addr;</div>
<div class="line"> </div>
<div class="line">            m-&gt;match.lpm.ip_version = 1;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parse_ipv4_addr(tokens[3], &amp;addr) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                    <span class="stringliteral">&quot;addr&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            m-&gt;match.lpm.ipv4 = <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(addr.s_addr);</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;ipv6&quot;</span>) == 0) {</div>
<div class="line">            <span class="keyword">struct </span>in6_addr addr;</div>
<div class="line"> </div>
<div class="line">            m-&gt;match.lpm.ip_version = 0;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (parse_ipv6_addr(tokens[3], &amp;addr) != 0) {</div>
<div class="line">                snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                    <span class="stringliteral">&quot;addr&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            memcpy(m-&gt;match.lpm.ipv6, addr.s6_addr, 16);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                <span class="stringliteral">&quot;ipv4 or ipv6&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint8(&amp;m-&gt;match.lpm.depth, tokens[4]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;depth&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> 5;</div>
<div class="line">    } <span class="comment">/* lpm */</span></div>
<div class="line"> </div>
<div class="line">    snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">        <span class="stringliteral">&quot;acl or array or hash or lpm&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">parse_table_action_fwd(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_action *a)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens == 0) || (strcmp(tokens[0], <span class="stringliteral">&quot;fwd&quot;</span>) != 0))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    tokens++;</div>
<div class="line">    n_tokens--;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;drop&quot;</span>) == 0)) {</div>
<div class="line">        a-&gt;fwd.action = <a name="a52"></a><a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572af41296546f2a86d1f8f1848010c7c111">RTE_PIPELINE_ACTION_DROP</a>;</div>
<div class="line">        a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aa5194910932359cba3eeca7183922dbf">RTE_TABLE_ACTION_FWD</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1 + 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;port&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t id;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &lt; 2) ||</div>
<div class="line">            parser_read_uint32(&amp;<span class="keywordtype">id</span>, tokens[1]))</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        a-&gt;fwd.action = <a name="a53"></a><a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572ac8c58609785d844989b7d9eb1e6db8aa">RTE_PIPELINE_ACTION_PORT</a>;</div>
<div class="line">        a-&gt;fwd.id = id;</div>
<div class="line">        a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aa5194910932359cba3eeca7183922dbf">RTE_TABLE_ACTION_FWD</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1 + 2;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;meta&quot;</span>) == 0)) {</div>
<div class="line">        a-&gt;fwd.action = <a name="a54"></a><a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572a5dc23d641b483615ea475152ac7ab7f4">RTE_PIPELINE_ACTION_PORT_META</a>;</div>
<div class="line">        a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aa5194910932359cba3eeca7183922dbf">RTE_TABLE_ACTION_FWD</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1 + 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;table&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t id;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &lt; 2) ||</div>
<div class="line">            parser_read_uint32(&amp;<span class="keywordtype">id</span>, tokens[1]))</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        a-&gt;fwd.action = <a name="a55"></a><a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572abafaf6276afcfcb170a2f7aa44c21048">RTE_PIPELINE_ACTION_TABLE</a>;</div>
<div class="line">        a-&gt;fwd.id = id;</div>
<div class="line">        a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aa5194910932359cba3eeca7183922dbf">RTE_TABLE_ACTION_FWD</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1 + 2;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">parse_table_action_balance(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_action *a)</div>
<div class="line">{</div>
<div class="line">    uint32_t i;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens == 0) || (strcmp(tokens[0], <span class="stringliteral">&quot;balance&quot;</span>) != 0))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    tokens++;</div>
<div class="line">    n_tokens--;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &lt; <a name="a56"></a><a class="code" href="rte__table__action_8h.html#af0ddb775e0c9d6dd04398f411cef5e6d">RTE_TABLE_ACTION_LB_TABLE_SIZE</a>)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="rte__table__action_8h.html#af0ddb775e0c9d6dd04398f411cef5e6d">RTE_TABLE_ACTION_LB_TABLE_SIZE</a>; i++)</div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;a-&gt;lb.out[i], tokens[i]) != 0)</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2af4f7ba5c7d7eefc2fde9341b8724c11b">RTE_TABLE_ACTION_LB</a>;</div>
<div class="line">    <span class="keywordflow">return</span> 1 + <a class="code" href="rte__table__action_8h.html#af0ddb775e0c9d6dd04398f411cef5e6d">RTE_TABLE_ACTION_LB_TABLE_SIZE</a>;</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_policer_action(<span class="keywordtype">char</span> *token, <span class="keyword">enum</span> <a class="code" href="rte__table__action_8h.html#a6a4e67d5a60f87389cd9f56787d2d176">rte_table_action_policer</a> *a)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(token, <span class="stringliteral">&quot;g&quot;</span>) == 0) {</div>
<div class="line">        *a = <a name="a57"></a><a class="code" href="rte__table__action_8h.html#a6a4e67d5a60f87389cd9f56787d2d176a27aa6e2021e308d76c3569b9f492a70c">RTE_TABLE_ACTION_POLICER_COLOR_GREEN</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(token, <span class="stringliteral">&quot;y&quot;</span>) == 0) {</div>
<div class="line">        *a = <a name="a58"></a><a class="code" href="rte__table__action_8h.html#a6a4e67d5a60f87389cd9f56787d2d176a711a4c01a0c9649e024cab6d3affb806">RTE_TABLE_ACTION_POLICER_COLOR_YELLOW</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(token, <span class="stringliteral">&quot;r&quot;</span>) == 0) {</div>
<div class="line">        *a = <a name="a59"></a><a class="code" href="rte__table__action_8h.html#a6a4e67d5a60f87389cd9f56787d2d176a06918153b593ada41b4685b285d7b80e">RTE_TABLE_ACTION_POLICER_COLOR_RED</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(token, <span class="stringliteral">&quot;drop&quot;</span>) == 0) {</div>
<div class="line">        *a = <a name="a60"></a><a class="code" href="rte__table__action_8h.html#a6a4e67d5a60f87389cd9f56787d2d176afe7f90714cd9ae3907e98073af4272ef">RTE_TABLE_ACTION_POLICER_DROP</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">parse_table_action_meter_tc(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keyword">struct</span> <a name="_a61"></a><a class="code" href="structrte__table__action__mtr__tc__params.html">rte_table_action_mtr_tc_params</a> *mtr)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens &lt; 9) ||</div>
<div class="line">        strcmp(tokens[0], <span class="stringliteral">&quot;meter&quot;</span>) ||</div>
<div class="line">        parser_read_uint32(&amp;mtr-&gt;<a name="a62"></a><a class="code" href="structrte__table__action__mtr__tc__params.html#a4269e06e25d2bd018a121045ac601455">meter_profile_id</a>, tokens[1]) ||</div>
<div class="line">        strcmp(tokens[2], <span class="stringliteral">&quot;policer&quot;</span>) ||</div>
<div class="line">        strcmp(tokens[3], <span class="stringliteral">&quot;g&quot;</span>) ||</div>
<div class="line">        parse_policer_action(tokens[4], &amp;mtr-&gt;<a name="a63"></a><a class="code" href="structrte__table__action__mtr__tc__params.html#afbd6fd0aa98794a1c59a425a0a6ca13f">policer</a>[<a name="a64"></a><a class="code" href="rte__meter_8h.html#a35388a9ecf2eab3020433bd6207b3436a43d24f9a4881b17f0d0af3c8358fea05">RTE_COLOR_GREEN</a>]) ||</div>
<div class="line">        strcmp(tokens[5], <span class="stringliteral">&quot;y&quot;</span>) ||</div>
<div class="line">        parse_policer_action(tokens[6], &amp;mtr-&gt;<a class="code" href="structrte__table__action__mtr__tc__params.html#afbd6fd0aa98794a1c59a425a0a6ca13f">policer</a>[<a name="a65"></a><a class="code" href="rte__meter_8h.html#a35388a9ecf2eab3020433bd6207b3436a83de16e2e12e9a65d07bca453b899fbe">RTE_COLOR_YELLOW</a>]) ||</div>
<div class="line">        strcmp(tokens[7], <span class="stringliteral">&quot;r&quot;</span>) ||</div>
<div class="line">        parse_policer_action(tokens[8], &amp;mtr-&gt;<a class="code" href="structrte__table__action__mtr__tc__params.html#afbd6fd0aa98794a1c59a425a0a6ca13f">policer</a>[<a name="a66"></a><a class="code" href="rte__meter_8h.html#a35388a9ecf2eab3020433bd6207b3436a910409b5938b2e9ad695db4676353e68">RTE_COLOR_RED</a>]))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 9;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">parse_table_action_meter(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_action *a)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens == 0) || strcmp(tokens[0], <span class="stringliteral">&quot;meter&quot;</span>))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    tokens++;</div>
<div class="line">    n_tokens--;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens &lt; 10) ||</div>
<div class="line">        strcmp(tokens[0], <span class="stringliteral">&quot;tc0&quot;</span>) ||</div>
<div class="line">        (parse_table_action_meter_tc(tokens + 1,</div>
<div class="line">            n_tokens - 1,</div>
<div class="line">            &amp;a-&gt;mtr.mtr[0]) == 0))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    tokens += 10;</div>
<div class="line">    n_tokens -= 10;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens == 0) || strcmp(tokens[0], <span class="stringliteral">&quot;tc1&quot;</span>)) {</div>
<div class="line">        a-&gt;mtr.tc_mask = 1;</div>
<div class="line">        a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a7442253cfdff0aec945b0ad7ddf5ab2d">RTE_TABLE_ACTION_MTR</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1 + 10;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens &lt; 30) ||</div>
<div class="line">        (parse_table_action_meter_tc(tokens + 1,</div>
<div class="line">            n_tokens - 1, &amp;a-&gt;mtr.mtr[1]) == 0) ||</div>
<div class="line">        strcmp(tokens[10], <span class="stringliteral">&quot;tc2&quot;</span>) ||</div>
<div class="line">        (parse_table_action_meter_tc(tokens + 11,</div>
<div class="line">            n_tokens - 11, &amp;a-&gt;mtr.mtr[2]) == 0) ||</div>
<div class="line">        strcmp(tokens[20], <span class="stringliteral">&quot;tc3&quot;</span>) ||</div>
<div class="line">        (parse_table_action_meter_tc(tokens + 21,</div>
<div class="line">            n_tokens - 21, &amp;a-&gt;mtr.mtr[3]) == 0))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    a-&gt;mtr.tc_mask = 0xF;</div>
<div class="line">    a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a7442253cfdff0aec945b0ad7ddf5ab2d">RTE_TABLE_ACTION_MTR</a>;</div>
<div class="line">    <span class="keywordflow">return</span> 1 + 10 + 3 * 10;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">parse_table_action_tm(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_action *a)</div>
<div class="line">{</div>
<div class="line">    uint32_t subport_id, pipe_id;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens &lt; 5) ||</div>
<div class="line">        strcmp(tokens[0], <span class="stringliteral">&quot;tm&quot;</span>) ||</div>
<div class="line">        strcmp(tokens[1], <span class="stringliteral">&quot;subport&quot;</span>) ||</div>
<div class="line">        parser_read_uint32(&amp;subport_id, tokens[2]) ||</div>
<div class="line">        strcmp(tokens[3], <span class="stringliteral">&quot;pipe&quot;</span>) ||</div>
<div class="line">        parser_read_uint32(&amp;pipe_id, tokens[4]))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    a-&gt;tm.subport_id = subport_id;</div>
<div class="line">    a-&gt;tm.pipe_id = pipe_id;</div>
<div class="line">    a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a9f9ca84acea19612c86d3da0898ed34e">RTE_TABLE_ACTION_TM</a>;</div>
<div class="line">    <span class="keywordflow">return</span> 5;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">parse_table_action_encap(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_action *a)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens == 0) || strcmp(tokens[0], <span class="stringliteral">&quot;encap&quot;</span>))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    tokens++;</div>
<div class="line">    n_tokens--;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* ether */</span></div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;ether&quot;</span>) == 0)) {</div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &lt; 3) ||</div>
<div class="line">            parse_mac_addr(tokens[1], &amp;a-&gt;encap.ether.ether.da) ||</div>
<div class="line">            parse_mac_addr(tokens[2], &amp;a-&gt;encap.ether.ether.sa))</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        a-&gt;encap.type = <a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629cade2089a818728f7245cb6a3aea427875">RTE_TABLE_ACTION_ENCAP_ETHER</a>;</div>
<div class="line">        a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1">RTE_TABLE_ACTION_ENCAP</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1 + 3;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* vlan */</span></div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;vlan&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t pcp, dei, vid;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &lt; 6) ||</div>
<div class="line">            parse_mac_addr(tokens[1], &amp;a-&gt;encap.vlan.ether.da) ||</div>
<div class="line">            parse_mac_addr(tokens[2], &amp;a-&gt;encap.vlan.ether.sa) ||</div>
<div class="line">            parser_read_uint32(&amp;pcp, tokens[3]) ||</div>
<div class="line">            (pcp &gt; 0x7) ||</div>
<div class="line">            parser_read_uint32(&amp;dei, tokens[4]) ||</div>
<div class="line">            (dei &gt; 0x1) ||</div>
<div class="line">            parser_read_uint32(&amp;vid, tokens[5]) ||</div>
<div class="line">            (vid &gt; 0xFFF))</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        a-&gt;encap.vlan.vlan.pcp = pcp &amp; 0x7;</div>
<div class="line">        a-&gt;encap.vlan.vlan.dei = dei &amp; 0x1;</div>
<div class="line">        a-&gt;encap.vlan.vlan.vid = vid &amp; 0xFFF;</div>
<div class="line">        a-&gt;encap.type = <a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629ca0cc0e97e7d412911cbe6e98994d4c2e4">RTE_TABLE_ACTION_ENCAP_VLAN</a>;</div>
<div class="line">        a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1">RTE_TABLE_ACTION_ENCAP</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1 + 6;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* qinq */</span></div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;qinq&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t svlan_pcp, svlan_dei, svlan_vid;</div>
<div class="line">        uint32_t cvlan_pcp, cvlan_dei, cvlan_vid;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &lt; 9) ||</div>
<div class="line">            parse_mac_addr(tokens[1], &amp;a-&gt;encap.qinq.ether.da) ||</div>
<div class="line">            parse_mac_addr(tokens[2], &amp;a-&gt;encap.qinq.ether.sa) ||</div>
<div class="line">            parser_read_uint32(&amp;svlan_pcp, tokens[3]) ||</div>
<div class="line">            (svlan_pcp &gt; 0x7) ||</div>
<div class="line">            parser_read_uint32(&amp;svlan_dei, tokens[4]) ||</div>
<div class="line">            (svlan_dei &gt; 0x1) ||</div>
<div class="line">            parser_read_uint32(&amp;svlan_vid, tokens[5]) ||</div>
<div class="line">            (svlan_vid &gt; 0xFFF) ||</div>
<div class="line">            parser_read_uint32(&amp;cvlan_pcp, tokens[6]) ||</div>
<div class="line">            (cvlan_pcp &gt; 0x7) ||</div>
<div class="line">            parser_read_uint32(&amp;cvlan_dei, tokens[7]) ||</div>
<div class="line">            (cvlan_dei &gt; 0x1) ||</div>
<div class="line">            parser_read_uint32(&amp;cvlan_vid, tokens[8]) ||</div>
<div class="line">            (cvlan_vid &gt; 0xFFF))</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        a-&gt;encap.qinq.svlan.pcp = svlan_pcp &amp; 0x7;</div>
<div class="line">        a-&gt;encap.qinq.svlan.dei = svlan_dei &amp; 0x1;</div>
<div class="line">        a-&gt;encap.qinq.svlan.vid = svlan_vid &amp; 0xFFF;</div>
<div class="line">        a-&gt;encap.qinq.cvlan.pcp = cvlan_pcp &amp; 0x7;</div>
<div class="line">        a-&gt;encap.qinq.cvlan.dei = cvlan_dei &amp; 0x1;</div>
<div class="line">        a-&gt;encap.qinq.cvlan.vid = cvlan_vid &amp; 0xFFF;</div>
<div class="line">        a-&gt;encap.type = <a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629caca0bdb5026849382b38c7ddc42a902da">RTE_TABLE_ACTION_ENCAP_QINQ</a>;</div>
<div class="line">        a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1">RTE_TABLE_ACTION_ENCAP</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1 + 9;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* qinq_pppoe */</span></div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;qinq_pppoe&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t svlan_pcp, svlan_dei, svlan_vid;</div>
<div class="line">        uint32_t cvlan_pcp, cvlan_dei, cvlan_vid;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &lt; 10) ||</div>
<div class="line">            parse_mac_addr(tokens[1],</div>
<div class="line">                &amp;a-&gt;encap.qinq_pppoe.ether.da) ||</div>
<div class="line">            parse_mac_addr(tokens[2],</div>
<div class="line">                &amp;a-&gt;encap.qinq_pppoe.ether.sa) ||</div>
<div class="line">            parser_read_uint32(&amp;svlan_pcp, tokens[3]) ||</div>
<div class="line">            (svlan_pcp &gt; 0x7) ||</div>
<div class="line">            parser_read_uint32(&amp;svlan_dei, tokens[4]) ||</div>
<div class="line">            (svlan_dei &gt; 0x1) ||</div>
<div class="line">            parser_read_uint32(&amp;svlan_vid, tokens[5]) ||</div>
<div class="line">            (svlan_vid &gt; 0xFFF) ||</div>
<div class="line">            parser_read_uint32(&amp;cvlan_pcp, tokens[6]) ||</div>
<div class="line">            (cvlan_pcp &gt; 0x7) ||</div>
<div class="line">            parser_read_uint32(&amp;cvlan_dei, tokens[7]) ||</div>
<div class="line">            (cvlan_dei &gt; 0x1) ||</div>
<div class="line">            parser_read_uint32(&amp;cvlan_vid, tokens[8]) ||</div>
<div class="line">            (cvlan_vid &gt; 0xFFF) ||</div>
<div class="line">            parser_read_uint16(&amp;a-&gt;encap.qinq_pppoe.pppoe.session_id,</div>
<div class="line">                tokens[9]))</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        a-&gt;encap.qinq_pppoe.svlan.pcp = svlan_pcp &amp; 0x7;</div>
<div class="line">        a-&gt;encap.qinq_pppoe.svlan.dei = svlan_dei &amp; 0x1;</div>
<div class="line">        a-&gt;encap.qinq_pppoe.svlan.vid = svlan_vid &amp; 0xFFF;</div>
<div class="line">        a-&gt;encap.qinq_pppoe.cvlan.pcp = cvlan_pcp &amp; 0x7;</div>
<div class="line">        a-&gt;encap.qinq_pppoe.cvlan.dei = cvlan_dei &amp; 0x1;</div>
<div class="line">        a-&gt;encap.qinq_pppoe.cvlan.vid = cvlan_vid &amp; 0xFFF;</div>
<div class="line">        a-&gt;encap.type = <a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629ca0ce6e8832b5b48c705b9f0f77d018b7c">RTE_TABLE_ACTION_ENCAP_QINQ_PPPOE</a>;</div>
<div class="line">        a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1">RTE_TABLE_ACTION_ENCAP</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1 + 10;</div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* mpls */</span></div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;mpls&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t label, tc, ttl;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens &lt; 8)</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[1], <span class="stringliteral">&quot;unicast&quot;</span>) == 0)</div>
<div class="line">            a-&gt;encap.mpls.unicast = 1;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[1], <span class="stringliteral">&quot;multicast&quot;</span>) == 0)</div>
<div class="line">            a-&gt;encap.mpls.unicast = 0;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parse_mac_addr(tokens[2], &amp;a-&gt;encap.mpls.ether.da) ||</div>
<div class="line">            parse_mac_addr(tokens[3], &amp;a-&gt;encap.mpls.ether.sa) ||</div>
<div class="line">            strcmp(tokens[4], <span class="stringliteral">&quot;label0&quot;</span>) ||</div>
<div class="line">            parser_read_uint32(&amp;label, tokens[5]) ||</div>
<div class="line">            (label &gt; 0xFFFFF) ||</div>
<div class="line">            parser_read_uint32(&amp;tc, tokens[6]) ||</div>
<div class="line">            (tc &gt; 0x7) ||</div>
<div class="line">            parser_read_uint32(&amp;ttl, tokens[7]) ||</div>
<div class="line">            (ttl &gt; 0x3F))</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        a-&gt;encap.mpls.mpls[0].label = label;</div>
<div class="line">        a-&gt;encap.mpls.mpls[0].tc = tc;</div>
<div class="line">        a-&gt;encap.mpls.mpls[0].ttl = ttl;</div>
<div class="line"> </div>
<div class="line">        tokens += 8;</div>
<div class="line">        n_tokens -= 8;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 0) || strcmp(tokens[0], <span class="stringliteral">&quot;label1&quot;</span>)) {</div>
<div class="line">            a-&gt;encap.mpls.mpls_count = 1;</div>
<div class="line">            a-&gt;encap.type = <a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629ca5ff940244e800cde375a6f7dbd743c80">RTE_TABLE_ACTION_ENCAP_MPLS</a>;</div>
<div class="line">            a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1">RTE_TABLE_ACTION_ENCAP</a>;</div>
<div class="line">            <span class="keywordflow">return</span> 1 + 8;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &lt; 4) ||</div>
<div class="line">            parser_read_uint32(&amp;label, tokens[1]) ||</div>
<div class="line">            (label &gt; 0xFFFFF) ||</div>
<div class="line">            parser_read_uint32(&amp;tc, tokens[2]) ||</div>
<div class="line">            (tc &gt; 0x7) ||</div>
<div class="line">            parser_read_uint32(&amp;ttl, tokens[3]) ||</div>
<div class="line">            (ttl &gt; 0x3F))</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        a-&gt;encap.mpls.mpls[1].label = label;</div>
<div class="line">        a-&gt;encap.mpls.mpls[1].tc = tc;</div>
<div class="line">        a-&gt;encap.mpls.mpls[1].ttl = ttl;</div>
<div class="line"> </div>
<div class="line">        tokens += 4;</div>
<div class="line">        n_tokens -= 4;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 0) || strcmp(tokens[0], <span class="stringliteral">&quot;label2&quot;</span>)) {</div>
<div class="line">            a-&gt;encap.mpls.mpls_count = 2;</div>
<div class="line">            a-&gt;encap.type = <a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629ca5ff940244e800cde375a6f7dbd743c80">RTE_TABLE_ACTION_ENCAP_MPLS</a>;</div>
<div class="line">            a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1">RTE_TABLE_ACTION_ENCAP</a>;</div>
<div class="line">            <span class="keywordflow">return</span> 1 + 8 + 4;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &lt; 4) ||</div>
<div class="line">            parser_read_uint32(&amp;label, tokens[1]) ||</div>
<div class="line">            (label &gt; 0xFFFFF) ||</div>
<div class="line">            parser_read_uint32(&amp;tc, tokens[2]) ||</div>
<div class="line">            (tc &gt; 0x7) ||</div>
<div class="line">            parser_read_uint32(&amp;ttl, tokens[3]) ||</div>
<div class="line">            (ttl &gt; 0x3F))</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        a-&gt;encap.mpls.mpls[2].label = label;</div>
<div class="line">        a-&gt;encap.mpls.mpls[2].tc = tc;</div>
<div class="line">        a-&gt;encap.mpls.mpls[2].ttl = ttl;</div>
<div class="line"> </div>
<div class="line">        tokens += 4;</div>
<div class="line">        n_tokens -= 4;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 0) || strcmp(tokens[0], <span class="stringliteral">&quot;label3&quot;</span>)) {</div>
<div class="line">            a-&gt;encap.mpls.mpls_count = 3;</div>
<div class="line">            a-&gt;encap.type = <a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629ca5ff940244e800cde375a6f7dbd743c80">RTE_TABLE_ACTION_ENCAP_MPLS</a>;</div>
<div class="line">            a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1">RTE_TABLE_ACTION_ENCAP</a>;</div>
<div class="line">            <span class="keywordflow">return</span> 1 + 8 + 4 + 4;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &lt; 4) ||</div>
<div class="line">            parser_read_uint32(&amp;label, tokens[1]) ||</div>
<div class="line">            (label &gt; 0xFFFFF) ||</div>
<div class="line">            parser_read_uint32(&amp;tc, tokens[2]) ||</div>
<div class="line">            (tc &gt; 0x7) ||</div>
<div class="line">            parser_read_uint32(&amp;ttl, tokens[3]) ||</div>
<div class="line">            (ttl &gt; 0x3F))</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        a-&gt;encap.mpls.mpls[3].label = label;</div>
<div class="line">        a-&gt;encap.mpls.mpls[3].tc = tc;</div>
<div class="line">        a-&gt;encap.mpls.mpls[3].ttl = ttl;</div>
<div class="line"> </div>
<div class="line">        a-&gt;encap.mpls.mpls_count = 4;</div>
<div class="line">        a-&gt;encap.type = <a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629ca5ff940244e800cde375a6f7dbd743c80">RTE_TABLE_ACTION_ENCAP_MPLS</a>;</div>
<div class="line">        a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1">RTE_TABLE_ACTION_ENCAP</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1 + 8 + 4 + 4 + 4;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* pppoe */</span></div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;pppoe&quot;</span>) == 0)) {</div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &lt; 4) ||</div>
<div class="line">            parse_mac_addr(tokens[1], &amp;a-&gt;encap.pppoe.ether.da) ||</div>
<div class="line">            parse_mac_addr(tokens[2], &amp;a-&gt;encap.pppoe.ether.sa) ||</div>
<div class="line">            parser_read_uint16(&amp;a-&gt;encap.pppoe.pppoe.session_id,</div>
<div class="line">                tokens[3]))</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        a-&gt;encap.type = <a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629cad02d848b8cb391c8e855f16b4fef1091">RTE_TABLE_ACTION_ENCAP_PPPOE</a>;</div>
<div class="line">        a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1">RTE_TABLE_ACTION_ENCAP</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1 + 4;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* vxlan */</span></div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;vxlan&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t n = 0;</div>
<div class="line"> </div>
<div class="line">        n_tokens--;</div>
<div class="line">        tokens++;</div>
<div class="line">        n++;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* ether &lt;da&gt; &lt;sa&gt; */</span></div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &lt; 3) ||</div>
<div class="line">            strcmp(tokens[0], <span class="stringliteral">&quot;ether&quot;</span>) ||</div>
<div class="line">            parse_mac_addr(tokens[1], &amp;a-&gt;encap.vxlan.ether.da) ||</div>
<div class="line">            parse_mac_addr(tokens[2], &amp;a-&gt;encap.vxlan.ether.sa))</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        n_tokens -= 3;</div>
<div class="line">        tokens += 3;</div>
<div class="line">        n += 3;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* [vlan &lt;pcp&gt; &lt;dei&gt; &lt;vid&gt;] */</span></div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;vlan&quot;</span>) == 0) {</div>
<div class="line">            uint32_t pcp, dei, vid;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> ((n_tokens &lt; 4) ||</div>
<div class="line">                parser_read_uint32(&amp;pcp, tokens[1]) ||</div>
<div class="line">                (pcp &gt; 7) ||</div>
<div class="line">                parser_read_uint32(&amp;dei, tokens[2]) ||</div>
<div class="line">                (dei &gt; 1) ||</div>
<div class="line">                parser_read_uint32(&amp;vid, tokens[3]) ||</div>
<div class="line">                (vid &gt; 0xFFF))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">            a-&gt;encap.vxlan.vlan.pcp = pcp;</div>
<div class="line">            a-&gt;encap.vxlan.vlan.dei = dei;</div>
<div class="line">            a-&gt;encap.vxlan.vlan.vid = vid;</div>
<div class="line"> </div>
<div class="line">            n_tokens -= 4;</div>
<div class="line">            tokens += 4;</div>
<div class="line">            n += 4;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* ipv4 &lt;sa&gt; &lt;da&gt; &lt;dscp&gt; &lt;ttl&gt;</span></div>
<div class="line"><span class="comment">           | ipv6 &lt;sa&gt; &lt;da&gt; &lt;flow_label&gt; &lt;dscp&gt; &lt;hop_limit&gt; */</span></div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;ipv4&quot;</span>) == 0) {</div>
<div class="line">            <span class="keyword">struct </span>in_addr sa, da;</div>
<div class="line">            uint8_t dscp, ttl;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> ((n_tokens &lt; 5) ||</div>
<div class="line">                parse_ipv4_addr(tokens[1], &amp;sa) ||</div>
<div class="line">                parse_ipv4_addr(tokens[2], &amp;da) ||</div>
<div class="line">                parser_read_uint8(&amp;dscp, tokens[3]) ||</div>
<div class="line">                (dscp &gt; 64) ||</div>
<div class="line">                parser_read_uint8(&amp;ttl, tokens[4]))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">            a-&gt;encap.vxlan.ipv4.sa = <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(sa.s_addr);</div>
<div class="line">            a-&gt;encap.vxlan.ipv4.da = <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(da.s_addr);</div>
<div class="line">            a-&gt;encap.vxlan.ipv4.dscp = dscp;</div>
<div class="line">            a-&gt;encap.vxlan.ipv4.ttl = ttl;</div>
<div class="line"> </div>
<div class="line">            n_tokens -= 5;</div>
<div class="line">            tokens += 5;</div>
<div class="line">            n += 5;</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;ipv6&quot;</span>) == 0) {</div>
<div class="line">            <span class="keyword">struct </span>in6_addr sa, da;</div>
<div class="line">            uint32_t flow_label;</div>
<div class="line">            uint8_t dscp, hop_limit;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> ((n_tokens &lt; 6) ||</div>
<div class="line">                parse_ipv6_addr(tokens[1], &amp;sa) ||</div>
<div class="line">                parse_ipv6_addr(tokens[2], &amp;da) ||</div>
<div class="line">                parser_read_uint32(&amp;flow_label, tokens[3]) ||</div>
<div class="line">                parser_read_uint8(&amp;dscp, tokens[4]) ||</div>
<div class="line">                (dscp &gt; 64) ||</div>
<div class="line">                parser_read_uint8(&amp;hop_limit, tokens[5]))</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">            memcpy(a-&gt;encap.vxlan.ipv6.sa, sa.s6_addr, 16);</div>
<div class="line">            memcpy(a-&gt;encap.vxlan.ipv6.da, da.s6_addr, 16);</div>
<div class="line">            a-&gt;encap.vxlan.ipv6.flow_label = flow_label;</div>
<div class="line">            a-&gt;encap.vxlan.ipv6.dscp = dscp;</div>
<div class="line">            a-&gt;encap.vxlan.ipv6.hop_limit = hop_limit;</div>
<div class="line"> </div>
<div class="line">            n_tokens -= 6;</div>
<div class="line">            tokens += 6;</div>
<div class="line">            n += 6;</div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* udp &lt;sp&gt; &lt;dp&gt; */</span></div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &lt; 3) ||</div>
<div class="line">            strcmp(tokens[0], <span class="stringliteral">&quot;udp&quot;</span>) ||</div>
<div class="line">            parser_read_uint16(&amp;a-&gt;encap.vxlan.udp.sp, tokens[1]) ||</div>
<div class="line">            parser_read_uint16(&amp;a-&gt;encap.vxlan.udp.dp, tokens[2]))</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        n_tokens -= 3;</div>
<div class="line">        tokens += 3;</div>
<div class="line">        n += 3;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* vxlan &lt;vni&gt; */</span></div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &lt; 2) ||</div>
<div class="line">            strcmp(tokens[0], <span class="stringliteral">&quot;vxlan&quot;</span>) ||</div>
<div class="line">            parser_read_uint32(&amp;a-&gt;encap.vxlan.vxlan.vni, tokens[1]) ||</div>
<div class="line">            (a-&gt;encap.vxlan.vxlan.vni &gt; 0xFFFFFF))</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        n_tokens -= 2;</div>
<div class="line">        tokens += 2;</div>
<div class="line">        n += 2;</div>
<div class="line"> </div>
<div class="line">        a-&gt;encap.type = <a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629caa4687757afebb0174bc1ab65a517dfbf">RTE_TABLE_ACTION_ENCAP_VXLAN</a>;</div>
<div class="line">        a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1">RTE_TABLE_ACTION_ENCAP</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 1 + n;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">parse_table_action_nat(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_action *a)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens &lt; 4) ||</div>
<div class="line">        strcmp(tokens[0], <span class="stringliteral">&quot;nat&quot;</span>))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[1], <span class="stringliteral">&quot;ipv4&quot;</span>) == 0) {</div>
<div class="line">        <span class="keyword">struct </span>in_addr addr;</div>
<div class="line">        uint16_t port;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parse_ipv4_addr(tokens[2], &amp;addr) ||</div>
<div class="line">            parser_read_uint16(&amp;port, tokens[3]))</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        a-&gt;nat.ip_version = 1;</div>
<div class="line">        a-&gt;nat.addr.ipv4 = <a class="code" href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a>(addr.s_addr);</div>
<div class="line">        a-&gt;nat.port = port;</div>
<div class="line">        a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a6368c734fa9c1ac9cb591160eb6bf293">RTE_TABLE_ACTION_NAT</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 4;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[1], <span class="stringliteral">&quot;ipv6&quot;</span>) == 0) {</div>
<div class="line">        <span class="keyword">struct </span>in6_addr addr;</div>
<div class="line">        uint16_t port;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parse_ipv6_addr(tokens[2], &amp;addr) ||</div>
<div class="line">            parser_read_uint16(&amp;port, tokens[3]))</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">        a-&gt;nat.ip_version = 0;</div>
<div class="line">        memcpy(a-&gt;nat.addr.ipv6, addr.s6_addr, 16);</div>
<div class="line">        a-&gt;nat.port = port;</div>
<div class="line">        a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a6368c734fa9c1ac9cb591160eb6bf293">RTE_TABLE_ACTION_NAT</a>;</div>
<div class="line">        <span class="keywordflow">return</span> 4;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">parse_table_action_ttl(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_action *a)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens &lt; 2) ||</div>
<div class="line">        strcmp(tokens[0], <span class="stringliteral">&quot;ttl&quot;</span>))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[1], <span class="stringliteral">&quot;dec&quot;</span>) == 0)</div>
<div class="line">        a-&gt;ttl.decrement = 1;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[1], <span class="stringliteral">&quot;keep&quot;</span>) == 0)</div>
<div class="line">        a-&gt;ttl.decrement = 0;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a64248fbadf2339ff36eee3c6c7c54ce6">RTE_TABLE_ACTION_TTL</a>;</div>
<div class="line">    <span class="keywordflow">return</span> 2;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">parse_table_action_stats(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_action *a)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens &lt; 1) ||</div>
<div class="line">        strcmp(tokens[0], <span class="stringliteral">&quot;stats&quot;</span>))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    a-&gt;stats.n_packets = 0;</div>
<div class="line">    a-&gt;stats.n_bytes = 0;</div>
<div class="line">    a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a491ff78ac06bce973d261ed4dea04101">RTE_TABLE_ACTION_STATS</a>;</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">parse_table_action_time(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_action *a)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens &lt; 1) ||</div>
<div class="line">        strcmp(tokens[0], <span class="stringliteral">&quot;time&quot;</span>))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    a-&gt;time.time = rte_rdtsc();</div>
<div class="line">    a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a5ff88316e4574c62086f9f978a89fe5a">RTE_TABLE_ACTION_TIME</a>;</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">parse_free_sym_crypto_param_data(<span class="keyword">struct</span> <a name="_a67"></a><a class="code" href="structrte__table__action__sym__crypto__params.html">rte_table_action_sym_crypto_params</a> *p)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a68"></a><a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *xform[2] = {NULL};</div>
<div class="line">    uint32_t i;</div>
<div class="line"> </div>
<div class="line">    xform[0] = p-&gt;<a name="a69"></a><a class="code" href="structrte__table__action__sym__crypto__params.html#ac8e4b59a436a743849b7116e8a3d135c">xform</a>;</div>
<div class="line">    <span class="keywordflow">if</span> (xform[0])</div>
<div class="line">        xform[1] = xform[0]-&gt;<a name="a70"></a><a class="code" href="structrte__crypto__sym__xform.html#aa8c788b7f832e2a4183a8924ff8dab97">next</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (xform[i] == NULL)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">switch</span> (xform[i]-&gt;<a name="a71"></a><a class="code" href="structrte__crypto__sym__xform.html#a714d838357b795dd999dc8de04f1c7f4">type</a>) {</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a72"></a><a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c">RTE_CRYPTO_SYM_XFORM_CIPHER</a>:</div>
<div class="line">            <span class="keywordflow">if</span> (p-&gt;<a name="a73"></a>cipher_auth.cipher_iv.val)</div>
<div class="line">                free(p-&gt;cipher_auth.cipher_iv.val);</div>
<div class="line">            <span class="keywordflow">if</span> (p-&gt;cipher_auth.cipher_iv_update.val)</div>
<div class="line">                free(p-&gt;cipher_auth.cipher_iv_update.val);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a74"></a><a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9">RTE_CRYPTO_SYM_XFORM_AUTH</a>:</div>
<div class="line">            <span class="keywordflow">if</span> (p-&gt;cipher_auth.auth_iv.val)</div>
<div class="line">                free(p-&gt;cipher_auth.cipher_iv.val);</div>
<div class="line">            <span class="keywordflow">if</span> (p-&gt;cipher_auth.auth_iv_update.val)</div>
<div class="line">                free(p-&gt;cipher_auth.cipher_iv_update.val);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a75"></a><a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a87d8d14b56f41d42ca643d33a279912a">RTE_CRYPTO_SYM_XFORM_AEAD</a>:</div>
<div class="line">            <span class="keywordflow">if</span> (p-&gt;<a name="a76"></a>aead.iv.val)</div>
<div class="line">                free(p-&gt;aead.iv.val);</div>
<div class="line">            <span class="keywordflow">if</span> (p-&gt;aead.aad.val)</div>
<div class="line">                free(p-&gt;aead.aad.val);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *</div>
<div class="line">parse_table_action_cipher(<span class="keyword">struct</span> <a class="code" href="structrte__table__action__sym__crypto__params.html">rte_table_action_sym_crypto_params</a> *p,</div>
<div class="line">        uint8_t *key, uint32_t max_key_len, <span class="keywordtype">char</span> **tokens,</div>
<div class="line">        uint32_t n_tokens, uint32_t encrypt, uint32_t *used_n_tokens)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *xform_cipher;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line">    <span class="keywordtype">size_t</span> len;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &lt; 7 || strcmp(tokens[1], <span class="stringliteral">&quot;cipher_algo&quot;</span>) ||</div>
<div class="line">            strcmp(tokens[3], <span class="stringliteral">&quot;cipher_key&quot;</span>) ||</div>
<div class="line">            strcmp(tokens[5], <span class="stringliteral">&quot;cipher_iv&quot;</span>))</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    xform_cipher = calloc(1, <span class="keyword">sizeof</span>(*xform_cipher));</div>
<div class="line">    <span class="keywordflow">if</span> (xform_cipher == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    xform_cipher-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a714d838357b795dd999dc8de04f1c7f4">type</a> = <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c">RTE_CRYPTO_SYM_XFORM_CIPHER</a>;</div>
<div class="line">    xform_cipher-&gt;<a name="a77"></a><a class="code" href="structrte__crypto__sym__xform.html#ac50ef6f5e9722a6125cad8e2547c9847">cipher</a>.<a name="a78"></a><a class="code" href="structrte__crypto__cipher__xform.html#ab8e313535343ba1b7b75ad16589de6c9">op</a> = encrypt ? <a name="a79"></a><a class="code" href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321a74a31028a7180f96bcbe6c1edc298c5b">RTE_CRYPTO_CIPHER_OP_ENCRYPT</a> :</div>
<div class="line">            <a name="a80"></a><a class="code" href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321a4ec0ce9be05fae0758c95aadfb03c4ee">RTE_CRYPTO_CIPHER_OP_DECRYPT</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* cipher_algo */</span></div>
<div class="line">    status = <a name="a81"></a><a class="code" href="rte__cryptodev_8h.html#aac0e6b2a8cb903ccad7118b8c8155067">rte_cryptodev_get_cipher_algo_enum</a>(</div>
<div class="line">            &amp;xform_cipher-&gt;<a class="code" href="structrte__crypto__sym__xform.html#ac50ef6f5e9722a6125cad8e2547c9847">cipher</a>.<a name="a82"></a><a class="code" href="structrte__crypto__cipher__xform.html#a23947db20adeb0a2e186dc618f645e44">algo</a>, tokens[2]);</div>
<div class="line">    <span class="keywordflow">if</span> (status &lt; 0)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* cipher_key */</span></div>
<div class="line">    len = strlen(tokens[4]);</div>
<div class="line">    <span class="keywordflow">if</span> (len / 2 &gt; max_key_len) {</div>
<div class="line">        status = -ENOMEM;</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = parse_hex_string(tokens[4], key, (uint32_t *)&amp;len);</div>
<div class="line">    <span class="keywordflow">if</span> (status &lt; 0)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    xform_cipher-&gt;<a class="code" href="structrte__crypto__sym__xform.html#ac50ef6f5e9722a6125cad8e2547c9847">cipher</a>.<a name="a83"></a><a class="code" href="structrte__crypto__cipher__xform.html#a320b4b9a8f44fe20dcf27b2914a83145">key</a>.<a name="a84"></a><a class="code" href="structrte__crypto__cipher__xform.html#a579f5164b5b16e18ddcdb0296ef81799">data</a> = key;</div>
<div class="line">    xform_cipher-&gt;<a class="code" href="structrte__crypto__sym__xform.html#ac50ef6f5e9722a6125cad8e2547c9847">cipher</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a320b4b9a8f44fe20dcf27b2914a83145">key</a>.<a name="a85"></a><a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a> = (uint16_t)len;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* cipher_iv */</span></div>
<div class="line">    len = strlen(tokens[6]);</div>
<div class="line"> </div>
<div class="line">    p-&gt;cipher_auth.cipher_iv.val = calloc(1, len / 2 + 1);</div>
<div class="line">    <span class="keywordflow">if</span> (p-&gt;cipher_auth.cipher_iv.val == NULL)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    status = parse_hex_string(tokens[6],</div>
<div class="line">            p-&gt;cipher_auth.cipher_iv.val,</div>
<div class="line">            (uint32_t *)&amp;len);</div>
<div class="line">    <span class="keywordflow">if</span> (status &lt; 0)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    xform_cipher-&gt;<a class="code" href="structrte__crypto__sym__xform.html#ac50ef6f5e9722a6125cad8e2547c9847">cipher</a>.<a name="a86"></a><a class="code" href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">iv</a>.<a class="code" href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a> = (uint16_t)len;</div>
<div class="line">    xform_cipher-&gt;<a class="code" href="structrte__crypto__sym__xform.html#ac50ef6f5e9722a6125cad8e2547c9847">cipher</a>.<a class="code" href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">iv</a>.<a name="a87"></a><a class="code" href="structrte__crypto__cipher__xform.html#ac681806181c80437cfab37335f62ff39">offset</a> = RTE_TABLE_ACTION_SYM_CRYPTO_IV_OFFSET;</div>
<div class="line">    p-&gt;cipher_auth.cipher_iv.length = (uint32_t)len;</div>
<div class="line">    *used_n_tokens = 7;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> xform_cipher;</div>
<div class="line"> </div>
<div class="line">error_exit:</div>
<div class="line">    <span class="keywordflow">if</span> (p-&gt;cipher_auth.cipher_iv.val) {</div>
<div class="line">        free(p-&gt;cipher_auth.cipher_iv.val);</div>
<div class="line">        p-&gt;cipher_auth.cipher_iv.val = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    free(xform_cipher);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> NULL;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *</div>
<div class="line">parse_table_action_cipher_auth(<span class="keyword">struct</span> <a class="code" href="structrte__table__action__sym__crypto__params.html">rte_table_action_sym_crypto_params</a> *p,</div>
<div class="line">        uint8_t *key, uint32_t max_key_len, <span class="keywordtype">char</span> **tokens,</div>
<div class="line">        uint32_t n_tokens, uint32_t encrypt, uint32_t *used_n_tokens)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *xform_cipher;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *xform_auth;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line">    <span class="keywordtype">size_t</span> len;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &lt; 13 ||</div>
<div class="line">            strcmp(tokens[7], <span class="stringliteral">&quot;auth_algo&quot;</span>) ||</div>
<div class="line">            strcmp(tokens[9], <span class="stringliteral">&quot;auth_key&quot;</span>) ||</div>
<div class="line">            strcmp(tokens[11], <span class="stringliteral">&quot;digest_size&quot;</span>))</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    xform_auth = calloc(1, <span class="keyword">sizeof</span>(*xform_auth));</div>
<div class="line">    <span class="keywordflow">if</span> (xform_auth == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    xform_auth-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a714d838357b795dd999dc8de04f1c7f4">type</a> = <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9">RTE_CRYPTO_SYM_XFORM_AUTH</a>;</div>
<div class="line">    xform_auth-&gt;<a name="a88"></a><a class="code" href="structrte__crypto__sym__xform.html#a3f971d41f5862b2967c0598d5e78e1a6">auth</a>.<a name="a89"></a><a class="code" href="structrte__crypto__auth__xform.html#a8e2f80c0b35f9851e755100ea1e8db95">op</a> = encrypt ? <a name="a90"></a><a class="code" href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47aa4697c029df30850f9f01b1c641aca32">RTE_CRYPTO_AUTH_OP_GENERATE</a> :</div>
<div class="line">            <a name="a91"></a><a class="code" href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47a99f910b408b48db113988c3b841972b9">RTE_CRYPTO_AUTH_OP_VERIFY</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* auth_algo */</span></div>
<div class="line">    status = <a name="a92"></a><a class="code" href="rte__cryptodev_8h.html#a385cf406030abf07a1581b6ae3aa03f2">rte_cryptodev_get_auth_algo_enum</a>(&amp;xform_auth-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a3f971d41f5862b2967c0598d5e78e1a6">auth</a>.<a name="a93"></a><a class="code" href="structrte__crypto__auth__xform.html#a00412ca4847e32cce6759541ca06ca86">algo</a>,</div>
<div class="line">            tokens[8]);</div>
<div class="line">    <span class="keywordflow">if</span> (status &lt; 0)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* auth_key */</span></div>
<div class="line">    len = strlen(tokens[10]);</div>
<div class="line">    <span class="keywordflow">if</span> (len / 2 &gt; max_key_len) {</div>
<div class="line">        status = -ENOMEM;</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = parse_hex_string(tokens[10], key, (uint32_t *)&amp;len);</div>
<div class="line">    <span class="keywordflow">if</span> (status &lt; 0)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    xform_auth-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a3f971d41f5862b2967c0598d5e78e1a6">auth</a>.<a name="a94"></a><a class="code" href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">key</a>.<a name="a95"></a><a class="code" href="structrte__crypto__auth__xform.html#a579f5164b5b16e18ddcdb0296ef81799">data</a> = key;</div>
<div class="line">    xform_auth-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a3f971d41f5862b2967c0598d5e78e1a6">auth</a>.<a class="code" href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">key</a>.<a name="a96"></a><a class="code" href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a> = (uint16_t)len;</div>
<div class="line"> </div>
<div class="line">    key += xform_auth-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a3f971d41f5862b2967c0598d5e78e1a6">auth</a>.<a class="code" href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">key</a>.<a class="code" href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>;</div>
<div class="line">    max_key_len -= xform_auth-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a3f971d41f5862b2967c0598d5e78e1a6">auth</a>.<a class="code" href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">key</a>.<a class="code" href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[11], <span class="stringliteral">&quot;digest_size&quot;</span>))</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    status = parser_read_uint16(&amp;xform_auth-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a3f971d41f5862b2967c0598d5e78e1a6">auth</a>.<a name="a97"></a><a class="code" href="structrte__crypto__auth__xform.html#a765cf2674d1c06ca36503b60c24c6b34">digest_length</a>,</div>
<div class="line">            tokens[12]);</div>
<div class="line">    <span class="keywordflow">if</span> (status &lt; 0)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    xform_cipher = parse_table_action_cipher(p, key, max_key_len, tokens,</div>
<div class="line">            7, encrypt, used_n_tokens);</div>
<div class="line">    <span class="keywordflow">if</span> (xform_cipher == NULL)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    *used_n_tokens += 6;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (encrypt) {</div>
<div class="line">        xform_cipher-&gt;<a class="code" href="structrte__crypto__sym__xform.html#aa8c788b7f832e2a4183a8924ff8dab97">next</a> = xform_auth;</div>
<div class="line">        <span class="keywordflow">return</span> xform_cipher;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        xform_auth-&gt;<a class="code" href="structrte__crypto__sym__xform.html#aa8c788b7f832e2a4183a8924ff8dab97">next</a> = xform_cipher;</div>
<div class="line">        <span class="keywordflow">return</span> xform_auth;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">error_exit:</div>
<div class="line">    <span class="keywordflow">if</span> (p-&gt;cipher_auth.auth_iv.val) {</div>
<div class="line">        free(p-&gt;cipher_auth.auth_iv.val);</div>
<div class="line">        p-&gt;cipher_auth.auth_iv.val = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    free(xform_auth);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> NULL;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *</div>
<div class="line">parse_table_action_aead(<span class="keyword">struct</span> <a class="code" href="structrte__table__action__sym__crypto__params.html">rte_table_action_sym_crypto_params</a> *p,</div>
<div class="line">        uint8_t *key, uint32_t max_key_len, <span class="keywordtype">char</span> **tokens,</div>
<div class="line">        uint32_t n_tokens, uint32_t encrypt, uint32_t *used_n_tokens)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *xform_aead;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line">    <span class="keywordtype">size_t</span> len;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &lt; 11 || strcmp(tokens[1], <span class="stringliteral">&quot;aead_algo&quot;</span>) ||</div>
<div class="line">            strcmp(tokens[3], <span class="stringliteral">&quot;aead_key&quot;</span>) ||</div>
<div class="line">            strcmp(tokens[5], <span class="stringliteral">&quot;aead_iv&quot;</span>) ||</div>
<div class="line">            strcmp(tokens[7], <span class="stringliteral">&quot;aead_aad&quot;</span>) ||</div>
<div class="line">            strcmp(tokens[9], <span class="stringliteral">&quot;digest_size&quot;</span>))</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    xform_aead = calloc(1, <span class="keyword">sizeof</span>(*xform_aead));</div>
<div class="line">    <span class="keywordflow">if</span> (xform_aead == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    xform_aead-&gt;<a class="code" href="structrte__crypto__sym__xform.html#a714d838357b795dd999dc8de04f1c7f4">type</a> = <a class="code" href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a87d8d14b56f41d42ca643d33a279912a">RTE_CRYPTO_SYM_XFORM_AEAD</a>;</div>
<div class="line">    xform_aead-&gt;<a name="a98"></a><a class="code" href="structrte__crypto__sym__xform.html#afe8d3d45863238a8b9d868967071061c">aead</a>.op = encrypt ? <a name="a99"></a><a class="code" href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57ea80f5756a76a8c903cc56a3b475576e2c">RTE_CRYPTO_AEAD_OP_ENCRYPT</a> :</div>
<div class="line">            <a name="a100"></a><a class="code" href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57ea331ebd5a481118673489e7c580530179">RTE_CRYPTO_AEAD_OP_DECRYPT</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* aead_algo */</span></div>
<div class="line">    status = <a name="a101"></a><a class="code" href="rte__cryptodev_8h.html#ad57cb5966e6545c495651953f55f057d">rte_cryptodev_get_aead_algo_enum</a>(&amp;xform_aead-&gt;<a class="code" href="structrte__crypto__sym__xform.html#afe8d3d45863238a8b9d868967071061c">aead</a>.algo,</div>
<div class="line">            tokens[2]);</div>
<div class="line">    <span class="keywordflow">if</span> (status &lt; 0)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* aead_key */</span></div>
<div class="line">    len = strlen(tokens[4]);</div>
<div class="line">    <span class="keywordflow">if</span> (len / 2 &gt; max_key_len) {</div>
<div class="line">        status = -ENOMEM;</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = parse_hex_string(tokens[4], key, (uint32_t *)&amp;len);</div>
<div class="line">    <span class="keywordflow">if</span> (status &lt; 0)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    xform_aead-&gt;<a class="code" href="structrte__crypto__sym__xform.html#afe8d3d45863238a8b9d868967071061c">aead</a>.key.data = key;</div>
<div class="line">    xform_aead-&gt;<a class="code" href="structrte__crypto__sym__xform.html#afe8d3d45863238a8b9d868967071061c">aead</a>.key.length = (uint16_t)len;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* aead_iv */</span></div>
<div class="line">    len = strlen(tokens[6]);</div>
<div class="line">    p-&gt;aead.iv.val = calloc(1, len / 2 + 1);</div>
<div class="line">    <span class="keywordflow">if</span> (p-&gt;aead.iv.val == NULL)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    status = parse_hex_string(tokens[6], p-&gt;aead.iv.val,</div>
<div class="line">            (uint32_t *)&amp;len);</div>
<div class="line">    <span class="keywordflow">if</span> (status &lt; 0)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    xform_aead-&gt;<a class="code" href="structrte__crypto__sym__xform.html#afe8d3d45863238a8b9d868967071061c">aead</a>.iv.length = (uint16_t)len;</div>
<div class="line">    xform_aead-&gt;<a class="code" href="structrte__crypto__sym__xform.html#afe8d3d45863238a8b9d868967071061c">aead</a>.iv.offset = RTE_TABLE_ACTION_SYM_CRYPTO_IV_OFFSET;</div>
<div class="line">    p-&gt;aead.iv.length = (uint32_t)len;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* aead_aad */</span></div>
<div class="line">    len = strlen(tokens[8]);</div>
<div class="line">    p-&gt;aead.aad.val = calloc(1, len / 2 + 1);</div>
<div class="line">    <span class="keywordflow">if</span> (p-&gt;aead.aad.val == NULL)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    status = parse_hex_string(tokens[8], p-&gt;aead.aad.val, (uint32_t *)&amp;len);</div>
<div class="line">    <span class="keywordflow">if</span> (status &lt; 0)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    xform_aead-&gt;<a class="code" href="structrte__crypto__sym__xform.html#afe8d3d45863238a8b9d868967071061c">aead</a>.aad_length = (uint16_t)len;</div>
<div class="line">    p-&gt;aead.aad.length = (uint32_t)len;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* digest_size */</span></div>
<div class="line">    status = parser_read_uint16(&amp;xform_aead-&gt;<a class="code" href="structrte__crypto__sym__xform.html#afe8d3d45863238a8b9d868967071061c">aead</a>.digest_length,</div>
<div class="line">            tokens[10]);</div>
<div class="line">    <span class="keywordflow">if</span> (status &lt; 0)</div>
<div class="line">        <span class="keywordflow">goto</span> error_exit;</div>
<div class="line"> </div>
<div class="line">    *used_n_tokens = 11;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> xform_aead;</div>
<div class="line"> </div>
<div class="line">error_exit:</div>
<div class="line">    <span class="keywordflow">if</span> (p-&gt;aead.iv.val) {</div>
<div class="line">        free(p-&gt;aead.iv.val);</div>
<div class="line">        p-&gt;aead.iv.val = NULL;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (p-&gt;aead.aad.val) {</div>
<div class="line">        free(p-&gt;aead.aad.val);</div>
<div class="line">        p-&gt;aead.aad.val = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    free(xform_aead);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> NULL;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">parse_table_action_sym_crypto(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_action *a)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__table__action__sym__crypto__params.html">rte_table_action_sym_crypto_params</a> *p = &amp;a-&gt;sym_crypto;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a> *xform = NULL;</div>
<div class="line">    uint8_t *key = a-&gt;sym_crypto_key;</div>
<div class="line">    uint32_t max_key_len = SYM_CRYPTO_MAX_KEY_SIZE;</div>
<div class="line">    uint32_t used_n_tokens;</div>
<div class="line">    uint32_t encrypt;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens &lt; 12) ||</div>
<div class="line">        strcmp(tokens[0], <span class="stringliteral">&quot;sym_crypto&quot;</span>) ||</div>
<div class="line">        strcmp(tokens[2], <span class="stringliteral">&quot;type&quot;</span>))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    memset(p, 0, <span class="keyword">sizeof</span>(*p));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[1], <span class="stringliteral">&quot;encrypt&quot;</span>) == 0)</div>
<div class="line">        encrypt = 1;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        encrypt = 0;</div>
<div class="line"> </div>
<div class="line">    status = parser_read_uint32(&amp;p-&gt;<a name="a102"></a><a class="code" href="structrte__table__action__sym__crypto__params.html#a0e322da8c7e3d2d6292089c0432f885d">data_offset</a>, tokens[n_tokens - 1]);</div>
<div class="line">    <span class="keywordflow">if</span> (status &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[3], <span class="stringliteral">&quot;cipher&quot;</span>) == 0) {</div>
<div class="line">        tokens += 3;</div>
<div class="line">        n_tokens -= 3;</div>
<div class="line"> </div>
<div class="line">        xform = parse_table_action_cipher(p, key, max_key_len, tokens,</div>
<div class="line">                n_tokens, encrypt, &amp;used_n_tokens);</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[3], <span class="stringliteral">&quot;cipher_auth&quot;</span>) == 0) {</div>
<div class="line">        tokens += 3;</div>
<div class="line">        n_tokens -= 3;</div>
<div class="line"> </div>
<div class="line">        xform = parse_table_action_cipher_auth(p, key, max_key_len,</div>
<div class="line">                tokens, n_tokens, encrypt, &amp;used_n_tokens);</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[3], <span class="stringliteral">&quot;aead&quot;</span>) == 0) {</div>
<div class="line">        tokens += 3;</div>
<div class="line">        n_tokens -= 3;</div>
<div class="line"> </div>
<div class="line">        xform = parse_table_action_aead(p, key, max_key_len, tokens,</div>
<div class="line">                n_tokens, encrypt, &amp;used_n_tokens);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (xform == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    p-&gt;<a class="code" href="structrte__table__action__sym__crypto__params.html#ac8e4b59a436a743849b7116e8a3d135c">xform</a> = xform;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[used_n_tokens], <span class="stringliteral">&quot;data_offset&quot;</span>)) {</div>
<div class="line">        parse_free_sym_crypto_param_data(p);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a962e3a5154b7a1a3e8648bd129c4b561">RTE_TABLE_ACTION_SYM_CRYPTO</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> used_n_tokens + 5;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">parse_table_action_tag(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_action *a)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens &lt; 2) ||</div>
<div class="line">        strcmp(tokens[0], <span class="stringliteral">&quot;tag&quot;</span>))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;a-&gt;tag.tag, tokens[1]))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a3a25fcdcb69e9946dc6d9f6fc7f6ac72">RTE_TABLE_ACTION_TAG</a>;</div>
<div class="line">    <span class="keywordflow">return</span> 2;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">parse_table_action_decap(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_action *a)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens &lt; 2) ||</div>
<div class="line">        strcmp(tokens[0], <span class="stringliteral">&quot;decap&quot;</span>))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint16(&amp;a-&gt;decap.n, tokens[1]))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    a-&gt;action_mask |= 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a73da4960f9f9b30236eeaaed592c855c">RTE_TABLE_ACTION_DECAP</a>;</div>
<div class="line">    <span class="keywordflow">return</span> 2;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t</div>
<div class="line">parse_table_action(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_action *a)</div>
<div class="line">{</div>
<div class="line">    uint32_t n_tokens0 = n_tokens;</div>
<div class="line"> </div>
<div class="line">    memset(a, 0, <span class="keyword">sizeof</span>(*a));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens &lt; 2) ||</div>
<div class="line">        strcmp(tokens[0], <span class="stringliteral">&quot;action&quot;</span>))</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    tokens++;</div>
<div class="line">    n_tokens--;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;fwd&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t n;</div>
<div class="line"> </div>
<div class="line">        n = parse_table_action_fwd(tokens, n_tokens, a);</div>
<div class="line">        <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;action fwd&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        tokens += n;</div>
<div class="line">        n_tokens -= n;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;balance&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t n;</div>
<div class="line"> </div>
<div class="line">        n = parse_table_action_balance(tokens, n_tokens, a);</div>
<div class="line">        <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;action balance&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        tokens += n;</div>
<div class="line">        n_tokens -= n;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;meter&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t n;</div>
<div class="line"> </div>
<div class="line">        n = parse_table_action_meter(tokens, n_tokens, a);</div>
<div class="line">        <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;action meter&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        tokens += n;</div>
<div class="line">        n_tokens -= n;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;tm&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t n;</div>
<div class="line"> </div>
<div class="line">        n = parse_table_action_tm(tokens, n_tokens, a);</div>
<div class="line">        <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;action tm&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        tokens += n;</div>
<div class="line">        n_tokens -= n;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;encap&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t n;</div>
<div class="line"> </div>
<div class="line">        n = parse_table_action_encap(tokens, n_tokens, a);</div>
<div class="line">        <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;action encap&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        tokens += n;</div>
<div class="line">        n_tokens -= n;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;nat&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t n;</div>
<div class="line"> </div>
<div class="line">        n = parse_table_action_nat(tokens, n_tokens, a);</div>
<div class="line">        <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;action nat&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        tokens += n;</div>
<div class="line">        n_tokens -= n;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;ttl&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t n;</div>
<div class="line"> </div>
<div class="line">        n = parse_table_action_ttl(tokens, n_tokens, a);</div>
<div class="line">        <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;action ttl&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        tokens += n;</div>
<div class="line">        n_tokens -= n;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;stats&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t n;</div>
<div class="line"> </div>
<div class="line">        n = parse_table_action_stats(tokens, n_tokens, a);</div>
<div class="line">        <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;action stats&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        tokens += n;</div>
<div class="line">        n_tokens -= n;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;time&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t n;</div>
<div class="line"> </div>
<div class="line">        n = parse_table_action_time(tokens, n_tokens, a);</div>
<div class="line">        <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;action time&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        tokens += n;</div>
<div class="line">        n_tokens -= n;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;sym_crypto&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t n;</div>
<div class="line"> </div>
<div class="line">        n = parse_table_action_sym_crypto(tokens, n_tokens, a);</div>
<div class="line">        <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;action sym_crypto&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        tokens += n;</div>
<div class="line">        n_tokens -= n;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;tag&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t n;</div>
<div class="line"> </div>
<div class="line">        n = parse_table_action_tag(tokens, n_tokens, a);</div>
<div class="line">        <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;action tag&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        tokens += n;</div>
<div class="line">        n_tokens -= n;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;decap&quot;</span>) == 0)) {</div>
<div class="line">        uint32_t n;</div>
<div class="line"> </div>
<div class="line">        n = parse_table_action_decap(tokens, n_tokens, a);</div>
<div class="line">        <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">                <span class="stringliteral">&quot;action decap&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        tokens += n;</div>
<div class="line">        n_tokens -= n;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens0 - n_tokens == 1) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;action&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> n_tokens0 - n_tokens;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_table_rule_add_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; table &lt;table_id&gt; rule add\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;     match &lt;match&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;     action &lt;table_action&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_table_rule_add(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>table_rule_match m;</div>
<div class="line">    <span class="keyword">struct </span>table_rule_action a;</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t table_id, t0, n_tokens_parsed;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &lt; 8) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;table&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;table_id, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;table_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;rule&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;rule&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;add&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;add&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    t0 = 6;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* match */</span></div>
<div class="line">    n_tokens_parsed = parse_match(tokens + t0,</div>
<div class="line">        n_tokens - t0,</div>
<div class="line">        out,</div>
<div class="line">        out_size,</div>
<div class="line">        &amp;m);</div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens_parsed == 0)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    t0 += n_tokens_parsed;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* action */</span></div>
<div class="line">    n_tokens_parsed = parse_table_action(tokens + t0,</div>
<div class="line">        n_tokens - t0,</div>
<div class="line">        out,</div>
<div class="line">        out_size,</div>
<div class="line">        &amp;a);</div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens_parsed == 0)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    t0 += n_tokens_parsed;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (t0 != n_tokens) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = pipeline_table_rule_add(pipeline_name, table_id, &amp;m, &amp;a);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (a.action_mask &amp; 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a962e3a5154b7a1a3e8648bd129c4b561">RTE_TABLE_ACTION_SYM_CRYPTO</a>)</div>
<div class="line">        parse_free_sym_crypto_param_data(&amp;a.sym_crypto);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_table_rule_add_default_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; table &lt;table_id&gt; rule add\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;     match\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;        default\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;     action\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;        fwd\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           drop\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           | port &lt;port_id&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           | meta\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           | table &lt;table_id&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_table_rule_add_default(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>table_rule_action action;</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t table_id;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens != 11) &amp;&amp; (n_tokens != 12)) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;table&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;table_id, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;table_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;rule&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;rule&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;add&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;add&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;match&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;match&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[7], <span class="stringliteral">&quot;default&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;default&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[8], <span class="stringliteral">&quot;action&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;action&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[9], <span class="stringliteral">&quot;fwd&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;fwd&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    action.action_mask = 1 &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aa5194910932359cba3eeca7183922dbf">RTE_TABLE_ACTION_FWD</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[10], <span class="stringliteral">&quot;drop&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens != 11) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        action.fwd.action = <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572af41296546f2a86d1f8f1848010c7c111">RTE_PIPELINE_ACTION_DROP</a>;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[10], <span class="stringliteral">&quot;port&quot;</span>) == 0) {</div>
<div class="line">        uint32_t id;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens != 12) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;<span class="keywordtype">id</span>, tokens[11]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;port_id&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        action.fwd.action = <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572ac8c58609785d844989b7d9eb1e6db8aa">RTE_PIPELINE_ACTION_PORT</a>;</div>
<div class="line">        action.fwd.id = id;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[10], <span class="stringliteral">&quot;meta&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens != 11) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        action.fwd.action = <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572a5dc23d641b483615ea475152ac7ab7f4">RTE_PIPELINE_ACTION_PORT_META</a>;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[10], <span class="stringliteral">&quot;table&quot;</span>) == 0) {</div>
<div class="line">        uint32_t id;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens != 12) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint32(&amp;<span class="keywordtype">id</span>, tokens[11]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;table_id&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        action.fwd.action = <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572abafaf6276afcfcb170a2f7aa44c21048">RTE_PIPELINE_ACTION_TABLE</a>;</div>
<div class="line">        action.fwd.id = id;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID,</div>
<div class="line">            <span class="stringliteral">&quot;drop or port or meta or table&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = pipeline_table_rule_add_default(pipeline_name,</div>
<div class="line">        table_id,</div>
<div class="line">        &amp;action);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_table_rule_add_bulk_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; table &lt;table_id&gt; rule add bulk &lt;file_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;  File &lt;file_name&gt;:\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;  - line format: match &lt;match&gt; action &lt;action&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">cli_rule_file_process(<span class="keyword">const</span> <span class="keywordtype">char</span> *file_name,</div>
<div class="line">    <span class="keywordtype">size_t</span> line_len_max,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_list **rule_list,</div>
<div class="line">    uint32_t *n_rules,</div>
<div class="line">    uint32_t *line_number,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_table_rule_add_bulk(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>table_rule_list *list = NULL;</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name, *file_name;</div>
<div class="line">    uint32_t table_id, n_rules, n_rules_added, n_rules_not_added, line_number;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 8) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;table&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;table_id, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;table_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;rule&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;rule&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;add&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;add&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;bulk&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;bulk&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    file_name = tokens[7];</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Load rules from file. */</span></div>
<div class="line">    status = cli_rule_file_process(file_name,</div>
<div class="line">        1024,</div>
<div class="line">        &amp;list,</div>
<div class="line">        &amp;n_rules,</div>
<div class="line">        &amp;line_number,</div>
<div class="line">        out,</div>
<div class="line">        out_size);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_FILE_ERR, file_name, line_number);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Rule bulk add */</span></div>
<div class="line">    status = pipeline_table_rule_add_bulk(pipeline_name,</div>
<div class="line">        table_id,</div>
<div class="line">        list,</div>
<div class="line">        &amp;n_rules_added,</div>
<div class="line">        &amp;n_rules_not_added);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    snprintf(out, out_size, <span class="stringliteral">&quot;Added %u rules out of %u.\n&quot;</span>,</div>
<div class="line">        n_rules_added,</div>
<div class="line">        n_rules);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_table_rule_delete_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; table &lt;table_id&gt; rule delete\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;     match &lt;match&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_table_rule_delete(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>table_rule_match m;</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t table_id, n_tokens_parsed, t0;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &lt; 8) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;table&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;table_id, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;table_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;rule&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;rule&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;delete&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;delete&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    t0 = 6;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* match */</span></div>
<div class="line">    n_tokens_parsed = parse_match(tokens + t0,</div>
<div class="line">        n_tokens - t0,</div>
<div class="line">        out,</div>
<div class="line">        out_size,</div>
<div class="line">        &amp;m);</div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens_parsed == 0)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    t0 += n_tokens_parsed;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != t0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = pipeline_table_rule_delete(pipeline_name,</div>
<div class="line">        table_id,</div>
<div class="line">        &amp;m);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_table_rule_delete_default_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; table &lt;table_id&gt; rule delete\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;     match\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;        default\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_table_rule_delete_default(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t table_id;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 8) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;table&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;table_id, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;table_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;rule&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;rule&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;delete&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;delete&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;match&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;match&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[7], <span class="stringliteral">&quot;default&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;default&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = pipeline_table_rule_delete_default(pipeline_name,</div>
<div class="line">        table_id);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">ether_addr_show(FILE *f, <span class="keyword">struct</span> <a class="code" href="structrte__ether__addr.html">rte_ether_addr</a> *addr)</div>
<div class="line">{</div>
<div class="line">    fprintf(f, <span class="stringliteral">&quot;%02x:%02x:%02x:%02x:%02x:%02x&quot;</span>,</div>
<div class="line">        (uint32_t)addr-&gt;<a name="a103"></a><a class="code" href="structrte__ether__addr.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[0], (uint32_t)addr-&gt;<a class="code" href="structrte__ether__addr.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[1],</div>
<div class="line">        (uint32_t)addr-&gt;<a class="code" href="structrte__ether__addr.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[2], (uint32_t)addr-&gt;<a class="code" href="structrte__ether__addr.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[3],</div>
<div class="line">        (uint32_t)addr-&gt;<a class="code" href="structrte__ether__addr.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[4], (uint32_t)addr-&gt;<a class="code" href="structrte__ether__addr.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">addr_bytes</a>[5]);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">ipv4_addr_show(FILE *f, uint32_t addr)</div>
<div class="line">{</div>
<div class="line">    fprintf(f, <span class="stringliteral">&quot;%u.%u.%u.%u&quot;</span>,</div>
<div class="line">        addr &gt;&gt; 24,</div>
<div class="line">        (addr &gt;&gt; 16) &amp; 0xFF,</div>
<div class="line">        (addr &gt;&gt; 8) &amp; 0xFF,</div>
<div class="line">        addr &amp; 0xFF);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">ipv6_addr_show(FILE *f, uint8_t *addr)</div>
<div class="line">{</div>
<div class="line">    fprintf(f, <span class="stringliteral">&quot;%02x%02x:%02x%02x:%02x%02x:%02x%02x:&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;%02x%02x:%02x%02x:%02x%02x:%02x%02x:&quot;</span>,</div>
<div class="line">        (uint32_t)addr[0], (uint32_t)addr[1],</div>
<div class="line">        (uint32_t)addr[2], (uint32_t)addr[3],</div>
<div class="line">        (uint32_t)addr[4], (uint32_t)addr[5],</div>
<div class="line">        (uint32_t)addr[6], (uint32_t)addr[7],</div>
<div class="line">        (uint32_t)addr[8], (uint32_t)addr[9],</div>
<div class="line">        (uint32_t)addr[10], (uint32_t)addr[11],</div>
<div class="line">        (uint32_t)addr[12], (uint32_t)addr[13],</div>
<div class="line">        (uint32_t)addr[14], (uint32_t)addr[15]);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *</div>
<div class="line">policer_action_string(<span class="keyword">enum</span> <a class="code" href="rte__table__action_8h.html#a6a4e67d5a60f87389cd9f56787d2d176">rte_table_action_policer</a> action) {</div>
<div class="line">    <span class="keywordflow">switch</span> (action) {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__table__action_8h.html#a6a4e67d5a60f87389cd9f56787d2d176a27aa6e2021e308d76c3569b9f492a70c">RTE_TABLE_ACTION_POLICER_COLOR_GREEN</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;G&quot;</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__table__action_8h.html#a6a4e67d5a60f87389cd9f56787d2d176a711a4c01a0c9649e024cab6d3affb806">RTE_TABLE_ACTION_POLICER_COLOR_YELLOW</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;Y&quot;</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__table__action_8h.html#a6a4e67d5a60f87389cd9f56787d2d176a06918153b593ada41b4685b285d7b80e">RTE_TABLE_ACTION_POLICER_COLOR_RED</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;R&quot;</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__table__action_8h.html#a6a4e67d5a60f87389cd9f56787d2d176afe7f90714cd9ae3907e98073af4272ef">RTE_TABLE_ACTION_POLICER_DROP</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;D&quot;</span>;</div>
<div class="line">        <span class="keywordflow">default</span>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;?&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">table_rule_show(<span class="keyword">const</span> <span class="keywordtype">char</span> *pipeline_name,</div>
<div class="line">    uint32_t table_id,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *file_name)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>table *table;</div>
<div class="line">    <span class="keyword">struct </span>table_rule *rule;</div>
<div class="line">    FILE *f = NULL;</div>
<div class="line">    uint32_t i;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input params. */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((pipeline_name == NULL) ||</div>
<div class="line">        (file_name == NULL))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    p = pipeline_find(pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (table_id &gt;= p-&gt;n_tables))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    table = &amp;p-&gt;table[table_id];</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Open file. */</span></div>
<div class="line">    f = fopen(file_name, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (f == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write table rules to file. */</span></div>
<div class="line">    TAILQ_FOREACH(rule, &amp;table-&gt;rules, node) {</div>
<div class="line">        <span class="keyword">struct </span>table_rule_match *m = &amp;rule-&gt;match;</div>
<div class="line">        <span class="keyword">struct </span>table_rule_action *a = &amp;rule-&gt;action;</div>
<div class="line"> </div>
<div class="line">        fprintf(f, <span class="stringliteral">&quot;match &quot;</span>);</div>
<div class="line">        <span class="keywordflow">switch</span> (m-&gt;match_type) {</div>
<div class="line">        <span class="keywordflow">case</span> TABLE_ACL:</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;acl priority %u &quot;</span>,</div>
<div class="line">                m-&gt;match.acl.priority);</div>
<div class="line"> </div>
<div class="line">            fprintf(f, m-&gt;match.acl.ip_version ? <span class="stringliteral">&quot;ipv4 &quot;</span> : <span class="stringliteral">&quot;ipv6 &quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (m-&gt;match.acl.ip_version)</div>
<div class="line">                ipv4_addr_show(f, m-&gt;match.acl.ipv4.sa);</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                ipv6_addr_show(f, m-&gt;match.acl.ipv6.sa);</div>
<div class="line"> </div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;%u&quot;</span>,    m-&gt;match.acl.sa_depth);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (m-&gt;match.acl.ip_version)</div>
<div class="line">                ipv4_addr_show(f, m-&gt;match.acl.ipv4.da);</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                ipv6_addr_show(f, m-&gt;match.acl.ipv6.da);</div>
<div class="line"> </div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;%u&quot;</span>,    m-&gt;match.acl.da_depth);</div>
<div class="line"> </div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;%u %u %u %u %u &quot;</span>,</div>
<div class="line">                (uint32_t)m-&gt;match.acl.sp0,</div>
<div class="line">                (uint32_t)m-&gt;match.acl.sp1,</div>
<div class="line">                (uint32_t)m-&gt;match.acl.dp0,</div>
<div class="line">                (uint32_t)m-&gt;match.acl.dp1,</div>
<div class="line">                (uint32_t)m-&gt;match.acl.proto);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> TABLE_ARRAY:</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;array %u &quot;</span>,</div>
<div class="line">                m-&gt;match.array.pos);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> TABLE_HASH:</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;hash raw &quot;</span>);</div>
<div class="line">            <span class="keywordflow">for</span> (i = 0; i &lt; table-&gt;params.match.hash.key_size; i++)</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot;%02x&quot;</span>, m-&gt;match.hash.key[i]);</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> TABLE_LPM:</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;lpm &quot;</span>);</div>
<div class="line"> </div>
<div class="line">            fprintf(f, m-&gt;match.lpm.ip_version ? <span class="stringliteral">&quot;ipv4 &quot;</span> : <span class="stringliteral">&quot;ipv6 &quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (m-&gt;match.acl.ip_version)</div>
<div class="line">                ipv4_addr_show(f, m-&gt;match.lpm.ipv4);</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                ipv6_addr_show(f, m-&gt;match.lpm.ipv6);</div>
<div class="line"> </div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;%u &quot;</span>,</div>
<div class="line">                (uint32_t)m-&gt;match.lpm.depth);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;unknown &quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        fprintf(f, <span class="stringliteral">&quot;action &quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (a-&gt;action_mask &amp; (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aa5194910932359cba3eeca7183922dbf">RTE_TABLE_ACTION_FWD</a>)) {</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;fwd &quot;</span>);</div>
<div class="line">            <span class="keywordflow">switch</span> (a-&gt;fwd.action) {</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572af41296546f2a86d1f8f1848010c7c111">RTE_PIPELINE_ACTION_DROP</a>:</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot;drop &quot;</span>);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572ac8c58609785d844989b7d9eb1e6db8aa">RTE_PIPELINE_ACTION_PORT</a>:</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot;port %u &quot;</span>, a-&gt;fwd.id);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572a5dc23d641b483615ea475152ac7ab7f4">RTE_PIPELINE_ACTION_PORT_META</a>:</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot;meta &quot;</span>);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572abafaf6276afcfcb170a2f7aa44c21048">RTE_PIPELINE_ACTION_TABLE</a>:</div>
<div class="line">            <span class="keywordflow">default</span>:</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot;table %u &quot;</span>, a-&gt;fwd.id);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (a-&gt;action_mask &amp; (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2af4f7ba5c7d7eefc2fde9341b8724c11b">RTE_TABLE_ACTION_LB</a>)) {</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;balance &quot;</span>);</div>
<div class="line">            <span class="keywordflow">for</span> (i = 0; i &lt; <a name="a104"></a><a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(a-&gt;lb.out); i++)</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot;%u &quot;</span>, a-&gt;lb.out[i]);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (a-&gt;action_mask &amp; (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a7442253cfdff0aec945b0ad7ddf5ab2d">RTE_TABLE_ACTION_MTR</a>)) {</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;mtr &quot;</span>);</div>
<div class="line">            <span class="keywordflow">for</span> (i = 0; i &lt; <a name="a105"></a><a class="code" href="rte__table__action_8h.html#ad90568b948ab3ce824e43fd789de8b9a">RTE_TABLE_ACTION_TC_MAX</a>; i++)</div>
<div class="line">                <span class="keywordflow">if</span> (a-&gt;mtr.tc_mask &amp; (1 &lt;&lt; i)) {</div>
<div class="line">                    <span class="keyword">struct </span><a class="code" href="structrte__table__action__mtr__tc__params.html">rte_table_action_mtr_tc_params</a> *p =</div>
<div class="line">                        &amp;a-&gt;mtr.mtr[i];</div>
<div class="line">                    <span class="keyword">enum</span> <a class="code" href="rte__table__action_8h.html#a6a4e67d5a60f87389cd9f56787d2d176">rte_table_action_policer</a> ga =</div>
<div class="line">                        p-&gt;<a class="code" href="structrte__table__action__mtr__tc__params.html#afbd6fd0aa98794a1c59a425a0a6ca13f">policer</a>[<a class="code" href="rte__meter_8h.html#a35388a9ecf2eab3020433bd6207b3436a43d24f9a4881b17f0d0af3c8358fea05">RTE_COLOR_GREEN</a>];</div>
<div class="line">                    <span class="keyword">enum</span> <a class="code" href="rte__table__action_8h.html#a6a4e67d5a60f87389cd9f56787d2d176">rte_table_action_policer</a> ya =</div>
<div class="line">                        p-&gt;<a class="code" href="structrte__table__action__mtr__tc__params.html#afbd6fd0aa98794a1c59a425a0a6ca13f">policer</a>[<a class="code" href="rte__meter_8h.html#a35388a9ecf2eab3020433bd6207b3436a83de16e2e12e9a65d07bca453b899fbe">RTE_COLOR_YELLOW</a>];</div>
<div class="line">                    <span class="keyword">enum</span> <a class="code" href="rte__table__action_8h.html#a6a4e67d5a60f87389cd9f56787d2d176">rte_table_action_policer</a> ra =</div>
<div class="line">                        p-&gt;<a class="code" href="structrte__table__action__mtr__tc__params.html#afbd6fd0aa98794a1c59a425a0a6ca13f">policer</a>[<a class="code" href="rte__meter_8h.html#a35388a9ecf2eab3020433bd6207b3436a910409b5938b2e9ad695db4676353e68">RTE_COLOR_RED</a>];</div>
<div class="line"> </div>
<div class="line">                    fprintf(f, <span class="stringliteral">&quot;tc%u meter %u policer g %s y %s r %s &quot;</span>,</div>
<div class="line">                        i,</div>
<div class="line">                        a-&gt;mtr.mtr[i].meter_profile_id,</div>
<div class="line">                        policer_action_string(ga),</div>
<div class="line">                        policer_action_string(ya),</div>
<div class="line">                        policer_action_string(ra));</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (a-&gt;action_mask &amp; (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a9f9ca84acea19612c86d3da0898ed34e">RTE_TABLE_ACTION_TM</a>))</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;tm subport %u pipe %u &quot;</span>,</div>
<div class="line">                a-&gt;tm.subport_id,</div>
<div class="line">                a-&gt;tm.pipe_id);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (a-&gt;action_mask &amp; (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1">RTE_TABLE_ACTION_ENCAP</a>)) {</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;encap &quot;</span>);</div>
<div class="line">            <span class="keywordflow">switch</span> (a-&gt;encap.type) {</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629cade2089a818728f7245cb6a3aea427875">RTE_TABLE_ACTION_ENCAP_ETHER</a>:</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot;ether &quot;</span>);</div>
<div class="line">                ether_addr_show(f, &amp;a-&gt;encap.ether.ether.da);</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line">                ether_addr_show(f, &amp;a-&gt;encap.ether.ether.sa);</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629ca0cc0e97e7d412911cbe6e98994d4c2e4">RTE_TABLE_ACTION_ENCAP_VLAN</a>:</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot;vlan &quot;</span>);</div>
<div class="line">                ether_addr_show(f, &amp;a-&gt;encap.vlan.ether.da);</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line">                ether_addr_show(f, &amp;a-&gt;encap.vlan.ether.sa);</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot; pcp %u dei %u vid %u &quot;</span>,</div>
<div class="line">                    a-&gt;encap.vlan.vlan.pcp,</div>
<div class="line">                    a-&gt;encap.vlan.vlan.dei,</div>
<div class="line">                    a-&gt;encap.vlan.vlan.vid);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629caca0bdb5026849382b38c7ddc42a902da">RTE_TABLE_ACTION_ENCAP_QINQ</a>:</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot;qinq &quot;</span>);</div>
<div class="line">                ether_addr_show(f, &amp;a-&gt;encap.qinq.ether.da);</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line">                ether_addr_show(f, &amp;a-&gt;encap.qinq.ether.sa);</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot; pcp %u dei %u vid %u pcp %u dei %u vid %u &quot;</span>,</div>
<div class="line">                    a-&gt;encap.qinq.svlan.pcp,</div>
<div class="line">                    a-&gt;encap.qinq.svlan.dei,</div>
<div class="line">                    a-&gt;encap.qinq.svlan.vid,</div>
<div class="line">                    a-&gt;encap.qinq.cvlan.pcp,</div>
<div class="line">                    a-&gt;encap.qinq.cvlan.dei,</div>
<div class="line">                    a-&gt;encap.qinq.cvlan.vid);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629ca5ff940244e800cde375a6f7dbd743c80">RTE_TABLE_ACTION_ENCAP_MPLS</a>:</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot;mpls %s &quot;</span>, (a-&gt;encap.mpls.unicast) ?</div>
<div class="line">                    <span class="stringliteral">&quot;unicast &quot;</span> : <span class="stringliteral">&quot;multicast &quot;</span>);</div>
<div class="line">                ether_addr_show(f, &amp;a-&gt;encap.mpls.ether.da);</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line">                ether_addr_show(f, &amp;a-&gt;encap.mpls.ether.sa);</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line">                <span class="keywordflow">for</span> (i = 0; i &lt; a-&gt;encap.mpls.mpls_count; i++) {</div>
<div class="line">                    <span class="keyword">struct </span><a name="_a106"></a><a class="code" href="structrte__table__action__mpls__hdr.html">rte_table_action_mpls_hdr</a> *l =</div>
<div class="line">                        &amp;a-&gt;encap.mpls.mpls[i];</div>
<div class="line"> </div>
<div class="line">                    fprintf(f, <span class="stringliteral">&quot;label%u %u %u %u &quot;</span>,</div>
<div class="line">                        i,</div>
<div class="line">                        l-&gt;<a name="a107"></a><a class="code" href="structrte__table__action__mpls__hdr.html#a9ce12edf40436c627879a2e93124f4c6">label</a>,</div>
<div class="line">                        l-&gt;<a name="a108"></a><a class="code" href="structrte__table__action__mpls__hdr.html#a67deec524d278467a2815a2783b95591">tc</a>,</div>
<div class="line">                        l-&gt;<a name="a109"></a><a class="code" href="structrte__table__action__mpls__hdr.html#a4d402503271315376ddf4e47674d4965">ttl</a>);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629cad02d848b8cb391c8e855f16b4fef1091">RTE_TABLE_ACTION_ENCAP_PPPOE</a>:</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot;pppoe &quot;</span>);</div>
<div class="line">                ether_addr_show(f, &amp;a-&gt;encap.pppoe.ether.da);</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line">                ether_addr_show(f, &amp;a-&gt;encap.pppoe.ether.sa);</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot; %u &quot;</span>, a-&gt;encap.pppoe.pppoe.session_id);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629caa4687757afebb0174bc1ab65a517dfbf">RTE_TABLE_ACTION_ENCAP_VXLAN</a>:</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot;vxlan ether &quot;</span>);</div>
<div class="line">                ether_addr_show(f, &amp;a-&gt;encap.vxlan.ether.da);</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line">                ether_addr_show(f, &amp;a-&gt;encap.vxlan.ether.sa);</div>
<div class="line">                <span class="keywordflow">if</span> (table-&gt;ap-&gt;params.encap.vxlan.vlan)</div>
<div class="line">                    fprintf(f, <span class="stringliteral">&quot; vlan pcp %u dei %u vid %u &quot;</span>,</div>
<div class="line">                        a-&gt;encap.vxlan.vlan.pcp,</div>
<div class="line">                        a-&gt;encap.vxlan.vlan.dei,</div>
<div class="line">                        a-&gt;encap.vxlan.vlan.vid);</div>
<div class="line">                <span class="keywordflow">if</span> (table-&gt;ap-&gt;params.encap.vxlan.ip_version) {</div>
<div class="line">                    fprintf(f, <span class="stringliteral">&quot; ipv4 &quot;</span>);</div>
<div class="line">                    ipv4_addr_show(f, a-&gt;encap.vxlan.ipv4.sa);</div>
<div class="line">                    fprintf(f, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line">                    ipv4_addr_show(f, a-&gt;encap.vxlan.ipv4.da);</div>
<div class="line">                    fprintf(f, <span class="stringliteral">&quot; %u %u &quot;</span>,</div>
<div class="line">                        (uint32_t)a-&gt;encap.vxlan.ipv4.dscp,</div>
<div class="line">                        (uint32_t)a-&gt;encap.vxlan.ipv4.ttl);</div>
<div class="line">                } <span class="keywordflow">else</span> {</div>
<div class="line">                    fprintf(f, <span class="stringliteral">&quot; ipv6 &quot;</span>);</div>
<div class="line">                    ipv6_addr_show(f, a-&gt;encap.vxlan.ipv6.sa);</div>
<div class="line">                    fprintf(f, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line">                    ipv6_addr_show(f, a-&gt;encap.vxlan.ipv6.da);</div>
<div class="line">                    fprintf(f, <span class="stringliteral">&quot; %u %u %u &quot;</span>,</div>
<div class="line">                        a-&gt;encap.vxlan.ipv6.flow_label,</div>
<div class="line">                        (uint32_t)a-&gt;encap.vxlan.ipv6.dscp,</div>
<div class="line">                        (uint32_t)a-&gt;encap.vxlan.ipv6.hop_limit);</div>
<div class="line">                    fprintf(f, <span class="stringliteral">&quot; udp %u %u vxlan %u &quot;</span>,</div>
<div class="line">                        a-&gt;encap.vxlan.udp.sp,</div>
<div class="line">                        a-&gt;encap.vxlan.udp.dp,</div>
<div class="line">                        a-&gt;encap.vxlan.vxlan.vni);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">default</span>:</div>
<div class="line">                fprintf(f, <span class="stringliteral">&quot;unknown &quot;</span>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (a-&gt;action_mask &amp; (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a6368c734fa9c1ac9cb591160eb6bf293">RTE_TABLE_ACTION_NAT</a>)) {</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;nat %s &quot;</span>, (a-&gt;nat.ip_version) ? <span class="stringliteral">&quot;ipv4 &quot;</span> : <span class="stringliteral">&quot;ipv6 &quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (a-&gt;nat.ip_version)</div>
<div class="line">                ipv4_addr_show(f, a-&gt;nat.addr.ipv4);</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                ipv6_addr_show(f, a-&gt;nat.addr.ipv6);</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot; %u &quot;</span>, (uint32_t)(a-&gt;nat.port));</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (a-&gt;action_mask &amp; (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a64248fbadf2339ff36eee3c6c7c54ce6">RTE_TABLE_ACTION_TTL</a>))</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;ttl %s &quot;</span>, (a-&gt;ttl.decrement) ? <span class="stringliteral">&quot;dec&quot;</span> : <span class="stringliteral">&quot;keep&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (a-&gt;action_mask &amp; (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a491ff78ac06bce973d261ed4dea04101">RTE_TABLE_ACTION_STATS</a>))</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;stats &quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (a-&gt;action_mask &amp; (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a5ff88316e4574c62086f9f978a89fe5a">RTE_TABLE_ACTION_TIME</a>))</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;time &quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (a-&gt;action_mask &amp; (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a962e3a5154b7a1a3e8648bd129c4b561">RTE_TABLE_ACTION_SYM_CRYPTO</a>))</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;sym_crypto &quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (a-&gt;action_mask &amp; (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a3a25fcdcb69e9946dc6d9f6fc7f6ac72">RTE_TABLE_ACTION_TAG</a>))</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;tag %u &quot;</span>, a-&gt;tag.tag);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (a-&gt;action_mask &amp; (1LLU &lt;&lt; <a class="code" href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a73da4960f9f9b30236eeaaed592c855c">RTE_TABLE_ACTION_DECAP</a>))</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;decap %u &quot;</span>, a-&gt;decap.n);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* end */</span></div>
<div class="line">        fprintf(f, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Write table default rule to file. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (table-&gt;rule_default) {</div>
<div class="line">        <span class="keyword">struct </span>table_rule_action *a = &amp;table-&gt;rule_default-&gt;action;</div>
<div class="line"> </div>
<div class="line">        fprintf(f, <span class="stringliteral">&quot;# match default action fwd &quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">switch</span> (a-&gt;fwd.action) {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572af41296546f2a86d1f8f1848010c7c111">RTE_PIPELINE_ACTION_DROP</a>:</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;drop &quot;</span>);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572ac8c58609785d844989b7d9eb1e6db8aa">RTE_PIPELINE_ACTION_PORT</a>:</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;port %u &quot;</span>, a-&gt;fwd.id);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572a5dc23d641b483615ea475152ac7ab7f4">RTE_PIPELINE_ACTION_PORT_META</a>:</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;meta &quot;</span>);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572abafaf6276afcfcb170a2f7aa44c21048">RTE_PIPELINE_ACTION_TABLE</a>:</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            fprintf(f, <span class="stringliteral">&quot;table %u &quot;</span>, a-&gt;fwd.id);</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span></div>
<div class="line">        fprintf(f, <span class="stringliteral">&quot;# match default action fwd drop &quot;</span>);</div>
<div class="line"> </div>
<div class="line">    fprintf(f, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Close file. */</span></div>
<div class="line">    fclose(f);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_table_rule_show_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; table &lt;table_id&gt; rule show\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;     file &lt;file_name&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_table_rule_show(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *file_name = NULL, *pipeline_name;</div>
<div class="line">    uint32_t table_id;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 8) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;table&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;table_id, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;table_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;rule&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;rule&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;show&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;show&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;file&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;file&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    file_name = tokens[7];</div>
<div class="line"> </div>
<div class="line">    status = table_rule_show(pipeline_name, table_id, file_name);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_table_rule_stats_read_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; table &lt;table_id&gt; rule read stats [clear]\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;     match &lt;match&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_table_rule_stats_read(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>table_rule_match m;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a110"></a><a class="code" href="structrte__table__action__stats__counters.html">rte_table_action_stats_counters</a> stats;</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t table_id, n_tokens_parsed;</div>
<div class="line">    <span class="keywordtype">int</span> clear = 0, status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &lt; 7) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;table&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;table_id, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;table_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;rule&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;rule&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;read&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;read&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;stats&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;stats&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    n_tokens -= 7;</div>
<div class="line">    tokens += 7;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* clear */</span></div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;clear&quot;</span>) == 0)) {</div>
<div class="line">        clear = 1;</div>
<div class="line"> </div>
<div class="line">        n_tokens--;</div>
<div class="line">        tokens++;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* match */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens == 0) || strcmp(tokens[0], <span class="stringliteral">&quot;match&quot;</span>)) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;match&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    n_tokens_parsed = parse_match(tokens,</div>
<div class="line">        n_tokens,</div>
<div class="line">        out,</div>
<div class="line">        out_size,</div>
<div class="line">        &amp;m);</div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens_parsed == 0)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    n_tokens -= n_tokens_parsed;</div>
<div class="line">    tokens += n_tokens_parsed;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* end */</span></div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read table rule stats. */</span></div>
<div class="line">    status = pipeline_table_rule_stats_read(pipeline_name,</div>
<div class="line">        table_id,</div>
<div class="line">        &amp;m,</div>
<div class="line">        &amp;stats,</div>
<div class="line">        clear);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Print stats. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (stats.n_packets_valid &amp;&amp; stats.n_bytes_valid)</div>
<div class="line">        snprintf(out, out_size, <span class="stringliteral">&quot;Packets: %&quot;</span> PRIu64 <span class="stringliteral">&quot;; Bytes: %&quot;</span> PRIu64 <span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line">            stats.n_packets,</div>
<div class="line">            stats.n_bytes);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (stats.n_packets_valid &amp;&amp; !stats.n_bytes_valid)</div>
<div class="line">        snprintf(out, out_size, <span class="stringliteral">&quot;Packets: %&quot;</span> PRIu64 <span class="stringliteral">&quot;; Bytes: N/A\n&quot;</span>,</div>
<div class="line">            stats.n_packets);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!stats.n_packets_valid &amp;&amp; stats.n_bytes_valid)</div>
<div class="line">        snprintf(out, out_size, <span class="stringliteral">&quot;Packets: N/A; Bytes: %&quot;</span> PRIu64 <span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line">            stats.n_bytes);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!stats.n_packets_valid &amp;&amp; !stats.n_bytes_valid)</div>
<div class="line">        snprintf(out, out_size, <span class="stringliteral">&quot;Packets: N/A ; Bytes: N/A\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_table_meter_profile_add_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; table &lt;table_id&gt; meter profile &lt;meter_profile_id&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   add srtcm cir &lt;cir&gt; cbs &lt;cbs&gt; ebs &lt;ebs&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   | trtcm cir &lt;cir&gt; pir &lt;pir&gt; cbs &lt;cbs&gt; pbs &lt;pbs&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_table_meter_profile_add(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a name="_a111"></a><a class="code" href="structrte__table__action__meter__profile.html">rte_table_action_meter_profile</a> p;</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t table_id, meter_profile_id;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &lt; 9) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;port&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;table_id, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;table_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;meter&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;meter&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;profile&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;profile&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;meter_profile_id, tokens[6]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;meter_profile_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[7], <span class="stringliteral">&quot;add&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;add&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[8], <span class="stringliteral">&quot;srtcm&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens != 15) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH,</div>
<div class="line">                tokens[0]);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.alg = <a class="code" href="rte__table__action_8h.html#ae2962eacf079d46d74fc6e2e7ac4d666ab51bd4d8c02db27c18cc31b0e67fb6b7">RTE_TABLE_ACTION_METER_SRTCM</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[9], <span class="stringliteral">&quot;cir&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;cir&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint64(&amp;p.srtcm.cir, tokens[10]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;cir&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[11], <span class="stringliteral">&quot;cbs&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;cbs&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint64(&amp;p.srtcm.cbs, tokens[12]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;cbs&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[13], <span class="stringliteral">&quot;ebs&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;ebs&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint64(&amp;p.srtcm.ebs, tokens[14]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;ebs&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(tokens[8], <span class="stringliteral">&quot;trtcm&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens != 17) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        p.alg = <a class="code" href="rte__table__action_8h.html#ae2962eacf079d46d74fc6e2e7ac4d666aad855c58b7ce34e2da8f1608c800778d">RTE_TABLE_ACTION_METER_TRTCM</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[9], <span class="stringliteral">&quot;cir&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;cir&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint64(&amp;p.trtcm.cir, tokens[10]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;cir&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[11], <span class="stringliteral">&quot;pir&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;pir&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint64(&amp;p.trtcm.pir, tokens[12]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;pir&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[13], <span class="stringliteral">&quot;cbs&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;cbs&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint64(&amp;p.trtcm.cbs, tokens[14]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;cbs&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[15], <span class="stringliteral">&quot;pbs&quot;</span>) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;pbs&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parser_read_uint64(&amp;p.trtcm.pbs, tokens[16]) != 0) {</div>
<div class="line">            snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;pbs&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = pipeline_table_mtr_profile_add(pipeline_name,</div>
<div class="line">        table_id,</div>
<div class="line">        meter_profile_id,</div>
<div class="line">        &amp;p);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_table_meter_profile_delete_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; table &lt;table_id&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   meter profile &lt;meter_profile_id&gt; delete\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_table_meter_profile_delete(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t table_id, meter_profile_id;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 8) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;port&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;table_id, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;table_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;meter&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;meter&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;profile&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;profile&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;meter_profile_id, tokens[6]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;meter_profile_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[7], <span class="stringliteral">&quot;delete&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;delete&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = pipeline_table_mtr_profile_delete(pipeline_name,</div>
<div class="line">        table_id,</div>
<div class="line">        meter_profile_id);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_table_rule_meter_read_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; table &lt;table_id&gt; rule read meter [clear]\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;     match &lt;match&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_table_rule_meter_read(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>table_rule_match m;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a112"></a><a class="code" href="structrte__table__action__mtr__counters.html">rte_table_action_mtr_counters</a> <a name="a113"></a><a class="code" href="structrte__table__action__mtr__counters.html#afb347cc5ec7a582aaf2067d1bcc979af">stats</a>;</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t table_id, n_tokens_parsed;</div>
<div class="line">    <span class="keywordtype">int</span> clear = 0, status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &lt; 7) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;table&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;table_id, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;table_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;rule&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;rule&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;read&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;read&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;meter&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;meter&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    n_tokens -= 7;</div>
<div class="line">    tokens += 7;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* clear */</span></div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;clear&quot;</span>) == 0)) {</div>
<div class="line">        clear = 1;</div>
<div class="line"> </div>
<div class="line">        n_tokens--;</div>
<div class="line">        tokens++;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* match */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens == 0) || strcmp(tokens[0], <span class="stringliteral">&quot;match&quot;</span>)) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;match&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    n_tokens_parsed = parse_match(tokens,</div>
<div class="line">        n_tokens,</div>
<div class="line">        out,</div>
<div class="line">        out_size,</div>
<div class="line">        &amp;m);</div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens_parsed == 0)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    n_tokens -= n_tokens_parsed;</div>
<div class="line">    tokens += n_tokens_parsed;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* end */</span></div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read table rule meter stats. */</span></div>
<div class="line">    status = pipeline_table_rule_mtr_read(pipeline_name,</div>
<div class="line">        table_id,</div>
<div class="line">        &amp;m,</div>
<div class="line">        &amp;<a class="code" href="structrte__table__action__mtr__counters.html#afb347cc5ec7a582aaf2067d1bcc979af">stats</a>,</div>
<div class="line">        clear);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Print stats. */</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_table_dscp_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; table &lt;table_id&gt; dscp &lt;file_name&gt;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot; File &lt;file_name&gt;:\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   - exactly 64 lines\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;   - line format: &lt;tc_id&gt; &lt;tc_queue_id&gt; &lt;color&gt;, with &lt;color&gt; as: g | y | r\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">load_dscp_table(<span class="keyword">struct</span> <a name="_a114"></a><a class="code" href="structrte__table__action__dscp__table.html">rte_table_action_dscp_table</a> *dscp_table,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *file_name,</div>
<div class="line">    uint32_t *line_number)</div>
<div class="line">{</div>
<div class="line">    FILE *f = NULL;</div>
<div class="line">    uint32_t dscp, l;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input arguments */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((dscp_table == NULL) ||</div>
<div class="line">        (file_name == NULL) ||</div>
<div class="line">        (line_number == NULL)) {</div>
<div class="line">        <span class="keywordflow">if</span> (line_number)</div>
<div class="line">            *line_number = 0;</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Open input file */</span></div>
<div class="line">    f = fopen(file_name, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (f == NULL) {</div>
<div class="line">        *line_number = 0;</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read file */</span></div>
<div class="line">    <span class="keywordflow">for</span> (dscp = 0, l = 1; ; l++) {</div>
<div class="line">        <span class="keywordtype">char</span> line[64];</div>
<div class="line">        <span class="keywordtype">char</span> *tokens[3];</div>
<div class="line">        <span class="keyword">enum</span> <a class="code" href="rte__meter_8h.html#a35388a9ecf2eab3020433bd6207b3436">rte_color</a> color;</div>
<div class="line">        uint32_t tc_id, tc_queue_id, n_tokens = <a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(tokens);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (fgets(line, <span class="keyword">sizeof</span>(line), f) == NULL)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (is_comment(line))</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (parse_tokenize_string(line, tokens, &amp;n_tokens)) {</div>
<div class="line">            *line_number = l;</div>
<div class="line">            fclose(f);</div>
<div class="line">            <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((dscp &gt;= <a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(dscp_table-&gt;<a name="a115"></a><a class="code" href="structrte__table__action__dscp__table.html#a21e19754e6f53f0cae27caf235c08cd4">entry</a>)) ||</div>
<div class="line">            (n_tokens != <a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(tokens)) ||</div>
<div class="line">            parser_read_uint32(&amp;tc_id, tokens[0]) ||</div>
<div class="line">            (tc_id &gt;= <a class="code" href="rte__table__action_8h.html#ad90568b948ab3ce824e43fd789de8b9a">RTE_TABLE_ACTION_TC_MAX</a>) ||</div>
<div class="line">            parser_read_uint32(&amp;tc_queue_id, tokens[1]) ||</div>
<div class="line">            (tc_queue_id &gt;= <a name="a116"></a><a class="code" href="rte__table__action_8h.html#a3a530079352603316d95f32c5585d329">RTE_TABLE_ACTION_TC_QUEUE_MAX</a>) ||</div>
<div class="line">            (strlen(tokens[2]) != 1)) {</div>
<div class="line">            *line_number = l;</div>
<div class="line">            fclose(f);</div>
<div class="line">            <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">switch</span> (tokens[2][0]) {</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;g&#39;</span>:</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;G&#39;</span>:</div>
<div class="line">            color = <a class="code" href="rte__meter_8h.html#a35388a9ecf2eab3020433bd6207b3436a43d24f9a4881b17f0d0af3c8358fea05">RTE_COLOR_GREEN</a>;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;y&#39;</span>:</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;Y&#39;</span>:</div>
<div class="line">            color = <a class="code" href="rte__meter_8h.html#a35388a9ecf2eab3020433bd6207b3436a83de16e2e12e9a65d07bca453b899fbe">RTE_COLOR_YELLOW</a>;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;r&#39;</span>:</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>:</div>
<div class="line">            color = <a class="code" href="rte__meter_8h.html#a35388a9ecf2eab3020433bd6207b3436a910409b5938b2e9ad695db4676353e68">RTE_COLOR_RED</a>;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            *line_number = l;</div>
<div class="line">            fclose(f);</div>
<div class="line">            <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        dscp_table-&gt;<a class="code" href="structrte__table__action__dscp__table.html#a21e19754e6f53f0cae27caf235c08cd4">entry</a>[dscp].<a name="a117"></a><a class="code" href="structrte__table__action__dscp__table__entry.html#ad58fbefda003686d57036245718cea8a">tc_id</a> = tc_id;</div>
<div class="line">        dscp_table-&gt;<a class="code" href="structrte__table__action__dscp__table.html#a21e19754e6f53f0cae27caf235c08cd4">entry</a>[dscp].<a name="a118"></a><a class="code" href="structrte__table__action__dscp__table__entry.html#ab6d4ef02ca93e7627791d2f70bd89111">tc_queue_id</a> = tc_queue_id;</div>
<div class="line">        dscp_table-&gt;<a class="code" href="structrte__table__action__dscp__table.html#a21e19754e6f53f0cae27caf235c08cd4">entry</a>[dscp].<a name="a119"></a><a class="code" href="structrte__table__action__dscp__table__entry.html#af49d1ab21b76d88c8f50a0bec4d9a42b">color</a> = color;</div>
<div class="line">        dscp++;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Close file */</span></div>
<div class="line">    fclose(f);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_table_dscp(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__table__action__dscp__table.html">rte_table_action_dscp_table</a> dscp_table;</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name, *file_name;</div>
<div class="line">    uint32_t table_id, line_number;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 6) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;port&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;table_id, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;table_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;dscp&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;dscp&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    file_name = tokens[5];</div>
<div class="line"> </div>
<div class="line">    status = load_dscp_table(&amp;dscp_table, file_name, &amp;line_number);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_FILE_ERR, file_name, line_number);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = pipeline_table_dscp_table_update(pipeline_name,</div>
<div class="line">        table_id,</div>
<div class="line">        UINT64_MAX,</div>
<div class="line">        &amp;dscp_table);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_table_rule_ttl_read_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; table &lt;table_id&gt; rule read ttl [clear]\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;     match &lt;match&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_table_rule_ttl_read(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>table_rule_match m;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a120"></a><a class="code" href="structrte__table__action__ttl__counters.html">rte_table_action_ttl_counters</a> stats;</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t table_id, n_tokens_parsed;</div>
<div class="line">    <span class="keywordtype">int</span> clear = 0, status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &lt; 7) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;table&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;table_id, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;table_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;rule&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;rule&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;read&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;read&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;ttl&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;ttl&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    n_tokens -= 7;</div>
<div class="line">    tokens += 7;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* clear */</span></div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &amp;&amp; (strcmp(tokens[0], <span class="stringliteral">&quot;clear&quot;</span>) == 0)) {</div>
<div class="line">        clear = 1;</div>
<div class="line"> </div>
<div class="line">        n_tokens--;</div>
<div class="line">        tokens++;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* match */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens == 0) || strcmp(tokens[0], <span class="stringliteral">&quot;match&quot;</span>)) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;match&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    n_tokens_parsed = parse_match(tokens,</div>
<div class="line">        n_tokens,</div>
<div class="line">        out,</div>
<div class="line">        out_size,</div>
<div class="line">        &amp;m);</div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens_parsed == 0)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    n_tokens -= n_tokens_parsed;</div>
<div class="line">    tokens += n_tokens_parsed;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* end */</span></div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read table rule TTL stats. */</span></div>
<div class="line">    status = pipeline_table_rule_ttl_read(pipeline_name,</div>
<div class="line">        table_id,</div>
<div class="line">        &amp;m,</div>
<div class="line">        &amp;stats,</div>
<div class="line">        clear);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Print stats. */</span></div>
<div class="line">    snprintf(out, out_size, <span class="stringliteral">&quot;Packets: %&quot;</span> PRIu64 <span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line">        stats.n_packets);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_pipeline_table_rule_time_read_help[] =</div>
<div class="line"><span class="stringliteral">&quot;pipeline &lt;pipeline_name&gt; table &lt;table_id&gt; rule read time\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;     match &lt;match&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_pipeline_table_rule_time_read(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>table_rule_match m;</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint64_t timestamp;</div>
<div class="line">    uint32_t table_id, n_tokens_parsed;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens &lt; 7) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[1];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;table&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;table_id, tokens[3]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;table_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;rule&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;rule&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[5], <span class="stringliteral">&quot;read&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;read&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[6], <span class="stringliteral">&quot;time&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;time&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    n_tokens -= 7;</div>
<div class="line">    tokens += 7;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* match */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens == 0) || strcmp(tokens[0], <span class="stringliteral">&quot;match&quot;</span>)) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;match&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    n_tokens_parsed = parse_match(tokens,</div>
<div class="line">        n_tokens,</div>
<div class="line">        out,</div>
<div class="line">        out_size,</div>
<div class="line">        &amp;m);</div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens_parsed == 0)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    n_tokens -= n_tokens_parsed;</div>
<div class="line">    tokens += n_tokens_parsed;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* end */</span></div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read table rule timestamp. */</span></div>
<div class="line">    status = pipeline_table_rule_time_read(pipeline_name,</div>
<div class="line">        table_id,</div>
<div class="line">        &amp;m,</div>
<div class="line">        &amp;timestamp);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Print stats. */</span></div>
<div class="line">    snprintf(out, out_size, <span class="stringliteral">&quot;Packets: %&quot;</span> PRIu64 <span class="stringliteral">&quot;\n&quot;</span>, timestamp);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_thread_pipeline_enable_help[] =</div>
<div class="line"><span class="stringliteral">&quot;thread &lt;thread_id&gt; pipeline &lt;pipeline_name&gt; enable\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_thread_pipeline_enable(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t thread_id;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 5) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;thread_id, tokens[1]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;thread_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;pipeline&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;pipeline&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[3];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;enable&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;enable&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = thread_pipeline_enable(thread_id, pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL, <span class="stringliteral">&quot;thread pipeline enable&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> cmd_thread_pipeline_disable_help[] =</div>
<div class="line"><span class="stringliteral">&quot;thread &lt;thread_id&gt; pipeline &lt;pipeline_name&gt; disable\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_thread_pipeline_disable(<span class="keywordtype">char</span> **tokens,</div>
<div class="line">    uint32_t n_tokens,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *pipeline_name;</div>
<div class="line">    uint32_t thread_id;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens != 5) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_MISMATCH, tokens[0]);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parser_read_uint32(&amp;thread_id, tokens[1]) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_INVALID, <span class="stringliteral">&quot;thread_id&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;pipeline&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;pipeline&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pipeline_name = tokens[3];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[4], <span class="stringliteral">&quot;disable&quot;</span>) != 0) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_NOT_FOUND, <span class="stringliteral">&quot;disable&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    status = thread_pipeline_disable(thread_id, pipeline_name);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_CMD_FAIL,</div>
<div class="line">            <span class="stringliteral">&quot;thread pipeline disable&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_help(<span class="keywordtype">char</span> **tokens, uint32_t n_tokens, <span class="keywordtype">char</span> *out, <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    tokens++;</div>
<div class="line">    n_tokens--;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens == 0) {</div>
<div class="line">        snprintf(out, out_size,</div>
<div class="line">            <span class="stringliteral">&quot;Type &#39;help &lt;command&gt;&#39; for details on each command.\n\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;List of commands:\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tmempool\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tlink\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tswq\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\ttmgr subport profile\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\ttmgr pipe profile\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\ttmgr\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\ttmgr subport\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\ttmgr subport pipe\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\ttap\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tkni\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tport in action profile\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\ttable action profile\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline port in\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline port out\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline table\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline port in table\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline port in stats\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline port in enable\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline port in disable\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline port out stats\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline table stats\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline table rule add\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline table rule add default\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline table rule add bulk\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline table rule delete\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline table rule delete default\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline table rule show\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline table rule stats read\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline table meter profile add\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline table meter profile delete\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline table rule meter read\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline table dscp\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline table rule ttl read\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tpipeline table rule time read\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tthread pipeline enable\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\tthread pipeline disable\n\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;mempool&quot;</span>) == 0) {</div>
<div class="line">        snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>, cmd_mempool_help);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;link&quot;</span>) == 0) {</div>
<div class="line">        snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>, cmd_link_help);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;swq&quot;</span>) == 0) {</div>
<div class="line">        snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>, cmd_swq_help);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;tmgr&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens == 1) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>, cmd_tmgr_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 2) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[1], <span class="stringliteral">&quot;subport&quot;</span>)) == 0) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>, cmd_tmgr_subport_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 3) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[1], <span class="stringliteral">&quot;subport&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;profile&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_tmgr_subport_profile_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 3) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[1], <span class="stringliteral">&quot;subport&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;pipe&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>, cmd_tmgr_subport_pipe_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 3) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[1], <span class="stringliteral">&quot;pipe&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;profile&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>, cmd_tmgr_pipe_profile_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;tap&quot;</span>) == 0) {</div>
<div class="line">        snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>, cmd_tap_help);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;kni&quot;</span>) == 0) {</div>
<div class="line">        snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>, cmd_kni_help);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;cryptodev&quot;</span>) == 0) {</div>
<div class="line">        snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>, cmd_cryptodev_help);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens == 4) &amp;&amp;</div>
<div class="line">        (strcmp(tokens[0], <span class="stringliteral">&quot;port&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">        (strcmp(tokens[1], <span class="stringliteral">&quot;in&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">        (strcmp(tokens[2], <span class="stringliteral">&quot;action&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">        (strcmp(tokens[3], <span class="stringliteral">&quot;profile&quot;</span>) == 0)) {</div>
<div class="line">        snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>, cmd_port_in_action_profile_help);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens == 3) &amp;&amp;</div>
<div class="line">        (strcmp(tokens[0], <span class="stringliteral">&quot;table&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">        (strcmp(tokens[1], <span class="stringliteral">&quot;action&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">        (strcmp(tokens[2], <span class="stringliteral">&quot;profile&quot;</span>) == 0)) {</div>
<div class="line">        snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>, cmd_table_action_profile_help);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((strcmp(tokens[0], <span class="stringliteral">&quot;pipeline&quot;</span>) == 0) &amp;&amp; (n_tokens == 1)) {</div>
<div class="line">        snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>, cmd_pipeline_help);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((strcmp(tokens[0], <span class="stringliteral">&quot;pipeline&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">        (strcmp(tokens[1], <span class="stringliteral">&quot;port&quot;</span>) == 0)) {</div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 3) &amp;&amp; (strcmp(tokens[2], <span class="stringliteral">&quot;in&quot;</span>)) == 0) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>, cmd_pipeline_port_in_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 3) &amp;&amp; (strcmp(tokens[2], <span class="stringliteral">&quot;out&quot;</span>)) == 0) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>, cmd_pipeline_port_out_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 4) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;in&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;table&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_port_in_table_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 4) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;in&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;stats&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_port_in_stats_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 4) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;in&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;enable&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_port_in_enable_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 4) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;in&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;disable&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_port_in_disable_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 4) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;out&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;stats&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_port_out_stats_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((strcmp(tokens[0], <span class="stringliteral">&quot;pipeline&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">        (strcmp(tokens[1], <span class="stringliteral">&quot;table&quot;</span>) == 0)) {</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens == 2) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>, cmd_pipeline_table_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 3) &amp;&amp; strcmp(tokens[2], <span class="stringliteral">&quot;stats&quot;</span>) == 0) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_table_stats_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 3) &amp;&amp; strcmp(tokens[2], <span class="stringliteral">&quot;dscp&quot;</span>) == 0) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_table_dscp_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 4) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;rule&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;add&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_table_rule_add_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 5) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;rule&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;add&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;default&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_table_rule_add_default_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 5) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;rule&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;add&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;bulk&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_table_rule_add_bulk_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 4) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;rule&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;delete&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_table_rule_delete_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 5) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;rule&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;delete&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;default&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_table_rule_delete_default_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 4) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;rule&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;show&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_table_rule_show_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 5) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;rule&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;stats&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;read&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_table_rule_stats_read_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 5) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;meter&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;profile&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;add&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_table_meter_profile_add_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 5) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;meter&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;profile&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;delete&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_table_meter_profile_delete_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 5) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;rule&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;meter&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;read&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_table_rule_meter_read_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 5) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;rule&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;ttl&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;read&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_table_rule_ttl_read_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens == 5) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;rule&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;time&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;read&quot;</span>) == 0)) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_pipeline_table_rule_time_read_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((n_tokens == 3) &amp;&amp;</div>
<div class="line">        (strcmp(tokens[0], <span class="stringliteral">&quot;thread&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">        (strcmp(tokens[1], <span class="stringliteral">&quot;pipeline&quot;</span>) == 0)) {</div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;enable&quot;</span>) == 0) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_thread_pipeline_enable_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[2], <span class="stringliteral">&quot;disable&quot;</span>) == 0) {</div>
<div class="line">            snprintf(out, out_size, <span class="stringliteral">&quot;\n%s\n&quot;</span>,</div>
<div class="line">                cmd_thread_pipeline_disable_help);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    snprintf(out, out_size, <span class="stringliteral">&quot;Invalid command\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">cli_process(<span class="keywordtype">char</span> *in, <span class="keywordtype">char</span> *out, <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *tokens[CMD_MAX_TOKENS];</div>
<div class="line">    uint32_t n_tokens = <a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(tokens);</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (is_comment(in))</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    status = parse_tokenize_string(in, tokens, &amp;n_tokens);</div>
<div class="line">    <span class="keywordflow">if</span> (status) {</div>
<div class="line">        snprintf(out, out_size, MSG_ARG_TOO_MANY, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_tokens == 0)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;help&quot;</span>) == 0) {</div>
<div class="line">        cmd_help(tokens, n_tokens, out, out_size);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;mempool&quot;</span>) == 0) {</div>
<div class="line">        cmd_mempool(tokens, n_tokens, out, out_size);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;link&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(tokens[1], <span class="stringliteral">&quot;show&quot;</span>) == 0) {</div>
<div class="line">            cmd_link_show(tokens, n_tokens, out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        cmd_link(tokens, n_tokens, out, out_size);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;swq&quot;</span>) == 0) {</div>
<div class="line">        cmd_swq(tokens, n_tokens, out, out_size);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;tmgr&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 3) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[1], <span class="stringliteral">&quot;subport&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;profile&quot;</span>) == 0)) {</div>
<div class="line">            cmd_tmgr_subport_profile(tokens, n_tokens,</div>
<div class="line">                out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 3) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[1], <span class="stringliteral">&quot;pipe&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;profile&quot;</span>) == 0)) {</div>
<div class="line">            cmd_tmgr_pipe_profile(tokens, n_tokens, out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 5) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;subport&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;profile&quot;</span>) == 0)) {</div>
<div class="line">            cmd_tmgr_subport(tokens, n_tokens, out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 5) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;subport&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;pipe&quot;</span>) == 0)) {</div>
<div class="line">            cmd_tmgr_subport_pipe(tokens, n_tokens, out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        cmd_tmgr(tokens, n_tokens, out, out_size);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;tap&quot;</span>) == 0) {</div>
<div class="line">        cmd_tap(tokens, n_tokens, out, out_size);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;kni&quot;</span>) == 0) {</div>
<div class="line">        cmd_kni(tokens, n_tokens, out, out_size);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;cryptodev&quot;</span>) == 0) {</div>
<div class="line">        cmd_cryptodev(tokens, n_tokens, out, out_size);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;port&quot;</span>) == 0) {</div>
<div class="line">        cmd_port_in_action_profile(tokens, n_tokens, out, out_size);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;table&quot;</span>) == 0) {</div>
<div class="line">        cmd_table_action_profile(tokens, n_tokens, out, out_size);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;pipeline&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 3) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;period&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline(tokens, n_tokens, out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 5) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;port&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;in&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;bsz&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline_port_in(tokens, n_tokens, out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 5) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;port&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;out&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;bsz&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline_port_out(tokens, n_tokens, out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 4) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;match&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline_table(tokens, n_tokens, out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 6) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;port&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;in&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[5], <span class="stringliteral">&quot;table&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline_port_in_table(tokens, n_tokens,</div>
<div class="line">                out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 6) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;port&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;in&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[5], <span class="stringliteral">&quot;stats&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline_port_in_stats(tokens, n_tokens,</div>
<div class="line">                out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 6) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;port&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;in&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[5], <span class="stringliteral">&quot;enable&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline_port_in_enable(tokens, n_tokens,</div>
<div class="line">                out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 6) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;port&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;in&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[5], <span class="stringliteral">&quot;disable&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline_port_in_disable(tokens, n_tokens,</div>
<div class="line">                out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 6) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;port&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[3], <span class="stringliteral">&quot;out&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[5], <span class="stringliteral">&quot;stats&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline_port_out_stats(tokens, n_tokens,</div>
<div class="line">                out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 5) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;stats&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline_table_stats(tokens, n_tokens,</div>
<div class="line">                out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 7) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;rule&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[5], <span class="stringliteral">&quot;add&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[6], <span class="stringliteral">&quot;match&quot;</span>) == 0)) {</div>
<div class="line">            <span class="keywordflow">if</span> ((n_tokens &gt;= 8) &amp;&amp;</div>
<div class="line">                (strcmp(tokens[7], <span class="stringliteral">&quot;default&quot;</span>) == 0)) {</div>
<div class="line">                cmd_pipeline_table_rule_add_default(tokens,</div>
<div class="line">                    n_tokens, out, out_size);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            cmd_pipeline_table_rule_add(tokens, n_tokens,</div>
<div class="line">                out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 7) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;rule&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[5], <span class="stringliteral">&quot;add&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[6], <span class="stringliteral">&quot;bulk&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline_table_rule_add_bulk(tokens,</div>
<div class="line">                n_tokens, out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 7) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;rule&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[5], <span class="stringliteral">&quot;delete&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[6], <span class="stringliteral">&quot;match&quot;</span>) == 0)) {</div>
<div class="line">            <span class="keywordflow">if</span> ((n_tokens &gt;= 8) &amp;&amp;</div>
<div class="line">                (strcmp(tokens[7], <span class="stringliteral">&quot;default&quot;</span>) == 0)) {</div>
<div class="line">                cmd_pipeline_table_rule_delete_default(tokens,</div>
<div class="line">                    n_tokens, out, out_size);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">            cmd_pipeline_table_rule_delete(tokens, n_tokens,</div>
<div class="line">                out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 6) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;rule&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[5], <span class="stringliteral">&quot;show&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline_table_rule_show(tokens, n_tokens,</div>
<div class="line">                out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 7) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;rule&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[5], <span class="stringliteral">&quot;read&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[6], <span class="stringliteral">&quot;stats&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline_table_rule_stats_read(tokens, n_tokens,</div>
<div class="line">                out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 8) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;meter&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[5], <span class="stringliteral">&quot;profile&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[7], <span class="stringliteral">&quot;add&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline_table_meter_profile_add(tokens, n_tokens,</div>
<div class="line">                out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 8) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;meter&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[5], <span class="stringliteral">&quot;profile&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[7], <span class="stringliteral">&quot;delete&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline_table_meter_profile_delete(tokens,</div>
<div class="line">                n_tokens, out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 7) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;rule&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[5], <span class="stringliteral">&quot;read&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[6], <span class="stringliteral">&quot;meter&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline_table_rule_meter_read(tokens, n_tokens,</div>
<div class="line">                out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 5) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;dscp&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline_table_dscp(tokens, n_tokens,</div>
<div class="line">                out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 7) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;rule&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[5], <span class="stringliteral">&quot;read&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[6], <span class="stringliteral">&quot;ttl&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline_table_rule_ttl_read(tokens, n_tokens,</div>
<div class="line">                out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 7) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[2], <span class="stringliteral">&quot;table&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;rule&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[5], <span class="stringliteral">&quot;read&quot;</span>) == 0) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[6], <span class="stringliteral">&quot;time&quot;</span>) == 0)) {</div>
<div class="line">            cmd_pipeline_table_rule_time_read(tokens, n_tokens,</div>
<div class="line">                out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(tokens[0], <span class="stringliteral">&quot;thread&quot;</span>) == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 5) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;enable&quot;</span>) == 0)) {</div>
<div class="line">            cmd_thread_pipeline_enable(tokens, n_tokens,</div>
<div class="line">                out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((n_tokens &gt;= 5) &amp;&amp;</div>
<div class="line">            (strcmp(tokens[4], <span class="stringliteral">&quot;disable&quot;</span>) == 0)) {</div>
<div class="line">            cmd_thread_pipeline_disable(tokens, n_tokens,</div>
<div class="line">                out, out_size);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    snprintf(out, out_size, MSG_CMD_UNKNOWN, tokens[0]);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">cli_script_process(<span class="keyword">const</span> <span class="keywordtype">char</span> *file_name,</div>
<div class="line">    <span class="keywordtype">size_t</span> msg_in_len_max,</div>
<div class="line">    <span class="keywordtype">size_t</span> msg_out_len_max)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *msg_in = NULL, *msg_out = NULL;</div>
<div class="line">    FILE *f = NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input arguments */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((file_name == NULL) ||</div>
<div class="line">        (strlen(file_name) == 0) ||</div>
<div class="line">        (msg_in_len_max == 0) ||</div>
<div class="line">        (msg_out_len_max == 0))</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"> </div>
<div class="line">    msg_in = malloc(msg_in_len_max + 1);</div>
<div class="line">    msg_out = malloc(msg_out_len_max + 1);</div>
<div class="line">    <span class="keywordflow">if</span> ((msg_in == NULL) ||</div>
<div class="line">        (msg_out == NULL)) {</div>
<div class="line">        free(msg_out);</div>
<div class="line">        free(msg_in);</div>
<div class="line">        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Open input file */</span></div>
<div class="line">    f = fopen(file_name, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (f == NULL) {</div>
<div class="line">        free(msg_out);</div>
<div class="line">        free(msg_in);</div>
<div class="line">        <span class="keywordflow">return</span> -EIO;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read file */</span></div>
<div class="line">    <span class="keywordflow">for</span> ( ; ; ) {</div>
<div class="line">        <span class="keywordflow">if</span> (fgets(msg_in, msg_in_len_max + 1, f) == NULL)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        printf(<span class="stringliteral">&quot;%s&quot;</span>, msg_in);</div>
<div class="line">        msg_out[0] = 0;</div>
<div class="line"> </div>
<div class="line">        cli_process(msg_in,</div>
<div class="line">            msg_out,</div>
<div class="line">            msg_out_len_max);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strlen(msg_out))</div>
<div class="line">            printf(<span class="stringliteral">&quot;%s&quot;</span>, msg_out);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Close file */</span></div>
<div class="line">    fclose(f);</div>
<div class="line">    free(msg_out);</div>
<div class="line">    free(msg_in);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">cli_rule_file_process(<span class="keyword">const</span> <span class="keywordtype">char</span> *file_name,</div>
<div class="line">    <span class="keywordtype">size_t</span> line_len_max,</div>
<div class="line">    <span class="keyword">struct</span> table_rule_list **rule_list,</div>
<div class="line">    uint32_t *n_rules,</div>
<div class="line">    uint32_t *line_number,</div>
<div class="line">    <span class="keywordtype">char</span> *out,</div>
<div class="line">    <span class="keywordtype">size_t</span> out_size)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>table_rule_list *list = NULL;</div>
<div class="line">    <span class="keywordtype">char</span> *line = NULL;</div>
<div class="line">    FILE *f = NULL;</div>
<div class="line">    uint32_t rule_id = 0, line_id = 0;</div>
<div class="line">    <span class="keywordtype">int</span> status = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check input arguments */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((file_name == NULL) ||</div>
<div class="line">        (strlen(file_name) == 0) ||</div>
<div class="line">        (line_len_max == 0) ||</div>
<div class="line">        (rule_list == NULL) ||</div>
<div class="line">        (n_rules == NULL) ||</div>
<div class="line">        (line_number == NULL) ||</div>
<div class="line">        (out == NULL)) {</div>
<div class="line">        status = -EINVAL;</div>
<div class="line">        <span class="keywordflow">goto</span> cli_rule_file_process_free;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Memory allocation */</span></div>
<div class="line">    list = malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> table_rule_list));</div>
<div class="line">    <span class="keywordflow">if</span> (list == NULL) {</div>
<div class="line">        status = -ENOMEM;</div>
<div class="line">        <span class="keywordflow">goto</span> cli_rule_file_process_free;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    TAILQ_INIT(list);</div>
<div class="line"> </div>
<div class="line">    line = malloc(line_len_max + 1);</div>
<div class="line">    <span class="keywordflow">if</span> (line == NULL) {</div>
<div class="line">        status = -ENOMEM;</div>
<div class="line">        <span class="keywordflow">goto</span> cli_rule_file_process_free;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Open file */</span></div>
<div class="line">    f = fopen(file_name, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (f == NULL) {</div>
<div class="line">        status = -EIO;</div>
<div class="line">        <span class="keywordflow">goto</span> cli_rule_file_process_free;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Read file */</span></div>
<div class="line">    <span class="keywordflow">for</span> (line_id = 1, rule_id = 0; ; line_id++) {</div>
<div class="line">        <span class="keywordtype">char</span> *tokens[CMD_MAX_TOKENS];</div>
<div class="line">        <span class="keyword">struct </span>table_rule *rule = NULL;</div>
<div class="line">        uint32_t n_tokens, n_tokens_parsed, t0;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Read next line from file. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (fgets(line, line_len_max + 1, f) == NULL)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Comment. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (is_comment(line))</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Parse line. */</span></div>
<div class="line">        n_tokens = <a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(tokens);</div>
<div class="line">        status = parse_tokenize_string(line, tokens, &amp;n_tokens);</div>
<div class="line">        <span class="keywordflow">if</span> (status) {</div>
<div class="line">            status = -EINVAL;</div>
<div class="line">            <span class="keywordflow">goto</span> cli_rule_file_process_free;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Empty line. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens == 0)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        t0 = 0;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Rule alloc and insert. */</span></div>
<div class="line">        rule = calloc(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> table_rule));</div>
<div class="line">        <span class="keywordflow">if</span> (rule == NULL) {</div>
<div class="line">            status = -ENOMEM;</div>
<div class="line">            <span class="keywordflow">goto</span> cli_rule_file_process_free;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        TAILQ_INSERT_TAIL(list, rule, node);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Rule match. */</span></div>
<div class="line">        n_tokens_parsed = parse_match(tokens + t0,</div>
<div class="line">            n_tokens - t0,</div>
<div class="line">            out,</div>
<div class="line">            out_size,</div>
<div class="line">            &amp;rule-&gt;match);</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens_parsed == 0) {</div>
<div class="line">            status = -EINVAL;</div>
<div class="line">            <span class="keywordflow">goto</span> cli_rule_file_process_free;</div>
<div class="line">        }</div>
<div class="line">        t0 += n_tokens_parsed;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Rule action. */</span></div>
<div class="line">        n_tokens_parsed = parse_table_action(tokens + t0,</div>
<div class="line">            n_tokens - t0,</div>
<div class="line">            out,</div>
<div class="line">            out_size,</div>
<div class="line">            &amp;rule-&gt;action);</div>
<div class="line">        <span class="keywordflow">if</span> (n_tokens_parsed == 0) {</div>
<div class="line">            status = -EINVAL;</div>
<div class="line">            <span class="keywordflow">goto</span> cli_rule_file_process_free;</div>
<div class="line">        }</div>
<div class="line">        t0 += n_tokens_parsed;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Line completed. */</span></div>
<div class="line">        <span class="keywordflow">if</span> (t0 &lt; n_tokens) {</div>
<div class="line">            status = -EINVAL;</div>
<div class="line">            <span class="keywordflow">goto</span> cli_rule_file_process_free;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Increment rule count */</span></div>
<div class="line">        rule_id++;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Close file */</span></div>
<div class="line">    fclose(f);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Memory free */</span></div>
<div class="line">    free(line);</div>
<div class="line"> </div>
<div class="line">    *rule_list = list;</div>
<div class="line">    *n_rules = rule_id;</div>
<div class="line">    *line_number = line_id;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">cli_rule_file_process_free:</div>
<div class="line">    <span class="keywordflow">if</span> (rule_list != NULL)</div>
<div class="line">        *rule_list = NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (n_rules != NULL)</div>
<div class="line">        *n_rules = rule_id;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (line_number != NULL)</div>
<div class="line">        *line_number = line_id;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (list != NULL)</div>
<div class="line">        <span class="keywordflow">for</span> ( ; ; ) {</div>
<div class="line">            <span class="keyword">struct </span>table_rule *rule;</div>
<div class="line"> </div>
<div class="line">            rule = TAILQ_FIRST(list);</div>
<div class="line">            <span class="keywordflow">if</span> (rule == NULL)</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">            TAILQ_REMOVE(list, rule, node);</div>
<div class="line">            free(rule);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (f)</div>
<div class="line">        fclose(f);</div>
<div class="line">    free(line);</div>
<div class="line">    free(list);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="arte__table__action_8h_html_ac3fd327e32beaa5080a6e42040e4629ca5ff940244e800cde375a6f7dbd743c80"><div class="ttname"><a href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629ca5ff940244e800cde375a6f7dbd743c80">RTE_TABLE_ACTION_ENCAP_MPLS</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_ENCAP_MPLS</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00374">rte_table_action.h:374</a></div></div>
<div class="ttc" id="arte__pipeline_8h_html_a6376b240935404d998f003d113651572ac8c58609785d844989b7d9eb1e6db8aa"><div class="ttname"><a href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572ac8c58609785d844989b7d9eb1e6db8aa">RTE_PIPELINE_ACTION_PORT</a></div><div class="ttdeci">@ RTE_PIPELINE_ACTION_PORT</div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00186">rte_pipeline.h:186</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_ac3fd327e32beaa5080a6e42040e4629caa4687757afebb0174bc1ab65a517dfbf"><div class="ttname"><a href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629caa4687757afebb0174bc1ab65a517dfbf">RTE_TABLE_ACTION_ENCAP_VXLAN</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_ENCAP_VXLAN</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00382">rte_table_action.h:382</a></div></div>
<div class="ttc" id="astructrte__pipeline__port__out__stats_html_a7d127ce0e2d9594ebb38cc5441e60174"><div class="ttname"><a href="structrte__pipeline__port__out__stats.html#a7d127ce0e2d9594ebb38cc5441e60174">rte_pipeline_port_out_stats::stats</a></div><div class="ttdeci">struct rte_port_out_stats stats</div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00093">rte_pipeline.h:100</a></div></div>
<div class="ttc" id="astructrte__crypto__sym__xform_html_a3f971d41f5862b2967c0598d5e78e1a6"><div class="ttname"><a href="structrte__crypto__sym__xform.html#a3f971d41f5862b2967c0598d5e78e1a6">rte_crypto_sym_xform::auth</a></div><div class="ttdeci">struct rte_crypto_auth_xform auth</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00548">rte_crypto_sym.h:550</a></div></div>
<div class="ttc" id="arte__sched_8h_html_ad30bb3bc9bb7531556d7866882135642"><div class="ttname"><a href="rte__sched_8h.html#ad30bb3bc9bb7531556d7866882135642">RTE_SCHED_BE_QUEUES_PER_PIPE</a></div><div class="ttdeci">#define RTE_SCHED_BE_QUEUES_PER_PIPE</div><div class="ttdef"><b>Definition:</b> <a href="rte__sched_8h_source.html#l00083">rte_sched.h:83</a></div></div>
<div class="ttc" id="arte__meter_8h_html_a35388a9ecf2eab3020433bd6207b3436a83de16e2e12e9a65d07bca453b899fbe"><div class="ttname"><a href="rte__meter_8h.html#a35388a9ecf2eab3020433bd6207b3436a83de16e2e12e9a65d07bca453b899fbe">RTE_COLOR_YELLOW</a></div><div class="ttdeci">@ RTE_COLOR_YELLOW</div><div class="ttdef"><b>Definition:</b> <a href="rte__meter_8h_source.html#l00038">rte_meter.h:38</a></div></div>
<div class="ttc" id="astructrte__table__action__dscp__table_html"><div class="ttname"><a href="structrte__table__action__dscp__table.html">rte_table_action_dscp_table</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00209">rte_table_action.h:209</a></div></div>
<div class="ttc" id="astructrte__crypto__cipher__xform_html_ab8e313535343ba1b7b75ad16589de6c9"><div class="ttname"><a href="structrte__crypto__cipher__xform.html#ab8e313535343ba1b7b75ad16589de6c9">rte_crypto_cipher_xform::op</a></div><div class="ttdeci">enum rte_crypto_cipher_operation op</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00103">rte_crypto_sym.h:190</a></div></div>
<div class="ttc" id="arte__pipeline_8h_html_a6376b240935404d998f003d113651572abafaf6276afcfcb170a2f7aa44c21048"><div class="ttname"><a href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572abafaf6276afcfcb170a2f7aa44c21048">RTE_PIPELINE_ACTION_TABLE</a></div><div class="ttdeci">@ RTE_PIPELINE_ACTION_TABLE</div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00192">rte_pipeline.h:192</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_a6a4e67d5a60f87389cd9f56787d2d176a06918153b593ada41b4685b285d7b80e"><div class="ttname"><a href="rte__table__action_8h.html#a6a4e67d5a60f87389cd9f56787d2d176a06918153b593ada41b4685b285d7b80e">RTE_TABLE_ACTION_POLICER_COLOR_RED</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_POLICER_COLOR_RED</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00247">rte_table_action.h:247</a></div></div>
<div class="ttc" id="arte__byteorder_8h_html_a6ec4cb000fc67785792d18728cf45563"><div class="ttname"><a href="rte__byteorder_8h.html#a6ec4cb000fc67785792d18728cf45563">rte_cpu_to_be_16</a></div><div class="ttdeci">static rte_be16_t rte_cpu_to_be_16(uint16_t x)</div></div>
<div class="ttc" id="arte__port__in__action_8h_html_aee01bd1fd2e3c3a1e65c6493ff7038a0"><div class="ttname"><a href="rte__port__in__action_8h.html#aee01bd1fd2e3c3a1e65c6493ff7038a0">RTE_PORT_IN_ACTION_LB_KEY_SIZE_MAX</a></div><div class="ttdeci">#define RTE_PORT_IN_ACTION_LB_KEY_SIZE_MAX</div><div class="ttdef"><b>Definition:</b> <a href="rte__port__in__action_8h_source.html#l00116">rte_port_in_action.h:116</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2af4f7ba5c7d7eefc2fde9341b8724c11b"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2af4f7ba5c7d7eefc2fde9341b8724c11b">RTE_TABLE_ACTION_LB</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_LB</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00074">rte_table_action.h:74</a></div></div>
<div class="ttc" id="astructrte__table__action__mpls__hdr_html_a4d402503271315376ddf4e47674d4965"><div class="ttname"><a href="structrte__table__action__mpls__hdr.html#a4d402503271315376ddf4e47674d4965">rte_table_action_mpls_hdr::ttl</a></div><div class="ttdeci">uint8_t ttl</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00405">rte_table_action.h:405</a></div></div>
<div class="ttc" id="astructrte__table__action__mpls__hdr_html_a9ce12edf40436c627879a2e93124f4c6"><div class="ttname"><a href="structrte__table__action__mpls__hdr.html#a9ce12edf40436c627879a2e93124f4c6">rte_table_action_mpls_hdr::label</a></div><div class="ttdeci">uint32_t label</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00403">rte_table_action.h:403</a></div></div>
<div class="ttc" id="astructrte__table__action__stats__counters_html"><div class="ttname"><a href="structrte__table__action__stats__counters.html">rte_table_action_stats_counters</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00685">rte_table_action.h:685</a></div></div>
<div class="ttc" id="astructrte__crypto__cipher__xform_html_a320b4b9a8f44fe20dcf27b2914a83145"><div class="ttname"><a href="structrte__crypto__cipher__xform.html#a320b4b9a8f44fe20dcf27b2914a83145">rte_crypto_cipher_xform::key</a></div><div class="ttdeci">struct rte_crypto_cipher_xform::@112 key</div></div>
<div class="ttc" id="arte__table__action_8h_html_a3a530079352603316d95f32c5585d329"><div class="ttname"><a href="rte__table__action_8h.html#a3a530079352603316d95f32c5585d329">RTE_TABLE_ACTION_TC_QUEUE_MAX</a></div><div class="ttdeci">#define RTE_TABLE_ACTION_TC_QUEUE_MAX</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00187">rte_table_action.h:187</a></div></div>
<div class="ttc" id="arte__port__in__action_8h_html_ac5d93af8e87d41bfefed6ed260fb380ea0b6b2ba5a14252bfef2f1cf9c804b311"><div class="ttname"><a href="rte__port__in__action_8h.html#ac5d93af8e87d41bfefed6ed260fb380ea0b6b2ba5a14252bfef2f1cf9c804b311">RTE_PORT_IN_ACTION_LB</a></div><div class="ttdeci">@ RTE_PORT_IN_ACTION_LB</div><div class="ttdef"><b>Definition:</b> <a href="rte__port__in__action_8h_source.html#l00066">rte_port_in_action.h:66</a></div></div>
<div class="ttc" id="astructrte__table__action__sym__crypto__params_html_a0e322da8c7e3d2d6292089c0432f885d"><div class="ttname"><a href="structrte__table__action__sym__crypto__params.html#a0e322da8c7e3d2d6292089c0432f885d">rte_table_action_sym_crypto_params::data_offset</a></div><div class="ttdeci">uint32_t data_offset</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00760">rte_table_action.h:760</a></div></div>
<div class="ttc" id="astructrte__crypto__auth__xform_html_a1892eba2086d12ac2b09005aeb09ea3b"><div class="ttname"><a href="structrte__crypto__auth__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">rte_crypto_auth_xform::length</a></div><div class="ttdeci">uint16_t length</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00375">rte_crypto_sym.h:375</a></div></div>
<div class="ttc" id="astructrte__table__action__dscp__table_html_a21e19754e6f53f0cae27caf235c08cd4"><div class="ttname"><a href="structrte__table__action__dscp__table.html#a21e19754e6f53f0cae27caf235c08cd4">rte_table_action_dscp_table::entry</a></div><div class="ttdeci">struct rte_table_action_dscp_table_entry entry[64]</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00200">rte_table_action.h:211</a></div></div>
<div class="ttc" id="astructrte__crypto__cipher__xform_html_a23947db20adeb0a2e186dc618f645e44"><div class="ttname"><a href="structrte__crypto__cipher__xform.html#a23947db20adeb0a2e186dc618f645e44">rte_crypto_cipher_xform::algo</a></div><div class="ttdeci">enum rte_crypto_cipher_algorithm algo</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00103">rte_crypto_sym.h:195</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_ac3fd327e32beaa5080a6e42040e4629cad02d848b8cb391c8e855f16b4fef1091"><div class="ttname"><a href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629cad02d848b8cb391c8e855f16b4fef1091">RTE_TABLE_ACTION_ENCAP_PPPOE</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_ENCAP_PPPOE</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00377">rte_table_action.h:377</a></div></div>
<div class="ttc" id="arte__errno_8h_html_a129a7eb4cfa1f5bdac5783bf49137d06"><div class="ttname"><a href="rte__errno_8h.html#a129a7eb4cfa1f5bdac5783bf49137d06">rte_strerror</a></div><div class="ttdeci">const char * rte_strerror(int errnum)</div></div>
<div class="ttc" id="astructrte__crypto__cipher__xform_html_a579f5164b5b16e18ddcdb0296ef81799"><div class="ttname"><a href="structrte__crypto__cipher__xform.html#a579f5164b5b16e18ddcdb0296ef81799">rte_crypto_cipher_xform::data</a></div><div class="ttdeci">const uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00199">rte_crypto_sym.h:199</a></div></div>
<div class="ttc" id="astructrte__eth__link_html"><div class="ttname"><a href="structrte__eth__link.html">rte_eth_link</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00313">rte_ethdev.h:313</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_a6a4e67d5a60f87389cd9f56787d2d176"><div class="ttname"><a href="rte__table__action_8h.html#a6a4e67d5a60f87389cd9f56787d2d176">rte_table_action_policer</a></div><div class="ttdeci">rte_table_action_policer</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00239">rte_table_action.h:239</a></div></div>
<div class="ttc" id="astructrte__table__action__sym__crypto__params_html_ac8e4b59a436a743849b7116e8a3d135c"><div class="ttname"><a href="structrte__table__action__sym__crypto__params.html#ac8e4b59a436a743849b7116e8a3d135c">rte_table_action_sym_crypto_params::xform</a></div><div class="ttdeci">struct rte_crypto_sym_xform * xform</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00753">rte_table_action.h:753</a></div></div>
<div class="ttc" id="astructrte__table__action__dscp__table__entry_html_ab6d4ef02ca93e7627791d2f70bd89111"><div class="ttname"><a href="structrte__table__action__dscp__table__entry.html#ab6d4ef02ca93e7627791d2f70bd89111">rte_table_action_dscp_table_entry::tc_queue_id</a></div><div class="ttdeci">uint32_t tc_queue_id</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00200">rte_table_action.h:200</a></div></div>
<div class="ttc" id="arte__pipeline_8h_html_a6376b240935404d998f003d113651572af41296546f2a86d1f8f1848010c7c111"><div class="ttname"><a href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572af41296546f2a86d1f8f1848010c7c111">RTE_PIPELINE_ACTION_DROP</a></div><div class="ttdeci">@ RTE_PIPELINE_ACTION_DROP</div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00183">rte_pipeline.h:183</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2a73da4960f9f9b30236eeaaed592c855c"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a73da4960f9f9b30236eeaaed592c855c">RTE_TABLE_ACTION_DECAP</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_DECAP</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00104">rte_table_action.h:104</a></div></div>
<div class="ttc" id="arte__meter_8h_html_a35388a9ecf2eab3020433bd6207b3436"><div class="ttname"><a href="rte__meter_8h.html#a35388a9ecf2eab3020433bd6207b3436">rte_color</a></div><div class="ttdeci">rte_color</div><div class="ttdef"><b>Definition:</b> <a href="rte__meter_8h_source.html#l00036">rte_meter.h:36</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_aa21ba0affdc8a7a267c879fb5599a57ea80f5756a76a8c903cc56a3b475576e2c"><div class="ttname"><a href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57ea80f5756a76a8c903cc56a3b475576e2c">RTE_CRYPTO_AEAD_OP_ENCRYPT</a></div><div class="ttdeci">@ RTE_CRYPTO_AEAD_OP_ENCRYPT</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00457">rte_crypto_sym.h:456</a></div></div>
<div class="ttc" id="astructrte__table__action__mtr__tc__params_html_a4269e06e25d2bd018a121045ac601455"><div class="ttname"><a href="structrte__table__action__mtr__tc__params.html#a4269e06e25d2bd018a121045ac601455">rte_table_action_mtr_tc_params::meter_profile_id</a></div><div class="ttdeci">uint32_t meter_profile_id</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00259">rte_table_action.h:259</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_a6a4e67d5a60f87389cd9f56787d2d176a27aa6e2021e308d76c3569b9f492a70c"><div class="ttname"><a href="rte__table__action_8h.html#a6a4e67d5a60f87389cd9f56787d2d176a27aa6e2021e308d76c3569b9f492a70c">RTE_TABLE_ACTION_POLICER_COLOR_GREEN</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_POLICER_COLOR_GREEN</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00241">rte_table_action.h:241</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2a9f9ca84acea19612c86d3da0898ed34e"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a9f9ca84acea19612c86d3da0898ed34e">RTE_TABLE_ACTION_TM</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_TM</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00080">rte_table_action.h:80</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_ad90568b948ab3ce824e43fd789de8b9a"><div class="ttname"><a href="rte__table__action_8h.html#ad90568b948ab3ce824e43fd789de8b9a">RTE_TABLE_ACTION_TC_MAX</a></div><div class="ttdeci">#define RTE_TABLE_ACTION_TC_MAX</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00184">rte_table_action.h:184</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2a491ff78ac06bce973d261ed4dea04101"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a491ff78ac06bce973d261ed4dea04101">RTE_TABLE_ACTION_STATS</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_STATS</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00092">rte_table_action.h:92</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a8998669d6c958fb1f0e31eeee515dd47a99f910b408b48db113988c3b841972b9"><div class="ttname"><a href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47a99f910b408b48db113988c3b841972b9">RTE_CRYPTO_AUTH_OP_VERIFY</a></div><div class="ttdeci">@ RTE_CRYPTO_AUTH_OP_VERIFY</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00352">rte_crypto_sym.h:352</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2a3a25fcdcb69e9946dc6d9f6fc7f6ac72"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a3a25fcdcb69e9946dc6d9f6fc7f6ac72">RTE_TABLE_ACTION_TAG</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_TAG</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00101">rte_table_action.h:101</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2a5ff88316e4574c62086f9f978a89fe5a"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a5ff88316e4574c62086f9f978a89fe5a">RTE_TABLE_ACTION_TIME</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_TIME</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00095">rte_table_action.h:95</a></div></div>
<div class="ttc" id="arte__pipeline_8h_html_a6376b240935404d998f003d113651572a5dc23d641b483615ea475152ac7ab7f4"><div class="ttname"><a href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572a5dc23d641b483615ea475152ac7ab7f4">RTE_PIPELINE_ACTION_PORT_META</a></div><div class="ttdeci">@ RTE_PIPELINE_ACTION_PORT_META</div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00189">rte_pipeline.h:189</a></div></div>
<div class="ttc" id="astructrte__crypto__auth__xform_html_a8e2f80c0b35f9851e755100ea1e8db95"><div class="ttname"><a href="structrte__crypto__auth__xform.html#a8e2f80c0b35f9851e755100ea1e8db95">rte_crypto_auth_xform::op</a></div><div class="ttdeci">enum rte_crypto_auth_operation op</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00252">rte_crypto_sym.h:368</a></div></div>
<div class="ttc" id="arte__byteorder_8h_html_a1d6fa9e3f0a9b2de0836177fa02eb403"><div class="ttname"><a href="rte__byteorder_8h.html#a1d6fa9e3f0a9b2de0836177fa02eb403">rte_be_to_cpu_32</a></div><div class="ttdeci">static uint32_t rte_be_to_cpu_32(rte_be32_t x)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_a8a28375b279ded9125c99a46bf3956ef"><div class="ttname"><a href="rte__ethdev_8h.html#a8a28375b279ded9125c99a46bf3956ef">rte_eth_macaddr_get</a></div><div class="ttdeci">int rte_eth_macaddr_get(uint16_t port_id, struct rte_ether_addr *mac_addr)</div></div>
<div class="ttc" id="arte__ethdev_8h_html_adec226574c53ae413252c9b15f6f4bab"><div class="ttname"><a href="rte__ethdev_8h.html#adec226574c53ae413252c9b15f6f4bab">rte_eth_stats_get</a></div><div class="ttdeci">int rte_eth_stats_get(uint16_t port_id, struct rte_eth_stats *stats)</div></div>
<div class="ttc" id="arte__table__action_8h_html_ae2962eacf079d46d74fc6e2e7ac4d666aad855c58b7ce34e2da8f1608c800778d"><div class="ttname"><a href="rte__table__action_8h.html#ae2962eacf079d46d74fc6e2e7ac4d666aad855c58b7ce34e2da8f1608c800778d">RTE_TABLE_ACTION_METER_TRTCM</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_METER_TRTCM</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00220">rte_table_action.h:220</a></div></div>
<div class="ttc" id="astructrte__crypto__auth__xform_html_a3de186f0ec180eb92911f6d723617b6c"><div class="ttname"><a href="structrte__crypto__auth__xform.html#a3de186f0ec180eb92911f6d723617b6c">rte_crypto_auth_xform::key</a></div><div class="ttdeci">struct rte_crypto_auth_xform::@114 key</div></div>
<div class="ttc" id="arte__cycles_8h_html"><div class="ttname"><a href="rte__cycles_8h.html">rte_cycles.h</a></div></div>
<div class="ttc" id="astructrte__table__action__mtr__counters_html"><div class="ttname"><a href="structrte__table__action__mtr__counters.html">rte_table_action_mtr_counters</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00327">rte_table_action.h:327</a></div></div>
<div class="ttc" id="arte__common_8h_html_ac963da91b35efa4700b73a1f4eb1d8a6"><div class="ttname"><a href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a></div><div class="ttdeci">#define RTE_DIM(a)</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00809">rte_common.h:809</a></div></div>
<div class="ttc" id="astructpipeline__params_html"><div class="ttname"><a href="structpipeline__params.html">pipeline_params</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__eth__softnic__internals_8h_source.html#l00368">rte_eth_softnic_internals.h:368</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_ade8a6c56c3b7c65fa4cabf1d1106fdc7"><div class="ttname"><a href="rte__ethdev_8h.html#ade8a6c56c3b7c65fa4cabf1d1106fdc7">rte_eth_link_speed_to_str</a></div><div class="ttdeci">__rte_experimental const char * rte_eth_link_speed_to_str(uint32_t link_speed)</div></div>
<div class="ttc" id="astructrte__pipeline__table__stats_html_a324dbcea014c359561641979bb66c6f1"><div class="ttname"><a href="structrte__pipeline__table__stats.html#a324dbcea014c359561641979bb66c6f1">rte_pipeline_table_stats::stats</a></div><div class="ttdeci">struct rte_table_stats stats</div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00103">rte_pipeline.h:109</a></div></div>
<div class="ttc" id="arte__common_8h_html_aa870761f77784e5b578d2ade3301d893"><div class="ttname"><a href="rte__common_8h.html#aa870761f77784e5b578d2ade3301d893">__rte_packed</a></div><div class="ttdeci">#define __rte_packed</div><div class="ttdef"><b>Definition:</b> <a href="rte__common_8h_source.html#l00084">rte_common.h:84</a></div></div>
<div class="ttc" id="astructrte__crypto__cipher__xform_html_ac681806181c80437cfab37335f62ff39"><div class="ttname"><a href="structrte__crypto__cipher__xform.html#ac681806181c80437cfab37335f62ff39">rte_crypto_cipher_xform::offset</a></div><div class="ttdeci">uint16_t offset</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00226">rte_crypto_sym.h:226</a></div></div>
<div class="ttc" id="astructrte__table__action__dscp__table__entry_html_af49d1ab21b76d88c8f50a0bec4d9a42b"><div class="ttname"><a href="structrte__table__action__dscp__table__entry.html#af49d1ab21b76d88c8f50a0bec4d9a42b">rte_table_action_dscp_table_entry::color</a></div><div class="ttdeci">enum rte_color color</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00200">rte_table_action.h:205</a></div></div>
<div class="ttc" id="astructrte__table__action__ttl__counters_html"><div class="ttname"><a href="structrte__table__action__ttl__counters.html">rte_table_action_ttl_counters</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00642">rte_table_action.h:642</a></div></div>
<div class="ttc" id="astructrte__crypto__cipher__xform_html_a1892eba2086d12ac2b09005aeb09ea3b"><div class="ttname"><a href="structrte__crypto__cipher__xform.html#a1892eba2086d12ac2b09005aeb09ea3b">rte_crypto_cipher_xform::length</a></div><div class="ttdeci">uint16_t length</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00200">rte_crypto_sym.h:200</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_ac3fd327e32beaa5080a6e42040e4629caca0bdb5026849382b38c7ddc42a902da"><div class="ttname"><a href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629caca0bdb5026849382b38c7ddc42a902da">RTE_TABLE_ACTION_ENCAP_QINQ</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_ENCAP_QINQ</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00371">rte_table_action.h:371</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_a6a4e67d5a60f87389cd9f56787d2d176a711a4c01a0c9649e024cab6d3affb806"><div class="ttname"><a href="rte__table__action_8h.html#a6a4e67d5a60f87389cd9f56787d2d176a711a4c01a0c9649e024cab6d3affb806">RTE_TABLE_ACTION_POLICER_COLOR_YELLOW</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_POLICER_COLOR_YELLOW</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00244">rte_table_action.h:244</a></div></div>
<div class="ttc" id="astructrte__pipeline__port__in__stats_html"><div class="ttname"><a href="structrte__pipeline__port__in__stats.html">rte_pipeline_port_in_stats</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00088">rte_pipeline.h:88</a></div></div>
<div class="ttc" id="arte__common_8h_html"><div class="ttname"><a href="rte__common_8h.html">rte_common.h</a></div></div>
<div class="ttc" id="astructrte__crypto__sym__xform_html_afe8d3d45863238a8b9d868967071061c"><div class="ttname"><a href="structrte__crypto__sym__xform.html#afe8d3d45863238a8b9d868967071061c">rte_crypto_sym_xform::aead</a></div><div class="ttdeci">struct rte_crypto_aead_xform aead</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00548">rte_crypto_sym.h:554</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_ac3fd327e32beaa5080a6e42040e4629ca0ce6e8832b5b48c705b9f0f77d018b7c"><div class="ttname"><a href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629ca0ce6e8832b5b48c705b9f0f77d018b7c">RTE_TABLE_ACTION_ENCAP_QINQ_PPPOE</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_ENCAP_QINQ_PPPOE</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00385">rte_table_action.h:385</a></div></div>
<div class="ttc" id="astructrte__crypto__sym__xform_html"><div class="ttname"><a href="structrte__crypto__sym__xform.html">rte_crypto_sym_xform</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00543">rte_crypto_sym.h:543</a></div></div>
<div class="ttc" id="astructrte__crypto__auth__xform_html_a765cf2674d1c06ca36503b60c24c6b34"><div class="ttname"><a href="structrte__crypto__auth__xform.html#a765cf2674d1c06ca36503b60c24c6b34">rte_crypto_auth_xform::digest_length</a></div><div class="ttdeci">uint16_t digest_length</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00421">rte_crypto_sym.h:421</a></div></div>
<div class="ttc" id="astructrte__pipeline__table__stats_html"><div class="ttname"><a href="structrte__pipeline__table__stats.html">rte_pipeline_table_stats</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00107">rte_pipeline.h:107</a></div></div>
<div class="ttc" id="astructrte__crypto__sym__xform_html_a714d838357b795dd999dc8de04f1c7f4"><div class="ttname"><a href="structrte__crypto__sym__xform.html#a714d838357b795dd999dc8de04f1c7f4">rte_crypto_sym_xform::type</a></div><div class="ttdeci">enum rte_crypto_sym_xform_type type</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00544">rte_crypto_sym.h:546</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9"><div class="ttname"><a href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a2a1c3a5cdf2efba6f028e2c70ab9c2c9">RTE_CRYPTO_SYM_XFORM_AUTH</a></div><div class="ttdeci">@ RTE_CRYPTO_SYM_XFORM_AUTH</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00529">rte_crypto_sym.h:529</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_a6a4e67d5a60f87389cd9f56787d2d176afe7f90714cd9ae3907e98073af4272ef"><div class="ttname"><a href="rte__table__action_8h.html#a6a4e67d5a60f87389cd9f56787d2d176afe7f90714cd9ae3907e98073af4272ef">RTE_TABLE_ACTION_POLICER_DROP</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_POLICER_DROP</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00250">rte_table_action.h:250</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a56200b0c25f3ecab5abe9bd2b647c215"><div class="ttname"><a href="rte__ethdev_8h.html#a56200b0c25f3ecab5abe9bd2b647c215">rte_eth_link_get</a></div><div class="ttdeci">int rte_eth_link_get(uint16_t port_id, struct rte_eth_link *link)</div></div>
<div class="ttc" id="astructrte__pipeline__port__out__stats_html"><div class="ttname"><a href="structrte__pipeline__port__out__stats.html">rte_pipeline_port_out_stats</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00098">rte_pipeline.h:98</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html_a386c83c7cc16ec9886ecf2925e7be4a3"><div class="ttname"><a href="rte__ethdev_8h.html#a386c83c7cc16ec9886ecf2925e7be4a3">rte_eth_dev_get_mtu</a></div><div class="ttdeci">int rte_eth_dev_get_mtu(uint16_t port_id, uint16_t *mtu)</div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c"><div class="ttname"><a href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782ac8a5a68138b7ed7a6a80636dbf7d8b2c">RTE_CRYPTO_SYM_XFORM_CIPHER</a></div><div class="ttdeci">@ RTE_CRYPTO_SYM_XFORM_CIPHER</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00530">rte_crypto_sym.h:530</a></div></div>
<div class="ttc" id="arte__port__in__action_8h_html_ac5d93af8e87d41bfefed6ed260fb380eae3e717e82386ce7c487c636c258b3900"><div class="ttname"><a href="rte__port__in__action_8h.html#ac5d93af8e87d41bfefed6ed260fb380eae3e717e82386ce7c487c636c258b3900">RTE_PORT_IN_ACTION_FLTR</a></div><div class="ttdeci">@ RTE_PORT_IN_ACTION_FLTR</div><div class="ttdef"><b>Definition:</b> <a href="rte__port__in__action_8h_source.html#l00063">rte_port_in_action.h:63</a></div></div>
<div class="ttc" id="arte__ethdev_8h_html"><div class="ttname"><a href="rte__ethdev_8h.html">rte_ethdev.h</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2a7442253cfdff0aec945b0ad7ddf5ab2d"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a7442253cfdff0aec945b0ad7ddf5ab2d">RTE_TABLE_ACTION_MTR</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_MTR</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00077">rte_table_action.h:77</a></div></div>
<div class="ttc" id="astructrte__pipeline__port__in__stats_html_a48efd9560ccf56a1dedb5d25e323fa8a"><div class="ttname"><a href="structrte__pipeline__port__in__stats.html#a48efd9560ccf56a1dedb5d25e323fa8a">rte_pipeline_port_in_stats::stats</a></div><div class="ttdeci">struct rte_port_in_stats stats</div><div class="ttdef"><b>Definition:</b> <a href="rte__pipeline_8h_source.html#l00084">rte_pipeline.h:90</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2a6368c734fa9c1ac9cb591160eb6bf293"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a6368c734fa9c1ac9cb591160eb6bf293">RTE_TABLE_ACTION_NAT</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_NAT</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00086">rte_table_action.h:86</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_ac3fd327e32beaa5080a6e42040e4629ca0cc0e97e7d412911cbe6e98994d4c2e4"><div class="ttname"><a href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629ca0cc0e97e7d412911cbe6e98994d4c2e4">RTE_TABLE_ACTION_ENCAP_VLAN</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_ENCAP_VLAN</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00368">rte_table_action.h:368</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_aa21ba0affdc8a7a267c879fb5599a57ea331ebd5a481118673489e7c580530179"><div class="ttname"><a href="rte__crypto__sym_8h.html#aa21ba0affdc8a7a267c879fb5599a57ea331ebd5a481118673489e7c580530179">RTE_CRYPTO_AEAD_OP_DECRYPT</a></div><div class="ttdeci">@ RTE_CRYPTO_AEAD_OP_DECRYPT</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00460">rte_crypto_sym.h:458</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a3c203be2dfa1c228cc8ccf0644422321a74a31028a7180f96bcbe6c1edc298c5b"><div class="ttname"><a href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321a74a31028a7180f96bcbe6c1edc298c5b">RTE_CRYPTO_CIPHER_OP_ENCRYPT</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_OP_ENCRYPT</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00174">rte_crypto_sym.h:173</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a3c203be2dfa1c228cc8ccf0644422321a4ec0ce9be05fae0758c95aadfb03c4ee"><div class="ttname"><a href="rte__crypto__sym_8h.html#a3c203be2dfa1c228cc8ccf0644422321a4ec0ce9be05fae0758c95aadfb03c4ee">RTE_CRYPTO_CIPHER_OP_DECRYPT</a></div><div class="ttdeci">@ RTE_CRYPTO_CIPHER_OP_DECRYPT</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00177">rte_crypto_sym.h:175</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a46aecd6ebcceea1eba91d16a90e76782a87d8d14b56f41d42ca643d33a279912a"><div class="ttname"><a href="rte__crypto__sym_8h.html#a46aecd6ebcceea1eba91d16a90e76782a87d8d14b56f41d42ca643d33a279912a">RTE_CRYPTO_SYM_XFORM_AEAD</a></div><div class="ttdeci">@ RTE_CRYPTO_SYM_XFORM_AEAD</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00532">rte_crypto_sym.h:531</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_ac3fd327e32beaa5080a6e42040e4629cade2089a818728f7245cb6a3aea427875"><div class="ttname"><a href="rte__table__action_8h.html#ac3fd327e32beaa5080a6e42040e4629cade2089a818728f7245cb6a3aea427875">RTE_TABLE_ACTION_ENCAP_ETHER</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_ENCAP_ETHER</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00365">rte_table_action.h:365</a></div></div>
<div class="ttc" id="astructrte__crypto__sym__xform_html_aa8c788b7f832e2a4183a8924ff8dab97"><div class="ttname"><a href="structrte__crypto__sym__xform.html#aa8c788b7f832e2a4183a8924ff8dab97">rte_crypto_sym_xform::next</a></div><div class="ttdeci">struct rte_crypto_sym_xform * next</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00544">rte_crypto_sym.h:544</a></div></div>
<div class="ttc" id="arte__meter_8h_html_a35388a9ecf2eab3020433bd6207b3436a43d24f9a4881b17f0d0af3c8358fea05"><div class="ttname"><a href="rte__meter_8h.html#a35388a9ecf2eab3020433bd6207b3436a43d24f9a4881b17f0d0af3c8358fea05">RTE_COLOR_GREEN</a></div><div class="ttdeci">@ RTE_COLOR_GREEN</div><div class="ttdef"><b>Definition:</b> <a href="rte__meter_8h_source.html#l00037">rte_meter.h:37</a></div></div>
<div class="ttc" id="arte__port__in__action_8h_html_aa8e04a1dab3e174379b73d5e57c8bb35"><div class="ttname"><a href="rte__port__in__action_8h.html#aa8e04a1dab3e174379b73d5e57c8bb35">RTE_PORT_IN_ACTION_FLTR_KEY_SIZE</a></div><div class="ttdeci">#define RTE_PORT_IN_ACTION_FLTR_KEY_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="rte__port__in__action_8h_source.html#l00073">rte_port_in_action.h:73</a></div></div>
<div class="ttc" id="arte__sched_8h_html_a987eaedb9cd05abdbdb1bf30ed446ac1"><div class="ttname"><a href="rte__sched_8h.html#a987eaedb9cd05abdbdb1bf30ed446ac1">RTE_SCHED_TRAFFIC_CLASSES_PER_PIPE</a></div><div class="ttdeci">#define RTE_SCHED_TRAFFIC_CLASSES_PER_PIPE</div><div class="ttdef"><b>Definition:</b> <a href="rte__sched_8h_source.html#l00089">rte_sched.h:89</a></div></div>
<div class="ttc" id="astructrte__table__action__mpls__hdr_html_a67deec524d278467a2815a2783b95591"><div class="ttname"><a href="structrte__table__action__mpls__hdr.html#a67deec524d278467a2815a2783b95591">rte_table_action_mpls_hdr::tc</a></div><div class="ttdeci">uint8_t tc</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00404">rte_table_action.h:404</a></div></div>
<div class="ttc" id="arte__meter_8h_html_a35388a9ecf2eab3020433bd6207b3436a910409b5938b2e9ad695db4676353e68"><div class="ttname"><a href="rte__meter_8h.html#a35388a9ecf2eab3020433bd6207b3436a910409b5938b2e9ad695db4676353e68">RTE_COLOR_RED</a></div><div class="ttdeci">@ RTE_COLOR_RED</div><div class="ttdef"><b>Definition:</b> <a href="rte__meter_8h_source.html#l00039">rte_meter.h:39</a></div></div>
<div class="ttc" id="astructrte__crypto__auth__xform_html_a00412ca4847e32cce6759541ca06ca86"><div class="ttname"><a href="structrte__crypto__auth__xform.html#a00412ca4847e32cce6759541ca06ca86">rte_crypto_auth_xform::algo</a></div><div class="ttdeci">enum rte_crypto_auth_algorithm algo</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00252">rte_crypto_sym.h:370</a></div></div>
<div class="ttc" id="astructrte__crypto__sym__xform_html_ac50ef6f5e9722a6125cad8e2547c9847"><div class="ttname"><a href="structrte__crypto__sym__xform.html#ac50ef6f5e9722a6125cad8e2547c9847">rte_crypto_sym_xform::cipher</a></div><div class="ttdeci">struct rte_crypto_cipher_xform cipher</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00548">rte_crypto_sym.h:552</a></div></div>
<div class="ttc" id="astructrte__ether__addr_html"><div class="ttname"><a href="structrte__ether__addr.html">rte_ether_addr</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00064">rte_ether.h:64</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_af0ddb775e0c9d6dd04398f411cef5e6d"><div class="ttname"><a href="rte__table__action_8h.html#af0ddb775e0c9d6dd04398f411cef5e6d">RTE_TABLE_ACTION_LB_TABLE_SIZE</a></div><div class="ttdeci">#define RTE_TABLE_ACTION_LB_TABLE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00142">rte_table_action.h:142</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2a962e3a5154b7a1a3e8648bd129c4b561"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a962e3a5154b7a1a3e8648bd129c4b561">RTE_TABLE_ACTION_SYM_CRYPTO</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_SYM_CRYPTO</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00098">rte_table_action.h:98</a></div></div>
<div class="ttc" id="astructrte__eth__stats_html"><div class="ttname"><a href="structrte__eth__stats.html">rte_eth_stats</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__ethdev_8h_source.html#l00244">rte_ethdev.h:244</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_ad57cb5966e6545c495651953f55f057d"><div class="ttname"><a href="rte__cryptodev_8h.html#ad57cb5966e6545c495651953f55f057d">rte_cryptodev_get_aead_algo_enum</a></div><div class="ttdeci">int rte_cryptodev_get_aead_algo_enum(enum rte_crypto_aead_algorithm *algo_enum, const char *algo_string)</div></div>
<div class="ttc" id="astructrte__crypto__auth__xform_html_a579f5164b5b16e18ddcdb0296ef81799"><div class="ttname"><a href="structrte__crypto__auth__xform.html#a579f5164b5b16e18ddcdb0296ef81799">rte_crypto_auth_xform::data</a></div><div class="ttdeci">const uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00374">rte_crypto_sym.h:374</a></div></div>
<div class="ttc" id="astructrte__table__action__sym__crypto__params_html"><div class="ttname"><a href="structrte__table__action__sym__crypto__params.html">rte_table_action_sym_crypto_params</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00750">rte_table_action.h:750</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_aac0e6b2a8cb903ccad7118b8c8155067"><div class="ttname"><a href="rte__cryptodev_8h.html#aac0e6b2a8cb903ccad7118b8c8155067">rte_cryptodev_get_cipher_algo_enum</a></div><div class="ttdeci">int rte_cryptodev_get_cipher_algo_enum(enum rte_crypto_cipher_algorithm *algo_enum, const char *algo_string)</div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2a64248fbadf2339ff36eee3c6c7c54ce6"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2a64248fbadf2339ff36eee3c6c7c54ce6">RTE_TABLE_ACTION_TTL</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_TTL</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00089">rte_table_action.h:89</a></div></div>
<div class="ttc" id="astructrte__table__action__mtr__tc__params_html_afbd6fd0aa98794a1c59a425a0a6ca13f"><div class="ttname"><a href="structrte__table__action__mtr__tc__params.html#afbd6fd0aa98794a1c59a425a0a6ca13f">rte_table_action_mtr_tc_params::policer</a></div><div class="ttdeci">enum rte_table_action_policer policer[RTE_COLORS]</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00259">rte_table_action.h:262</a></div></div>
<div class="ttc" id="arte__crypto__sym_8h_html_a8998669d6c958fb1f0e31eeee515dd47aa4697c029df30850f9f01b1c641aca32"><div class="ttname"><a href="rte__crypto__sym_8h.html#a8998669d6c958fb1f0e31eeee515dd47aa4697c029df30850f9f01b1c641aca32">RTE_CRYPTO_AUTH_OP_GENERATE</a></div><div class="ttdeci">@ RTE_CRYPTO_AUTH_OP_GENERATE</div><div class="ttdef"><b>Definition:</b> <a href="rte__crypto__sym_8h_source.html#l00354">rte_crypto_sym.h:353</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aecaf0325b1c0d95423d65975ee04d5e1">RTE_TABLE_ACTION_ENCAP</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_ENCAP</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00083">rte_table_action.h:83</a></div></div>
<div class="ttc" id="astructrte__table__action__mtr__tc__params_html"><div class="ttname"><a href="structrte__table__action__mtr__tc__params.html">rte_table_action_mtr_tc_params</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00257">rte_table_action.h:257</a></div></div>
<div class="ttc" id="astructrte__crypto__cipher__xform_html_abfc0b8c122ad81aec569d93a5eea0fe4"><div class="ttname"><a href="structrte__crypto__cipher__xform.html#abfc0b8c122ad81aec569d93a5eea0fe4">rte_crypto_cipher_xform::iv</a></div><div class="ttdeci">struct rte_crypto_cipher_xform::@113 iv</div></div>
<div class="ttc" id="astructrte__table__action__mpls__hdr_html"><div class="ttname"><a href="structrte__table__action__mpls__hdr.html">rte_table_action_mpls_hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00402">rte_table_action.h:402</a></div></div>
<div class="ttc" id="astructrte__ether__addr_html_ad6f7cb65b39d12b5250ecf82c8ffaa45"><div class="ttname"><a href="structrte__ether__addr.html#ad6f7cb65b39d12b5250ecf82c8ffaa45">rte_ether_addr::addr_bytes</a></div><div class="ttdeci">uint8_t addr_bytes[RTE_ETHER_ADDR_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="rte__ether_8h_source.html#l00065">rte_ether.h:65</a></div></div>
<div class="ttc" id="astructrte__table__action__meter__profile_html"><div class="ttname"><a href="structrte__table__action__meter__profile.html">rte_table_action_meter_profile</a></div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00224">rte_table_action.h:224</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_acd4dfc142512f5919b3e3113335f86b2aa5194910932359cba3eeca7183922dbf"><div class="ttname"><a href="rte__table__action_8h.html#acd4dfc142512f5919b3e3113335f86b2aa5194910932359cba3eeca7183922dbf">RTE_TABLE_ACTION_FWD</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_FWD</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00071">rte_table_action.h:71</a></div></div>
<div class="ttc" id="astructrte__table__action__dscp__table__entry_html_ad58fbefda003686d57036245718cea8a"><div class="ttname"><a href="structrte__table__action__dscp__table__entry.html#ad58fbefda003686d57036245718cea8a">rte_table_action_dscp_table_entry::tc_id</a></div><div class="ttdeci">uint32_t tc_id</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00195">rte_table_action.h:195</a></div></div>
<div class="ttc" id="arte__cryptodev_8h_html_a385cf406030abf07a1581b6ae3aa03f2"><div class="ttname"><a href="rte__cryptodev_8h.html#a385cf406030abf07a1581b6ae3aa03f2">rte_cryptodev_get_auth_algo_enum</a></div><div class="ttdeci">int rte_cryptodev_get_auth_algo_enum(enum rte_crypto_auth_algorithm *algo_enum, const char *algo_string)</div></div>
<div class="ttc" id="astructrte__table__action__mtr__counters_html_afb347cc5ec7a582aaf2067d1bcc979af"><div class="ttname"><a href="structrte__table__action__mtr__counters.html#afb347cc5ec7a582aaf2067d1bcc979af">rte_table_action_mtr_counters::stats</a></div><div class="ttdeci">struct rte_table_action_mtr_counters_tc stats[RTE_TABLE_ACTION_TC_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00323">rte_table_action.h:329</a></div></div>
<div class="ttc" id="arte__table__action_8h_html_ae2962eacf079d46d74fc6e2e7ac4d666ab51bd4d8c02db27c18cc31b0e67fb6b7"><div class="ttname"><a href="rte__table__action_8h.html#ae2962eacf079d46d74fc6e2e7ac4d666ab51bd4d8c02db27c18cc31b0e67fb6b7">RTE_TABLE_ACTION_METER_SRTCM</a></div><div class="ttdeci">@ RTE_TABLE_ACTION_METER_SRTCM</div><div class="ttdef"><b>Definition:</b> <a href="rte__table__action_8h_source.html#l00217">rte_table_action.h:217</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
